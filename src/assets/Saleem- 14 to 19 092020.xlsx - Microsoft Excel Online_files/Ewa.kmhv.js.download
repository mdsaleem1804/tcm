Type.registerNamespace("CADWLTR");CADWLTR.e=function(){};CADWLTR.a=function(n,t,i,r,u,f,e){var s,o,a,d,g,p,w,c,v,y,nt,tt,h,b,k,l;if(this.dN=Function.createDelegate(this,this.dR),this.dP=Function.createDelegate(this,this.eN),this.dO=Function.createDelegate(this,this.eM),this.cX=Function.createDelegate(this,this.dU),this.cW=Function.createDelegate(this,this.eK),this.dM=Function.createDelegate(this,this.eJ),CADWLTR.a.initializeBase(this),this.bG=r||new CADWLTR.b(n,!0),this.bG.b(this),this.ce=f,this.dQ=e,t?i?this.ce?(this.g(3),this.h(1,this.cY()),this.h(2,$a.fQ),this.h(0,$a.b)):(this.g(4),this.h(1,this.cY()),this.h(2,$a.b)):(this.g(6),this.h(0,$a.b)):this.g(5),s=document.createElement("span"),this.cZ()&&(s.className=this.cZ()),o=document.createElement("a"),o.innerText=this.bX(),o.href=n,o.target="_blank",o.id=this.bW(),o.className="AllowBrowserClick",a=!Common.c.r()&&!!u&&u.e.length>0,a)for(d=Common.k.r(n,u),g=Common.k.s(n,u),o.href="#",o.target="_self",this.a=document.createElement("form"),this.a.id="printPreviewPostForm1",this.a.method="post",this.a.target="_blank",this.a.action=g,p=d.$$ge();p.$$mn();)w=p.$$cu(),c=document.createElement("input"),c.type="hidden",c.name=w.b,c.value=w.a,this.a.appendChild(c);else this.a=null;if(v=[],y=[],this.a?(nt=this,tt=function(){nt.dW()},Array.add(y,{type:"AppLinkProps",id:this.bW(),text:this.bX(),handler:tt})):Array.add(y,{type:"AppLinkProps",id:this.bW(),text:this.bX(),handler:{href:a?"#":n,target:a?"_self":"_blank"}}),Array.add(v,this.bH()),i)k=document.createElement("span"),k.innerText=this.bH().replace("{0}",""),s.appendChild(k);else if(this.dT()){h=document.createElement("span");h.id=this.n+"message";var it=document.createElement("span"),rt=document.createElement("span"),ut=this.bH().split("{0}");it.innerText=ut[0];rt.innerText=ut[1];h.appendChild(it);h.appendChild(o);h.appendChild(rt);s.appendChild(h)}else b=document.createElement("span"),b.innerText=this.bH(),s.appendChild(b),s.appendChild(document.createElement("br")),s.appendChild(document.createElement("br")),s.appendChild(o),Array.add(v,"{0}");this.a&&s.appendChild(this.a);CADWLTR.a.a()&&(this.bM()&&this.bL()&&this.eG(this.bL(),this.bM()),this.dL(v,y));this.cc(f?$a.fR:$a.a,null,this.dS(),null,this.dM,CADWLTR.a.a()?null:s,!1);this.K(this.n+"message");!CADWLTR.a.a()&&this.bM()&&this.bL()&&(l=document.createElement("div"),l.className="WACDialogLearnMoreLinkContainer",this.b=document.createElement("a"),this.b.innerText=this.bL(),this.b.href=this.bM(),this.b.target="_blank",this.b.id=this.n+"LearnMoreLinkId",this.b.className="AllowBrowserClick",l.appendChild(this.b),t?this.f.insertBefore(l,this.f.lastChild):this.f.appendChild(l),this.K(String.format("{0} {1}",this.n+"message",this.n+"LearnMoreLinkId")));this.e=o;i?this.G(this.C):this.G(this.e);this.da();Common.a.b().j().a("click",this.e,this.cW,null);this.b&&Common.a.b().j().a("click",this.b,this.cX,null);this.ch=!1};CADWLTR.a.a=function(){return Common.a.b().a().f()&&Common.a.a.a("ConvertStandardDialogsToReactIsEnabled")};CADWLTR.a.prototype={e:null,b:null,bG:null,a:null,Z:null,bs:null,ce:!1,dQ:!1,dS:function(){return null},bM:function(){return null},bL:function(){return null},dT:function(){return!1},cY:function(){return $a.bH},cZ:function(){return null},eL:function(){},dq:function(){this.a&&(this.Z||(this.Z=this.dO,this.D.a("click",this.C,this.Z)),this.bs||(this.bs=this.dP,this.o.a("keyup",this.C,this.bs)));CommonUI.c.prototype.dq.call(this)},eM:function(n){return this.dR(n),!0},eN:function(n){return this.ex(n,this.dN)},dR:function(n){this.a&&this.a.submit();this.cO(n.c,0)},dV:function(){},eK:function(){return this.db(),this.a?this.a.submit():this.bG.a(),!0},dU:function(){return!1},dispose:function(){this.bG.dispose();this.e&&(Common.a.b().j().b("click",this.e,this.cW),this.e=null);this.b&&(Common.a.b().j().b("click",this.b,this.cX),this.b=null);this.D&&this.Z&&(this.D.b("click",this.C,this.Z),this.Z=null);this.o&&this.bs&&(this.o.b("keyup",this.C,this.bs),this.bs=null);CommonUI.d.prototype.dispose.call(this)},dW:function(){this.a&&(document.body.appendChild(this.a),this.a.submit(),document.body.removeChild(this.a))},eJ:function(n){n===1?(this.dV(),this.a?CADWLTR.a.a()&&this.dW():this.bG.a()):this.ce&&n===2&&this.eL();this.dispose()}};CADWLTR.b=function(n,t){this.c=n;this.d=t};CADWLTR.b.prototype={c:null,d:!1,b:function(){},a:function(){this.d?Common.g.F(this.c):Common.g.c(this.c,"_blank","",!1,"OpenUrlInTabDialogDownloadBehavior:DoDownload")},dispose:function(){}};CADWLTR.c=function(n,t,i){CADWLTR.c.initializeBase(this,[n,!0,Common.a.bY,new CADWLTR.b(n,t),i,!1,!1])};CADWLTR.c.prototype={dS:function(){return"Print_32x32x32"},bH:function(){return Common.a.bY?$a.gJ:$a.gI},bX:function(){return $a.gK},bW:function(){return"PrintPDFLink"},cY:function(){return $a.gL},cZ:function(){return Common.a.bY?"UIFontDialogTextLarge":null},da:function(){Diag.a.a(7690390,324,50,"Legacy print dialog displayed")},db:function(){Common.a.m.b(9540,1);Diag.a.a(7690391,324,50,"Legacy print dialog clicked")},dV:function(){Diag.a.a(19462215,324,50,"Legacy print dialog button clicked")}};CADWLTR.d=function(){};CADWLTR.d.a=function(){Common.App.a.a().a(new CADWLTR.d,0,!1)};CADWLTR.d.prototype={a:function(){return"Common.App.DialogWithLinkToResource"},c:function(){},b:function(){}};CADWLTR.a.registerClass("CADWLTR.a",CommonUI.d);CADWLTR.c.registerClass("CADWLTR.c",CADWLTR.a);CADWLTR.d.a();Type.registerNamespace("Common.App.DirectPrint");Common.App.DirectPrint.h=function(){};Common.App.DirectPrint.h.registerInterface("Common.App.DirectPrint.h");Common.App.DirectPrint.i=function(){};Common.App.DirectPrint.i.registerInterface("Common.App.DirectPrint.i");Common.App.DirectPrint.e=function(){};Common.App.DirectPrint.e.registerInterface("Common.App.DirectPrint.e");Common.App.DirectPrint.b=function(n){var t,i;this.i=Boolean.parse(n.DirectPrintIsEnabled||"false");this.k=Boolean.parse(n.DirectPrintProbeIsEnabled||"false");this.j=Boolean.parse(n.DirectPrintEnabledForInternetExplorer||"false");this.a=(n.DirectPrintSupportedMimeTypes||"").split(Common.App.DirectPrint.b.a);this.b=(n.DirectPrintSupportedPlugins||"").split(Common.App.DirectPrint.b.a);this.g=(n.DirectPrintImmersivePreviewPlugins||"").split(Common.App.DirectPrint.b.a);this.d=Boolean.parse(n.DirectPrintEnabledForEdge||"false");this.h=Boolean.parse(n.ChromePrintLayoutFixIsEnabled||"false");this.f=parseInt(n.ChromeVersionFromWhichPrintLayoutIsEnabled||"76");this.c=14;this.e=14394;t=n.DirectPrintMinimalSupportedEdgeVersion;t?(i=t.split("."),i.length===2?(this.c=parseInt(i[0]),this.e=parseInt(i[1])):Diag.a.a(20734112,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",t)):Diag.a.a(20734113,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")};Common.App.DirectPrint.b.prototype={i:!1,k:!1,j:!1,a:null,b:null,g:null,d:!1,c:0,e:0,h:!1,f:0};Common.App.DirectPrint.f=function(n,t,i,r){this.bW=Function.createDelegate(this,this.cZ);this.ce=Function.createDelegate(this,this.da);this.cW=Function.createDelegate(this,this.db);this.bL=[];Common.App.DirectPrint.f.initializeBase(this);this.bs=t;this.bM=n;this.bX=i;this.bG=r;this.bH=new DiagUse.b("LoadResource","LoadPrintablePdf")};Common.App.DirectPrint.f.prototype={Z:null,b:null,bG:null,bs:null,bM:null,bX:!1,bH:null,e:null,a:function(){var n,t,f,e,r,u,i;if(this.g(5),this.fO(40),n=document.createElement("span"),n.id=this.n+"DirectPrintHeaderContent",t=document.createElement("span"),t.innerText=$a.dP,Sys.UI.DomElement.addCssClass(t,"DirectPrintHeader"),this.e=document.createElement("iframe"),this.e.name="pdfObjectFrame",this.e.title=$a.dQ,this.e.onload=this.cW,this.bG&&this.bG.e.length>0)for(f=Common.k.r(this.bs,this.bG),e=Common.k.s(this.bs,this.bG),this.b=document.createElement("form"),this.b.id="printPreviewPostForm",this.b.method="POST",this.b.target=this.e.name,this.b.action=e,r=f.$$ge();r.$$mn();)u=r.$$cu(),i=document.createElement("input"),i.type="hidden",i.name=u.b,i.value=u.a,this.b.appendChild(i);else this.e.setAttribute("src",this.bs);Sys.UI.DomElement.addCssClass(this.e,"ObjectInDialog");this.bX?(Sys.UI.DomElement.addCssClass(this.e,"DirectPrintPdfObjectHidden"),t.innerText=$a.dR,Common.F.a(this.e,"aria-hidden","true")):(Sys.UI.DomElement.addCssClass(this.e,"DirectPrintPdfObject"),this.bL.push(this.e));n.appendChild(t);n.appendChild(document.createElement("br"));n.appendChild(this.e);this.b&&n.appendChild(this.b);n.appendChild(document.createElement("br"));n.appendChild(this.cX(this.b?"#":this.bs));this.bH.d();this.cc($a.dg,null,null,null,null,n,!1);this.K(this.n+"DirectPrintHeaderContent");this.b&&this.b.submit();Common.a.a&&!Common.a.a.a("WacPrintDialogFocus")?this.Z.focus():this.cY();Diag.a.a(4771852,328,50,"Direct Print Dialog launched.")},cX:function(n){var i=document.createElement("span"),r=document.createElement("span"),t;return r.innerText=$a.dN,i.appendChild(r),t=document.createElement("a"),t.innerText=$a.dO,t.href=n,t.target="_blank",t.id="PrintPDFLink",t.className="AllowBrowserClick",this.Z=t,this.bL.push(this.Z),i.appendChild(document.createElement("br")),i.appendChild(t),this.b&&Common.j.a(t,"click",this.ce),this.bM.a("click",this.Z,this.bW,null),i},da:function(n){this.b&&(this.b.target="_blank",this.b.submit());n.preventDefault()},cY:function(){if(this.bL.length>0){var t=new CommonUI.l(this.bL),i=Common.n.a(),n=i.j();n&&(this.Z.focus(),n.a=t,n.b=!0)}},cZ:function(){return Diag.a.a(4585050,328,50,"Download PDF from Direct Print dialog clicked."),!1},db:function(){Diag.a.a(51426332,328,50,"PDF content loaded successfully");this.bH&&this.bH.a()},dispose:function(){this.Z&&(this.bM.b("click",this.Z,this.bW),this.Z=null);Common.m.g(this.e);this.e=null;CommonUI.d.prototype.dispose.call(this)}};Common.App.DirectPrint.c=function(n){this.b=n};Common.App.DirectPrint.c.prototype={b:null,a:function(n,t,i){return new Common.App.DirectPrint.f(this.b,n,t,i)}};Common.App.DirectPrint.d=function(n,t){this.a=n;this.b=t};Common.App.DirectPrint.d.prototype={a:null,b:null};Common.App.DirectPrint.a=function(n,t,i,r,u,f,e,o,s,h){this.p=Function.createDelegate(this,this.s);this.d=n;this.e=t;this.h=i;this.j=r;this.k=u;this.f=new($$sc.z.$$(Common.App.DirectPrint.d))(this.p);this.i=f;this.n=s;this.o=e;this.l=o;this.m=h};Common.App.DirectPrint.a.c=function(n){try{return new ActiveXObject(n),!0}catch(t){Diag.a.a(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",n)}return!1};Common.App.DirectPrint.a.b=function(n){return isNullOrUndefined(n)?!1:!isNullOrUndefined(n.enabledPlugin)};Common.App.DirectPrint.a.d=function(n){return Common.c.f()?!0:Common.c.a()&&n.j?!0:n.d&&Common.App.DirectPrint.a.a(n)?!0:!1};Common.App.DirectPrint.a.a=function(n){var r=Common.c.be(),t,i,u;return r&&(t=r.split("."),t.length===2)?(i=parseInt(t[0]),u=parseInt(t[1]),i>n.c||i===n.c&&u>=n.e):!1};Common.App.DirectPrint.a.prototype={d:null,e:null,h:null,j:null,f:null,k:null,i:null,o:null,l:null,n:null,m:!1,g:null,c:function(){},w:function(){var t=new Array(this.d.a.length),i=!isNullOrUndefined(this.e),n;if(i)for(n=0;n<this.d.a.length;n++)t[n]=this.d.a[n]in this.e&&this.j(this.e[this.d.a[n]]);return t},x:function(){for(var t,i=new Array(this.d.b.length),r=!isNullOrUndefined(this.h),n=0;n<this.d.b.length;n++)t=this.d.b[n],i[n]=r&&t in this.h?!0:this.k(t);return i},t:function(){for(var t=this.w(),i=new Array(t.length),n=0;n<t.length;n++)i[n]=t[n]?this.r(this.e[this.d.a[n]]):null;return i},r:function(n){if(isNullOrUndefined(n))return null;var t=n.enabledPlugin;return isNullOrUndefined(t)?null:t.name},s:function(){for(var n,u=this.t(),f=this.x(),i={},r={},t=0;t<this.d.a.length;t++)i[this.d.a[t]]=u[t];for(n=0;n<this.d.b.length;n++)r[this.d.b[n]]=f[n];return new Common.App.DirectPrint.d(i,r)},y:function(){return this.m?!1:this.d.i?this.z():!1},a:function(){if(this.g!=null)return this.g;var n=Common.App.DirectPrint.a.a(this.d);return this.g=this.d.d&&n||this.v(),this.g},v:function(){return Common.c.f()&&this.d.h&&Common.c.bd()>=this.d.f?!0:!1},z:function(){var i,u,f,o;if(!this.l(this.d))return!1;i=Common.N.e(this.f.a().a);for(var r=i,s=r.length,n=0;n<s;++n)if(u=r[n],!isNullOrUndefined(u))return!0;f=Common.N.e(this.f.a().b);for(var e=f,h=e.length,t=0;t<h;++t)if(o=e[t],o)return!0;return!1},u:function(){for(var i,r=Common.N.e(this.f.a().a),t=r,u=t.length,n=0;n<u;++n)if(i=t[n],Array.contains(this.d.g,i))return!0;return!1},b:function(n,t,i){this.y()?this.q(n,this.u()&&!t,i):this.n(n,i)},q:function(n,t,i){var r=this.o.a("UserAction","OpenDirectPrintDialog");this.i.a(n,t,i).a();r.a()}};Common.App.DirectPrint.g=function(){};Common.App.DirectPrint.g.prototype={d:null,a:function(){return"Common.App.DirectPrint"},e:null,c:function(n){var t,i;this.d=n;t=this;n.b(Common.App.DirectPrint.c,null).a().b(function(){return new Common.App.DirectPrint.c(Common.a.b().j())});i=this;n.b(Common.App.DirectPrint.e,null).a().b(function(){return new Common.App.DirectPrint.a(new Common.App.DirectPrint.b(Common.a.a.j.g),window.navigator.mimeTypes,window.navigator.plugins,Common.App.DirectPrint.a.b,Common.App.DirectPrint.a.c,n.a(Common.App.DirectPrint.c,null),Common.a.b().c(),Common.App.DirectPrint.a.d,function(n,t){return new CADWLTR.c(n,!1,t)},Common.a.y)})},b:function(){this.e=this.d.a(Common.App.DirectPrint.e,null);this.e.c()}};Common.App.DirectPrint.j=function(){};Common.App.DirectPrint.j.a=function(){Common.App.a.a().a(new Common.App.DirectPrint.g,0,!1)};Common.App.DirectPrint.f.registerClass("Common.App.DirectPrint.f",CommonUI.d);Common.App.DirectPrint.c.registerClass("Common.App.DirectPrint.c",null,Common.App.DirectPrint.i);Common.App.DirectPrint.d.registerClass("Common.App.DirectPrint.d");Common.App.DirectPrint.b.a=",";Common.App.DirectPrint.j.a();Type.registerNamespace("Common.App.NewAndOpen.UX");Common.App.NewAndOpen.UX.c=function(){};Common.App.NewAndOpen.UX.c.registerInterface("Common.App.NewAndOpen.UX.c");Common.App.NewAndOpen.UX.g=function(n,t,i,r,u,f){this.w=Function.createDelegate(this,this.M);this.v=Function.createDelegate(this,this.L);this.u=Function.createDelegate(this,this.G);this.q=n;this.m=t;var e=this;this.n=new($$sc.z.$$(Common.jz.$$(Common.bq)))(function(){return new(Common.App.NewAndOpen.Core.h.$$(Common.bq))(i.a(),e.u)});this.p=r;this.r=u;this.s=f;this.c=this.l();this.b().a()===2&&(this.h=!0)};Common.App.NewAndOpen.UX.g.prototype={q:null,m:null,n:null,p:null,r:null,s:null,c:!1,d:null,a:null,j:null,i:!1,e:!1,o:0,g:!1,h:!1,t:function(){switch(this.b().a()){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null},O:function(){var n=this.b().h();n.a(1056925771,2147483648,this.v);n.c(2074131365,2147483648,this.w,96)},L:function(n,t,i,r,u){if(i===1)return 32;if(i===2){var f=u;if(f&&f.MenuItemId&&f.SourceControlId)return this.C(f.MenuItemId,f.SourceControlId)}return 8},C:function(n,t){var e=this.k().b,o,s,i,h,f;if(isNull(e))return 8;if(o=Common.a.a.a("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC"),s=Common.a.bt,s&&o)Diag.a.a(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message."),i={},i.template=n,i.appID=this.t(),i.lcid=Common.a.o.toString(),i.reason="createNew",h=this,Common.a.L().a(function(n){n.a("App_CreateNewDocument",i,"")});else{var c=(new Date).getTime(),r=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",e,Common.d.a(this.x()),Common.d.a(n),Common.d.a(this.t()),Common.d.a(Common.a.o.toString()),Common.d.a(c.toString()),Common.d.a(t),Common.d.a(Common.a.G),Common.a.j),u=Common.a.a.b("ScenarioId");u&&u!==""&&(r+="&wdscenarioid="+Common.d.a(u));r+="&"+Common.a.cI();Common.a.S&&(r+="&"+Common.a.cH());f=this.a?this.a.b():null;f&&(r+="&DestinationUrl="+Common.d.a(f));Common.g.c(r,"_blank","",!1,"CreateNewDocument")}return this.b().a()===2&&Diag.a.a(24700384,202,50,"CreateNewDocument from New Menu {0}",{AppType:Common.bR.toString(this.b().a()),Template:n}),32},K:function(n){var t=Number.MAX_VALUE,i=Number.MIN_VALUE,f=window.performance,r,o,u,e,s;if(f&&typeof f.getEntriesByName!="undefined"){for(r=0;r<n.length;r++)o=n[r],u=f.getEntriesByName(o),u&&u.length>0&&(e=u[0],t=Math.min(parseInt(e.fetchStart),t),i=Math.max(parseInt(e.responseEnd),i));i>t&&(s=i-t,Diag.a.a(5849601,202,50,"Total time to download template thumbnails {0}",{TotalElapsedMs:s,MinFetchStart:t,MaxResponseEnd:i}))}},M:function(n,t,i,r,u){return i===1?(this.h&&(Common.a.q("Microsoft.Office.Server.Powerpoint.Web.IPptMoreThemesInNewMenuSettings"),this.h=!1),32):(i!==2||this.g||(this.o=(new Date).getTime(),Diag.a.a(5849602,202,50,"File New menu flyout opened by user {0}",{ShouldShowTemplates:this.l(),CachedNewMenuXmlExists:!!this.d,ShouldCallGetMoreInfo:this.b().c()})),this.N(u))},N:function(n){return n&&(this.d?n.PopulationXML=this.d:(this.b().c()&&!this.a&&this.E().a("Opened New menu",!0),n.PopulationXML=this.D(this.H()))),32},y:function(){return!this.b().c()||!!this.a&&this.a.a()===3&&!!this.a.c()&&!!this.a.b()},J:function(){return Common.a.b()&&Common.a.b().a().i()?!0:this.y()},H:function(){var i,t,n,f,r,u;return!this.l()||!this.J()?null:(this.c&&!this.e&&(i="9",t=Common.a.a.j.g,"NumberOfTemplatesInBackstage"in t&&(i=t.NumberOfTemplatesInBackstage),n=String.format(this.b().e()+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",Common.d.a(Common.a.o.toString()),Common.d.a(this.t()),i),f=Boolean.parse(t.AppendOriginQueryParam||"false"),f&&(n+="&org=backstage"),n+="&"+Common.a.cI(),Common.a.S&&(n+="&"+Common.a.cH()),r=this,u=this,this.b().d().a(n,1,null,null,!1,2,function(n){r.b().b("CreateNewActor.GetTemplateListJson",n.b,"");r.Q(n.b.a)},function(n){u.b().b("CreateNewActor.GetTemplateListJson",n.b,"");u.P()},null,null,!1,null,null,"5",null,!1,null,!1,null),this.c=!1),this.j)},Q:function(n){this.j=n;this.c=!1;this.f();Common.a.b()&&Common.a.b().a().i()&&Common.C.a()&&appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.j,!0))},P:function(){this.c=!0;this.e=!0;this.f();Common.a.b()&&Common.a.b().a().i()&&Common.C.a()&&appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",!1))},I:function(n,t){var s=0,i,h,u;for(t.val="",i=0;i<n.length;i++)if(h=n[i],h.ImageType==="ST"){s=i;break}var r=n.length?n[s]:null,c=r?r.Url||"":"",l,f=!1,e=!1,o=!1;if(r&&(l=r.AspectRatio))u=parseFloat(l),u<1?f=!0:u>1.5?e=!0:u===1&&(o=!0);else{Diag.a.a(5849603,202,10,"Thumbnail aspect ratio missing {0}",{Url:c});switch(this.b().a()){case 3:f=!0;break;case 2:e=!0;break;case 5:o=!0}}return t.val=f?"95by123":e?"123by69":o?"100by100":"123by95",c},D:function(n){var t,e=this.k().c||"1056925771",i,r,u=(r=this.z(n,this.k(),e,i={val:t}),t=i.val,r),f;return t&&(this.d=u,f=(new Date).getTime()-this.o,Diag.a.a(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",{ElapsedMsSinceMenuOpened:f})),u},G:function(n,t){if(Diag.a.a(590964757,202,50,"GetMoreInfoEventReceived"),this.a||n.a()!==3)n.a()===2&&(Diag.a.a(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.i=!0,this.f());else if(this.a=n,t||this.f(),Common.a.b()&&Common.a.b().a().i()&&Common.C.a()&&Common.C.d("setFileMenuHostInformation")){var i,r=(i=new $C,i.hostUrl=this.a.b(),i.hostName=this.a.c(),i.folderUrl=Common.a.bi,i.folderName=Common.a.Q,i);Diag.a.a(590964758,202,50,"Sending HostInformation to FileMenu");appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(r))}},z:function(n,t,i,r){r.val=!1;var f=this.y(),u="";return this.b().c()&&(this.i?(u=Common.App.NewAndOpen.UX.a.i(t),this.i=!1,Diag.a.a(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure")):this.a?f?u=Common.App.NewAndOpen.UX.a.s(t,this.a):this.a.d()?(r.val=!0,this.c=!1,u=Common.App.NewAndOpen.UX.a.q(t,this.a),Diag.a.a(5849607,202,50,"Rendering File>New with personal storage instantiation message")):(r.val=!0,u=Common.App.NewAndOpen.UX.a.i(t),Diag.a.a(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",{PersonalFileStorageUrlIsSet:!!this.a.b(),StorageServiceDisplayNameIsSet:!!this.a.c()})):(u=Common.App.NewAndOpen.UX.a.r(t.a),Diag.a.a(5849606,202,50,"Rendering File>New with loading spinner"))),f&&(u+=Common.App.NewAndOpen.UX.a.p(t,i,!u)+this.B(n,i,r)),Common.App.NewAndOpen.UX.a.k("New",u)},B:function(n,t,i){var e;if(i.val=!1,!this.l())return i.val=!0,Diag.a.a(5849609,202,50,"Rendering File>New without template buttons due to BRS"),"";var r="",u="",f="MenuTemplate";if(this.e)r=Common.App.NewAndOpen.UX.a.j(),this.e=!1,Diag.a.a(5849610,202,10,"Rendering File>New with template error message");else if(n){try{e=Sys.Serialization.JavaScriptSerializer.deserialize(n,!0);r=this.A(e,t);Diag.a.a(5849612,202,50,"Rendering File>New with template buttons");Common.a.cu&&this.x()==="OneDrive"&&(u=Common.App.NewAndOpen.UX.a.o(this.F(),Common.a.cu))}catch(o){Diag.a.a(5849613,202,10,"Failed to parse JSON response from template service {0}",{JsonToConvert:n});r=Common.App.NewAndOpen.UX.a.j()}i.val=!0}else f="MenuLoading",r=Common.App.NewAndOpen.UX.a.t(),Diag.a.a(5849611,202,50,"Rendering File>New with template loading spinner");return Common.App.NewAndOpen.UX.a.u(f,r)+u},A:function(n,t){for(var r,u,f,l,a,v,y,e="",o=[],i=0;i<n.length;i++){if(r=n[i],u="",r){var s=r.Title,h=r.AssetId,c=r.Thumbnails;h&&s&&c&&(u=(a=this.I(c,l={val:f}),f=l.val,a),e+=Common.App.NewAndOpen.UX.a.b("jbtnNewTemplate"+i,s,null,f,null,u,t,h))}o[i]=u}return v=this,y=new Common.U(4,1,5e3,function(){v.K(o)},106,null,!1,0),this.b().f().a(y),e},f:function(){this.g=!0;this.b().i().w(this.k().d);this.g=!1},b:function(){return this.q.a()},k:function(){return this.m.a()},E:function(){return this.n.a()},F:function(){return this.p.a()},x:function(){return this.r.a()},l:function(){return this.s.a()}};Common.App.NewAndOpen.UX.b=function(){Common.App.NewAndOpen.UX.b.initializeBase(this)};Common.App.NewAndOpen.UX.b.b=function(){return Common.App.NewAndOpen.UX.b.a||(Common.App.NewAndOpen.UX.b.a=new Common.App.NewAndOpen.UX.b)};Common.App.NewAndOpen.UX.b.c=function(n){return Common.App.NewAndOpen.UX.b.b().b(n)};Common.App.NewAndOpen.UX.b.prototype={f:function(){this.a(0,$a.gq);this.a(1,$a.gt);this.a(2,$a.bH);this.a(3,$a.gs);this.a(4,$a.gr);this.a(5,$a.S)}};Common.App.NewAndOpen.UX.h=function(n,t,i,r,u,f,e,o){var h,s;this.r=Function.createDelegate(this,this.I);this.q=Function.createDelegate(this,this.G);this.c=o;this.o=n;this.p=t;this.l=i;this.k=r;this.j=u;h=this;this.m=new($$sc.z.$$(Common.jz.$$(Common.bq)))(function(){return new(Common.App.NewAndOpen.Core.h.$$(Common.bq))(f.a(),null)});s=this;this.n=new($$sc.z.$$(Common.jz.$$(Common.cN)))(function(){return new(Common.App.NewAndOpen.Core.h.$$(Common.cN))(e.a(),s.q)});this.s=this.c.a("WacInTabOpenMRUIsEnabledForUiHost");this.u=this.c.a("UiHostSupportsDocRebootFeatures")};Common.App.NewAndOpen.UX.h.prototype={o:null,h:null,e:!0,d:"",t:0,b:null,k:null,j:null,p:null,l:null,i:3,n:null,m:null,s:!1,u:!1,c:null,G:function(n,t){this.b=n;t||this.v()},J:function(){var n=this.g().h();n.c(2799130311,2147483648,this.r,96)},I:function(n,t,i,r,u){var f=u;return i===1||!f?32:this.H(f)},H:function(n){return this.y(),this.x(),n.PopulationXML=Common.App.NewAndOpen.UX.a.v(this.d+this.h),32},y:function(){var n=3,r=!1,u,t,f,e,o,i;this.d&&this.t===this.b.c()?(Diag.a.a(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",{CacheRefresh:"Not Dirty"}),n=this.i):(Diag.a.a(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",{CacheRefresh:"Starting"}),u=this.g().g()(),this.b=this.D().a("File Open opened",!0),this.d&&this.i!==2&&this.b.a()!==3?r=!0:(t=this.E(this.b),Common.a.b()&&Common.a.b().a().i()&&Common.C.a()&&t&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(t,!0)),this.d=(e=this.z(this.b,f={val:n}),n=f.val,e)),o=this.g().g()()-u,Diag.a.a(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",{CacheRefresh:"Complete",ElapsedMs:o}));n!==2&&(i={DisplayState:Common.App.NewAndOpen.UX.h.a.toString(n)},n!==1&&(i.IsStale=r),Diag.a.a(5849630,202,50,"MRU section display state {0}",i));this.i=n},E:function(n){var t;try{t=JSON.stringify(n.b())}catch(i){t=null;Diag.a.a(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",i)}return t},x:function(){if(this.e){Diag.a.a(5849632,202,50,"Open menu Browse More Link creation necessary.");var n,t;this.h=(t=this.F(n={val:this.e}),this.e=n.val,t)}else Diag.a.a(5849631,202,50,"Open menu Browse More Link creation not required.");Diag.a.a(5849633,202,50,"Browse More link display state {0}",{WaitingOnLinkInfo:this.e,NotDisplayingLink:!this.h})},z:function(n,t){var i;return n.a()!==1&&n.a()?n.a()===3&&n.b()?(i=this.w(n.b()),t.val=0):(Diag.a.a(5849634,202,50,"Open menu XML built {0}",{Display:"Server Error"}),i=Common.App.NewAndOpen.UX.a.d(this.a()(1),this.a()(2),null,null),t.val=1):(Diag.a.a(5849635,202,50,"Open menu XML built {0}",{Display:"Spinner"}),t.val=2,i=Common.App.NewAndOpen.UX.a.h(this.a()(2),this.a()(5))),i},w:function(n){var i,f=this.f().a||"2155708348",u,r,t;if(n.length){for(i=Common.App.NewAndOpen.UX.a.c("lblRecentDocuments",this.a()(3),null,null),u=0,r=0;r<n.length;r++)t=n[r],"FileName"in t&&"DocumentUrl"in t&&"Path"in t&&(i+=Common.App.NewAndOpen.UX.a.b("MruButton"+r,t.FileName.toString(),t.Path.toString(),null,this.f().d,this.f().c,f,t.DocumentUrl.toString()),t.IsPinned&&u++);i=Common.App.NewAndOpen.UX.a.a("RecentDocumentsMenuSection",Common.App.NewAndOpen.UX.a.f,this.a()(2),i);Diag.a.a(5849665,202,50,"Open menu XML built {0}",{Display:"MRU List",TotalDocuments:n.length,NumPinnedDocuments:u})}else i=Common.App.NewAndOpen.UX.a.d(this.a()(0),this.a()(2),null,null),Diag.a.a(5849664,202,50,"Open menu XML built {0}",{Display:"Empty MRU"});return i},F:function(n){var i,t,r,u;return n.val=!0,i=this.B(),t=this.A(),i&&t||!this.g().c()?n.val=!1:(r=this.C().a("File Open",!1),r.a()===3&&(i=r.b(),t=r.c(),n.val=!1)),u=t?String.format(this.a()(4),t):null,Common.App.NewAndOpen.UX.a.n(this.f().a,u,i,this.c)},v:function(){this.g().i().w(this.f().b)},g:function(){return this.o.a()},a:function(){return this.p.a()},f:function(){return this.l.a()},B:function(){return this.k.a()},A:function(){return this.j.a()},C:function(){return this.m.a()},D:function(){return this.n.a()}};Common.App.NewAndOpen.UX.h.a=function(){};Common.App.NewAndOpen.UX.h.a.prototype={success:0,failure:1,spinner:2,none:3};Common.App.NewAndOpen.UX.h.a.registerEnum("Common.App.NewAndOpen.UX.h.a",!1);Common.App.NewAndOpen.UX.a=function(){};Common.App.NewAndOpen.UX.a.v=function(n){return Common.App.NewAndOpen.UX.a.k("Open",n)};Common.App.NewAndOpen.UX.a.h=function(n,t){return Common.App.NewAndOpen.UX.a.a("LoadingMenuSection",Common.App.NewAndOpen.UX.a.m,n,Common.App.NewAndOpen.UX.a.c("lblLoading",t,null,null))};Common.App.NewAndOpen.UX.a.d=function(n,t,i,r){return Common.App.NewAndOpen.UX.a.a("MessageMenuSection",Common.App.NewAndOpen.UX.a.f,t,Common.App.NewAndOpen.UX.a.c("lblMessage",n,i,r))};Common.App.NewAndOpen.UX.a.r=function(n){return Common.App.NewAndOpen.UX.a.h(n,$a.S)};Common.App.NewAndOpen.UX.a.s=function(n,t){return Common.App.NewAndOpen.UX.a.d($a.fl,n.a,t.b(),t.c())};Common.App.NewAndOpen.UX.a.q=function(n,t){return Common.App.NewAndOpen.UX.a.d(String.format($a.fo,t.c(),"\n\n"),n.a,null,null)};Common.App.NewAndOpen.UX.a.i=function(n){return Common.App.NewAndOpen.UX.a.d($a.fn,n.a,null,null)};Common.App.NewAndOpen.UX.a.p=function(n,t,i){return Common.App.NewAndOpen.UX.a.a("menuNewBlank",Common.App.NewAndOpen.UX.a.l,i?n.a:null,Common.App.NewAndOpen.UX.a.b(n.e,n.f,n.g,null,n.i,n.h,t,"blank"))};Common.App.NewAndOpen.UX.a.t=function(){return Common.App.NewAndOpen.UX.a.c("lblTemplatesLoading",$a.S,null,null)};Common.App.NewAndOpen.UX.a.j=function(){return Common.App.NewAndOpen.UX.a.c("lblTemplatesError",$a.fp,null,null)};Common.App.NewAndOpen.UX.a.u=function(n,t){return Common.App.NewAndOpen.UX.a.a("menuNewTemplates",n,null,t)};Common.App.NewAndOpen.UX.a.o=function(n,t){return Common.App.NewAndOpen.UX.a.a("menuNewMoreTemplates",Common.App.NewAndOpen.UX.a.e,null,Common.App.NewAndOpen.UX.a.b("menuNewMoreTemplatesButton",$a.bx,$a.bx,null,null,null,n,t))};Common.App.NewAndOpen.UX.a.n=function(n,t,i){var r="";return i&&t&&(r=Common.App.NewAndOpen.UX.a.a("BrowseMoreMenuSection",Common.App.NewAndOpen.UX.a.e,null,Common.App.NewAndOpen.UX.a.b("btnBrowseMore",t,t,null,null,null,n||"1959943459",i))),r};Common.App.NewAndOpen.UX.a.c=function(n,t,i,r){var u=r,f;return t&&t.length>0&&(u=Common.App.NewAndOpen.UX.a.g.a(t).trimEnd(),u=u.indexOf("{0}")>=0?String.format(u,r):String.format("{0} {1}",u,r)),f=i&&r?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',Common.d.c(i),Common.d.c(r),Common.d.c(u)):"",String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',Common.d.c(n||""),Common.App.NewAndOpen.UX.a.g.a(Common.d.c(t||"")),f)};Common.App.NewAndOpen.UX.a.b=function(n,t,i,r,u,f,e,o){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',Common.d.c(n||""),Common.d.c(t||""),Common.d.c(i||""),r||"32by32",Common.d.c(u||""),Common.d.c(f||""),e,Common.d.c(o||""))};Common.App.NewAndOpen.UX.a.k=function(n,t){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t<\/Menu>',n,t)};Common.App.NewAndOpen.UX.a.a=function(n,t,i,r){var u=i?String.format('Title="{0}"',Common.d.c(i)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t<\/Controls>\r\n\t\t\t\t<\/MenuSection>',Common.d.c(n||""),Common.d.c(t||""),u,r)};Common.App.NewAndOpen.UX.d=function(n,t,i,r){this.b=n;this.e=t;this.d=i;this.c=r};Common.App.NewAndOpen.UX.d.prototype={b:null,e:null,d:null,c:null,a:function(n,t,i){return new Common.App.NewAndOpen.UX.i(n,t,i,this.b,this.e,this.d,this.c)}};Common.App.NewAndOpen.UX.e=function(n,t,i,r){this.b=n;this.c=t;this.d=i;this.a=r};Common.App.NewAndOpen.UX.e.prototype={b:null,c:null,d:null,a:null};Common.App.NewAndOpen.UX.i=function(n,t,i,r,u,f,e){this.o=Function.createDelegate(this,this.w);this.p=Function.createDelegate(this,this.x);this.n=Function.createDelegate(this,this.v);this.j=n;this.b=t;this.e=i;this.g=r;this.k=u;this.i=f;var o=this;this.h=new($$sc.z.$$(Common.jz.$$(Common.bq)))(function(){return new(Common.App.NewAndOpen.Core.h.$$(Common.bq))(e.a(),o.n)})};Common.App.NewAndOpen.UX.i.prototype={d:null,l:!1,f:0,a:0,e:null,j:null,b:null,g:null,k:null,i:null,h:null,q:function(){!this.d&&this.m().c()?this.s().a("NewDocumentFromStream",!0):this.r()},v:function(n){if(this.d||n.a()!==3){if(n.a()===2){this.l?Diag.a.a(24904471,202,10,"After second try GetMoreResult still fail."):(this.s().a("NewDocumentFromStream",!0),this.l=!0);return}}else this.d=n;this.r()},r:function(){var t,e,n,i,r;if(this.f=(new Date).getTime(),t=this.t().b,isNull(t)){this.b(null);return}var o=this.e.b,s=this.e.c,u=this.e.d,f=this.e.a;this.a=u==="streamBase64"?f.length/1024:0;Diag.a.a(35156358,202,50,"FileType:{0}, FileSize:{1}",this.c(),this.a);e=(new Date).getTime();n=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",t,Common.d.a(this.u()),Common.d.a(o),Common.d.a(this.c()),Common.d.a(Common.a.o.toString()),Common.d.a(e.toString()),Common.d.a(s),Common.d.a(Common.a.G),Common.a.j,Common.d.a(u));n+="&"+Common.a.cI();Common.a.S&&(n+="&"+Common.a.cH());i=this.d?this.d.b():null;i&&(n+="&DestinationUrl="+Common.d.a(i));r={};r["Content-Type"]="application/json; charset=utf-8";this.m().d().a(n,2,f,r,!0,2,this.p,this.o,null,null,!1,null,null,"31",null,!1,null,!1,null)},x:function(n){var i,r,u,t,f;if(!n||!n.b||!n.b.a){Diag.a.a(24904473,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",this.c(),this.a);this.b(null);return}if(!(u=Common.bz.a(n.b.a,r={val:i}),i=r.val,u)){Diag.a.a(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",this.c(),this.a,{ResponseData:Common.Utils.e.a(n.b.a)});this.b(null);return}if(t=i,t.StatusCode!==200&&t.StatusCode!==201){Diag.a.a(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",this.c(),this.a,t.StatusCode);this.b(null);return}t.NewDocumentUrl&&t.NewDocumentUrl!==""?(f=(new Date).getTime()-this.f,Diag.a.a(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",this.c(),this.a,f),this.j(t.NewDocumentUrl)):(Diag.a.a(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.c(),this.a),this.b(null))},w:function(n){n&&n.b&&Diag.a.a(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.c(),this.a,n.b.b);this.b(null)},c:function(){switch(this.m().a()){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null},t:function(){return this.g.a()},u:function(){return this.k.a()},m:function(){return this.i.a()},s:function(){return this.h.a()}};Common.App.NewAndOpen.UX.j=function(){};Common.App.NewAndOpen.UX.j.a=function(){Common.App.a.a().a(new Common.App.NewAndOpen.UX.f,0,!1)};Common.App.NewAndOpen.UX.f=function(){};Common.App.NewAndOpen.UX.f.prototype={a:function(){return"Common.App.NewAndOpen.UX"},c:function(n){var t=this;n.b(Common.App.NewAndOpen.UX.d,null).c(Common.App.NewAndOpen.UX.c,null).a().b(function(){return new Common.App.NewAndOpen.UX.d(new($$sc.z.$$(Common.et))(function(){return Common.a.b().a().H()}),new($$sc.z.$$(String))(function(){return Common.a.bv}),new($$sc.z.$$(Common.ch))(function(){return n.d(Common.ch,null)}),new($$sc.z.$$(Common.jy.$$(Common.bq)))(function(){return n.d(Common.jy.$$(Common.bq),null)}))})},b:function(){var n=this;Common.a.a.i(function(){n.d()})},d:function(){var n=Common.Utils.b.a(Common.ch,Common.Utils.a.a().c(Common.ch,null)),t=Common.Utils.b.a(Common.jy.$$(Common.bq),Common.Utils.a.a().c(Common.jy.$$(Common.bq),null)),r,i,u;Common.a.bv&&(r=this,$$sc.a.WAA.call(null,n,t).CW(function(){var i=new Common.App.NewAndOpen.UX.g(new($$sc.z.$$(Common.ch))(function(){return n.a()}),new($$sc.z.$$(Common.et))(function(){return Common.a.b().a().H()}),new($$sc.z.$$(Common.jy.$$(Common.bq)))(function(){return t.a()}),new($$sc.z.$$(String))(function(){return Common.a.b().a().I().a||"1959943459"}),new($$sc.z.$$(String))(function(){return Common.a.bv}),new($$sc.z.$$(Boolean))(function(){return Common.a.df}));i.O();i.f()}));Common.a.cw&&(i=Common.Utils.b.a(Common.jy.$$(Common.cN),Common.Utils.a.a().c(Common.jy.$$(Common.cN),null)),u=this,$$sc.a.WAA.call(null,n,t,i).CW(function(){var r=new Common.App.NewAndOpen.UX.h(new($$sc.z.$$(Common.ch))(function(){return n.a()}),new($$sc.z.$$(Function))(function(){return Common.App.NewAndOpen.UX.b.c}),new($$sc.z.$$(Common.fk))(function(){return Common.a.b().a().I()}),new($$sc.z.$$(String))(function(){return Common.a.di}),new($$sc.z.$$(String))(function(){return Common.a.dh}),new($$sc.z.$$(Common.jy.$$(Common.bq)))(function(){return t.a()}),new($$sc.z.$$(Common.jy.$$(Common.cN)))(function(){return i.a()}),Common.a.a);r.J();r.v()}))},dispose:function(){}};Common.App.NewAndOpen.UX.b.registerClass("Common.App.NewAndOpen.UX.b",Common.Utils.p);Common.App.NewAndOpen.UX.d.registerClass("Common.App.NewAndOpen.UX.d",null,Common.App.NewAndOpen.UX.c);Common.App.NewAndOpen.UX.f.registerClass("Common.App.NewAndOpen.UX.f",null,Common.App.i,Common.Utils.q,Sys.IDisposable);Common.App.NewAndOpen.UX.b.a=null;Common.App.NewAndOpen.UX.a.f="MenuMru";Common.App.NewAndOpen.UX.a.m="MenuLoading";Common.App.NewAndOpen.UX.a.l="MenuHeader";Common.App.NewAndOpen.UX.a.e="MenuFooter";Common.App.NewAndOpen.UX.a.g=Common.bi.a("\n","&#10;");Common.App.NewAndOpen.UX.j.a();Type.registerNamespace("Common.App.OneDriveFilePickerApi");Common.App.OneDriveFilePickerApi.m=function(){};Common.App.OneDriveFilePickerApi.m.registerInterface("Common.App.OneDriveFilePickerApi.m");Common.App.OneDriveFilePickerApi.c=function(){};Common.App.OneDriveFilePickerApi.c.registerInterface("Common.App.OneDriveFilePickerApi.c");Common.App.OneDriveFilePickerApi.d=function(){};Common.App.OneDriveFilePickerApi.d.registerInterface("Common.App.OneDriveFilePickerApi.d");Common.App.OneDriveFilePickerApi.h=function(n,t){this.a=n;this.b=t};Common.App.OneDriveFilePickerApi.h.prototype={a:null,b:null};Common.App.OneDriveFilePickerApi.a=function(){Common.App.OneDriveFilePickerApi.a.initializeBase(this);this.g(0);this.h(1,$a.b)};Common.App.OneDriveFilePickerApi.a.prototype={a:function(n){this.j(n,$a.a,$a.I,null)},b:function(n){this.j(n,$a.a,$a.I,null,!0)}};Common.App.OneDriveFilePickerApi.i=function(){};Common.App.OneDriveFilePickerApi.j=function(n){this.d=Function.createDelegate(this,this.g);this.e=Function.createDelegate(this,this.h);this.c=n;this.a=3};Common.App.OneDriveFilePickerApi.j.prototype={b:null,c:null,a:0,f:function(n){var t=String.format("GetMoreInfoHandler.ashx?{0}",Common.a.bd);this.c.d(t,1,null,n,["PersonalFileStorageUrl","X-NewKey"],!1,2,this.e,this.d,null,null,!1,null,null,"21",null,!1,null,!1,null,null)},g:function(n){if(n.b.c===412&&"X-NewKey"in n.b.d){Diag.a.a(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");var t={};t["X-Key"]=n.b.d["X-NewKey"];this.f(t)}else this.a>0?(Diag.a.a(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",this.a),this.a--,this.f(null)):(Diag.a.a(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),this.b.SX(Error.create("GetMoreInfo request failed and no more retries remain")))},h:function(n){"PersonalFileStorageUrl"in n.b.d&&n.b.d.PersonalFileStorageUrl!==""?(Diag.a.a(24134239,352,50,"Successfully received an ODB endpoint"),this.b.b(n.b.d.PersonalFileStorageUrl)):(Diag.a.a(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),this.b.SX(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))}};Common.App.OneDriveFilePickerApi.e=function(n,t,i,r,u,f){Common.App.OneDriveFilePickerApi.e.initializeBase(this,[t,i,r,f]);this.w=n;this.p=u};Common.App.OneDriveFilePickerApi.e.prototype={w:null,p:null,b:null,h:function(){return this.c.b("OneDriveApiUrl")},o:function(){var n=this.k===1||this.k===2?{client_id:this.c.j.g.UploadToSkyDriveClientId}:{client_id:this.c.j.g.UploadToSkyDriveClientId,env:"INT"};WL.init(n)},j:function(){try{Diag.a.a(17909027,352,50,"Launching file dialogue");WL.fileDialog(this.b).then(this.v,this.u)}catch(n){Diag.a.a(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",n,n.stack);this.f()}},i:function(n){var t=n;if(n&&t.error){if(t.error.code==="user_canceled"){Diag.a.a(17909058,352,50,"User canceled.");return}Diag.a.a(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",t.error.code,t.error.message)}else Diag.a.a(17909060,352,50,"File Dialog returned with no response");this.d&&this.d(!1,n);this.f()}};Common.App.OneDriveFilePickerApi.f=function(n,t,i,r,u){this.w=Function.createDelegate(this,this.z);Common.App.OneDriveFilePickerApi.f.initializeBase(this,[n,t,i,r]);this.x=u;this.b={};this.b.clientId=this.c.b("OneDriveApiV7ClientId");this.b.cancel=this.w};Common.App.OneDriveFilePickerApi.f.prototype={x:null,y:null,p:null,b:null,h:function(){return this.c.b("OneDriveApiV72Url")},o:function(){var t=this,n;this.b.success=function(n){var i={};i.data=n;t.s(i)};n=this;this.b.error=function(t){var i={};i.error=t;n.i(i)};this.b.advanced={};this.b.advanced.linkType="share";this.b.advanced.endpointHint=this.y;this.b.advanced.iframeParentDiv=this.p},j:function(){try{Diag.a.a(22090007,352,50,"Launching OneDrive file picker dialog");this.z();OneDrive.open(this.b)}catch(n){Diag.a.a(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",n.message);this.f()}},i:function(n){this.d&&this.d(!1,n);this.f()},z:function(){this.p.style.visibility=this.p.style.visibility==="hidden"?"":"hidden"}};Common.App.OneDriveFilePickerApi.b=function(n,t,i,r){Common.App.OneDriveFilePickerApi.b.initializeBase(this,[n,t,i,r]);this.b={};this.b.advanced={};this.b.action="query";this.b.clientId=this.c.b("OneDriveApiV72ClientId");this.b.advanced.trapFocus=!0};Common.App.OneDriveFilePickerApi.b.prototype={b:null,h:function(){return this.c.b("OneDriveApiV72Url")},p:function(n,t,i,r){this.b.advanced.iframeParentDiv=i;this.b.advanced.endpointHint=r;this.b.cancel=t;this.w(n)},w:function(n){this.d=n;this.q?Diag.a.a(24391838,216,50,"In limited edit mode, will not show Picker."):(Diag.a.a(24391837,216,50,"Not in limited edit mode, will show file picker."),this.C(this.t))},o:function(){var t=this,n;this.b.success=function(n){var i={};i.data=n;t.s(i)};n=this;this.b.error=function(t){var i={};i.error=t;n.i(i)}},j:function(){try{Diag.a.a(23881879,216,50,"Launching OneDrive file picker dialog");OneDrive.save(this.b)}catch(n){Diag.a.a(23881880,216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",n.message,n.stack);this.f()}},r:function(n){Diag.a.a(25180160,216,15,"Failure during OneDrive API download: {0}",n.c?n.c.toString():"No error detail.");Common.bc.h(this.h());this.g=null},f:function(){this.l().b(35)},i:function(n){this.d&&this.d(!1,n)}};Common.App.OneDriveFilePickerApi.l=function(n,t,i,r){this.u=Function.createDelegate(this,this.i);this.v=Function.createDelegate(this,this.s);this.t=Function.createDelegate(this,this.A);this.c=n;this.k=t;this.q=i;this.l=r};Common.App.OneDriveFilePickerApi.l.prototype={l:null,k:0,c:null,d:null,q:!1,e:null,n:!1,m:!1,g:null,a:function(){return this.g||(this.g=this.h()?Common.bs.a(this.h(),null,null,null,!1,!1,null,!0,!1):null),this.g},C:function(n){var t,i;if(this.e=n,this.n||this.m)this.n&&this.e&&this.e(!0);else{if(t=this.a(),!t){Diag.a.a(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty.");this.e(!1);return}this.m=!0;i=this;t.f.a.CW(function(n){i.B(n)});Common.bc.a(t)}},r:function(n){Diag.a.a(20509838,352,15,"Failure during OneDrive API download: {0}",n.c?n.c.toString():"No error detail.")},B:function(n){if(this.m=!1,n.b===5){this.r(n);this.e(!1);return}try{this.n=!0;Diag.a.a(17909022,352,50,"Initializing OneDrive API");this.o();Diag.a.a(17909023,352,50,"OneDrive API is initialized.");this.e(!0)}catch(t){Diag.a.a(20555412,352,10,"Failed during OneDrive API init: {0}",t.toString());this.e(!1)}},A:function(n){n?this.j():this.f()},f:function(){this.l().a(34)},s:function(n){Diag.a.a(17909057,352,50,"Success Callback called. Calling callback function.");this.d&&this.d(!0,n)},dispose:function(){this.g&&this.g.dispose()}};Common.App.OneDriveFilePickerApi.g=function(n,t,i,r){Common.App.OneDriveFilePickerApi.g.initializeBase(this,[n,t,i,r]);this.b.advanced.filter=n.b("OneDriveApiV72Filter")||"folder,photo";this.b.advanced.linkType="download";this.b.multiSelect=Common.a.dK;n.a("OneDriveApiV72CommandModeEnabled")&&(this.b.commandMode=n.b("OneDriveApiV72CommandMode")||"none");n.a("OneDriveApiV72QosExtraDataEnabled")&&(this.b.qosExtradata=new Common.App.OneDriveFilePickerApi.h("OfficeSessionId",Common.a.k))};Common.App.OneDriveFilePickerApi.g.prototype={h:function(){return this.c.b("OneDriveApiV72Url")},j:function(){try{Diag.a.a(26071182,352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}",this.b.advanced.filter,this.b.commandMode);OneDrive.open(this.b)}catch(n){Diag.a.a(26071183,352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",n.message,n.stack);this.f()}}};Common.App.OneDriveFilePickerApi.k=function(){};Common.App.OneDriveFilePickerApi.k.a=function(){Common.App.a.a().a(new Common.App.OneDriveFilePickerApi.k,0,!1)};Common.App.OneDriveFilePickerApi.k.prototype={d:null,a:function(){return"Common.App.OneDriveFilePickerApi"},b:function(){},c:function(n){var i,r,u,t,f,e;this.d=n;i=this;this.d.b(Common.App.OneDriveFilePickerApi.e,null).c(Common.App.OneDriveFilePickerApi.d,null).a().b(function(){return new Common.App.OneDriveFilePickerApi.e(Common.bF.a(),Common.a.a,Common.a.Y,Common.a.D,Common.a.fT,function(){return new Common.App.OneDriveFilePickerApi.a})});Common.a.cr?(r=this,this.d.b(Common.App.OneDriveFilePickerApi.c,null).a().b(function(){return new Common.App.OneDriveFilePickerApi.i})):(u=this,this.d.b(Common.App.OneDriveFilePickerApi.c,null).a().b(function(){return new Common.App.OneDriveFilePickerApi.j(Common.a.d)}));t=this;this.d.b(Common.App.OneDriveFilePickerApi.f,null).a().b(function(){return new Common.App.OneDriveFilePickerApi.f(Common.a.a,Common.a.Y,Common.a.D,function(){return new Common.App.OneDriveFilePickerApi.a},t.d.a(Common.App.OneDriveFilePickerApi.c,null))});f=this;this.d.b(Common.App.OneDriveFilePickerApi.b,null).a().b(function(){return new Common.App.OneDriveFilePickerApi.b(Common.a.a,Common.a.Y,Common.a.D,function(){return new Common.App.OneDriveFilePickerApi.a})});e=this;this.d.b(Common.App.OneDriveFilePickerApi.g,null).a().b(function(){return new Common.App.OneDriveFilePickerApi.g(Common.a.a,Common.a.Y,Common.a.D,function(){return new Common.App.OneDriveFilePickerApi.a})})}};Common.App.OneDriveFilePickerApi.a.registerClass("Common.App.OneDriveFilePickerApi.a",CommonUI.d);Common.App.OneDriveFilePickerApi.l.registerClass("Common.App.OneDriveFilePickerApi.l",null,Common.App.OneDriveFilePickerApi.d,Sys.IDisposable);Common.App.OneDriveFilePickerApi.e.registerClass("Common.App.OneDriveFilePickerApi.e",Common.App.OneDriveFilePickerApi.l);Common.App.OneDriveFilePickerApi.f.registerClass("Common.App.OneDriveFilePickerApi.f",Common.App.OneDriveFilePickerApi.l);Common.App.OneDriveFilePickerApi.b.registerClass("Common.App.OneDriveFilePickerApi.b",Common.App.OneDriveFilePickerApi.l);Common.App.OneDriveFilePickerApi.g.registerClass("Common.App.OneDriveFilePickerApi.g",Common.App.OneDriveFilePickerApi.b);Common.App.OneDriveFilePickerApi.k.a();Type.registerNamespace("Common");Common.gk=function(){};Common.cX=function(n){this.k=Function.createDelegate(this,this.x);this.l=Function.createDelegate(this,this.y);this.m=Function.createDelegate(this,this.A);this.i=Function.createDelegate(this,this.u);this.j=Function.createDelegate(this,this.v);this.e=n;this.f=!1;this.g=!1};Common.cX.b=function(){return Common.cX.a||(Common.cX.a=new Common.cX(Common.a.cZ))};Common.cX.prototype={f:!1,b:!1,g:!1,a:1e3,c:0,d:0,e:!1,o:null,n:null,s:null,p:null,r:null,t:function(n){Common.a.cg&&this.e&&!this.f&&!this.b&&(this.d=n,this.b=!0,this.z(),this.q())},z:function(){this.a=1e3;this.c=0},q:function(){var n=new Common.gj;n.RoamingApp=this.d;n.BaseDocQuerySignature=Common.a.j;n.c(this.j,this.i,null)},v:function(n){if(!Common.a.g){var i=n.b.a,t=Common.eW.a(i);t?this.h(t.HasRights):this.h(!1)}},u:function(){if(!Common.a.g){if(this.c>=5){this.h(!1);return}var n=new Common.U(2,1,this.a,this.m,59,null,!1,0);Common.a.i().a(n);this.c++;this.a*=5;this.a>12e5&&(this.a=12e5)}},h:function(n){this.g=n;this.f=!0;this.b=!1},A:function(){this.q()},w:function(n){var t=new Common.gl;t.RoamingApp=this.d;t.BaseDocQuerySignature=Common.a.j;t.c(this.l,this.k,n)},y:function(n){if(!Common.a.g){var r=n.b.a,t=Common.eW.a(r),i=n.b.f;t?(this.o=t.Launcher,this.s=t.Platform,this.r=t.OfficeVersion,this.p=t.Application,this.n=new Date,i.a(!0,t.Launcher,i.b)):i.a(!1,"",i.b)}},x:function(n){if(!Common.a.g){var t=n.b.f;if(n.b.b===5&&t.c){t.c=!1;this.w(t);return}t.a(!1,"",t.b)}}};Common.cX.c=function(){};Common.cX.c.prototype={a:null,b:null,c:!1};Common.iz=function(){};Common.iz.prototype={BaseDocQuerySignature:null,RoamingApp:0,d:function(){return JSON.stringify([this.a(),this])},c:function(n,t,i){var u={},r;u["Content-Type"]="application/json; charset=utf-8";r="RoamingAppsHandler.ashx";Common.cX.b().e&&document.URL.toUpperCase().indexOf("WDENABLEROAMING=1")>0&&(r=Common.k.a(r,"wdEnableRoaming","1",!1));Common.a.d.a(r,2,this.d(),u,!1,this.b(),n,t,i,null,!1,null,null,"6",null,!1,null,!1,null)}};Common.gj=function(){Common.gj.initializeBase(this)};Common.gj.prototype={b:function(){return 2},a:function(){return 1}};Common.gl=function(){Common.gl.initializeBase(this)};Common.gl.prototype={b:function(){return 0},a:function(){return 2}};Common.eW=function(){};Common.eW.a=function(n){try{return JSON.parse(n)}catch(t){}return null};Common.iA=function(){Common.iA.initializeBase(this)};Common.iA.prototype={HasRights:!1};Common.iB=function(){Common.iB.initializeBase(this)};Common.iB.prototype={Launcher:null,Platform:null,Application:null,OfficeVersion:null};Common.el=function(){};Common.el.a=function(n,t,i,r,u,f,e,o,s,h){var c=new Common.gk;c.DocumentUrl=n;c.Mode=t;c.Options=i;c.Application=r;c.SilentExternalHandler=e;c.EncodeUrl=o;c.CorrelationIdForWinClient=s;c.NavigateUsingWindowOpen=h;MSOJS.ClientUtils.EditDocumentInClient(c,u,f)};Common.cX.c.registerClass("Common.cX.c");Common.iz.registerClass("Common.iz");Common.gj.registerClass("Common.gj",Common.iz);Common.gl.registerClass("Common.gl",Common.iz);Common.eW.registerClass("Common.eW");Common.iA.registerClass("Common.iA",Common.eW);Common.iB.registerClass("Common.iB",Common.eW);Common.cX.a=null;Type.registerNamespace("Common.App.SaveAsToHost");Common.App.SaveAsToHost.a=function(){};Common.App.SaveAsToHost.a.registerInterface("Common.App.SaveAsToHost.a");Common.App.SaveAsToHost.m=function(){};Common.App.SaveAsToHost.m.registerInterface("Common.App.SaveAsToHost.m");Common.App.SaveAsToHost.j=function(){};Common.App.SaveAsToHost.j.registerInterface("Common.App.SaveAsToHost.j");Common.App.SaveAsToHost.n=function(){};Common.App.SaveAsToHost.n.registerInterface("Common.App.SaveAsToHost.n");Common.App.SaveAsToHost.g=function(){};Common.App.SaveAsToHost.g.registerInterface("Common.App.SaveAsToHost.g");Common.App.SaveAsToHost.d=function(){};Common.App.SaveAsToHost.d.b=function(){return CommonUI.b.a(Common.App.SaveAsToHost.d.a,$a.ch,$a.hl)};Common.App.SaveAsToHost.f=function(n,t){this.c=n;this.b=t;this.d=this.c.a("SaveToHostWithExtraCharsInFileName")};Common.App.SaveAsToHost.f.prototype={b:null,c:null,d:!1,a:function(){return new Common.App.SaveAsToHost.h(this.b,this.d)}};Common.App.SaveAsToHost.h=function(n,t){this.bH=Function.createDelegate(this,this.bW);Common.App.SaveAsToHost.h.initializeBase(this);this.b=n;this.Z=t;this.bc=!1};Common.App.SaveAsToHost.h.prototype={b:null,Z:!1,bs:!1,e:null,a:function(n,t,i){this.e=t;this.bs=i;Diag.a.a(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",n,i);n=this.bG(n);n?(this.g(0),this.h(1,$a.b)):(this.g(6),this.h(0,$a.b));n||Diag.a.a(8194009,216,50,"Show standard error dialog.");this.j(26,this.bM(n),this.bL(n,t),this.bH,!0)},bW:function(n){n===1?(Diag.a.a(8194010,216,50,"User click to retry button in error dialog."),this.e?this.b.b(2316717900,2,[this.e,this.bs],null):this.b.d(2316717900,2,null)):Diag.a.a(8194011,216,50,"User cancel the error dialog.")},bG:function(n){return n<0||n>6?(Diag.a.a(8194012,216,15,"Unexpected error code {0}.",n),0):n},bL:function(n,t){return(n=this.bG(n),this.Z)?[$a.A,$a.eO,$a.bb,$a.bn,String.format($a.bI,t),$a.bq,$a.eP][n]:[$a.A,$a.bl,$a.bb,$a.bn,String.format($a.bI,t),$a.bq,$a.bl][n]},bM:function(n){return n=this.bG(n),[$a.r,$a.bm,$a.dT,$a.r,$a.r,$a.r,$a.bm][n]}};Common.App.SaveAsToHost.c=function(n,t,i,r,u,f){this.b=t;this.e=n;this.d=r;this.g=f;this.f=u;this.c=i};Common.App.SaveAsToHost.c.prototype={b:null,d:null,g:null,f:null,e:null,c:null,a:function(){return new Common.App.SaveAsToHost.i(this.e,this.b,this.c,this.d,this.f,this.g)}};Common.App.SaveAsToHost.i=function(n,t,i,r,u,f){Common.App.SaveAsToHost.i.initializeBase(this,[n,t,i,r,u,f,null]);this.p=Common.App.SaveAsToHost.d.b();this.k="FileNameDialog-SaveAsToHost"};Common.App.SaveAsToHost.i.prototype={a:function(n,t){var i=Common.d.d(Common.a.l.a()),r={txtFileName:n||i,lblFolderName:$a.ic,chkOverwrite:t};this.j($a.L_SaveAs,this.bc,r);this.bG(n,i)}};Common.App.SaveAsToHost.l=function(n,t,i,r,u,f,e){this.R=Function.createDelegate(this,this.bZ);this.bc=Function.createDelegate(this,this.bY);Common.App.SaveAsToHost.l.initializeBase(this,[!1,!1,!1,!1]);this.bw=t;this.bF=r;this.bq=f;this.bd=n;this.e=u;this.Y=i;this.be=this.bd.a("SaveToHostWithExtraCharsInFileName");this.bp=e;this.h(1,$a.ci)};Common.App.SaveAsToHost.l.prototype={c:null,e:null,bq:null,bw:null,bF:null,bd:null,Y:null,be:!1,bp:null,bG:function(n,t){this.E(1,!!n&&n!==t);this.c=document.getElementById("txtFileName");Common.j.a(this.c,"change",this.R);Common.j.a(this.c,"input",this.R);this.c.focus()},bI:function(n){return this.be?new RegExp("["+this.bH('\\/:*?"<>|')+"]").test(n):new RegExp("["+this.bH('\\/:*?"<>|#{}%~&')+"]").test(n)},bH:function(n){return n.replace(new RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&")},br:function(){var n=Common.d.d(Common.a.l.a());this.E(1,!!this.c&&this.c.value!==""&&this.c.value!==n)},bZ:function(){if(this.c){var n=this;window.setTimeout(function(){n.br()},0)}},bY:function(n,t){var i,r,u;if(n!==1)Diag.a.a(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{if(i=t.txtFileName,r="chkOverwrite"in t?t.chkOverwrite:!1,Diag.a.a(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",Common.d.u(i),r),u=Common.d.o(Common.a.bm),i=i?i.trim():null,(!i||i===""||u==="")&&this.Y.g()!==1){this.e.a().a(2,i,r);return}if(this.bI(i)){this.e.a().a(1,i,r);return}this.bq.a(i+u,r,this.bp)}},dispose:function(){this.c&&(Common.j.c(this.c,"change",this.R),Common.j.c(this.c,"input",this.R),this.c=null);CommonUI.b.prototype.dispose.call(this)}};Common.App.SaveAsToHost.e=function(n,t,i){this.a=Function.createDelegate(this,this.f);this.d=i;this.c=t;this.b=n};Common.App.SaveAsToHost.e.prototype={b:null,c:null,d:null,e:function(){Common.a.b().a().b()===2?Common.a.c().c(2316717900,2147483648,this.a,4):Common.a.c().a(2316717900,2147483648,this.a)},f:function(n,t,i,r,u){var f,e;return t.a()!==2147483648||n!==2316717900?2:this.b.a("SaveAsToHostBrsIsEnabled")?i===1?32:i===2?(f=u,Diag.a.a(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),e=this.c.a(),u&&Object.getType(u)===Array&&f.length===2?e.a(f[0],!!f[1]):e.a(null,!1),32):8:8}};Common.App.SaveAsToHost.k=function(){this.e=Function.createDelegate(this,this.f)};Common.App.SaveAsToHost.k.a=function(){Common.App.a.a().a(new Common.App.SaveAsToHost.k,0,!1)};Common.App.SaveAsToHost.k.prototype={d:null,a:function(){return"Common.App.SaveAsToHost"},b:function(){Common.a.a.i(this.e)},f:function(){Common.a.a.a("SaveAsToHostBrsIsEnabled")&&this.d.a(Common.App.SaveAsToHost.e,null).e()},c:function(n){var t,i,r,u;this.d=n;t=this;this.d.b(Common.App.SaveAsToHost.f,null).c(Common.App.SaveAsToHost.a,null).b(function(){return new Common.App.SaveAsToHost.f(Common.a.a,Common.a.c())}).a();i=this;this.d.b(Common.App.SaveAsToHost.b,null).c(Common.App.SaveAsToHost.g,null).b(function(){return new Common.App.SaveAsToHost.b(Common.a.c(),Common.a.a,Common.a.d,function(){return Common.a.g},function(){var n=new CommonUI.g;return n.a(!1)},n.a(Common.App.SaveAsToHost.a,null),Common.a.b(),Common.a.b().c())}).a();r=this;this.d.b(Common.App.SaveAsToHost.c,null).c(Common.App.SaveAsToHost.j,null).b(function(){return new Common.App.SaveAsToHost.c(Common.a.a,Common.a.c(),Common.a.b(),Common.a.b().a(),n.a(Common.App.SaveAsToHost.a,null),n.a(Common.App.SaveAsToHost.b,null))}).a();u=this;this.d.b(Common.App.SaveAsToHost.e,null).b(function(){return new Common.App.SaveAsToHost.e(Common.a.a,n.a(Common.App.SaveAsToHost.c,null),n.a(Common.App.SaveAsToHost.b,null))}).a()}};Common.App.SaveAsToHost.b=function(n,t,i,r,u,f,e,o){this.t=Function.createDelegate(this,this.y);this.u=Function.createDelegate(this,this.z);this.d=t;this.s=this.d.j.g.SaveAsToHostWebServiceBase;this.l=r;this.r=u;this.i=i;this.p=f;this.n=o;this.h=e;this.g=n;this.q=t.b("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"};Common.App.SaveAsToHost.b.prototype={h:null,c:null,r:null,p:null,i:null,g:null,l:null,d:null,s:null,q:null,j:!1,m:!1,k:null,b:null,n:null,e:null,C:function(){this.h.g()!==1&&(this.c=this.r(),this.c.d($a.o),this.c.b(5),this.c.c(!1),this.c.e($a.a,null,null))},f:function(n){this.h.g()!==1&&this.p.a().a(n,Common.d.d(this.k),this.m)},B:function(){var n=this.d.j.g.BreadcrumbFolderUrl;Diag.a.a(8194016,216,50,"Redirecting to OneDrive for business Folder.");Common.g.c(n,Common.g.g(3),"",!1,"UploadToHostManager.RedirectToFolder")},A:function(n){var i=!1,r=!1,t,u;this.d&&(i=this.d.a("SaveACopyIsEnabledForUiHost"),r=this.d.a("UiHostSupportsDocRebootFeatures"));Diag.a.a(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",n,i);i&&r?(Diag.a.a(51245197,216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message."),t={},t.rebootMode="1",t.documentUrl=n,t.reason="saveAs",u=this,Common.a.L().a(function(n){n.a("App_DocReboot",t,"")})):Common.g.c(n,Common.g.g(3),"",!1,"UploadToHostManager.RedirectToEditUrl")},a:function(n,t,i){Diag.a.a(8194018,216,50,"Starting to upload file");this.l&&!this.l()&&this.i&&(this.n&&(this.e=this.n.a("DialogShown","SaveAsToHostUploadTime")),this.C(),this.m=t,this.k=n,this.b=i,this.b&&this.b.SkipSaveToHost==="true"?this.o():this.w())},w:function(){var n=this.g.d(3070187925,1,null);if(n!==32)Diag.a.a(18989378,219,15,"The save file change is not supported, this operation may exist data losting."),this.o();else{var t=this,i=function(){Diag.a.a(18989379,219,50,"Call the force save file change successfully.");t.o()},r=this,u=function(n,t){Diag.a.a(18989380,219,15,"The file change is not saved successfully, this operation may lead to data loss.");r.f(t)};this.g.b(3070187925,2,[i,u],null)}},z:function(n){var i,r,u,t;if(this.v(),this.j=!1,!n||!n.b||!n.b.a){Diag.a.a(8194019,216,10,"UploadToHostManager failure. Response data is null");this.f(0);return}if(!(u=Common.bz.a(n.b.a,r={val:i}),i=r.val,u)){Diag.a.a(8194048,216,10,"Failed to deserialize : {0}",{ResponseData:Common.Utils.e.a(n.b.a)});this.f(0);return}if(t=i,t.StatusCode!==200&&t.StatusCode!==201){Diag.a.a(8194049,216,10,"UploadToHostManager failure. Response data is not JSON.");this.f(parseInt(t.ExtraInfo));return}Diag.a.a(8194050,216,50,"UploadToHost execute success.");try{t.NewDocumentUrl&&t.NewDocumentUrl!==""?this.A(t.NewDocumentUrl):this.B()}catch(f){Diag.a.a(37025699,216,15,"Redirect failed with exception: {0}",f.toString())}this.x()},y:function(n){n.b.b!==5&&n.b.b!==12||this.j?(Diag.a.a(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",{Status:n.b.b,HttpStatus:n.b.c}),this.v(),this.f(0),this.x()):(Diag.a.a(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.j=!0,this.b&&this.b.SkipSaveToHost==="true"?this.o():this.w())},v:function(){this.c&&(this.c.a(),this.c=null)},x:function(){this.e&&(this.e.a(),this.e=null)},o:function(){var t={},n;t["Content-Type"]="application/json; charset=utf-8";n=this.s+this.q;n=Common.k.a(n,"qs",Common.d.a(Common.a.j),!1);n=Common.k.a(n,"n",Common.d.a((new Date).getTime().toString()),!1);n=Common.k.a(n,"ov",Common.d.a(this.m.toString()),!1);n=Common.k.a(n,"fn",Common.d.a(this.k),!1);this.b&&this.b.FileDownloadUrl&&(n=Common.k.a(n,"furl",Common.d.a(this.b.FileDownloadUrl),!1));this.i.a(n,1,"",t,!1,2,this.u,this.t,null,null,!1,null,null,"1",null,!1,null,!1,null)}};Common.App.SaveAsToHost.f.registerClass("Common.App.SaveAsToHost.f",null,Common.App.SaveAsToHost.a);Common.App.SaveAsToHost.h.registerClass("Common.App.SaveAsToHost.h",CommonUI.d);Common.App.SaveAsToHost.c.registerClass("Common.App.SaveAsToHost.c",null,Common.App.SaveAsToHost.j);Common.App.SaveAsToHost.l.registerClass("Common.App.SaveAsToHost.l",CommonUI.b);Common.App.SaveAsToHost.i.registerClass("Common.App.SaveAsToHost.i",Common.App.SaveAsToHost.l);Common.App.SaveAsToHost.e.registerClass("Common.App.SaveAsToHost.e");Common.App.SaveAsToHost.b.registerClass("Common.App.SaveAsToHost.b",null,Common.App.SaveAsToHost.g);Common.App.SaveAsToHost.d.a="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}<\/label> <\/div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}<\/label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> <\/div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'><\/input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}<\/label><\/span> <\/div>";Common.App.SaveAsToHost.k.a();Type.registerNamespace("Common.App.SaveToCloudStorage");Common.App.SaveToCloudStorage.l=function(){};Common.App.SaveToCloudStorage.l.registerInterface("Common.App.SaveToCloudStorage.l");Common.App.SaveToCloudStorage.m=function(){};Common.App.SaveToCloudStorage.m.registerInterface("Common.App.SaveToCloudStorage.m");Common.App.SaveToCloudStorage.g=function(){};Common.App.SaveToCloudStorage.g.registerInterface("Common.App.SaveToCloudStorage.g");Common.App.SaveToCloudStorage.n=function(){};Common.App.SaveToCloudStorage.n.registerInterface("Common.App.SaveToCloudStorage.n");Common.App.SaveToCloudStorage.o=function(){};Common.App.SaveToCloudStorage.h=function(){};Common.App.SaveToCloudStorage.h.registerInterface("Common.App.SaveToCloudStorage.h");Common.App.SaveToCloudStorage.p=function(){};Common.App.SaveToCloudStorage.p.registerInterface("Common.App.SaveToCloudStorage.p");Common.App.SaveToCloudStorage.f=function(){Common.App.SaveToCloudStorage.f.initializeBase(this);this.g(0);this.h(1,$a.b)};Common.App.SaveToCloudStorage.f.prototype={a:function(n){this.j(n,$a.a,$a.z,null)}};Common.App.SaveToCloudStorage.i=function(){};Common.App.SaveToCloudStorage.i.a=function(){Common.App.a.a().a(new Common.App.SaveToCloudStorage.i,0,!1)};Common.App.SaveToCloudStorage.i.prototype={d:null,a:function(){return"Common.App.SaveToCloudStorage"},b:function(){Common.a.a.a("SaveToCloudStorageUIIsEnabled")&&this.d.a(Common.App.SaveToCloudStorage.e,null).m()},c:function(n){var t,i,r,u,f;this.d=n;t=this;this.d.b(Common.App.SaveToCloudStorage.a,null).c(Common.App.SaveToCloudStorage.g,null).b(function(){return new Common.App.SaveToCloudStorage.a(Common.a.c(),Common.bF.a(),Common.a.b().a())}).a();i=this;this.d.b(Common.App.SaveToCloudStorage.b,null).c(Common.App.SaveToCloudStorage.h,null).b(function(){return new Common.App.SaveToCloudStorage.b(Common.a.a)}).a();r=this;this.d.b(Common.App.SaveToCloudStorage.e,null).b(function(){return new Common.App.SaveToCloudStorage.e(n.a(Common.App.SaveToCloudStorage.d,null),n.a(Common.App.OneDriveFilePickerApi.d,null),Common.a.a,Common.a.b().c())}).a();u=this;this.d.b(Common.App.SaveToCloudStorage.c,null).b(function(){return new Common.App.SaveToCloudStorage.c(n.a(Common.App.SaveToCloudStorage.b,null),function(){var n=new CommonUI.g;return n.a(!1)},function(){return new Common.App.SaveToCloudStorage.f},Common.a.b(),Common.a.b().c())}).a();f=this;this.d.b(Common.App.SaveToCloudStorage.d,null).b(function(){return new Common.App.SaveToCloudStorage.d(n.a(Common.App.SaveToCloudStorage.a,null),Common.bF.a(),n.a(Common.App.SaveToCloudStorage.c,null),Common.a.a,Common.a.Y,function(){return new Common.App.SaveToCloudStorage.f})}).a()}};Common.App.SaveToCloudStorage.e=function(n,t,i,r){this.g=Function.createDelegate(this,this.n);this.h=n;this.c=i;this.d=t;this.b=new($$sc.D.$$(Boolean));this.e=r};Common.App.SaveToCloudStorage.e.prototype={h:null,d:null,c:null,e:null,a:null,b:null,k:function(){return this.c.a("SaveToCloudStorageUIIsEnabled")},j:function(){return 617689800},i:function(){Common.bc.e(this.g);Common.bc.d([new Common.er(617689800,2147483648,0)],this.d.a())},m:function(){var n=this.d.a(),t;n?(t=this,n.d(function(){t.b.b(!0)}),this.i()):Diag.a.a(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")},l:function(){Diag.a.a(6590597,216,50,"User clicked on SaveToOneDrive button")},n:function(n,t,i,r,u){var e,f;return t.a()!==2147483648||n!==this.j()?2:this.k()?i===1?32:i===2?(this.l(),e=u,e&&e.FileDownloadUrl&&Diag.a.a(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there"),this.e&&(this.a=this.e.a("DialogShown","SaveToOneDriveReponseTime")),f=this,this.b.a.CW(function(){f.a&&(f.a.a(),f.a=null);f.h.a(e)}),32):8:8}};Common.App.SaveToCloudStorage.d=function(n,t,i,r,u,f){this.l=Function.createDelegate(this,this.k);this.m=Function.createDelegate(this,this.n);this.h=n;this.i=t;this.j=i;this.d=r;this.c=u;this.g=f};Common.App.SaveToCloudStorage.d.prototype={h:null,g:null,i:null,j:null,d:null,c:0,e:null,a:function(n){this.e=n;this.i.b()?(Diag.a.a(6590559,216,50,"User is signed in. We will show file picker."),this.o()):(Diag.a.a(6590560,216,50,"User is not signed in. We will show sign in dialog."),this.p())},p:function(){var n=this.h.a();n.a()},b:function(){this.g().a(0)},o:function(){var n,t;try{Diag.a.a(6590561,216,50,"Initializing OneDrive API");n={client_id:this.d.j.g.UploadToSkyDriveClientId,env:"INT"};(this.c===1||this.c===2)&&(n={client_id:this.d.j.g.UploadToSkyDriveClientId});t={mode:"save",lightbox:"grey"};WL.init(n);Diag.a.a(6590562,216,50,"OneDrive API is initialized. Launching file dialogue");WL.fileDialog(t).then(this.m,this.l)}catch(i){Diag.a.a(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",i,i.stack);this.b()}},n:function(n){Diag.a.a(6590592,216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");n&&n.data&&n.data.folders&&this.j.a(n.data.folders[0].id,n.data.folders[0].urls.viewInBrowser,null,this.e)},k:function(n){if(n&&n.error){if(n.error.code==="user_canceled"){Diag.a.a(6590593,216,50,"User cancelled upload to their OneDrive.");return}Diag.a.a(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",n.error.code,n.error.message)}else Diag.a.a(6590595,216,50,"File Dialog returned with no response");this.b()}};Common.App.SaveToCloudStorage.a=function(n,t,i){this.b=n;this.d=t;this.c=i};Common.App.SaveToCloudStorage.a.prototype={b:null,d:null,c:null,a:function(){return new Common.App.SaveToCloudStorage.j(this.b,this.d,this.c)}};Common.App.SaveToCloudStorage.j=function(n,t,i){this.bG=Function.createDelegate(this,this.bL);this.Z=Function.createDelegate(this,this.bM);Common.App.SaveToCloudStorage.j.initializeBase(this);this.bs=n;this.e=t;this.b=i;this.v=!1;this.g(1);this.I=1;this.h(1,$a.j);this.h(0,$a.cp)};Common.App.SaveToCloudStorage.j.prototype={bs:null,e:null,b:null,a:function(){this.e.a(this.Z);this.c($a.cq,$a.hp,0,this.bG)},bL:function(n){if(!n){Diag.a.a(6590598,216,50,"User dismissed SignIn Dialog.");this.i();return}this.bW()},bH:function(){var n="2";if(this.b)switch(this.b.b()){case 3:n="0";break;case 2:n="3";break;case 1:n="1"}return n},i:function(){this.e.c(this.Z);CommonUI.c.prototype.i.call(this)},bW:function(){var n=new Common.bB("Signin.aspx");n.a("prompt","1");n.a("cbcxt",this.bH());Common.a.bV(n);Common.g.c(n.toString(),"LoginWindow","",!1,"SignInDialog")},bM:function(){this.S&&this.i();Diag.a.a(7143885,216,50,"User signed in successfully. Calling Savetocloudstorage action handler");this.bs.d(617689800,2,null)}};Common.App.SaveToCloudStorage.k=function(n,t,i,r,u,f,e){this.h=n;this.d=t;this.c=i;this.e=r;this.g=u;this.f=f;this.b=e};Common.App.SaveToCloudStorage.k.prototype={h:null,d:null,c:null,e:null,g:null,f:null,b:null,a:function(n,t){var r,i;!Common.a.g&&Common.a.d&&(r={},r["Content-Type"]="application/json; charset=utf-8",i=this.h+this.f,i=Common.k.a(i,"fo",Common.d.a(this.e),!1),i=Common.k.a(i,"fn",Common.d.a(this.d),!1),i=Common.k.a(i,"qs",Common.d.a(this.g),!1),i=Common.k.a(i,"n",Common.d.a((new Date).getTime().toString()),!1),this.b&&this.b.FileDownloadUrl&&(i=Common.k.a(i,"furl",Common.d.a(this.b.FileDownloadUrl),!1)),this.c&&(i=Common.k.a(i,"fnn",Common.d.a(this.c),!1)),Common.a.d.a(i,1,"",r,!1,2,n,t,null,null,!1,null,null,null,null,!1,null,!1,null))}};Common.App.SaveToCloudStorage.b=function(n){this.e=n;this.d=n.j.g.SkyDriveUploadWebServiceBase;this.b=n.j.g.FileName;this.c=n.b("SkyDriveUploadHandler")||"skydriveuploadhandler.ashx"};Common.App.SaveToCloudStorage.b.prototype={d:null,b:null,c:null,e:null,a:function(n,t,i){return new Common.App.SaveToCloudStorage.k(this.d,this.b,t,n,Common.a.j,this.c,i)}};Common.App.SaveToCloudStorage.c=function(n,t,i,r,u){this.r=Function.createDelegate(this,this.v);this.s=Function.createDelegate(this,this.w);this.o=n;this.n=t;this.l=i;this.g=r;this.j=u};Common.App.SaveToCloudStorage.c.prototype={o:null,k:null,b:null,g:null,m:null,n:null,l:null,h:!1,j:null,e:null,i:null,x:function(){this.g&&this.g.g()===1||(this.b=this.n(),this.b.d($a.o),this.b.b(5),this.b.c(!1),this.b.e($a.a,null,null))},t:function(){this.b&&(this.b.a(),this.b=null)},c:function(){Common.a.b().g()!==1&&this.l().a(0)},q:function(){Diag.a.a(6590599,216,50,"Redirecting to OneDrive Folder.");Common.g.c(this.m,Common.g.g(3),"",!1,"UploadToCloudManager.RedirectToFolder")},p:function(n){var i=!1,r=!1,t,u;Common.a.a&&(i=Common.a.a.a("SaveACopyIsEnabledForUiHost"),r=Common.a.a.a("UiHostSupportsDocRebootFeatures"));Diag.a.a(6654163,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",n,i);i&&r?(Diag.a.a(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message."),t={},t.rebootMode="1",t.documentUrl=n,u=this,Common.a.L().a(function(n){n.a("App_DocReboot",t,"")})):Common.g.c(n,Common.g.g(3),"",!1,"UploadToCloudManager.RedirectToEditUrl")},a:function(n,t,i,r){Diag.a.a(7143886,216,50,"Starting to upload file");this.j&&(this.e=this.j.a("DialogShown","SaveToOneDriveUploadTime"));this.x();this.m=t;this.k=this.o.a(n,i,r);this.i=r;this.d()},d:function(){Diag.a.a(6590600,216,50,"Calling SkydriveUploadHandler.");this.k.a(this.s,this.r)},w:function(n){var i,r,u,t;if(this.t(),this.h=!1,!n||!n.b||!n.b.a){Diag.a.a(6590601,216,10,"UploadToCloudManager upload failure. Response data is null");this.c();return}if(!(u=Common.bz.a(n.b.a,r={val:i}),i=r.val,u)){Diag.a.a(7660114,216,10,"Failed to deserialize : {0}",{ResponseData:Common.Utils.e.a(n.b.a)});this.c();return}if(t=i,t.StatusCode!==200&&t.StatusCode!==201){Diag.a.a(6590602,216,10,"UploadToCloudManager upload failure. Response data is not JSON.");this.c();return}Diag.a.a(6590603,216,50,"UploadToCloudManager upload success.");try{t.NewDocumentUrl&&t.NewDocumentUrl!==""?this.p(t.NewDocumentUrl):this.q()}catch(f){Diag.a.a(37025728,216,15,"Redirect failed with exception: {0}",f.toString())}this.u()},v:function(n){n.b.b!==5&&n.b.b!==12||this.h?(Diag.a.a(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",n.b.b),this.t(),this.c(),this.u()):(Diag.a.a(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.h=!0,this.d())},u:function(){this.e&&(this.e.a(),this.e=null)}};Common.App.SaveToCloudStorage.f.registerClass("Common.App.SaveToCloudStorage.f",CommonUI.d);Common.App.SaveToCloudStorage.e.registerClass("Common.App.SaveToCloudStorage.e");Common.App.SaveToCloudStorage.d.registerClass("Common.App.SaveToCloudStorage.d",null,Common.App.SaveToCloudStorage.m);Common.App.SaveToCloudStorage.a.registerClass("Common.App.SaveToCloudStorage.a",null,Common.App.SaveToCloudStorage.g);Common.App.SaveToCloudStorage.j.registerClass("Common.App.SaveToCloudStorage.j",CommonUI.d);Common.App.SaveToCloudStorage.b.registerClass("Common.App.SaveToCloudStorage.b",null,Common.App.SaveToCloudStorage.h);Common.App.SaveToCloudStorage.c.registerClass("Common.App.SaveToCloudStorage.c",null,Common.App.SaveToCloudStorage.p);Common.App.SaveToCloudStorage.i.a();Type.registerNamespace("Common.App.SaveToSharePoint");Common.App.SaveToSharePoint.q=function(){};Common.App.SaveToSharePoint.q.registerInterface("Common.App.SaveToSharePoint.q");Common.App.SaveToSharePoint.s=function(){};Common.App.SaveToSharePoint.s.registerInterface("Common.App.SaveToSharePoint.s");Common.App.SaveToSharePoint.r=function(){};Common.App.SaveToSharePoint.r.registerInterface("Common.App.SaveToSharePoint.r");Common.App.SaveToSharePoint.c=function(){};Common.App.SaveToSharePoint.c.registerInterface("Common.App.SaveToSharePoint.c");Common.App.SaveToSharePoint.t=function(){};Common.App.SaveToSharePoint.t.registerInterface("Common.App.SaveToSharePoint.t");Common.App.SaveToSharePoint.u=function(){};Common.App.SaveToSharePoint.l=function(){};Common.App.SaveToSharePoint.l.registerInterface("Common.App.SaveToSharePoint.l");Common.App.SaveToSharePoint.d=function(){};Common.App.SaveToSharePoint.d.registerInterface("Common.App.SaveToSharePoint.d");Common.App.SaveToSharePoint.m=function(){};Common.App.SaveToSharePoint.m.registerInterface("Common.App.SaveToSharePoint.m");Common.App.SaveToSharePoint.b=function(){};Common.App.SaveToSharePoint.b.b=function(){return CommonUI.b.a(Common.App.SaveToSharePoint.b.a,$a.eE,$a.fm,$a.X,"")};Common.App.SaveToSharePoint.h=function(){Common.App.SaveToSharePoint.h.initializeBase(this);this.g(0);this.h(1,$a.b)};Common.App.SaveToSharePoint.h.prototype={a:function(n,t,i){Diag.a.a(25180161,216,10,"Show upload error dialog with error code {0}.",i);this.j(i,n,t,null)},b:function(n,t){Diag.a.a(25235986,216,15,"Show warning dialog of Picker related issue.");this.j(37,n,t,null,!0)}};Common.App.SaveToSharePoint.a=function(n,t,i,r,u,f,e){this.b=t;this.e=n;this.d=r;this.h=f;this.f=u;this.c=i;this.g=e};Common.App.SaveToSharePoint.a.prototype={b:null,d:null,h:null,f:null,e:null,c:null,g:null,a:function(n){return new Common.App.SaveToSharePoint.k(this.e,this.b,this.c,this.d,this.f,this.h,this.g,n)}};Common.App.SaveToSharePoint.k=function(n,t,i,r,u,f,e,o){this.bt=Function.createDelegate(this,this.cs);this.bs=Function.createDelegate(this,this.bX);this.bL=$a.ho;Common.App.SaveToSharePoint.k.initializeBase(this,[n,t,i,r,u,f,o]);this.p=Common.App.SaveToSharePoint.b.b();this.k="FileNameDialog-SaveToSharePoint";this.bv=e;this.bu=o};Common.App.SaveToSharePoint.k.prototype={bv:null,bu:null,b:null,Z:null,d:null,a:function(n){var r=Common.d.d(Common.a.l.a()),t=Common.a.Q,u=Common.a.bc,s={txtFileName:n||r},f=$a.L_SaveAs,e,i,o;Common.a.b().a().b()===2&&(f=$a.L_SaveACopy);this.j(f,this.bc,s);this.bG(n,r);this.V().style.width="450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");Common.a.a.a("HideSaveToAnotherFolderButtonforUIHost")||(this.b=document.getElementById("anotherFolder"),e=document.getElementById("folderLocation"),this.Z=Common.F.b(e,this.b,"anotherFolderDescribedBy",""),this.b.className="WACButton WACDialogButtonNormal",i=!1,t&&t.length?(this.bK(this.b,this.Z,String.format($a.hs,u,t)),this.ca(u,t,o={val:i}),i=o.val):this.bK(this.b,this.Z,$a.X),this.cc(this.b),this.cb(this.b),i?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.b,"SaveToAnotherLocationTwo"),Diag.a.a(24459297,216,50,"Move save to another folder button to second line.")):Sys.UI.DomElement.addCssClass(this.b,"SaveToAnotherLocationOne"),Common.j.a(this.b,"click",this.bs),Common.j.a(this.b,"keydown",this.bt))},ca:function(n,t,i){var r;i.val=!1;r=document.getElementById("currentLocation");r.innerText="";var u=this.bW(r,n),f=this.bW(r,t),e=255,o=255;u+f>255&&(e=Math.max(238,408-u),o=Math.max(170,408-f),i.val=!0);this.cq(r,n,o,t,e)},bW:function(n,t){var i=document.createElement("div"),r;return i.innerText=t,i.style.visibility="hidden",n.appendChild(i),r=i.clientWidth,n.removeChild(i),r},cq:function(n,t,i,r,u){t&&(this.bJ(n,t,i),this.cd(n));r&&this.bJ(n,r,u)},bJ:function(n,t,i){var r=document.createElement("div");r.innerText=t;r.title=t;r.className="SaveToAnotherFolderBreadcrumb";r.style.maxWidth=i.toString()+"px";n.appendChild(r)},cd:function(n){var i=document.createElement("span"),t,r;i.id="FolderSeparator";t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.setAttribute("class","SeparatorCaret");r=document.createElementNS("http://www.w3.org/2000/svg","polygon");r.setAttribute("points","1 4 1 11 5 7.5");t.appendChild(r);i.appendChild(t);n.appendChild(i)},bK:function(n,t,i){var r=String.format($a.ht,i);t&&(t.innerText=r);n.tabIndex=0;n.setAttribute("role","button")},cb:function(n){var t=document.createElement("span");t.id="anotherFolderText";t.innerText=this.bL;t.className="AnotherFolderTextSpan";n.appendChild(t)},cc:function(n){var t=document.createElement("span"),i;t.className="cui-img-cont-float cui-img-16by16 ";this.d=document.createElementNS("http://www.w3.org/2000/svg","svg");this.d.setAttribute("class","FolderIconSVG");i=document.createElementNS("http://www.w3.org/2000/svg","path");i.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");this.d.appendChild(i);t.appendChild(this.d);n.appendChild(t)},cs:function(n){n&&(n.keyCode===13||n.keyCode===32)&&this.bX(n)},bX:function(){if(this.c){var t=Common.d.o(Common.a.bm),n=this.c.value;if(this.i(),(!n||n===""||t==="")&&this.Y.g()!==1){this.e.a().a(2,n,!1);return}if(t!==""&&(n=n+t),this.bI(n)){this.e.a().a(1,n,!1);return}this.bv.a(n,this.bu)}},cr:function(n){this.b&&this.d&&(n?(this.b.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.b,"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.d,"DisabledFolderIconSVG")):(this.b.tabIndex=-1,Sys.UI.DomElement.containsCssClass(this.b,"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.d,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.b,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.d,"DisabledFolderIconSVG"))))},br:function(){Common.App.SaveAsToHost.l.prototype.br.call(this);this.cr(!!this.c&&this.c.value!=="")},dispose:function(){this.b&&(Common.j.c(this.b,"click",this.bs),Common.j.c(this.b,"keydown",this.bt),this.b=null);Common.App.SaveAsToHost.l.prototype.dispose.call(this)}};Common.App.SaveToSharePoint.i=function(n,t,i,r){this.h=Function.createDelegate(this,this.j);this.e=n;this.i=i;this.g=r;var u=this;this.f=new($$sc.z.$$(Common.jz.$$(Common.bq)))(function(){return new(Common.App.NewAndOpen.Core.h.$$(Common.bq))(t.a(),u.h)})};Common.App.SaveToSharePoint.i.prototype={e:null,i:null,g:null,d:null,c:null,f:null,a:function(){return this.d||(this.f.a().a("Save As",!0),this.c&&this.c.b()&&this.c.b().length&&(this.d=this.k(this.c.b()))),this.d},b:function(n){var t,i,u,r;if(!this.a())if(Common.a.bi&&Common.a.bi.length)this.d=Common.a.bi;else return Diag.a.a(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.c),!1;return(t=this.g(),t.c(),i=t.b(),!i)?(Diag.a.a(24664067,216,10,"Picker container is null, will not show picker."),!1):(u=this,r=this,this.e.p(function(i,r){t.a();n(i,r)},function(){r.l(t)},i,this.d),!0)},l:function(n){n.a();Diag.a.a(24664068,216,50,"User cancelled save to another folder.")},k:function(n){n=n.toLowerCase();n.endsWith("/")||(n=n+"/");var t=n.indexOf("/documents/");return t!==-1?n.substring(0,t+1)+"_layouts/15/onedrive.aspx":""},j:function(n){this.c||n.a()!==3||(this.c=n)}};Common.App.SaveToSharePoint.n=function(){};Common.App.SaveToSharePoint.n.a=function(){Common.App.a.a().a(new Common.App.SaveToSharePoint.n,0,!1)};Common.App.SaveToSharePoint.n.prototype={d:null,a:function(){return"Common.App.SaveToSharePoint"},b:function(){},c:function(n){this.d=n;var i=Common.Utils.b.a(Common.jy.$$(Common.bq),n.c(Common.jy.$$(Common.bq),null)),t=this;$$sc.a.WAA.call(null,i).CW(function(){t.d.b(Common.App.SaveToSharePoint.f,null).c(Common.App.SaveToSharePoint.l,null).b(function(){return new Common.App.SaveToSharePoint.f(Common.a.a)}).a();t.d.b(Common.App.SaveToSharePoint.g,null).c(Common.App.SaveToSharePoint.m,null).b(function(){return new Common.App.SaveToSharePoint.g(Common.a.c(),n.a(Common.App.SaveToSharePoint.f,null),function(){var n=new CommonUI.g;return n.a(!1)},function(){return new Common.App.SaveToSharePoint.h},Common.a.b())}).a();t.d.b(Common.App.SaveToSharePoint.j,null).c(Common.App.SaveToSharePoint.d,null).b(function(){return new Common.App.SaveToSharePoint.j(n.a(Common.App.SaveToSharePoint.g,null),function(){return new Common.App.SaveToSharePoint.h},n.a(Common.App.SaveToSharePoint.c,null),Common.a.b())}).a();t.d.b(Common.App.SaveToSharePoint.i,null).c(Common.App.SaveToSharePoint.c,null).b(function(){return new Common.App.SaveToSharePoint.i(n.a(Common.App.OneDriveFilePickerApi.b,null),new($$sc.z.$$(Common.jy.$$(Common.bq)))(function(){return i.a()}),Common.a.b(),function(){return new Common.App.SaveToSharePoint.o})}).a();t.d.b(Common.App.SaveToSharePoint.a,null).b(function(){return new Common.App.SaveToSharePoint.a(Common.a.a,Common.a.c(),Common.a.b(),Common.a.b().a(),n.a(Common.App.SaveAsToHost.a,null),n.a(Common.App.SaveAsToHost.g,null),n.a(Common.App.SaveToSharePoint.d,null))}).a();t.d.b(Common.App.SaveToSharePoint.e,null).b(function(){return new Common.App.SaveToSharePoint.e(Common.a.a,Common.a.c(),n.a(Common.App.SaveToSharePoint.a,null),n.a(Common.App.SaveToSharePoint.d,null),n.a(Common.App.OneDriveFilePickerApi.b,null),n.a(Common.App.SaveToSharePoint.c,null),function(){return Common.a.b().I()})}).a();Common.a.a.a("SaveToAnotherFolderBrsIsEnabled")&&t.d.a(Common.App.SaveToSharePoint.e,null).l()})}};Common.App.SaveToSharePoint.o=function(){Common.App.SaveToSharePoint.o.resolveInheritance();this.a=this.i;Common.App.SaveToSharePoint.o.initializeBase(this,[!1,!1,!1,!1])};Common.App.SaveToSharePoint.o.prototype={c:function(){this.cz="FilePickerDialog";this.p="<div class='FilePickerDiv' id='FilePickerDiv'><\/div>";this.k="PickerDialog-MsoSp";this.bf("",null)},b:function(){return document.getElementById("FilePickerDiv")},B:function(){},bn:function(){}};Common.App.SaveToSharePoint.p=function(n,t,i,r,u,f,e,o){this.i=n;this.d=t;this.b=r;this.g=f;this.e=i;this.h=u;this.f=e;this.c=o};Common.App.SaveToSharePoint.p.prototype={i:null,d:null,b:null,g:null,e:null,h:null,f:null,c:null,a:function(n,t){var r,i;!Common.a.g&&Common.a.d&&(r={},r["Content-Type"]="application/json; charset=utf-8",i=this.i+this.f,i=Common.k.a(i,"fu",Common.d.a(this.e),!1),i=Common.k.a(i,"su",Common.d.a(this.h),!1),i=Common.k.a(i,"fn",Common.d.a(this.d),!1),i=Common.k.a(i,"n",Common.d.a((new Date).getTime().toString()),!1),this.c&&this.c.FileDownloadUrl&&(i=Common.k.a(i,"furl",Common.d.a(this.c.FileDownloadUrl),!1)),i=i+"&"+this.g,this.b&&this.b.length?i=Common.k.a(i,"fnn",Common.d.a(this.b),!1):Diag.a.a(23881891,216,15,"No new file name in request."),Diag.a.a(23881920,216,50,"Trying send SharePointSaveAsHandler.ashx request."),Common.a.d.a(i,1,"",r,!1,2,n,t,null,null,!1,null,null,"9",null,!1,null,!1,null))}};Common.App.SaveToSharePoint.f=function(n){this.d=n.j.g.SaveAsToHostWebServiceBase;this.b=n.j.g.FileName;this.c=n.b("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"};Common.App.SaveToSharePoint.f.prototype={d:null,b:null,c:null,a:function(n,t,i,r){return new Common.App.SaveToSharePoint.p(this.d,this.b,n,t,i,Common.a.j,this.c,r)}};Common.App.SaveToSharePoint.e=function(n,t,i,r,u,f,e){this.c=Function.createDelegate(this,this.m);this.a=n;this.f=i;this.d=t;this.h=r;this.b=u;this.g=f;this.e=e};Common.App.SaveToSharePoint.e.prototype={f:null,a:null,d:null,h:null,b:null,g:null,e:null,l:function(){var n=this.b.a(),t;n?Common.c.n()||this.a.a("SaveToSharePointOnDemandDownloadJsIsEnabled")?this.d.c(3050207199,2147483648,this.c,64):(t=this,n.f.a.CW(function(n){n.b===5&&t.b.r(n)}),this.j()):Diag.a.a(25180162,216,15,"Failure with OneDrive API download as the js url is empty.")},j:function(){Common.bc.e(this.c);Common.bc.d([new Common.er(3050207199,2147483648,0)],this.b.a())},k:function(){return this.a.a("SaveToAnotherFolderBrsIsEnabled")},i:function(){return this.a.a("UserCanWriteRelative")},m:function(n,t,i,r,u){var f,e;return t.a()!==2147483648||n!==3050207199?2:!this.k()||!this.g.a()&&!this.i()?8:i===1?this.e()?32:8:i===2?(Diag.a.a(23881885,216,50,"User clicked on SaveToSharePoint button from the backstage."),f=u,f&&f.FileDownloadUrl&&Diag.a.a(40379589,216,50,"SaveToSharePoint FileDownloadUrl - "+f.FileDownloadUrl),this.i()?(Diag.a.a(24524226,216,50,"Show save a copy dialog."),e=this.f.a(f),e.a(null)):(Diag.a.a(24524225,216,50,"No permission save to current folder, show Picker to save to another folder."),this.h.a(null,f)),32):8}};Common.App.SaveToSharePoint.j=function(n,t,i,r){this.g=n;this.c=t;this.e=i;this.b=r};Common.App.SaveToSharePoint.j.prototype={b:null,c:null,g:null,e:null,d:null,f:null,a:function(n,t){Diag.a.a(25180163,216,50,"Try launch Picker.");this.d=n;this.f=t;var i=this,r=this.e.b(function(n,t){i.m(n,t)});r||this.h()},m:function(n,t){var i=t;n?this.l(i):this.k(i)},h:function(){this.b.g()!==1&&this.c().b($a.a,$a.I)},l:function(n){if(Diag.a.a(23881886,216,50,"Success Callback called. Calling UploadToSharePointManager to start upload."),n&&n.data&&n.data.value&&n.data.value.length&&n.data.value[0].sharePoint){var t=n.data.value[0].sharePoint.url,r=n.data.value[0].sharePoint.listUrl,i=null;if(t&&(i=r?this.j(r):this.i(t),i)){this.g.a(t,this.d,i,this.f);return}Diag.a.a(25180164,216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!t,!i)}Diag.a.a(23881887,216,10,"Picker return invalid data or empty SharePoint url.");this.h()},i:function(n){var i,t;for(n.endsWith("/")||(n+="/"),i=0,t=0;t<n.length;t++)if(n.charAt(t)==="/"&&++i==5)return n.substr(0,t);return null},j:function(n){n.endsWith("/")&&(n=n.substring(0,n.length-1));var t=n.lastIndexOf("/");return t!==-1?n.substring(0,t):null},k:function(n){Diag.a.a(23881888,216,10,"Picker failure Callback called.");n&&n.error?Diag.a.a(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",n.error.errorCode,n.error.message):Diag.a.a(23881890,216,10,"File Dialog returned empty error.");this.h()}};Common.App.SaveToSharePoint.g=function(n,t,i,r,u){this.o=Function.createDelegate(this,this.t);this.p=Function.createDelegate(this,this.u);this.m=t;this.l=i;this.j=r;this.c=u;this.h=n};Common.App.SaveToSharePoint.g.prototype={m:null,i:null,b:null,c:null,l:null,j:null,h:null,e:!1,k:null,a:function(n,t,i,r){this.e=!1;Diag.a.a(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");this.A();this.k=n;this.i=this.m.a(n,t,i,r);r&&r.SkipSaveToHost==="true"?this.g():this.s()},s:function(){var t=this,i=function(){Diag.a.a(23881922,216,50,"Call the force save file change successfully.");t.g()},r=this,n=function(){Diag.a.a(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");r.g()},u=this.h.b(3070187925,2,[i,n],null);u!==32&&n()},g:function(){Diag.a.a(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");this.i.a(this.p,this.o)},u:function(n){var i,r,u,t;if(!n||!n.b||!n.b.a){Diag.a.a(23881925,216,10,"Upload failure. Response data is null");this.f()||this.d();return}if(!(u=Common.bz.a(n.b.a,r={val:i}),i=r.val,u)){Diag.a.a(23881926,216,10,"Failed to deserialize : {0}",{ResponseData:Common.Utils.e.a(n.b.a)});this.f()||this.d();return}if(t=i,t.StatusCode!==200&&t.StatusCode!==201){Diag.a.a(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",n.b.b,t.StatusCode);t.StatusCode!==413&&this.q(n.b.b)||this.x(t.StatusCode);return}Diag.a.a(23881927,216,50,"UploadToSharePointManager upload success.");try{t.NewDocumentUrl?this.v(t.NewDocumentUrl):this.w()}catch(f){Diag.a.a(37025729,216,15,"Redirect failed with exception: {0}",f.toString())}},t:function(n){if(!n||!n.b){Diag.a.a(23881928,216,10,"Upload failure. Response data is null");this.f()||this.d();return}this.q(n.b.b)||(Diag.a.a(23881929,216,10,"Upload failed."),this.d())},f:function(){return this.e?(Diag.a.a(23881931,216,10,"Upload fail. Already retry once but still fail."),!1):(Diag.a.a(23881930,216,10,"Upload fail. Retrying."),this.e=!0,this.g(),!0)},q:function(n){return Diag.a.a(23881932,216,10,"HTTP failure with code: {0}",n),this.f()},w:function(){Diag.a.a(23881933,216,50,"Redirecting to Folder.");Common.g.c(this.k,Common.g.g(3),"",!1,"UploadToSharePointManager.RedirectToFolder")},v:function(n){var i=!1,r=!1,t,u;Common.a.a&&(i=Common.a.a.a("SaveACopyIsEnabledForUiHost"),r=Common.a.a.a("UiHostSupportsDocRebootFeatures"));Diag.a.a(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",n,i);i&&r?(Diag.a.a(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message."),t={},t.rebootMode="1",t.documentUrl=n,t.reason="saveAs",u=this,Common.a.L().a(function(n){n.a("App_DocReboot",t,"")})):Common.g.c(n,Common.g.g(3),"",!1,"UploadToSharePointManager.RedirectToEditUrl")},A:function(){this.c&&this.c.g()===1||(this.b=this.l(),this.b.d($a.o),this.b.b(5),this.b.c(!1),this.b.e($a.a,null,null))},r:function(){this.b&&(this.b.a(),this.b=null)},d:function(){this.n($a.hm,$a.A,38)},z:function(){this.n($a.fr,$a.fq,38)},y:function(){var n=String.format($a.hj,250);this.n($a.hk,n,32)},n:function(n,t,i){Diag.a.a(25180165,216,10,"Upload failure with title: {0}, message: {1}",n,t);this.r();this.c.g()!==1&&this.j().a(n,t,i)},x:function(n){Diag.a.a(25180166,216,50,"Upload fail with status code: {0}.",n);switch(n){case 401:this.z();break;case 413:this.y();break;default:this.d()}}};Common.App.SaveToSharePoint.h.registerClass("Common.App.SaveToSharePoint.h",CommonUI.d);Common.App.SaveToSharePoint.a.registerClass("Common.App.SaveToSharePoint.a",null,Common.App.SaveToSharePoint.s);Common.App.SaveToSharePoint.k.registerClass("Common.App.SaveToSharePoint.k",Common.App.SaveAsToHost.l);Common.App.SaveToSharePoint.i.registerClass("Common.App.SaveToSharePoint.i",null,Common.App.SaveToSharePoint.c);Common.App.SaveToSharePoint.o.registerClass("Common.App.SaveToSharePoint.o",CommonUI.b);Common.App.SaveToSharePoint.f.registerClass("Common.App.SaveToSharePoint.f",null,Common.App.SaveToSharePoint.l);Common.App.SaveToSharePoint.e.registerClass("Common.App.SaveToSharePoint.e");Common.App.SaveToSharePoint.j.registerClass("Common.App.SaveToSharePoint.j",null,Common.App.SaveToSharePoint.d);Common.App.SaveToSharePoint.g.registerClass("Common.App.SaveToSharePoint.g",null,Common.App.SaveToSharePoint.m);Common.App.SaveToSharePoint.b.a="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}<\/label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> <\/div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}<\/label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}<\/label> <span id='anotherFolder' class='WACDialogSpan'>{3}<\/span> <\/div> <\/div>";Common.App.SaveToSharePoint.n.a();Type.registerNamespace("Common.App.WildFire");Common.App.WildFire.d=function(){this.d=Function.createDelegate(this,this.i)};Common.App.WildFire.d.a=function(){Common.App.a.a().a(new Common.App.WildFire.d,0,!1)};Common.App.WildFire.d.prototype={a:function(){return"Common.App.WildFire"},e:function(n){var i=Common.a.b().a(),t=!1;return n&&(n.v(),n.a&&(t=i.B(n.a,!0))),t},g:function(){var n=Common.a.b().a(),r=n.b(),t=n.o()===1,i=new Common.App.WildFire.c(n.b(),Common.App.WildFire.a.b(),!1,t,null,null);this.e(i)&&Diag.a.a(17571982,306,50,"ChromeExtBannerDisplayed")},f:function(n,t,i,r,u,f,e){var o=new Common.App.WildFire.c(t,r,u,i,f,e);this.e(o)&&Diag.a.a(9208407,306,50,"AppBusinessBarDisplayed")},h:function(){var n=Common.a.b().a(),r=Common.a.a,t=n.b(),u=n.o()===1,e=r.a(Common.App.WildFire.a.o(t)),i,f;if(e&&(i=Common.App.WildFire.a.b(),f=Common.c.w()>8,t!==2||i!==2||!u)){var c=document.body,o=r.a(Common.App.WildFire.a.p(t)),s=n.bd(),l=this,h=function(){return n.t()};o&&!Common.App.WildFire.a.d(Common.App.WildFire.a.c(t))&&this.f(n,t,u,i,f,h,s)}},b:function(){var n=Common.a.a,t=n.a("WildFireChromeExtensionEnabled"),i=n.a("WildFireChromeExtensionBar"),r=i&&t;if(Common.App.WildFire.a.a()&&r&&!Common.App.WildFire.a.d("ChromeExtensionBarDismiss")){this.g();return}document.body&&Common.App.WildFire.a.k()&&this.h();Common.a.c().a(2531463828,2147483648,this.d)},i:function(n,t,i,r,u){if(i===1)return 32;if(!u)return 8;var f=u;return this.f(Common.a.b().a(),f.app,f.mode,f.platform,f.useTwoButton,null,null),32},c:function(){}};Common.App.WildFire.c=function(n,t,i,r,u,f){this.k=Function.createDelegate(this,this.n);this.m=Function.createDelegate(this,this.t);this.l=Function.createDelegate(this,this.s);this.f=n;this.g=t;this.i=u;this.c=r;this.d=f;this.a=null;this.b=i;this.e=Common.App.WildFire.b.b().r(t,n)};Common.App.WildFire.c.a=function(){var n=Common.a.b().a(),s=Common.a.a,t=n.b(),i=n.o()===1,r=Common.App.WildFire.a.b(),u=n.bd(),f=Common.c.w()>8,e=function(){return n.t()},o=new Common.App.WildFire.c(t,r,f,i,e,u);return Diag.a.a(9208407,306,50,"AppBusinessBarDisplayed"),o};Common.App.WildFire.c.prototype={a:null,g:0,f:0,h:null,c:!1,d:null,i:null,b:!1,e:null,v:function(){this.a=new CommonUI.k(this.r(),this.q(),null);this.a.c(this.o(),this.l,"",!1);this.b&&this.a.l(this.p(),this.m,"",!1);this.a.n(this.k);this.a.k(3);this.a.e(16);this.a.d(!0)},r:function(){return this.e.d("Headline")},q:function(){return this.e.d("CallToAction")},o:function(){return this.b?this.e.d("InstallButton"):this.e.d("UseAppButton")},p:function(){return this.b?this.e.d("OpenAppButton"):""},s:function(n){this.b?this.x(n):this.z(n)},t:function(n){this.b&&this.y(n)},j:function(){return this.h||(this.h=this.i()),this.h},x:function(){Diag.a.a(17932829,306,50,"Install App Button of BusinessBar Clicked");this.c&&this.d&&this.d();Common.App.WildFire.a.h(this.f,this.g)},y:function(){this.j()&&(Diag.a.a(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.c&&this.d&&this.d(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(Common.App.WildFire.a.f(this.f),this.j(),0,!1))},z:function(n){Common.App.WildFire.a.a()?this.u(n):(Diag.a.a(17109255,306,50,"AppBusinessBarNav"),Common.App.WildFire.a.e("BizBarClicked"),(this.g===1||this.g===2)&&Common.App.WildFire.a.i(this.j(),this.c,this.f,this.d))},u:function(){this.c?Diag.a.a(17571974,323,50,"ChromeExtBannerClicked"):Diag.a.a(17571975,301,50,"ChromeExtBannerClicked");Common.g.f(Common.a.a.j.g.WildFireChromeExtensionUrl.toString())},w:function(){this.c?Diag.a.a(17571976,323,50,"ChromeExtBannerDismissed"):Diag.a.a(17571977,301,50,"ChromeExtBannerDismissed");Common.App.WildFire.a.e("ChromeExtensionBarDismiss")},n:function(n){Common.App.WildFire.a.a()?this.w(n):(Common.App.WildFire.a.e(Common.App.WildFire.a.c(this.f)),Diag.a.a(17109256,306,50,"AppBusinessBarDismissed"))}};Common.App.WildFire.b=function(){this.d=new(Common.Collections.a.$$(String,String))(null);this.c=new(Common.Collections.a.$$(String,String))(null);this.b=new(Common.Collections.a.$$(String,String))(null);this.k(this.d);this.j(this.c);this.i(this.b);this.h=new(Common.Collections.a.$$(String,String))(null);this.g=new(Common.Collections.a.$$(String,String))(null);this.f=new(Common.Collections.a.$$(String,String))(null);this.o(this.h);this.n(this.g);this.m(this.f);this.e=new(Common.Collections.a.$$(String,String))(null);this.l(this.e);this.a(this.e);this.a(this.b);this.a(this.c);this.a(this.d);this.a(this.g);this.a(this.h);this.a(this.f)};Common.App.WildFire.b.b=function(){return Common.App.WildFire.b.a||(Common.App.WildFire.b.a=new Common.App.WildFire.b),Common.App.WildFire.b.a};Common.App.WildFire.b.prototype={d:null,c:null,b:null,h:null,g:null,f:null,e:null,r:function(n,t){switch(n){case 1:return this.q(t);case 2:return this.p(t)}return Common.App.WildFire.a.a()?this.e:null},k:function(n){n.a("Headline",$a.cG);n.a("UseAppButton",$a.g);n.a("CallToAction",$a.lF)},j:function(n){n.a("Headline",$a.cF);n.a("UseAppButton",$a.g);n.a("CallToAction",$a.lD)},i:function(n){n.a("Headline",$a.cE);n.a("UseAppButton",$a.g);n.a("CallToAction",$a.lB)},o:function(n){n.a("Headline",$a.cG);n.a("UseAppButton",$a.g);n.a("InstallButton",$a.T);n.a("OpenAppButton",$a.U);n.a("CallToAction",$a.lG);n.a("OverlayBig","Get the Word app");n.a("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");n.a("OverlaySmallSplit1","Discover Word");n.a("OverlaySmallSplit2","designed for the iPad.");n.a("SkipButton","Skip for now")},l:function(n){n.a("Headline","Get the Office Online extension for Chrome");n.a("UseAppButton","Get the extension");n.a("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")},n:function(n){n.a("Headline",$a.cF);n.a("UseAppButton",$a.g);n.a("InstallButton",$a.T);n.a("OpenAppButton",$a.U);n.a("CallToAction",$a.lE);n.a("OverlayBig","Get the PowerPoint app");n.a("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");n.a("OverlaySmallSplit1","Discover PowerPoint");n.a("OverlaySmallSplit2","designed for the iPad.");n.a("SkipButton","Skip for now")},m:function(n){n.a("Headline",$a.cE);n.a("UseAppButton",$a.g);n.a("InstallButton",$a.T);n.a("OpenAppButton",$a.U);n.a("CallToAction",$a.lC)},a:function(n){n.a("Corporation","Microsoft Corporation")},q:function(n){switch(n){case 3:return this.h;case 2:return this.g;case 1:return this.f}return null},p:function(n){switch(n){case 3:return this.d;case 2:return this.c;case 1:return this.b}return null}};Common.App.WildFire.a=function(){};Common.App.WildFire.a.g=function(n,t){switch(n){case 3:return Common.App.WildFire.a.q(t);case 2:return Common.App.WildFire.a.n(t);case 1:return Common.App.WildFire.a.l(t)}return""};Common.App.WildFire.a.q=function(n){switch(n){case 1:return Common.a.a.j.g.WildFireAdjustLinkWordWac.toString();case 2:return Common.a.a.j.g.WildFireAdjustLinkWordWac.toString()}return""};Common.App.WildFire.a.n=function(n){switch(n){case 1:return Common.a.a.j.g.WildFireAdjustLinkPptWac.toString();case 2:return Common.a.a.j.g.WildFireAdjustLinkPptWac.toString()}return""};Common.App.WildFire.a.l=function(n){switch(n){case 1:return Common.a.a.j.g.WildFireAdjustLinkExcelWac.toString();case 2:return Common.a.a.j.g.WildFireAdjustLinkExcelWac.toString()}return""};Common.App.WildFire.a.r=function(n,t,i){var r=function(){Common.App.WildFire.a.h(i,Common.App.WildFire.a.b())};(Common.c.c()||Common.c.h())&&(window.setTimeout(r,500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(Common.App.WildFire.a.f(i),n,0,!1))};Common.App.WildFire.a.i=function(n,t,i,r){t&&r&&r();Common.App.WildFire.a.r(n,t,i)};Common.App.WildFire.a.b=function(){return Common.c.c()?1:Common.c.h()?2:Common.c.y()?3:Common.c.e()?4:0};Common.App.WildFire.a.o=function(n){switch(n){case 3:return"WildFireWordBizBar";case 2:return"WildFirePowerPointBizBar";case 1:return"WildFireExcelBizBar";default:return""}};Common.App.WildFire.a.p=function(n){switch(n){case 3:return"WildFireWordBizBarFlight";case 2:return"WildFirePowerPointBizBarFlight";case 1:return"WildFireExcelBizBarFlight";default:return""}};Common.App.WildFire.a.j=function(){return window.navigator.language==="zh-CN"};Common.App.WildFire.a.h=function(n,t){var i,r;if(t===1)Diag.a.a(17151569,306,50,"User Directed to App Store"),i=Common.App.WildFire.a.g(n,t),Common.c.w()>8?Common.g.c(i,null,"",!1,"RedirectToAppStore"):Common.g.f(i);else{if(document.hidden)return;Common.App.WildFire.a.j()?(r=Common.a.a.j.g.WildFireUrlChinaStoreAndroid.toString(),r?(Diag.a.a(18088018,306,50,"User Directed to China Proxy Page"),Common.g.f(r)):Diag.a.a(18088019,306,50,"Empty Url in China Proxy Page BRS Setting")):(Diag.a.a(18088020,306,50,"User Directed to Play Store"),MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(Common.App.WildFire.a.g(n,t),null,null))}};Common.App.WildFire.a.f=function(n){switch(n){case 3:return 5;case 2:return 3;case 1:return 1;default:return 0}};Common.App.WildFire.a.a=function(){return(Common.c.y()||Common.c.e())&&Common.c.f()};Common.App.WildFire.a.k=function(){return Common.c.c()||Common.c.h()};Common.App.WildFire.a.c=function(n){switch(n){case 3:return"WordBizBarDismiss";case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";default:return""}};Common.App.WildFire.a.d=function(n){var t=Common.App.WildFire.a.m(n);return!t||t===""?!1:Boolean.parse(t)};Common.App.WildFire.a.e=function(n){Common.App.WildFire.a.s(n,"true")};Common.App.WildFire.a.m=function(n){try{return localStorage.getItem(n)}catch(t){return Diag.a.a(18416668,306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+t.message),null}};Common.App.WildFire.a.s=function(n,t){try{localStorage.setItem(n,t)}catch(i){Diag.a.a(18416669,306,50,"WildFire LocalStorage SetItem Failed with exception : "+i.message)}};Common.App.WildFire.c.registerClass("Common.App.WildFire.c");Common.App.WildFire.b.a=null;Common.App.WildFire.d.a();Type.registerNamespace("_Ewa");_Ewa.bda=function(){};_Ewa.bda.a=function(){Common.I.a(".HyperlinkDialog .ewa-dlg-body-sectionlabel{margin-bottom:5px}.HyperlinkDialog .disabledInput{background-color:#ebebe4;border:solid 1px #b5b5b5}.HyperlinkDialog .ewa-dlg-body-fullLine{width:inherit;min-width:318px;padding-right:5px;padding-left:25px}.ewa-dlg-elements-container-rtl .HyperlinkDialog .ewa-dlg-body-fullLine{padding-right:25px;padding-left:5px}.HyperlinkDialog input[type=text]{width:100%;outline:none;padding-left:3px;border:solid 1px #ccc}.HyperlinkDialog .ewa-dlg-body-sectionbreak{height:50px;position:relative}.HyperlinkDialog input[type=radio]{position:absolute;left:0}.ewa-dlg-elements-container-rtl .HyperlinkDialog input[type=radio]{left:auto;right:0}.HyperlinkDialog .ewa-dlg-body-sectionlabel label{margin-left:24px}.ewa-dlg-elements-container-rtl .HyperlinkDialog .ewa-dlg-body-sectionlabel label{margin-right:24px;margin-left:auto}.ValidationLabel{position:relative;display:block}.ValidationLabelWarning{color:#cc4200}.ValidationLabelError{color:#d90000}.ValidationWarningGlowColor,.ValidationErrorGlowColor,.ValidationLableGlow{border-style:solid;border-width:1px;-webkit-transition:all .2s ease-in-out;-moz-transition:all .2s ease-in-out;-ms-transition:all .2s ease-in-out;-o-transition:all .2s ease-in-out}.HyperlinkDialog div .ValidationErrorGlowColor{box-shadow:0 0 2px #d90000;border-color:#d90000}.HyperlinkDialog div .ValidationWarningGlowColor{box-shadow:0 0 2px #cc4200;border-color:#cc4200}")};_Ewa.bda.a();Type.registerNamespace("_Ewa");_Ewa.bfL=function(){};_Ewa.bfL.a=function(){Common.I.a(".MsformCalloutContent{color:#fff;font-size:13pt;line-height:1;padding-right:5px;margin-bottom:12px;margin-top:-6px;padding-left:10px;width:90%}.MsFormCalloutOuter{background-color:#107c41;z-index:1030}")};_Ewa.bfL.a();Type.registerNamespace("_Ewa");_Ewa.bgB=function(){};_Ewa.bgB.a=function(){Common.I.a(".eye-icon{float:right;width:-10px;margin-top:-19px;left:-7px;position:relative}.ewa-ppfo-eye{border:solid 1px transparent}.ewa-ppfo-eye:focus{border-color:#86bfa0;background-color:#e9f5ee !important;outline:2px dashed transparent}.usehover .ewa-ppfo-eye:hover{border-color:#86bfa0;background-color:#d3f0e0;outline:2px dashed transparent}@media screen and (-ms-high-contrast:active){.ewa-ppfo-eye{border:solid 1px transparent}.ewa-ppfo-eye:focus,.usehover .ewa-ppfo-eye:hover{-ms-high-contrast-adjust:none;background-color:Highlight !important;color:HighlightText !important;outline-color:inherit !important;fill:HighlightText !important}}input[type='password']::-ms-reveal{display:none}.ewa-ppfo-input{height:18px;position:relative;width:91%;padding-right:28px}.ewa-ppfo-label-div{height:5px}.ewa-ppfo-input-div{height:12px}")};_Ewa.bgB.a();Type.registerNamespace("_Ewa");_Ewa.bgY=function(){};_Ewa.bgY.a=function(){Common.I.a('.PrintDialogBody{height:260px;width:516px;margin-top:17px}.PrintDialogTitle{font-size:21px;margin-top:14px;margin-left:18px;font-family:"Segoe UI Light"}.ewa-dlg-elements-container-rtl .PrintDialogTitle{margin-left:auto;margin-right:18px}.PrintDialogLeftContainer{float:left;width:240px;height:100%;font-size:14px;margin-left:18px}.ewa-dlg-elements-container-rtl .PrintDialogLeftContainer{float:right;margin-left:auto;margin-right:18px}.PrintDialogRightContainer{float:left;font-size:14px;width:240px;height:inherit;margin-left:18px}.ewa-dlg-elements-container-rtl .PrintDialogRightContainer{float:right;margin-left:auto;margin-right:18px}.PrintDialogRadioButtonContainer{width:224px;height:32px;display:flex;align-items:center}.PrintRadioButtonElementInnerDiv{vertical-align:middle;display:table-cell}.PrintRadioButtonElementOuterDiv{position:absolute;top:0;left:64px;height:32px;width:140px;vertical-align:middle;display:table}.ewa-dlg-elements-container-rtl .PrintRadioButtonElementOuterDiv{left:auto;right:64px}.PrintDialogTitleSection{width:224px;height:19px}.PrintDialogComboBoxContainer{width:224px;height:32px;margin-top:12px}.PrintRadioButtonIcon{margin:0 16px;vertical-align:middle}.PrintButtonArea{margin-right:32px}.ewa-dlg-elements-container-rtl .PrintButtonArea{margin-right:auto;margin-left:32px}.PrintPreviewerContainer{height:100%;width:100%;z-index:998;position:absolute;background:#edebe9}')};_Ewa.bgY.a();Type.registerNamespace("_Ewa");_Ewa.bhv=function(){};_Ewa.bhv.a=function(){Common.I.a(".ewa-resizehdr-dlg-input{width:48px;padding-left:3px}.ewa-resizehdr-dlg-err-label{width:260px;min-height:21px;margin-bottom:-15px;font-size:8pt;color:#d90000}.ewa-resizehdr-dlg-radio{margin-top:3px;margin-bottom:3px}.ewa-resizehdr-dlg-radio-label{vertical-align:middle}.ewa-resizehdr-row-hidden{width:inherit;height:0}.ewa-resizehdr-col-hidden{width:0;height:inherit}")};_Ewa.bhv.a();Type.registerNamespace("_Ewa");_Ewa.biz=function(){};_Ewa.biz.a=function(){Common.I.a(".ewa-customsort-dlg-err-msg{min-height:21px;max-width:640px;margin-bottom:-15px;font-size:9pt;color:#a4262c;padding-top:5px;padding-left:5px}.AppRtl .ewa-customsort-dlg-err-msg{padding-left:0;padding-right:5px}.ewa-customsort-dlg-controls{padding-top:10px}.WACButton.ewa-customsort-dlg-icon-and-label-button{border:1px solid transparent;height:24px;vertical-align:middle;padding-left:2px;padding-right:16px}.AppRtl .WACButton.ewa-customsort-dlg-icon-and-label-button{padding-left:16px;padding-right:2px}.WACButton.ewa-customsort-dlg-button{border:none;padding:unset;height:24px;min-width:24px;margin-left:8px;margin-right:2px;vertical-align:middle}.AppRtl .WACButton.ewa-customsort-dlg-button{margin-left:2px;margin-right:8px}.WACButton.ewa-customsort-dlg-button:hover,.WACButton.ewa-customsort-dlg-button:focus{padding:unset}.WACButton.ewa-customsort-dlg-button:hover,.WACButton.ewa-customsort-dlg-icon-and-label-button:hover,.WACButton.ewa-customsort-dlg-button:focus,.WACButton.ewa-customsort-dlg-icon-and-label-button:focus{border:1px solid #217346}.WACButton.ewa-customsort-dlg-button:disabled,.WACButton.ewa-customsort-dlg-icon-and-label-button:disabled{border:none;opacity:.5;background-color:inherit !important}@media screen and (-ms-high-contrast:active){.WACButton.ewa-customsort-dlg-button,.WACButton.ewa-customsort-dlg-button:disabled,.WACButton.ewa-customsort-dlg-icon-and-label-button,.WACButton.ewa-customsort-dlg-icon-and-label-button:disabled{border:1px solid #217346}}.ewa-customsort-dlg-icon-text{vertical-align:text-bottom;margin-left:0;margin-right:5px;-webkit-user-drag:none}.AppRtl .ewa-customsort-dlg-icon-text{margin-left:5px;margin-right:0}.ewa-customsort-dlg-icon{vertical-align:text-bottom}.ewa-customsort-dlg-options-button{display:inline-block;height:24px;margin-left:4px}.AppRtl .ewa-customsort-dlg-options-button{margin-left:0;margin-right:4px}div.ewa-customsort-dlg-options-dropdown-menu{padding:8px}.ewa-customsort-orientation-label{font-weight:bold;margin:8px 0 0}.ewa-customsort-dlg-has-headers-checkbox{display:inline-block;float:right;height:24px;font-size:13px}.AppRtl .ewa-customsort-dlg-has-headers-checkbox{float:left}hr.ewa-customsort-dlg-hr{margin:8px -14px 0 -14px;border:none;height:1.5px;background-color:#e1e1e1}.ewa-customsort-dlg-sort-conditions{padding-top:12px;min-height:60px;min-width:640px}table.ewa-customsort-dlg-table{border-spacing:0}table.ewa-customsort-dlg-table thead tr{display:block;cursor:default;pointer-events:none}table.ewa-customsort-dlg-table tbody{display:block;max-height:calc(4*44px);overflow-y:auto;overflow-x:hidden}table.ewa-customsort-dlg-table tbody tr{height:44px}table.ewa-customsort-dlg-table thead th.ewa-customsort-dlg-level{min-width:60px;padding:0}table.ewa-customsort-dlg-table thead .WACDialogLabel{margin:0 4px 0 4px}table.ewa-customsort-dlg-table tbody th.ewa-customsort-dlg-level{min-width:60px;padding-left:5px;padding-right:10px;white-space:nowrap;cursor:pointer}.AppRtl table.ewa-customsort-dlg-table tbody th.ewa-customsort-dlg-level{padding-left:10px;padding-right:5px}table.ewa-customsort-dlg-table th.ewa-customsort-dlg-column,table.ewa-customsort-dlg-table td.ewa-customsort-dlg-column{width:calc(180px + 12px);padding-left:8px;padding-right:4px}.AppRtl table.ewa-customsort-dlg-table th.ewa-customsort-dlg-column,.AppRtl table.ewa-customsort-dlg-table td.ewa-customsort-dlg-column{padding-left:4px;padding-right:8px}table.ewa-customsort-dlg-table tr{outline:none}table.ewa-customsort-dlg-table td,table.ewa-customsort-dlg-table th{box-sizing:border-box}table.ewa-customsort-dlg-table tr:focus>td.ewa-customsort-dlg-column{border-top:1px solid;border-bottom:1px solid;border-left:1px solid;border-color:#217346}.AppRtl table.ewa-customsort-dlg-table tr:focus>td.ewa-customsort-dlg-column{border-left:unset;border-right:1px solid}table.ewa-customsort-dlg-table th.ewa-customsort-dlg-sorton,table.ewa-customsort-dlg-table td.ewa-customsort-dlg-sorton{width:calc(120px + 8px);padding-left:4px;padding-right:4px}table.ewa-customsort-dlg-table tr:focus>td.ewa-customsort-dlg-sorton{border-top:1px solid;border-bottom:1px solid;border-color:#217346}table.ewa-customsort-dlg-table th.ewa-customsort-dlg-order,table.ewa-customsort-dlg-table td.ewa-customsort-dlg-order{width:calc(248px + 12px);padding-left:4px;padding-right:8px}.AppRtl table.ewa-customsort-dlg-table th.ewa-customsort-dlg-order,.AppRtl table.ewa-customsort-dlg-table td.ewa-customsort-dlg-order{padding-left:8px;padding-right:4px}table.ewa-customsort-dlg-table tr:focus>td.ewa-customsort-dlg-order{border-top:1px solid;border-bottom:1px solid;border-right:1px solid;border-color:#217346}.AppRtl table.ewa-customsort-dlg-table tr:focus>td.ewa-customsort-dlg-order{border-left:1px solid;border-right:unset}table.ewa-customsort-dlg-table td.ewa-customsort-dlg-color-or-icon{width:128px;padding-left:4px;padding-right:4px;position:relative}table.ewa-customsort-dlg-table tr:focus>td.ewa-customsort-dlg-color-or-icon{border-top:1px solid;border-bottom:1px solid;border-color:#217346}table.ewa-customsort-dlg-table td .color-or-icon-combobox{pointer-events:none}table.ewa-customsort-dlg-table td .selected-color-or-icon{position:absolute;width:100px;height:32px;top:6px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}table.ewa-customsort-dlg-table tr:focus>td.ewa-customsort-dlg-color-or-icon .selected-color-or-icon{top:5px}.selected-color-or-icon .selected-icon{position:absolute;left:42px;top:8px}table.ewa-customsort-dlg-table td .color-or-icon-flyout-anchor{position:absolute;width:120px;height:32px;top:6px}table.ewa-customsort-dlg-table td.ewa-customsort-dlg-color-or-icon-order{width:calc(120px + 12px);padding-left:4px;padding-right:8px}.AppRtl table.ewa-customsort-dlg-table td.ewa-customsort-dlg-color-or-icon-order{padding-left:8px;padding-right:4px}table.ewa-customsort-dlg-table tr:focus>td.ewa-customsort-dlg-color-or-icon-order{border-top:1px solid;border-bottom:1px solid;border-right:1px solid;border-color:#217346}.AppRtl table.ewa-customsort-dlg-table tr:focus>td.ewa-customsort-dlg-color-or-icon-order{border-left:1px solid;border-right:unset}table.ewa-customsort-dlg-table th{font-size:10pt;font-weight:normal}table.ewa-customsort-dlg-table td{background-color:#f3f3f3}table.ewa-customsort-dlg-table tr:hover>td{background-color:#e8e8e8}table.ewa-customsort-dlg-table tr.ewa-customsort-dlg-selected>td{background-color:#d3f0e0;border-collapse:collapse}table.ewa-customsort-dlg-table tr.ewa-customsort-dlg-selected>td.ewa-customsort-dlg-column{border-top:1px solid;border-bottom:1px solid;border-left:1px solid;border-color:#217346}table.ewa-customsort-dlg-table tr.ewa-customsort-dlg-selected>td.ewa-customsort-dlg-sorton{border-top:1px solid;border-bottom:1px solid;border-color:#217346}table.ewa-customsort-dlg-table tr.ewa-customsort-dlg-selected>td.ewa-customsort-dlg-order{border-top:1px solid;border-bottom:1px solid;border-right:1px solid;border-color:#217346}table.ewa-customsort-dlg-table tr.ewa-customsort-dlg-selected>td.ewa-customsort-dlg-color-or-icon-order{border-top:1px solid;border-bottom:1px solid;border-right:1px solid;border-color:#217346}table.ewa-customsort-dlg-table tr.ewa-customsort-dlg-selected>td.ewa-customsort-dlg-color-or-icon{border-top:1px solid;border-bottom:1px solid;border-color:#217346}table.ewa-customsort-dlg-table tr.ewa-customsort-dlg-selected:hover>td{background-color:#c0ead3}.ewa-dlg-list-error,.ewa-dlg-list-error:focus{border-color:#a4262c !important}.ewa-dlg-list.ewa-customsort-dlg-list{height:32px;margin:0}.ewa-dlg-list.ewa-customsort-dlg-list:disabled{opacity:.8;pointer-events:none}.ewa-customsort-dlg-disc-msg{margin:0 -14px 0 -14px;border:none;background-color:#e1e1e1;padding-bottom:2px}.ewa-customsort-dlg-disc-msg-label{width:640px;display:inline-block;font-size:9pt;padding-left:20px}.AppRtl .ewa-customsort-dlg-disc-msg-label{padding-right:20px;padding-left:0}")};_Ewa.biz.a();Type.registerNamespace("_Ewa");_Ewa.Zd=function(){};_Ewa.Zd.a=function(){Common.I.a(".ewa-bb{padding:0;display:block;background-color:#fcf7b6;color:#444;position:relative;overflow:hidden;cursor:default}.ewa-bb.region-composer{flex:auto}.ewa-bb-entry{position:relative;height:auto;border-bottom:1px solid #d7d889;overflow:hidden}.ewa-bb-entry:first-child{border-top:1px solid #d7d889}.ewa-bb-entry-body{min-height:24px;position:relative}.ewa-bb-icon{vertical-align:middle;display:inline-block}.ewa-bb-entry-icon{margin:2px 6px 0;display:inline-block}.ewa-bb-entry-title{font-weight:bold}.ewa-bb-entry-message{padding:0 8px}.ewa-bb-entry-button{background-color:#fff;border:1px solid #ababab;color:#444;text-align:center;cursor:default;margin-bottom:1px;padding:3px 10px 4px}.ewa-bb-entry-button:hover{background:#f0f0f0}.ewa-bb-entry-button:active{background:#c6c6c6}.ewa-bb-entry-link{color:#369}.ewa-bb-entry-close{position:absolute;top:50%;margin-top:-8px;cursor:pointer}.ewa-bb-entry-close .clip16x16{display:inline-block}.ewa-bb-entry-title,.ewa-bb-entry-message,.ewa-bb-entry-button-holder,.ewa-bb-entry-link{vertical-align:middle}.ewa-root-ltr .ewa-bb-entry-close,.ewa-nov2-ltr .ewa-bb-entry-close{right:2px}.ewa-root-ltr .ewa-bb-content,.ewa-nov2-ltr .ewa-bb-content{margin-right:26px}.ewa-root-ltr .ewa-bb-entry-button-holder,.ewa-nov2-ltr .ewa-bb-button-holder,.ewa-root-ltr .ewa-bb-entry-link,.ewa-nov2-ltr .ewa-bb-entry-link{margin-left:8px}.ewa-root-rtl .ewa-bb-entry-close,.ewa-nov2-rtl .ewa-bb-entry-close{left:2px}.ewa-root-rtl .ewa-bb-content,.ewa-nov2-rtl .ewa-bb-content{margin-left:26px}.ewa-root-rtl .ewa-bb-entry-button-holder,.ewa-nov2-rtl .ewa-bb-button-holder,.ewa-root-rtl .ewa-bb-entry-link,.ewa-nov2-rtl .ewa-bb-entry-link{margin-right:8px}")};_Ewa.Zd.a();Type.registerNamespace("Common.App.OpenInClient");Common.App.OpenInClient.u=function(){};Common.App.OpenInClient.q=function(n,t,i,r){this.p=Function.createDelegate(this,this.w);this.o=Function.createDelegate(this,this.v);this.l=Function.createDelegate(this,this.u);this.k=Function.createDelegate(this,this.t);this.i=r;this.e=n;this.c=t;this.d=i;this.f=this.r().a();var u=$a.fW.split("{0}");this.h=u[0];this.g=u[1]};Common.App.OpenInClient.q.prototype={i:0,c:null,e:null,d:null,f:!1,m:null,r:function(){return this.m||(this.m=Common.Utils.a.a().a(Common.ez,null))},h:null,g:null,q:function(){return this.f?3:2},j:function(){return!!this.c},w:function(n){this.s(n)},v:function(n){this.s(n)},s:function(n){var t=10;this.c&&n===1&&(this.c(this.d),t=1);this.e&&this.e(this.d);this.n(t)},t:function(){Common.bw.b("OICFailure");this.n(2)},u:function(){this.r().b(null);this.n(4)},n:function(n){Diag.a.a(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",this.i,n);Common.a.cR(4,this.i,n,null)},dispose:function(){this.c=null;this.e=null;this.d=null}};Common.App.OpenInClient.r=function(n,t,i){this.h=Function.createDelegate(this,this.m);this.g=Function.createDelegate(this,this.l);this.e=Function.createDelegate(this,this.j);this.c=t;this.d=n;this.b=i};Common.App.OpenInClient.r.prototype={c:null,d:null,b:null,f:function(){return"OICErrorDialogWithDownload"},m:function(n){this.i(n)},l:function(n){this.i(n)},i:function(n){var t=10;n===1&&(this.d(this.b),t=1);this.c&&this.c(this.b);this.k(t)},j:function(){Common.bw.b("OICFailure");this.k(2)},k:function(n){Common.a.cR(14,3,n,null)},dispose:function(){this.c=null;this.d=null;this.b=null}};Common.App.OpenInClient.s=function(n,t,i,r,u,f){this.i=Function.createDelegate(this,this.o);this.h=Function.createDelegate(this,this.n);this.b=n;this.c=t;this.e=i;this.a=r;this.f=u;this.d=f};Common.App.OpenInClient.s.prototype={b:null,c:null,a:null,e:null,d:0,f:0,l:function(){return!this.c&&!this.e},k:function(){return this.d===2?$a.fV:$a.fU},g:function(){return"OICErrorDialogWithTrial"},j:function(){return this.d===2?$a.fT:$a.fS},o:function(n){this.m(n)},n:function(n){this.m(n)},m:function(n){var t=10,i;n===1?(i=Common.Utils.a.a().a(Common.dV,null),i.b(this.d),t=3):n===2&&((!this.e||this.e(this.a))&&this.c&&Common.App.OpenInClient.b.b().b(this.c,this.b,this.a),t=5);n&&n!==1||this.b&&this.b(this.a);Common.a.cR(9,this.f,t,null);this.dispose()},dispose:function(){this.b=null;this.c=null;this.a=null}};Common.App.OpenInClient.t=function(n){this.bd=Function.createDelegate(this,this.bx);this.Q=Function.createDelegate(this,this.bF);this.N=Function.createDelegate(this,this.bC);this.M=Function.createDelegate(this,this.bB);this.O=Function.createDelegate(this,this.bD);this.P=Function.createDelegate(this,this.bE);this.be=Function.createDelegate(this,this.bH);this.Y=n&&Common.a.a.a("OICLaunchDialogIsEnabled");var t=Common.a.c().h[1596290176];t||Common.a.c().a(1596290176,2147483648,this.be);this.J=!!Common.a.a&&Common.a.a.a("SilentExternalHandler")};Common.App.OpenInClient.t.prototype={u:null,R:null,s:null,x:!1,S:null,t:0,J:!1,bH:function(n,t,i){return t.a()!==2147483648?2:i===1?32:this.bG()},V:function(){var n=0;return Common.a.cy&&(n|=1),Common.a.ed&&(n|=4),this.bJ()&&(n|=64),n},bJ:function(){return!(this.A===2&&Common.a.a.a("IsEmbeddedScenario"))},A:0,K:!1,bq:!1,Y:!1,B:function(){return Common.a.r},C:function(){return Common.a.bC},bj:function(){return""},U:function(){return""},bk:function(){return Common.a.a.a("OneNoteMobileViewerIsEnabled")},r:function(){return!1},I:function(){return this.S||(this.S=Common.Utils.a.a().a(Common.dV,null))},T:function(){this.K||this.bh()},y:function(){this.bq||this.bi()},bn:function(n){return this.Y&&Common.c.c()?(new Common.App.OpenInClient.j(this),32):this.H(n)},H:function(n){var t,i,r,u=(r=this.bz(n,i={val:t}),t=i.val,r);return Diag.a.a(34198736,211,50,"OICLaunchClient,{0},{1}",u===32,t),u},v:function(n,t,i,r,u,f){return this.u=n,this.R=t,this.s=f,this.A=i,this.t=r,Common.a.dS?(this.X(),32):Common.a.D&&!Common.a.dY?(Common.a.fT(),8):this.bf(u)},bG:function(){return this.H(this.x)},bp:function(){var n=new Common.cT("UI_OpenInClient");return n.Values["ui-language"]=Common.a.o.toString(),n.Values.wdUserSession=Common.a.k,this.s.a().f(n,null)?32:8},bI:function(n){var t=new Common.cT("Wac_ActionComplete");t.Values["ui-language"]=Common.a.o.toString();t.Values.wdUserSession=Common.a.k;t.Values.Action=n;this.s.a().f(t,null)},bz:function(n,t){return(this.x=n,this.bI(this.t===5?"OpenInBrowser":"OpenInDesktop"),this.t===5)?this.by(t):this.bA(t)},by:function(n){return n.val="",this.bm(),n.val+="HostEditUrl,",32},bA:function(n){var t,u,i,r;return n.val="",t="",Common.a.dI&&(t="|f|"+Common.a.k),u=Common.a.a.a("IsAssignmentMode")&&Common.a.a.a("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||Common.c.D(),Common.a.ef?(n.val+="NewOrder,",i=8,this.s&&this.s.a()&&this.s.a().d()&&Common.a.cW&&(n.val+="Post,",i=this.bp()),i===32)?i:(Diag.a.a(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),Common.a.l.b())?(Diag.a.b(5566816,211,!!Common.a.l.b(),null),n.val+="HostUrl,",Common.a.b().E(!0,Common.a.l.b(),!1)):this.u?(Diag.a.a(18715405,211,15,"Try to open doc in rich client, SessionId {0}",Common.a.k),n.val+="DocUrl,",Common.el.a(this.u,this.t,this.V(),this.A,this.P,this.O,this.J,Common.a.a.a("OICEncodeUrlIsEnabled"),t,u),32):8:(n.val+="OldOrder,",!this.u&&Common.a.l.b()?(this.s&&this.s.a()&&this.s.a().d()&&Common.a.cW?(n.val+="Post,",r=this.bp()):(Diag.a.a(22595483,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),r=8),r!==32?(Diag.a.b(22595484,211,!!Common.a.l.b(),null),n.val+="HostUrl,",Common.a.b().E(!0,Common.a.l.b(),!1)):r):(Diag.a.a(22595485,211,15,"Try to open doc in rich client, SessionId {0}",Common.a.k),n.val+="DocUrl,",Common.el.a(this.u,this.t,this.V(),this.A,this.P,this.O,this.J,Common.a.a.a("OICEncodeUrlIsEnabled"),t,u),32))},bo:function(n){Common.a.m.a(8981,n)},bE:function(n){this.bo(n);Diag.a.a(18715406,211,50,"Open in rich client succeed");n===6&&MSOJS.ClientUtils.ShouldShowDialog()?this.bk()||this.bm():this.K||this.T()},bD:function(n,t){if(Diag.a.a(18715407,211,10,"Fail to open doc in rich client. Failure Type: {0}, Application: {1}",n,t),n===5)alert($a.fX);else{var r=!!this.R&&!this.x,i=0;n===1&&(i=2);n===2&&(i=1,t===1&&(this.K=!0));this.I().c()?(Diag.a.a(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",i),Common.App.OpenInClient.b.b().c(this.x?this.M:this.N,r?this.Q:null,this.bg(!1)?this.bd:null,null,i,t)):(Diag.a.a(18715409,211,50,"Open OICErrorDialog. Dialog cause: {0}",i),Common.App.OpenInClient.b.b().a(this.x?this.M:this.N,r?this.Q:null,null,i))}},bm:function(){Common.a.b()&&Common.a.b().a().f()&&Common.a.a.a("StandardProtocolDialogIsEnabled")&&!this.r()?new Common.App.OpenInClient.p(this):new Common.App.OpenInClient.l(this)},bB:function(){this.T()},bC:function(){this.y()},bF:function(){this.X()},bx:function(){return this.bg(!0)},bg:function(n){var t=(Common.c.j()||Common.c.m())&&!!Common.a.bZ;return t&&n&&(Common.g.c(Common.a.bZ,"_blank","",!1,"OpenInClient"),this.T()),t}};Common.App.OpenInClient.a=function(){};Common.App.OpenInClient.a.a=function(n){for(var t,i=0;i<n.children.length;i++)t=n.children[i],t.style.position="relative",t.style.top=(t.parentNode.offsetHeight-t.offsetHeight)/2+"px"};Common.App.OpenInClient.a.c=function(n){return n.a.keyCode===13||n.a.keyCode===32?(n.c.click(),!0):!1};Common.App.OpenInClient.a.b=function(n,t,i,r,u,f,e){var o=document.createElement("a"),s;return o.className="ProtocolLaunchingDialogButtonAnchor",o.className+=" OICDialog",o.id=n,o.setAttribute("role","button"),o.style.padding="0",o.style.margin="0",r&&Common.App.OpenInClient.a.d(u,t,i,r,o),s=document.createElement("span"),s.className="ProtocolLaunchingDialogButtonLabel",s.innerText=u,o.appendChild(s),o.tabIndex=0,f&&Common.i.a().a("click",o,f),e&&Common.h.a().a("keyup",o,e),o};Common.App.OpenInClient.a.d=function(n,t,i,r,u){var f=document.createElement("img"),e,o;f.alt=n;f.className=Common.D.d(i,r);f.src=t;f.setAttribute("role","presentation");e=document.createElement("span");e.className="ProtocolLaunchingDialogImg32Container";e.appendChild(f);o=document.createElement("span");o.className="ProtocolLaunchingDialogIconContainer";o.appendChild(e);u.appendChild(o)};Common.App.OpenInClient.g=function(n,t,i,r){var u,f,e,o,s;Common.App.OpenInClient.g.initializeBase(this,[n,t,i,r]);u=document.createElement("span");u.id="errorMessageText";u.innerText=$a.bC;!0&&(u.appendChild(document.createElement("br")),u.appendChild(document.createElement("br")),this.a=document.createElement("a"),this.a.href="#",this.a.innerText=$a.f,u.appendChild(this.a),Common.j.a(this.a,"click",this.k));f=new CommonUI.d;f.k="OICErrorDialog";this.f?(e=document.createElement("span"),o=document.createElement("span"),e.innerText=this.h,o.innerText=this.g,this.b=document.createElement("a"),this.b.href="#",this.b.innerText=$a.bB,u.appendChild(document.createElement("br")),u.appendChild(e),u.appendChild(this.b),u.appendChild(o),Common.j.a(this.b,"click",this.l)):this.j()&&(u.appendChild(document.createElement("br")),u.appendChild(document.createElement("br")),s=document.createElement("span"),s.innerText=$a.s,u.appendChild(s));this.j()?(f.g(1),f.h(1,$a.t)):f.g(0);f.c($a.a,null,this.q(),this.o,u);f.K("errorMessageText")};Common.App.OpenInClient.g.prototype={a:null,b:null,dispose:function(){this.a&&(Common.j.c(this.a,"click",this.k),this.a=null);this.b&&(Common.j.c(this.b,"click",this.l),this.b=null);Common.App.OpenInClient.q.prototype.dispose.call(this)}};Common.App.OpenInClient.b=function(){this.d=!!Common.a.b()&&Common.a.b().a().f()};Common.App.OpenInClient.b.b=function(){return Common.App.OpenInClient.b.a||(Common.App.OpenInClient.b.a=new Common.App.OpenInClient.b)};Common.App.OpenInClient.b.prototype={d:!1,a:function(n,t,i,r){return this.d?new Common.App.OpenInClient.m(n,t,i,r):new Common.App.OpenInClient.g(n,t,i,r)},b:function(n,t,i){return this.d?new Common.App.OpenInClient.n(n,t,i):new Common.App.OpenInClient.h(n,t,i)},c:function(n,t,i,r,u,f){return this.d?new Common.App.OpenInClient.o(n,t,i,r,u,f):new Common.App.OpenInClient.i(n,t,i,r,u,f)}};Common.App.OpenInClient.h=function(n,t,i){var r,f,u;Common.App.OpenInClient.h.initializeBase(this,[n,t,i]);r=document.createElement("span");r.id="errorMessageText";r.innerText=$a.bE;!0&&(r.appendChild(document.createElement("br")),r.appendChild(document.createElement("br")),this.a=document.createElement("a"),this.a.href="#",this.a.innerText=$a.f,r.appendChild(this.a),Common.j.a(this.a,"click",this.e));r.appendChild(document.createElement("br"));r.appendChild(document.createElement("br"));f=document.createElement("span");f.innerText=$a.s;r.appendChild(f);u=new CommonUI.d;u.k=this.f();u.g(1);u.h(1,$a.t);u.c($a.a,null,2,this.g,r);u.K("errorMessageText")};Common.App.OpenInClient.h.prototype={a:null,dispose:function(){this.a&&(Common.j.c(this.a,"click",this.e),this.a=null);Common.App.OpenInClient.r.prototype.dispose.call(this)}};Common.App.OpenInClient.i=function(n,t,i,r,u,f){var o,s,e;Common.App.OpenInClient.i.initializeBase(this,[n,t,i,r,u,f]);o=document.createElement("span");o.innerText=$a.bD;o.appendChild(document.createElement("br"));o.appendChild(document.createElement("br"));s=document.createElement("span");s.innerText=this.k();o.appendChild(s);e=new CommonUI.d;this.l()?(e.g(1),e.eP($a.f,"OICFailure",null)):(e.g(4),e.h(2,$a.bA));e.h(1,this.j());e.k=this.g();e.c($a.a,null,3,this.h,o)};Common.App.OpenInClient.j=function(n){this.d=Function.createDelegate(this,this.bc);this.e=Function.createDelegate(this,this.bd);this.Y=Function.createDelegate(this,this.Z);Common.App.OpenInClient.j.initializeBase(this,[!1,!1,!1,!1]);this.a=n;this.p=Common.App.OpenInClient.e.b();this.ce=!0;this.g(5);this.k="OICLaunchDialog";this.bf("",this.Y);this.eC("ProtocolLaunchingDialogTitle");this.K("ProtocolLaunchingDialogTitle");Common.a.b().a().k()!==4&&(document.getElementById("ProtocolLaunchingDialogTitle").innerText=$a.fZ);this.G(this.b);Diag.a.a(22140865,211,50,"OIC launch dialog opened");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"};Common.App.OpenInClient.j.prototype={a:null,b:null,c:null,R:!1,bM:function(){this.b=Common.App.OpenInClient.a.b("BtnRichClient",this.a.B(),this.a.C(),this.a.U(),$a.ga,this.e,Common.App.OpenInClient.a.c);document.getElementById("OICLaunchRichClient").appendChild(this.b);Common.App.OpenInClient.a.a(this.b);this.c=Common.App.OpenInClient.a.b("BtnReturn",this.a.B(),this.a.C(),this.a.bj(),$a.bG,this.d,Common.App.OpenInClient.a.c);document.getElementById("OICReturnToApp").appendChild(this.c);Common.App.OpenInClient.a.a(this.c)},bc:function(){return this.i(),this.a.r()||this.a.y(),!0},bd:function(){return Diag.a.a(22140866,211,50,"OIC dialog: launch rich client"),this.i(),Common.a.c().d(1596290176,2,null),!0},Z:function(){this.a.r()||this.a.y()},dispose:function(){this.R||(this.b&&(Common.i.a().b("click",this.b,this.e),Common.h.a().b("keyup",this.b,Common.App.OpenInClient.a.c)),this.c&&(Common.i.a().b("click",this.c,this.d),Common.h.a().b("keyup",this.c,Common.App.OpenInClient.a.c)),CommonUI.b.prototype.dispose.call(this),this.R=!0)}};Common.App.OpenInClient.k=function(){};Common.App.OpenInClient.k.prototype={c:function(n){var i=this,t;n.b(Common.App.OpenInClient.d,null).c(Common.dV,null).a().b(function(){return new Common.App.OpenInClient.d(Common.a.c(),Common.a.bI,Common.a.o)});t=this;n.b(Common.App.OpenInClient.c,null).c(Common.ez,null).a().b(function(){return new Common.App.OpenInClient.c(Common.a.c(),Common.a.cf,Common.a.o)})}};Common.App.OpenInClient.l=function(n){var t,i;this.bd=Function.createDelegate(this,this.bH);this.bc=Function.createDelegate(this,this.bG);this.R=Function.createDelegate(this,this.bv);this.e=Function.createDelegate(this,this.bu);this.Z=Function.createDelegate(this,this.bF);this.Y=Function.createDelegate(this,this.bw);this.bq=Function.createDelegate(this,this.bI);Common.App.OpenInClient.l.initializeBase(this,[!1,!1,!1,!1]);this.a=n;this.p=Common.App.OpenInClient.f.b();this.ce=!0;this.g(5);this.k="ProtocolLaunchingDialog";this.cz="OICRetryDialog";Common.a.i().e()&&Common.a.i().f();this.a.r()?(i=this,Common.a.i().a(new Common.U(2,1,5e3,function(){i.bt()},0,null,!1,0))):(t=this,Common.a.i().a(new Common.U(2,1,5e3,function(){t.bJ()},101,null,!1,0)));this.bf("",this.bq);this.eC("ProtocolLaunchingDialogTitle");this.K("Issues");this.br();Diag.a.a(19239262,211,50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"};Common.App.OpenInClient.l.prototype={a:null,b:null,d:null,be:!1,c:null,bM:function(){var n=document.getElementById("Issues"),t,u,i,r;n&&(Common.App.OpenInClient.a.d("",this.a.B(),this.a.C(),this.a.U(),n),t=document.createElement("span"),t.className="WACDialogSectionTitle",t.innerText=this.a.t===5?$a.by:$a.fO,n.appendChild(t),Common.App.OpenInClient.a.a(n),n.style.display="none");Common.a.b().a().D()?(u=$a.fN,this.d=Common.App.OpenInClient.a.b("GiveFeedback",this.a.B(),this.a.C(),"",u,this.Y,this.Z),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.d),Common.App.OpenInClient.a.a(this.d)):document.getElementById("ButtonGiveFeedback").style.display="none";Common.a.b().a().k()&&!Common.a.gm()?(i=null,i=Common.a.b().a().b()===2?Common.a.b().a().k()===4?$a.bF:$a.bG:this.a.r()?$a.p:Common.a.b().a().k()===4?$a.bF:$a.fJ,this.b=Common.App.OpenInClient.a.b("Edit",this.a.B(),this.a.C(),"",i,this.e,this.R),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.b),Common.App.OpenInClient.a.a(this.b),this.a.r()&&(document.getElementById("Buttons").style.textAlign="right",document.getElementById("Edit").style.textAlign="center",r=document.getElementById(this.n+"WACDialogButtonPanel"),r&&(r.style.display="none",this.g(5)))):document.getElementById("ButtonEdit").style.display="none";Common.a.b().a().k()||Common.a.bI||n&&(n.style.display="none")},bs:function(){return this.c?(this.G(this.c),!0):!1},br:function(){return this.b?(this.G(this.b),!0):!1},bv:function(n){return this.bp(n,0)},bF:function(n){return this.bp(n,2)},bH:function(n){return this.bp(n,1)},bp:function(n,t){var i=!1;if(n.a.keyCode===13||n.a.keyCode===32)n.c.click(),i=!0;else if(n.a.keyCode===40||n.a.keyCode===38)switch(t){case 1:i=this.br();break;case 0:i=this.bs()}return i},bu:function(){return this.i(),Common.a.b().a().k()===4?this.a.r()||(Diag.a.a(18715411,211,50,"Restart the App and continue editing"),this.a.y()):(Diag.a.a(18715412,211,50,"Switch to edit doc in browser"),this.a.W()),!0},bw:function(){return Diag.a.a(37339423,211,50,"Open give feedback dialog"),this.a.bl(),!0},bG:function(){return Diag.a.a(19239263,211,50,"OIC dialog retry"),document.getElementById("WACDialogPanel").style.display="none",Common.a.c().d(1596290176,2,null),!0},bI:function(){this.a.r()||this.a.y()},bJ:function(){var r=document.getElementById("ProtocolLaunchingDialogTitle"),t,n,i;r&&(r.innerText=this.a.r()?"":$a.bz,t=document.getElementById("Issues"),t&&(t.style.display="block"),this.a.r()?(i=document.getElementById("ButtonRetryOIC"),i&&(i.style.display="none")):(n=document.getElementById("ProtocolHandlerDialogRetryOIC"),n&&!n.children.length&&(this.c=Common.App.OpenInClient.a.b("RetryOIC","","","",$a.fM,this.bc,this.bd),n.appendChild(this.c),Common.App.OpenInClient.a.a(this.c),this.b||this.bs())))},bt:function(){var n=document.getElementById("ProtocolLaunchingDialogTitle");n&&(Diag.a.a(50857158,211,50,"OIC dialog auto hidden after client launched"),this.i())},dispose:function(){this.be||(this.b&&(Common.i.a().b("click",this.b,this.e),Common.h.a().b("keyup",this.b,this.R)),this.d&&(Common.i.a().b("click",this.d,this.Y),Common.h.a().b("keyup",this.d,this.Z)),this.c&&(Common.i.a().b("click",this.c,this.bc),Common.h.a().b("keyup",this.c,this.bd)),CommonUI.b.prototype.dispose.call(this),this.be=!0)}};Common.App.OpenInClient.c=function(n,t,i){this.e=Function.createDelegate(this,this.k);this.g=Function.createDelegate(this,this.j);this.d=n;this.f=t;this.h=i};Common.App.OpenInClient.c.a=function(){return Common.k.b("522401")};Common.App.OpenInClient.c.prototype={d:null,f:!1,h:0,c:function(){this.d.a(3901198658,2147483648,this.g);this.d.a(201621520,2147483648,this.e);this.d.a(1391456747,2147483648,this.e)},j:function(n,t,i,r,u){if(i===1)return 32;if(u){var e=u,f=e.SourceControlId;f==="btnjTryMacOfficeForWordEditor"?Common.g.c(Common.k.f(12),"_blank","",!1,"MacOfficeOffer.TriggerFromWordEditor"):f==="PptJewel.About.TryMacOffice"&&Common.g.c(Common.k.f(22),"_blank","",!1,"MacOfficeOffer.TriggerFromPPTEditor")}else this.b(null);return 32},k:function(n,t,i){if(i===1)return 32;switch(n){case 201621520:Common.g.c(Common.k.f(15),"_blank","",!1,"MacOfficeOffer.TriggerFromWordViewer");break;case 1391456747:Common.g.c(Common.k.f(25),"_blank","",!1,"MacOfficeOffer.TriggerFromPPTViewer")}return 32},b:function(n){var t=0,i;n&&(t=n);i=t===2?"https://go.microsoft.com/fwlink/?LinkId=331579":Common.App.OpenInClient.c.a();Common.g.c(i,"_blank","",!1,"LaunchMacTrialWindow")},i:function(){return this.f&&Common.c.e()&&!Common.c.bA()&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()},a:function(){return this.i()}};Common.App.OpenInClient.d=function(n,t,i){this.f=Function.createDelegate(this,this.o);this.i=Function.createDelegate(this,this.n);this.h=Function.createDelegate(this,this.m);this.e=n;this.g=t;this.j=i};Common.App.OpenInClient.d.a=function(n){if(Common.c.c())switch(n){case 1:return Common.k.b("393806");case 2:return Common.k.b("393810");case 3:return Common.k.b("393809");case 5:return Common.k.b("393805")}else if(Common.c.h())switch(n){case 1:return Common.k.b("521979");case 3:return Common.k.b("521980");case 5:return Common.k.b("521978");case 2:return Common.k.b("522490")}else{if(n===2)return Common.k.b("517778");if(n===1)return Common.k.f(30)}return Common.k.b("522402")};Common.App.OpenInClient.d.prototype={e:null,g:!1,j:0,d:function(){this.e.a(1773624819,2147483648,this.h);this.e.a(215809929,2147483648,this.i);this.e.a(2578423837,2147483648,this.f);this.e.a(4268365028,2147483648,this.f)},m:function(n,t,i,r,u){if(i===2)if(u){var e=u,f=e.SourceControlId;f==="btnjTryOfficeForWordEditor"?Common.g.c(Common.k.f(11),"_blank","",!1,"OfficeTrial.TriggerFromWordEditor"):f==="PptJewel.About.TryOffice"?Common.g.c(Common.k.f(21),"_blank","",!1,"OfficeTrial.TriggerFromPPTViewer"):this.b(null)}else this.b(null);return 32},n:function(n,t,i,r,u){if(i===2)if(u){var f=u,e=f.SourceControlId;Common.g.c(Common.k.b("862405")+this.l(e),"_blank","",!1,"TryOfficeThroughTellMe.WithSourceControlId")}else Common.g.c(Common.k.b("522402"),"_blank","",!1,"TryOfficeThroughTellMe.Legacy");return 32},o:function(n,t,i){if(i===2)switch(n){case 2578423837:Common.g.c(Common.k.f(14),"_blank","",!1,"TryOfficeThroughViewer.Word");break;case 4268365028:Common.g.c(Common.k.f(24),"_blank","",!1,"TryOfficeThroughViewer.PPT")}return 32},a:function(){return this.k()},c:function(){return this.k()&&MSOJS.ClientUtils.OfferOfficeInDialog()},k:function(){return this.g&&!Common.c.e()},b:function(n){var t=0;n&&(t=n);Common.g.c(Common.App.OpenInClient.d.a(t),"_blank","",!1,"LaunchOfficeOffer")},l:function(n){var t=0;switch(n){case"jbtnTryOfficeThroughTellMeForWordTrackChanges":t=1;break;case"jbtnTryOfficeThroughTellMeForWordShapes":t=2;break;case"jbtnTryOfficeThroughTellMeForWordLabel":t=3;break;case"jbtnTryOfficeThroughTellMeForWordCitations":t=4;break;case"jbtnTryOfficeThroughTellMeForWordTextBox":t=5;break;case"jbtnTryOfficeThroughTellMeForWordTableOfContent":t=6;break;case"jbtnTryOfficeThroughTellMeForWordSmartArt":t=7;break;case"jbtnTryOfficeThroughTellMeForWordWordArt":t=8;break;case"jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":t=9;break;case"jbtnTryOfficeThroughTellMeForWordEquation":t=10;break;case"jbtnTryOfficeThroughTellMeForPPTGroupShapes":t=16;break;case"jbtnTryOfficeThroughTellMeForPPTWordArt":t=17;break;case"jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":t=18;break;case"jbtnTryOfficeThroughTellMeForPPTInsertAudio":t=19;break;case"jbtnTryOfficeThroughTellMeForPPTInsertChart":t=20;break;case"TellMe.TryOfficeThroughTellMeForXLSSpellCheck":t=26;break;case"TellMe.TryOfficeThroughTellMeForXLSMacros":t=27;break;case"TellMe.TryOfficeThroughTellMeForXLSPivotTable":t=28;break;case"TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":t=29}return t?String.format("&pc={0:D}",t):""}};Common.App.OpenInClient.m=function(n,t,i,r){var u,e,o,s,h,f,c;Common.App.OpenInClient.m.initializeBase(this,[n,t,i,r]);u={errorMessage:$a.bC};!0&&(e=this,o=function(n){e.t(n)},u.helpLink={type:"AppLinkProps",id:"helpLink",text:$a.f,handler:o});this.f?(u.macOfficePreLinkText=this.h,s=this,h=function(n){s.u(n)},u.macOfficeLink={type:"AppLinkProps",id:"macOfficeLink",text:$a.bB,handler:h},u.macOfficePostText=this.g):this.j()&&(u.errorFileDownloadOffer=$a.s);f=new CommonUI.b(!1,!1,!0,!1);this.j()?(f.g(1),f.h(1,$a.t)):f.g(0);f.k="OICErrorDialog";c={id:"OICErrorDialog",dialogIcon:this.q(),bodyControls:u};f.j($a.a,this.p,c)};Common.App.OpenInClient.n=function(n,t,i){var u,f,e,r,o;Common.App.OpenInClient.n.initializeBase(this,[n,t,i]);u={errorMessage:$a.bE,errorFileDownloadOffer:$a.s};!0&&(f=this,e=function(n){f.j(n)},u.helpLink={type:"AppLinkProps",id:"helpLink",text:$a.f,handler:e});r=new CommonUI.b(!1,!1,!0,!1);r.g(1);r.h(1,$a.t);r.k=this.f();o={id:this.f(),dialogIcon:2,bodyControls:u};r.j($a.a,this.h,o)};Common.App.OpenInClient.o=function(n,t,i,r,u,f){var o,e,c,s,h;Common.App.OpenInClient.o.initializeBase(this,[n,t,i,r,u,f]);o={errorMessage:$a.bD,offerString:this.k()};e=new CommonUI.b(!1,!1,!0,!1);this.l()?(e.g(1),c=this,s=function(){Common.bw.b("OICFailure")},o.helpLink={type:"AppLinkProps",id:"helpLink",text:$a.f,handler:s}):(e.g(4),e.h(2,$a.bA));e.h(1,this.j());e.k=this.g();h={id:this.g(),dialogIcon:3,bodyControls:o};e.j($a.a,this.i,h)};Common.App.OpenInClient.p=function(n){this.e=Function.createDelegate(this,this.bG);this.Z=Function.createDelegate(this,this.bH);this.b=Function.createDelegate(this,this.bs);Common.App.OpenInClient.p.initializeBase(this);this.a=n;this.k="ProtocolLaunchingDialog";Common.a.i().e()&&Common.a.i().f();Common.a.b().a().D()&&this.eO($a.gb,this.b,!0);this.g(4);this.h(1,$a.fK);this.h(2,$a.fL);var t=this.a.t===5?$a.by:$a.gc;this.cc($a.bz,t,null,null,this.Z,null,!1)};Common.App.OpenInClient.p.prototype={a:null,bs:function(n){Diag.a.a(595342858,211,50,"Open give feedback dialog");CommonUI.d.prototype.eH.call(this,n)},bG:function(){Diag.a.a(595342857,211,50,"OIC dialog retry");Common.a.c().d(1596290176,2,null)},bH:function(n){n===2?(Diag.a.a(593602691,211,50,"OIC dialog retry"),window.setTimeout(this.e,0)):n!==1&&n||(Common.a.b().a().k()===4?this.a.r()||(Diag.a.a(593602690,211,50,"Restart the App and continue editing"),this.a.y()):(Diag.a.a(593602689,211,50,"Switch to edit doc in browser"),this.a.W()))}};Common.App.OpenInClient.f=function(){};Common.App.OpenInClient.f.b=function(){return CommonUI.b.a(Common.App.OpenInClient.f.a,$a.fP)};Common.App.OpenInClient.e=function(){};Common.App.OpenInClient.e.b=function(){return CommonUI.b.a(Common.App.OpenInClient.e.a,$a.fY)};Common.App.OpenInClient.q.registerClass("Common.App.OpenInClient.q",null,Sys.IDisposable);Common.App.OpenInClient.r.registerClass("Common.App.OpenInClient.r",null,Sys.IDisposable);Common.App.OpenInClient.s.registerClass("Common.App.OpenInClient.s",null,Sys.IDisposable);Common.App.OpenInClient.t.registerClass("Common.App.OpenInClient.t");Common.App.OpenInClient.g.registerClass("Common.App.OpenInClient.g",Common.App.OpenInClient.q);Common.App.OpenInClient.h.registerClass("Common.App.OpenInClient.h",Common.App.OpenInClient.r);Common.App.OpenInClient.i.registerClass("Common.App.OpenInClient.i",Common.App.OpenInClient.s);Common.App.OpenInClient.j.registerClass("Common.App.OpenInClient.j",CommonUI.b);Common.App.OpenInClient.l.registerClass("Common.App.OpenInClient.l",CommonUI.b);Common.App.OpenInClient.c.registerClass("Common.App.OpenInClient.c",null,Common.ez);Common.App.OpenInClient.d.registerClass("Common.App.OpenInClient.d",null,Common.dV);Common.App.OpenInClient.m.registerClass("Common.App.OpenInClient.m",Common.App.OpenInClient.q);Common.App.OpenInClient.n.registerClass("Common.App.OpenInClient.n",Common.App.OpenInClient.r);Common.App.OpenInClient.o.registerClass("Common.App.OpenInClient.o",Common.App.OpenInClient.s);Common.App.OpenInClient.p.registerClass("Common.App.OpenInClient.p",CommonUI.d);Common.App.OpenInClient.b.a=null;Common.App.OpenInClient.f.a="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}<\/div> <\/div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> <\/div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'><\/div> <\/div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'><\/div> <\/div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'><\/div> <\/div> <\/div> <\/div> <\/div>";Common.App.OpenInClient.e.a="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}<\/div> <\/div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'><\/div> <\/div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'><\/div> <\/div> <\/div> <\/div> <\/div>";Type.registerNamespace("Common.App.SaveACopy");Common.App.SaveACopy.h=function(){};Common.App.SaveACopy.h.registerInterface("Common.App.SaveACopy.h");Common.App.SaveACopy.j=function(){};Common.App.SaveACopy.j.registerInterface("Common.App.SaveACopy.j");Common.App.SaveACopy.b=function(n,t,i){this.b=n;this.c=t;this.d=i};Common.App.SaveACopy.b.prototype={b:null,c:null,d:null,a:function(n){return new Common.App.SaveACopy.g(this.b,this.c,this.d,n)}};Common.App.SaveACopy.g=function(n,t,i,r){this.R=Function.createDelegate(this,this.bc);Common.App.SaveACopy.g.initializeBase(this,[!1,!1,!1,!1]);this.Y=n;this.Z=t;this.e=i;this.h(1,$a.ci);this.p=Common.App.SaveACopy.c.b();this.k="FileNameDialog-SaveACopy";this.d=r};Common.App.SaveACopy.g.prototype={Y:null,Z:null,e:null,c:null,b:null,d:null,a:function(n,t,i){var r,u;this.b=n;this.c=i;r={txtFileName:Common.d.d(Common.a.l.a()),lblFolderName:String.format($a.dA,t)};this.j($a.hq,this.R,r);Diag.a.a(7174148,216,50,"The file name dialog is initialized and shown.");u=document.getElementById("txtFileName");u.focus()},bc:function(n,t){var i,r;n!==1?Diag.a.a(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(i=t.txtFileName.trim(),Diag.a.a(7165651,216,50,"User click save to upload file with new name."),r=Common.d.o(Common.a.bm),i&&i!==""&&r!==""&&(i=i+r),this.e.a(this.b,this.c,i,this.d))}};Common.App.SaveACopy.i=function(){this.e=Function.createDelegate(this,this.f)};Common.App.SaveACopy.i.a=function(){Common.App.a.a().a(new Common.App.SaveACopy.i,0,!1)};Common.App.SaveACopy.i.prototype={d:null,a:function(){return"Common.App.SaveACopy"},b:function(){Common.a.a.i(this.e)},f:function(){Common.a.a.a("SaveACopyBrsIsEnabled")&&this.d.a(Common.App.SaveACopy.d,null).m()},c:function(n){var t,i,r,u;this.d=n;t=this;this.d.b(Common.App.SaveACopy.a,null).b(function(){return new Common.App.SaveACopy.a(Common.a.c(),n.a(Common.App.SaveToCloudStorage.b,null),function(){var n=new CommonUI.g;return n.a(!1)},function(){return new Common.App.SaveACopy.f(Common.a.c())},Common.a.b(),Common.a.b().c())}).a();i=this;this.d.b(Common.App.SaveACopy.b,null).c(Common.App.SaveACopy.h,null).b(function(){return new Common.App.SaveACopy.b(Common.a.c(),Common.a.b().a(),n.a(Common.App.SaveACopy.a,null))}).a();r=this;this.d.b(Common.App.SaveACopy.d,null).b(function(){return new Common.App.SaveACopy.d(n.a(Common.App.SaveACopy.e,null),n.a(Common.App.OneDriveFilePickerApi.d,null),Common.a.a,Common.a.b().c())}).a();u=this;this.d.b(Common.App.SaveACopy.e,null).b(function(){return new Common.App.SaveACopy.e(n.a(Common.App.SaveACopy.b,null),n.a(Common.App.SaveToCloudStorage.a,null),Common.bF.a(),n.a(Common.App.SaveACopy.a,null),Common.a.a,Common.a.Y,function(){return new Common.App.SaveACopy.f(Common.a.c())})}).a()}};Common.App.SaveACopy.f=function(n){this.e=Function.createDelegate(this,this.Z);Common.App.SaveACopy.f.initializeBase(this);this.g(1);this.h(1,$a.hg);this.h(0,$a.b);this.b=n};Common.App.SaveACopy.f.prototype={b:null,a:function(n){Diag.a.a(7165652,216,50,"Show error dialog here {0}.",n);this.j(n,$a.a,$a.z,this.e)},Z:function(n){n===1?(Diag.a.a(7165653,216,50,"User click to retry the action."),this.b.d(4246497969,2,null)):Diag.a.a(7165654,216,50,"User cancel the error dialog.")}};Common.App.SaveACopy.d=function(n,t,i,r){Common.App.SaveACopy.d.initializeBase(this,[n,t,i,r]);this.f=t};Common.App.SaveACopy.d.prototype={f:null,k:function(){return this.c.a("SaveACopyBrsIsEnabled")},j:function(){return 4246497969},i:function(){Common.bc.e(this.g);Common.bc.d([new Common.er(4246497969,2147483648,0)],this.f.a())},l:function(){Diag.a.a(7205456,216,50,"User clicked on SaveAs button from the backstage.")}};Common.App.SaveACopy.e=function(n,t,i,r,u,f,e){Common.App.SaveACopy.e.initializeBase(this,[t,i,r,u,f,e]);this.f=n};Common.App.SaveACopy.e.prototype={f:null,n:function(n){if(n&&n.data&&n.data.folders){Diag.a.a(7165655,216,50,"User selected which folder to upload file to.");var t=this.f.a(this.e);t.a(n.data.folders[0].id,n.data.folders[0].name,n.data.folders[0].urls.viewInBrowser)}else Diag.a.a(7165656,216,10,"Fail to select folder to upload file."),this.b()},k:function(n){n&&n.error&&n.error.code==="user_canceled"&&Diag.a.a(7205457,216,50,"User cancelled upload to their OneDrive in Save A Copy.");Common.App.SaveToCloudStorage.d.prototype.k.call(this,n)},b:function(){Diag.a.a(7205458,216,50,"Error occur in Save A Copy Manager.");Common.App.SaveToCloudStorage.d.prototype.b.call(this)}};Common.App.SaveACopy.a=function(n,t,i,r,u,f){Common.App.SaveACopy.a.initializeBase(this,[t,i,r,u,f]);this.f=n};Common.App.SaveACopy.a.prototype={f:null,c:function(){Diag.a.a(7205459,216,50,"Display Error for Save A Copy.");Common.App.SaveToCloudStorage.c.prototype.c.call(this)},q:function(){Diag.a.a(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");Common.App.SaveToCloudStorage.c.prototype.q.call(this)},p:function(n){Diag.a.a(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",n);Common.App.SaveToCloudStorage.c.prototype.p.call(this,n)},d:function(){var n;if(this.i&&this.i.SkipSaveToHost==="true")Common.App.SaveToCloudStorage.c.prototype.d.call(this);else if(n=this.f.d(3070187925,1,null),n!==32)Diag.a.a(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),Common.App.SaveToCloudStorage.c.prototype.d.call(this);else{var t=this,i=function(){Diag.a.a(8741712,216,50,"Call the force save file change successfully.");Common.App.SaveToCloudStorage.c.prototype.d.call(t)},r=this,u=function(){Diag.a.a(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");r.c()};this.f.b(3070187925,2,[i,u],null)}}};Common.App.SaveACopy.c=function(){};Common.App.SaveACopy.c.b=function(){return CommonUI.b.a(Common.App.SaveACopy.c.a,$a.ch)};Common.App.SaveACopy.b.registerClass("Common.App.SaveACopy.b",null,Common.App.SaveACopy.h);Common.App.SaveACopy.g.registerClass("Common.App.SaveACopy.g",CommonUI.b);Common.App.SaveACopy.f.registerClass("Common.App.SaveACopy.f",CommonUI.d);Common.App.SaveACopy.d.registerClass("Common.App.SaveACopy.d",Common.App.SaveToCloudStorage.e);Common.App.SaveACopy.e.registerClass("Common.App.SaveACopy.e",Common.App.SaveToCloudStorage.d);Common.App.SaveACopy.a.registerClass("Common.App.SaveACopy.a",Common.App.SaveToCloudStorage.c);Common.App.SaveACopy.c.a="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}<\/label> <\/div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}<\/label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> <\/div>";Common.App.SaveACopy.i.a();Type.registerNamespace("_Ewa");_Ewa.Fo=function(n){this.a=n};_Ewa.Fo.prototype={a:null,z:function(){return!1},x:function(n,t,i){var r=this.a.b(1056925771,2,i,null);return r!==2?$$sc.a.a(Boolean,!0):_Ewa.L.a(t.a)},w:function(n,t){return t.a===1056925771},y:function(n,t,i){var r=!0;switch(t){case"PopulateNewMenu":this.a&&this.a.b(2074131365,2,i,null);break;default:r=!1}return r}};_Ewa.tV=function(n){_Ewa.tV.initializeBase(this,[n])};_Ewa.tV.a=function(n){_Ewa.Z.a(87,new _Ewa.tV(n))};_Ewa.tV.prototype={g:function(){var n=_Ewa.l.a(Object,this.a.b(),155,this.b(),this.c,null),t=_Ewa.l.a(Sys.IDisposable,this.a.b(),165,this.b(),this.c,null),i=this;_Ewa.f.cw(_Ewa.f.ws([n,t],this.b(),3),function(){i.f([new _Ewa.Fo(Common.a.c())],null)},this.b(),3)}};_Ewa.Fo.registerClass("_Ewa.Fo",null,_Ewa.kh);_Ewa.tV.registerClass("_Ewa.tV",_Ewa.Z);Type.registerNamespace("_Ewa");_Ewa.bas=function(){};_Ewa.bas.a=function(){_Ewa.k.a(_Ewa.tV.a)};_Ewa.bas.a();Type.registerNamespace("_Ewa");_Ewa.NT=function(n){this.calculationMode=n};_Ewa.NT.prototype={calculationMode:0};_Ewa.NV=function(n){this.calculateType=n};_Ewa.NV.prototype={calculateType:0};_Ewa.He=function(n,t){this.e=Function.createDelegate(this,this.g);this.f=n;this.d=t;this.d.bC(this.e)};_Ewa.He.prototype={f:null,d:null,c:null,b:function(n){this.c=n},a:function(){this.f.c(-1059172980,0)},dispose:function(){this.d.bF(this.e)},g:function(){this.c&&this.c.i()}};_Ewa.Hd=function(n,t){_Ewa.Hd.initializeBase(this,[n,!0,!1,t,null,!1,!1])};_Ewa.Hd.prototype={bH:function(){return _Ewa.ClientStringManager.a().b(349)},bX:function(){return _Ewa.ClientStringManager.a().b(350)},bW:function(){return"DownloadOdsLink"},bM:function(){return"#"},bL:function(){return _Ewa.ClientStringManager.a().b(351)},dT:function(){return!0},da:function(){Diag.a.a(7702494,0,50,"DownloadACopyAsOdsDialog.LogDialogDisplayed - ODS download dialog displayed")},db:function(){Diag.a.a(7702495,0,50,"DownloadACopyAsOdsDialog.LogDownloadLinkClicked - ODS download dialog link clicked")},dU:function(){return Common.bw.b("XLWAEndUser_ExcelODF"),!0}};_Ewa.lr=function(n,t,i,r){_Ewa.lr.initializeBase(this);this.a=n;this.d=r;this.i=t;this.g=i};_Ewa.lr.a=function(n){n.o()&&n.o().bc()>0&&n.o().bR(function(n){n.d()})};_Ewa.lr.c=function(n,t){return function(i){_Ewa.h.d(i.Errors)&&(n.c().f().CalcMode=t,Diag.a.a(593609297,0,50,"OnSetCalcModeSucess: successCallback was called with errors for SetCalculationMode. reverting calc mode to {0}.  Error id names: {1}",t,_Ewa.h.a(i.Errors,",")))}};_Ewa.lr.b=function(n,t){return function(){n.c().f().CalcMode=t;Diag.a.a(593609296,0,50,"OnSetCalcModeFailure: failedCallback was called for SetCalculationMode. reverting calc mode to {0})",t)}};_Ewa.lr.prototype={a:null,d:null,i:null,g:null,e:function(){return this.a.c().a()},c:function(){return this.a.l()},h:function(){return this.a.l().FullDocumentInfo},b:function(){return _Ewa.N.a(this.a)},f:function(){return this.a.w()},z:function(){return!1},x:function(n,t,i,r){var l=this.h(),f=this.a,o=t.a,u=this.i,w=this.a.m(),b=i.SourceControlId,e,k,a,v,d,s,h,c,nt,y,p,tt,et;f.F().d(o);e=null;switch(o){case 1455037301:this.a.L()?u.b():u.a();break;case-2044628748:case 2004484710:this.a.L()?u.b():u.n();break;case 213236505:Common.a.gI();break;case-2028960985:u.d();break;case-1059172980:new _Ewa.Hd(u.e(o),new _Ewa.He(u,f.o()));break;case-1285148982:k=this.b().a().a();k.OWMfsr=!0;this.j(!1);break;case-75280711:this.j(!1);break;case-455164169:this.j(!0);break;case 810888577:Common.a.cS((new Date).getTime());Diag.a.a(40749250,0,50,"FileOperationsCommandHandler.ExecuteCommand: Set AccessTokenTtl to {0}",Common.a.p);break;case-1804063550:case-974518828:a=0;"OpenCopyInExcelClientTimeout"in i&&(a=i.OpenCopyInExcelClientTimeout);u.c(o,a);break;case-1339961039:v=!1;i&&"SkipReloadConfirmation"in i&&(v=i.SkipReloadConfirmation);this.m(!1,v);break;case-8805455:d=this.c();f.k()||(_Ewa.lr.a(f),s=this,e=_Ewa.f.cw(this.g.a(),function(n){var i=n.a(),r=i.d(),t;r&&_Ewa.jb.a(i,"UI_CopyAndEdit",_Ewa.B.a().Z(),s.a.c().e().a(2))?Diag.a.a(19482255,0,50,"FileOperationsCommandHandler.ExecuteCommand: ReloadInEditMode ribbon command was procesed through SendMessageIfOptionSet()"):r&&Common.a.eq?(t={},t.wdPreviousSession=Common.a.k,t.wdModeSwitchTime=_Ewa.t.a().a().getTime().toString(),Diag.a.a(19482256,0,50,"FileOperationsCommandHandler.ExecuteCommand: processing ReloadInEditMode ribbon command whike UseEditModePostMessage flag is ON"),i.a("UI_Edit",t,"")):l.CopyAndEditUrl?s.l():(s.f().r()||d.EditUrl)&&s.n()},this.dM(),3));break;case-723527778:f.k()&&(_Ewa.lr.a(f),this.o());break;case 1783960667:case-1355155015:var it=f.d().a().b(!1),g=o===-1355155015?1:0,ot=this,rt=function(){return new _Ewa.NV(g)},st=this,ht=this;e=_Ewa.M.a(this.a.g(),function(n,t){return _Ewa.j.l(f.d().a(),g,null,n,t,null,it)},function(n){return new _Ewa.F(128,0,n,0,rt)},t);_Ewa.b.a(f).r().a();break;case-988468372:if(this.a.a(385))if(h=parseInt(i.MenuItemId),h>=0&&h<3)this.r(t,h);else return Diag.a.a(41263680,0,10,"SetCalculationMode , unexpected menuItemId: {0}",i.MenuItemId),_Ewa.L.a(o);break;case 257398710:_Ewa.Gim.ntw(l.ReportAbuseUrl,f);break;case 1800405051:this.q();break;case-48469327:this.p();break;case 214430355:if(c=!1,i&&"EditAttemptInReadingViewCanEdit"in i&&(c=i.EditAttemptInReadingViewCanEdit),!this.s(c,i))break;this.d.a(c?21:22,null,null);break;case 1389557314:nt=this;e=_Ewa.f.cw(this.g.a(),function(n){var t=n.a();_Ewa.jb.a(t,"UI_FileVersions",null,nt.a.c().e().a(6))||_Ewa.Gim.ntw(l.FileVersionUrl,f)},this.dM(),3);break;case 2145659238:this.k();break;case 1773624819:b===w+"Jewel.TryOfficeFromViewer"?u.j():u.i();break;case 512141517:b===w+"Jewel.TryOfficeForMacTrialFromViewer"?u.l():u.k();break;case-1224038235:y="On"in i?!i.On:!!(f.c().f().Options&2);i.Description=y?_Ewa.ClientStringManager.a().a(515):_Ewa.ClientStringManager.a().a(516);var ut=this,ft=function(n,t){return _Ewa.vi.b(ut.a.d().a(),!y,n,t,null,null)},ct=this;e=_Ewa.M.a(this.a.g(),ft,function(n){return new _Ewa.F(129,0,n,0,null)},t);break;case 1118926154:this.a.k()&&(p=new($$sc.D.$$(Boolean)),tt=this,this.a.b().c(_Ewa.fK,53,function(n){n?(n.a().i(1,tt.a.m()+"faOpen"),p.b(!0)):Diag.a.a(39661579,0,50,"Ignoring RibbonCommand.LaunchFileMenuShortcut, the ribbonManager is null.")},null),e=p.a);break;case-1698025133:u.m();break;case 520859864:et=this;e=_Ewa.f.cw(_Ewa.l.b(_Ewa.iP,this.a.b(),393,394,r.b(),null),function(n){var t=n.a();t||Diag.a.a(588801298,0,10,"FileMenuCommandHandler::ExecuteCommand Failed to create SaveToHostManager")},this.a.i(),3);break;default:e=_Ewa.L.a(o)}return e||$$sc.a.a(Boolean,!0)},s:function(n,t){if(Common.a.C)return Diag.a.a(595080800,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view in mobile browser "),!1;if(Common.a.bs&&(n&&_Ewa.gt.c(this.c().WorkbookFileName)||_Ewa.e.a(this.c().FullDocumentInfo.HostEditUrl)))return Diag.a.a(23414109,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view a non-editable format .{0}, HostEditUrl {1}empty. Skipped prompt to edit",_Ewa.gt.a(this.c().WorkbookFileName)?"xls":"csv",_Ewa.e.a(this.c().FullDocumentInfo.HostEditUrl)?"":"not "),!1;var i=this;return Common.P.a([24,25,28,41],function(n){return i.d.g(n)})?(Diag.a.a(593081302,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view after opening in Edit by default"),!1):t&&"PromptEditAttemptInReadingOnlyIfCanEdit"in t&&!n?!1:!0},w:function(n,t){var i=!1;switch(t.a){case 1455037301:case-2044628748:case 2004484710:case-2028960985:case-974518828:case-1339961039:case-8805455:case-723527778:case 1783960667:case-1355155015:case 257398710:case 214430355:case 1389557314:case 2145659238:case 1773624819:case 512141517:case 1118926154:case-1698025133:i=!0;break;case 520859864:i=this.a.isChangeGateEnabled("OfficeVSO:3773098_SaveDeferredActionDispatcherEnabled")?!0:!1;break;case 213236505:i=this.a.a(455);break;case-1285148982:case-75280711:case-455164169:i=this.a.a(135);break;case 810888577:i=this.a.a(329);break;case-1224038235:i=this.a.c().I();!this.a.c().I();break;case-988468372:i=this.a.a(385);break;case-1804063550:case-1059172980:case 1800405051:case-48469327:i=this.a.Y()?!1:this.a.l().IsPasswordProtected?!1:!0}return i},y:function(){return!1},q:function(){if(this.e()){var n=this.a,t=this,i=function(){n.W(!1,!0);var i=t.b().a().a();i.PUOAudna="cw18";i.CWMsbc=2;i.OWMem=n.k();i.CWMuun=!1};_Ewa.I.a(n).a(new _Ewa.cJ("cw8",5,i))}},p:function(){if(this.e()){var t=this.a,n=this,i=function(){var r,i,u;t.W(!1,!1);r=n.b().a();i=r.a();i.PUOAudna="cw15";i.SAEUAwufl=n.f().p();i.CWMuun=!1;u=[-502303485];r.d(_Ewa.h.k(n.d.e(),u))};_Ewa.I.a(t).a(new _Ewa.cJ("cw8",5,i))}},j:function(n){var t=this,i=function(){var i;t.a.W(!0,!0);var f=_Ewa.N.a(t.a).a(),r=t.a.k(),u=_Ewa.h.b(1,1,0,0,0,r?-315732528:-2087635043,r?"DeploymentInvalidEditSession":"InvalidOrTimedOutSession");u.ForceVersionUpgrade=n;f.d([u]);i=_Ewa.N.a(t.a).a().a();i.PUOAudna="cw4";i.OWMem=t.a.k();i.CWMuun=!1};_Ewa.I.a(this.a).a(new _Ewa.cJ("cw4",2,i))},k:function(){var n,r,t,i;this.e()&&(n=this.a,_Ewa.B.a().x("2145659238")?(r=this,_Ewa.f.cw(this.g.a(),function(n){n.a().a("UI_Close",{},"")},this.dM(),3)):(t=this,i=function(){n.W(!0,!1);var i=t.b().a().a();i.CWMfsc=!1;i.CWMuun=!1;t.f().q()?(_Ewa.iW.a(n,t.b().a()),n.F().a("InViewerFromWebPart"),i.PUOAudna="cw28"):(i.PUOAudna="cw32",n.r()&32?i.CWMsbc=0:(i.CWMsbc=1,i.CWMcc=new _Ewa.ts),i.SAWMdnn=!0)},_Ewa.I.a(n).a(new _Ewa.cJ("cw8",5,i))))},l:function(){var i=this.f().P(),n,t,r;Diag.a.a(19674946,0,50,"FileOperationsCommandHandler.CopyAndEditWorkbook: vbaRemovedDuringConversion = {0}",i);n=this.a;i?(t=this,r=function(){var i=_Ewa.h.b(3,0,0,1089,0,1069271157,"XLSMacroFailure"),n;t.b().a().d([i]);n=t.b().a().a();n.PUOAudna="cw21"},_Ewa.I.a(n).a(new _Ewa.cJ("cw8",5,r))):Common.a.B?_Ewa.i.f(this.h().CopyAndEditUrl,"_blank",null,"FileOperationCommandHandler.CopyAndEditUrl"):_Ewa.Gim.ntw(this.h().CopyAndEditUrl,n)},n:function(){var o,f,n;if(this.e()){if(Common.a.bs&&!Common.a.bt){_Ewa.i.f(this.a.bD(!0,!0),"_blank",null,"FileOperationCommandHandler.BuildHostUrl");return}var i=this.a,r=!1,t=this.f().p(),s=this.c().FileWasRepaired;_Ewa.gt.a(this.c().WorkbookFileName)?(r=!0,Diag.a.a(19482258,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an XLS file, unsupported features = {0}",t)):_Ewa.gt.b(this.c().WorkbookFileName)&&(r=!0,Diag.a.a(19931723,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an CSV file"));var u,h=i.z().a(58),e=!(i.A().c().r()&&h),c=r||t;r&&!t||e&&c?(o=e?t?-2066104278:816071846:!this.a.isChangeGateEnabled("OfficeVSO:4035916_RemoveConvertInTeams")||!_Ewa.bn.a(this.a.e(),25)||this.a.bI()?-213064907:765011943,f=this,u=function(){var t=_Ewa.h.n([o]),n;f.b().a().d(t);n=f.b().a().a();n.PUOAudna="cw21"}):(n=this,u=function(){var u,r,f,e;i.W(!0,!1);u=n.b().a();r=u.a();r.CWMsbc=1;r.PRrr="modeSwitch";r.OWMem=!0;r.SAEUAwufl=n.f().p();r.CWMuun=!!n.c().EditUrl;r.NPAnu=n.c().EditUrl;n.h().CopyAndEditUrl||(f=[!n.a.isChangeGateEnabled("OfficeVSO:4035912_RemoveEditACopyInTeams")||!_Ewa.bn.a(n.a.e(),25)||n.a.bI()?1821390342:-943219229],u.d(_Ewa.h.k(n.d.e(),f)));s&&!t?(e=_Ewa.h.n([108482388]),n.b().a().d(e),r.PUOAudna="cw29"):r.PUOAudna="cw21"});_Ewa.I.a(i).a(new _Ewa.cJ("cw8",5,u))}},o:function(){var n,t,i;this.e()&&(n=this.a,Common.c.c()&&_Ewa.b.a(n).g().a().cr(),t=this,i=function(){var r=!n.c().b(),i;n.W(r,!1);i=t.b().a().a();i.PUOAudna="cw12";i.CWMsbc=1;i.CWMfsc=!0;i.OWMem=!1;i.OWMtfe=!0;i.PRrr="modeSwitch"},_Ewa.I.a(n).a(new _Ewa.cJ("cw8",5,i)))},m:function(n,t){var i,r,u;this.e()&&(i=this.a,i.U()&65536)&&(r=this,u=function(){i.W(n,!0);var u=r.b().a().a();u.PUOAudna="cw10";u.OWMnovm=r.c().NovMode;t||(u.CWMsbc=1,u.CWMcc=new _Ewa.QC)},_Ewa.I.a(i).a(new _Ewa.cJ("cw8",5,u)))},r:function(n,t){var i;Diag.a.a(41263681,0,50,"SetCalculationMode ,calculation mode chosen : {0} ",t);i=this.a.c().f().CalcMode;this.a.c().f().CalcMode=t;var r=this,u=function(n,u){return _Ewa.vi.a(r.a.d().a(),t,_Ewa.n.a(n,_Ewa.lr.c(r.a,i)),_Ewa.n.b(u,_Ewa.lr.b(r.a,i)),null,null)},e=this,f=function(){return new _Ewa.NT(t)},o=this;return _Ewa.M.a(this.a.g(),u,function(n){return new _Ewa.F(197,0,n,0,f)},n)}};_Ewa.vh=function(n){_Ewa.vh.initializeBase(this,[n])};_Ewa.vh.a=function(n){_Ewa.Z.a(94,new _Ewa.vh(n))};_Ewa.vh.prototype={g:function(){var n=this.a,i=[],r=_Ewa.l.a(_Ewa.gC,n.b(),56,this.b(),this.c,null),u,t;i.push(r);u=_Ewa.l.b(_Ewa.cQ,n.b(),5,4,this.c,null);i.push(u);t=this;_Ewa.f.cw($$sc.a.WAA.apply(null,i),function(){_Ewa.cn.a(r)&&t.f([new _Ewa.lr(n,r.a(),new($$sc.z.$$($$sc.o.$$(Common.V)))(function(){return _Ewa.l.a(Common.V,n.b(),137,t.b(),t.c,null)}),u.a())],null)},this.b(),0)}};_Ewa.bbN=function(){};_Ewa.bbN.a=function(){_Ewa.k.a(_Ewa.vh.a)};_Ewa.vi=function(){};_Ewa.vi.b=function(n,t,i,r,u,f){var e=n.a(9,f);return e.isReadOnlyRecommended=t,_Ewa.j.a(n,"SetReadOnlyRecommended",e,i,r,u,0,null)};_Ewa.vi.a=function(n,t,i,r,u,f){var e=n.a(9,f);return e.calc_type=t,_Ewa.j.a(n,"SetCalculationOptions",e,i,r,u,0,null)};_Ewa.NT.registerClass("_Ewa.NT");_Ewa.NV.registerClass("_Ewa.NV");_Ewa.Hd.registerClass("_Ewa.Hd",CADWLTR.a);_Ewa.lr.registerClass("_Ewa.lr",_Ewa.bcz,_Ewa.kh);_Ewa.vh.registerClass("_Ewa.vh",_Ewa.Z);_Ewa.bbN.a();Type.registerNamespace("_Ewa");_Ewa.bcR=function(){};_Ewa.bcR.a=function(){_Ewa.k.a(_Ewa.vS.a)};_Ewa.IV=function(n){this.a=n};_Ewa.IV.prototype={a:null,z:function(){return!1},x:function(n,t,i){var r,u=t.a;switch(u){case 1197865058:r=this.c();break;case 2064539126:r=this.b(t,_Ewa.H.b(i.CommandValueId));break;default:r=_Ewa.L.a(u)}return r},w:function(n,t){var i=this.a.c().X();if(i)switch(t.a){case 1197865058:case 2064539126:break;default:i=!1}return i},y:function(){return!1},c:function(){return _Ewa.b.a(this.a).ct(),_Ewa.j.d(this.a.d().a(),null,null,null)},b:function(n,t){var i={},r,u,f;return this.a.C(i),i.FirstRow=t.Row,i.FirstColumn=t.Column,i.NamedObjectName=t.PivotTableName,r=$$sc.a.a(Boolean,!0),!0&&(u=this,f=this,r=_Ewa.M.a(this.a.g(),function(n,r){return _Ewa.j.n(u.a.d().a(),i,0,t.Column.toString(),t.SortType,!0,n,r,null,null)},function(n){return new _Ewa.F(131,0,n,0,null)},n)),r}};_Ewa.vS=function(n){_Ewa.vS.initializeBase(this,[n])};_Ewa.vS.a=function(n){_Ewa.Z.a(20,new _Ewa.vS(n))};_Ewa.vS.prototype={g:function(){this.f([new _Ewa.IV(this.a)],null)}};_Ewa.IV.registerClass("_Ewa.IV",null,_Ewa.kh);_Ewa.vS.registerClass("_Ewa.vS",_Ewa.Z);_Ewa.bcR.a();Type.registerNamespace("_Ewa");_Ewa.vV=function(n,t,i){this.bV=Function.createDelegate(this,this.cX);this.bR=Function.createDelegate(this,this.cY);this.bH=Function.createDelegate(this,this.cz);this.bI=Function.createDelegate(this,this.cW);this.bU=Function.createDelegate(this,this.cy);_Ewa.vV.initializeBase(this,[n,"",!0,3,n.a(545),!1]);this.bb=t;this.b=i;this.A=!0};_Ewa.vV.prototype={bb:null,b:null,bj:!1,bT:!0,A:!1,z:null,bk:null,bp:null,bA:null,ba:null,y:0,Y:null,U:null,e:function(){return"HyperlinkDialog"},S:function(){return 526},dispose:function(){this.dn();System.a.b([this.bA,this.Y]);System.a.b(this.ba);this.z=null;this.U=null;_Ewa.TX.prototype.dispose.call(this)},E:function(){this.cx();var n="<div class='ewa-dlg-body-sectionbreak'>\r\n\t\t\t\t\t<div class='ewa-dlg-body-sectionlabel'>\r\n\t\t\t\t\t\t<label for='textToDisplay'>{0}<\/label>\r\n\t\t\t\t\t<\/div>\r\n\t\t\t\t\t<div class='ewa-dlg-body-fullLine'>\r\n\t\t\t\t\t\t<input type='text' id='textToDisplay' maxlength='{1}' dir='ltr' />\r\n\t\t\t\t\t<\/div>\r\n\t\t\t\t<\/div>";n=String.format(n,_Ewa.ClientStringManager.a().a(663),2083);this.D.innerHTML=n;this.F()?(this.cI(!0,!0,!0),this.bj?this.fm(4,this.br,672,this.ce,5,null):this.de(4,this.br,5,null)):this.H();_Ewa.TX.prototype.E.call(this)},H:function(){_Ewa.a.g(this.D,"HyperlinkDialog",!0);var n=new _Ewa.lS(document.createElement("div"));this.cw(n);this.D.appendChild(n.co());this.z=_Ewa.a.a(this.D,"textToDisplay");this.bA=this.dX.a(this.z);this.bA.a("change",this.bU,!1)},c:function(n){n===5&&(this.bT=!1);_Ewa.bU.prototype.c.call(this,n)},bG:function(n,t){var i=this.R();this.y!==n&&(i.t(!1),this.y=n,i=this.R(),i.t(!0));t&&(this.F()?_Ewa.bU.c(i.a):_Ewa.a.c(i.a,!1));this.U.disabled=i.n()},R:function(){return this.ba[this.y]},bz:function(){var n=new _Ewa.bU.d,t=this.R();return(t.i(),!this.bT)?(n.a=!0,n):(this.y!==1||t.d||(this.bW(!0),n.b=_Ewa.h.b(3,1,662,673,0,1938352623,"HyperlinkDialogValidationPopUp"),this.be(!0),this.F()||(this.T.disabled=!0)),n.a=t.d,n)},cr:function(){var n=new _Ewa.vV(this.B,this.bb,this.b);n.E();n.x(!1)},df:function(n){n.a()?(Diag.a.a(8757260,0,50,"Cancel pressed"),this.be(!1),this.F()||(this.T.disabled=!1),this.bW(!1),this.bG(this.y,!0)):(Diag.a.a(8757259,0,50,"InsertLink pressed"),this.O())},cx:function(){this.bj=!!this.b.y(64,"click")||!!this.b.y(128,"click")},I:function(){var n=this.R().a,t;this.F()?_Ewa.bU.c(n):_Ewa.a.c(n,!1);t=n.value.length;_Ewa.jW.a(n,t,t)},J:function(){var n,t,i,r;this.F()||this.cH();this.bj?(this.z.value=_Ewa.o.b(this.B)&&_Ewa.b.a(this.B).b().e()?this.b.c():this.b.D()?this.b.h().innerText:this.b.c(),n=this.dm(this.b.h()),t=this.R().a,n&&(t.value=n),this.V.innerHTML=_Ewa.ClientStringManager.a().a(725),this.A=t.value===this.z.value,this.F()||this.fi(672,!1)):(this.b.c()?(this.z.value=this.b.c(),this.A=!1):(this.z.value="",this.A=!0),this.y=0,this.V.innerHTML=_Ewa.ClientStringManager.a().a(724));this.F()||this.W();this.U=this.n(0).get_element();this.F()&&this.bj&&(i=this.U.parentNode,r=this.n(1).get_element(),i.appendChild(this.U),i.appendChild(r));this.R().t(!0);this.bG(this.y,!0);this.b.m()&&(this.A=!1,this.z.disabled=!0);_Ewa.bjx.prototype.J.call(this)},cT:function(n){return this.M(0,_Ewa.bU.b(n),_Ewa.bU.a(n),null),!0},cp:function(n){return this.M(5,_Ewa.bU.b(n),_Ewa.bU.a(n),null),!0},Q:function(){var t=this.B,i=this.R();this.bp=i.u();Diag.a.a(8757258,0,50,"Committing {0} link",_Ewa.vV.a.toString(i.k));this.bk=this.z.value.length?this.z.value:i.B();t.M();var r=t.d().a().b(!1),u=_Ewa.g.j(this.bb),n=this;return function(i,f){return _Ewa.j.g(t.d().a(),u,n.bk,n.bp,n.P===5,!1,123,i,f,n.b.b(),r,null)}},bc:function(){var t=_Ewa.g.j(this.bb),n=this;return function(){return new _Ewa.nC(t,n.bk,n.bp)}},bn:function(n){return _Ewa.bU.prototype.bn.call(this,n)||n===5},dm:function(n){var t;return _Ewa.o.b(this.B)?(t=this.b.a().C(),this.b.a().v()?t&&t.startsWith("mailto:")?(this.y=2,t=t.substr(7)):this.y=0:this.y=1):_Ewa.a.o(n,"_link",null)==="int"?(t=_Ewa.a.o(n,"_goto",null)||_Ewa.a.o(n,"_loc",null),this.y=1):(t=_Ewa.a.o(n,"_loc",null)||_Ewa.a.o(n,"data-relative-url",null)||n.href,t&&t.startsWith("mailto:")?(this.y=2,t=t.substr(7)):this.y=0),t},cw:function(n){var t;this.ba=[new _Ewa.vV.b("url_radio","url_text",666,"url_validation_id",0,0,"http://",this.F()),new _Ewa.vV.d("ref_radio","ref_text",667,670,1,this.B.A(),this.bb.SheetName,this.F()),new _Ewa.vV.c("mailto_radio","mailto_text",669,671,2,this.F())];for(var r=this.ba,u=r.length,i=0;i<u;++i)t=r[i],t.G(this.bI),t.F(this.bH),t.H(this.bR),n.a(t.dH)},bW:function(n){var i,t;for(this.be(n),i=this.dH.getElementsByTagName("input"),t=0;t<i.length;++t)i[t].disabled=n},dn:function(){for(var n,i=this.ba,r=i.length,t=0;t<r;++t)n=i[t],n.O(this.bI),n.N(this.bH),n.P(this.bR)},cX:function(){var t=this.R(),i=t.a,n=i.value,r;this.U.disabled=t.n();!this.y&&_Ewa.e.t(n)&&(r=n,n=_Ewa.bf.d(n,!1),r!==n&&(i.value=n));this.bS(n);System.a.a(this.Y)},bS:function(n){this.A&&(this.z.value=n)},cy:function(){this.A=!1;System.a.a(this.Y)},cY:function(){System.a.a(this.Y);this.Y=_Ewa.x.a().a(this.bV,150,_Ewa.m.bg,!0,!1)},cW:function(n){System.a.a(this.Y);var t=n;this.bS(t.a.value);this.bG(t.k,!0)},cz:function(n){var t=n;this.bS(t.a.value);this.bG(t.k,!1)}};_Ewa.vV.a=function(){};_Ewa.vV.a.prototype={url:0,ref:1,mailto:2};_Ewa.vV.a.registerEnum("_Ewa.vV.a",!1);_Ewa.vV.b=function(n,t,i,r,u,f,e,o){this.z=Function.createDelegate(this,this.M);this.s=Function.createDelegate(this,this.L);this.A=Function.createDelegate(this,this.i);this.r=Function.createDelegate(this,this.K);this.q=Function.createDelegate(this,this.J);_Ewa.vV.b.initializeBase(this,[document.createElement("div"),null]);this.j=n;this.o=t;this.v=_Ewa.ClientStringManager.a().a(i);this.p=r;this.x=_Ewa.ClientStringManager.a().a(u);this.d=!0;this.dH.className="ewa-dlg-body-sectionbreak";this.m=e;this.k=f;this.f=o;this.I();this.w=Common.bL.c().toString()};_Ewa.vV.b.prototype={j:null,o:null,v:null,m:null,p:null,x:null,w:null,k:0,g:null,d:!1,h:null,f:!1,H:function(n){this.dK("tch",n)},P:function(n){this.dL("tch",n)},F:function(n){this.dK("rch",n)},N:function(n){this.dL("rch",n)},G:function(n){this.dK("rcl",n)},O:function(n){this.dL("rcl",n)},a:null,D:function(n){return this.d=n,this.a.setAttribute("aria-invalid",!this.d),this.d?(this.c.removeAttribute("aria-live"),this.c.removeAttribute("role")):(this.c.setAttribute("aria-live","polite"),this.c.setAttribute("role","alert")),n},c:null,b:null,t:function(n){n?(this.a.tabIndex=0,this.b.a(!0),this.f&&(this.b.co().tabIndex=0,_Ewa.bU.c(this.b.co())),this.i()):(this.a.tabIndex=-1,this.f&&(this.b.co().tabIndex=-1),this.g&&this.g.c()&&this.g.a(),this.e(!0));_Ewa.a.g(this.a,"disabledInput",!n);this.f&&(this.a.disabled=!n)},dispose:function(){Diag.a.a(22050770,0,50,"LinkOption.Despose: Id: {0}, UniqueId: {1}, RedioElement != null: {2}, Inner callstack: {3}",this.j,this.w,!!this.b,_Ewa.cl.a(!0,null));System.a.b([this.h,this.g]);this.b&&(this.b.e(this.q),this.b.i(this.r));this.a=null;this.b=null;_Ewa.hR.prototype.dispose.call(this)},u:function(){return this.a.value},B:function(){return this.a.value},i:function(){},e:function(n){_Ewa.a.b(this.c,!n,!0);n&&(this.c.removeAttribute("aria-live"),this.c.removeAttribute("role"))},n:function(){var n=this.a.value;return!n.length||n===this.m},L:function(){this.d?this.g=_Ewa.dw.a(this.A,500,_Ewa.m.bh,this.g):this.i();this.dJ("tch",null,null)},I:function(){this.dH.className="ewa-dlg-body-sectionbreak";var t=this.f?"tabindex='-1'":"",n="\t<div class='ewa-dlg-body-sectionlabel'>\r\n\t\t\t\t\t\t\t\t\t\t\t<label id='{1}Label' for='{2}'>{0}<\/label>\r\n\t\t\t\t\t\t\t\t\t\t<\/div>\r\n\t\t\t\t\t\t\t\t\t\t<div class='ewa-dlg-body-fullLine'>\r\n\t\t\t\t\t\t\t\t\t\t\t<input type='radio' aria-labelledby='{1}Label' name='hyperlink_type' id='{1}' {6}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<input type='text' tabindex='-1' class='disabledInput' id='{2}' maxlength='{3}' dir='ltr' />\r\n\t\t\t\t\t\t\t\t\t\t\t\t<label class='ValidationLabel' id='{4}'>{5}<\/label>\r\n\t\t\t\t\t\t\t\t\t\t\t<\/input>\r\n\t\t\t\t\t\t\t\t\t\t<\/div>";n=String.format(n,this.v,this.j,this.o,2083,this.p,this.x,t);this.dH.innerHTML=n;this.a=this.dR(this.o);this.f&&(this.a.disabled=!0);this.b=new _Ewa.kq(this.dR(this.j),!0);this.a.value=this.m;this.c=this.dR(this.p);_Ewa.a.b(this.c,!1,!0);this.Q()},Q:function(){this.h=this.dX.a(this.a);this.h.a("keyup",this.s,!1);this.h.a("change",this.s,!1);this.h.a("focus",this.z,!1);this.b.b(this.q);this.b.h(this.r)},M:function(){this.dJ("rcl",null,null)},J:function(){this.dJ("rch",null,null)},K:function(){this.dJ("rcl",null,null)}};_Ewa.vV.d=function(n,t,i,r,u,f,e,o){_Ewa.vV.d.initializeBase(this,[n,t,i,"ref_validation_id",r,u,"",o]);this.l=f;_Ewa.a.g(this.c,"ValidationLabelWarning",!0);this.y=e};_Ewa.vV.d.prototype={l:null,y:null,u:function(){return String.format("{0}{1}","#",this.E())},B:function(){return this.E()},e:function(n){_Ewa.vV.b.prototype.e.call(this,n);_Ewa.a.g(this.a,"ValidationWarningGlowColor",!n)},i:function(){var n=this.a.value;this.D(!n.length||_Ewa.g.R(n,this.l.u())||this.R(n));this.e(this.d)},R:function(n){return this.l.L().f(n)},E:function(){var t=this.a.value,r,i,n,u,f,e,o;return(o=_Ewa.g.i(t,this.l.u(),u={val:i},f={val:r},e={val:n}),i=u.val,r=f.val,n=e.val,o)&&n&&(t=_Ewa.g.l(n,i||this.y,!0,!1,!1)),t}};_Ewa.vV.c=function(n,t,i,r,u,f){_Ewa.vV.c.initializeBase(this,[n,t,i,"mailto_validation_id",r,u,"",f]);_Ewa.a.g(this.c,"ValidationLabelError",!0)};_Ewa.vV.c.prototype={u:function(){var n=this.a.value;return n.startsWith("mailto:")?n:"mailto:"+n},e:function(n){_Ewa.vV.b.prototype.e.call(this,n);_Ewa.a.g(this.a,"ValidationErrorGlowColor",!n)},i:function(){var n=this.a.value;this.D(!n.length||Common.d.s(n));this.e(this.d)},n:function(){var n=this.a.value;return _Ewa.vV.b.prototype.n.call(this)||!Common.d.s(n)}};_Ewa.bcY=function(){};_Ewa.bcY.a=function(){_Ewa.k.a(_Ewa.vW.a)};_Ewa.vW=function(n){_Ewa.vW.initializeBase(this,[n])};_Ewa.vW.a=function(n){_Ewa.Z.a(105,new _Ewa.vW(n))};_Ewa.vW.prototype={g:function(){this.f([new _Ewa.Jh(this.a,_Ewa.b.a(this.a))],null)}};_Ewa.Jh=function(n,t){this.a=n;this.b=t};_Ewa.Jh.prototype={a:null,b:null,z:function(){return!1},w:function(n,t){return n===1&&t.a===-1583422759},y:function(){return!1},x:function(){return this.c(),$$sc.a.a(Boolean,!0)},c:function(){var i=_Ewa.g.a(this.b.a().a().b(),this.a),t=_Ewa.b.d(this.b),n;t&&(n=new _Ewa.vV(this.a,i,t),n.E(),n.x(!1))}};_Ewa.vV.registerClass("_Ewa.vV",_Ewa.TX);_Ewa.vV.b.registerClass("_Ewa.vV.b",_Ewa.hR);_Ewa.vV.d.registerClass("_Ewa.vV.d",_Ewa.vV.b);_Ewa.vV.c.registerClass("_Ewa.vV.c",_Ewa.vV.b);_Ewa.vW.registerClass("_Ewa.vW",_Ewa.Z);_Ewa.Jh.registerClass("_Ewa.Jh",null,_Ewa.kh);_Ewa.bcY.a();Type.registerNamespace("_Ewa");_Ewa.Oh=function(n){this.a=n;this.h=_Ewa.iU.b()};_Ewa.Oh.prototype={b:"Excel",a:null,h:null,f:function(){return!!(this.a.x()&1024)},g:function(){return this.a.l().MsFormId},d:function(){return this.a.l().MsFormDocUrl},c:function(){var n=this.a.bk().DocumentHostInfo.FileSource;return _Ewa.e.c(n,"onedrive",!0)?"MSA":"OrgId"},z:function(n,t){switch(t){case-105284469:return!(this.a.x()&2048)||this.f();case-1219864912:case 1674421386:case-1128532220:case 2023601781:return!this.f()}return!1},x:function(n,t){var i=$$sc.a.a(Boolean,!0),r=t.a;switch(r){case-105284469:this.m();break;case-1219864912:this.n();break;case-1128532220:this.l();break;case 1674421386:this.o();break;case 2023601781:i=this.i();break;default:i=_Ewa.L.a(r)}return i},w:function(n,t){if(!this.a.c().e().a(61))return!1;var i=!1;switch(t.a){case-105284469:i=!!(this.a.x()&2048)&&!this.f();break;case-1219864912:case 1674421386:case-1128532220:case 2023601781:i=this.f()}return i},y:function(){return!1},m:function(){var i=Common.d.d(this.a.l().FullDocumentInfo.BreadcrumbDocName),t={},n={};t.Action="Create";t.auth_pvr=this.c();n.Action="Create";n.XlWorkbookId=encodeURIComponent(this.d());n.Host=this.b;n.Title=encodeURIComponent(i);this.e(t,n,!0);this.a.l().Options=_Ewa.i.j(!1,this.a.l().Options,2048)},l:function(){var t={},n={};t.auth_pvr=this.c();n.formId=this.g();n.XlWorkbookId=encodeURIComponent(this.d());n.Host=this.b;this.e(t,n,!0)},n:function(){var t={},n={};t.auth_pvr=this.c();n.formId=this.g();n.XlWorkbookId=encodeURIComponent(this.d());n.Host=this.b;n.TopView="Preview";this.e(t,n,!0)},o:function(){var t={},n={};t.auth_pvr=this.c();n.formId=this.g();n.FlexPane="SendForm";n.XlWorkbookId=encodeURIComponent(this.d());n.Host=this.b;this.e(t,n,!0)},i:function(){return new _Ewa.Oh.a(this)},k:function(){var n=this,t=function(t,i){return _Ewa.Oi.a(n.a.d().c(),n.h.b(),_Ewa.n.a(t,function(){n.j()}),i,null,null)};this.a.g().d(new _Ewa.F(158,0,t,0,null))},j:function(){var t={},n={};t.Action="Delete";t.auth_pvr=this.c();n.Action="Delete";n.Host=this.b;n.formId=encodeURIComponent(this.g());n.XlWorkbookId=encodeURIComponent(this.d());this.e(t,n,!0)},e:function(n,t,i){var l=this.a.e().MsFormBaseUrl+"/Pages/"+(i?"DesignPage":"ResponsePage")+".aspx",r="",u="",f,e,o,s,h,c;if(t){f=t;for(e in f)o={key:e,value:f[e]},u+=u.length?"&":"",u+=o.key+"="+o.value;n||(n={});n.Fragment=encodeURIComponent(u)}if(n){s=n;for(h in s)c={key:h,value:s[h]},r+=r.length?"&":"?",r+=c.key+"="+c.value}window.open(l+r,"_blank")}};_Ewa.Oh.a=function(n){this.s=Function.createDelegate(this,this.moveNext);this.a=n;_Ewa.Oh.a.initializeBase(this);this.l=this.t;this.moveNext()};_Ewa.Oh.a.prototype={a:null,m:null,n:0,j:null,l:null,f:0,t:function(){return this.m=_Ewa.h.b(3,2,0,1428,0,-1244327602,"MsFormDeleteConfirmation"),this.j=_Ewa.I.a(this.a.a).e(this.m).G(),this.j.b.b>3||(this.f=2,this.j.a(this.s)),this.u},u:function(){this.n=this.j.c();this.n||(this.a.a.l().Options=_Ewa.i.j(!1,this.a.a.l().Options,2048),this.a.k());this.f=3;this.k(!0)},dispose:function(){},moveNext:function(){try{for(this.f=1;this.f===1;)this.l=this.l()}catch(n){this.e(n);this.f=3}}};_Ewa.wX=function(n){_Ewa.wX.initializeBase(this,[n])};_Ewa.wX.a=function(n){n.c().e().a(61)&&_Ewa.Z.a(215,new _Ewa.wX(n))};_Ewa.wX.prototype={g:function(){var t=_Ewa.l.a(Sys.IDisposable,this.a.b(),203,this.b(),this.c,null),n=this;_Ewa.f.cw(_Ewa.f.ws([t],this.b(),3),function(){n.f([new _Ewa.Oh(n.a)],null)},this.b(),3)}};_Ewa.Oi=function(){};_Ewa.Oi.a=function(n,t,i,r,u,f){var e=n.a(9,f);return e.sheetName=t,e.confirmationChoice=!0,_Ewa.j.a(n,"DeleteSheet",e,i,r,u,0,null)};_Ewa.Oh.registerClass("_Ewa.Oh",null,_Ewa.kh);_Ewa.Oh.a.registerClass("_Ewa.Oh.a",$$sc.a,Sys.IDisposable);_Ewa.wX.registerClass("_Ewa.wX",_Ewa.Z);Type.registerNamespace("_Ewa");_Ewa.bfM=function(){};_Ewa.bfM.a=function(){_Ewa.k.a(function(n){_Ewa.wX.a(n)})};_Ewa.bfM.a();Type.registerNamespace("_Ewa");_Ewa.qr=function(){};_Ewa.qr.b=function(){return CommonUI.b.a(_Ewa.qr.a,_Ewa.ClientStringManager.a().b(372))};_Ewa.OB=function(n){this.b=n;n.b().b(_Ewa.hf,309,this)};_Ewa.OB.prototype={b:null,a:function(){var t;if(this.c()){if(this.b.a(956)){this.b.f().a().d.i=!0;var n=new($$sc.D.$$(Boolean)),i=this.b.h().a(new _Ewa.R(-2050946363,_Ewa.D.a,2,0,null),null,null),r=this;return i.CW(function(t){n.b(!_Ewa.cn.b(t)&&t.a())}),n.a}return t=new _Ewa.OE(this.b),t.R()}return $$sc.a.a(Boolean,!0)},c:function(){var n=this.b.f().a();return this.b.c().M()&&this.b.c().bV()&&!n.d.c()&&this.b.c().B()}};_Ewa.xc=function(n){_Ewa.xc.initializeBase(this);this.a=n;this.e()};_Ewa.xc.a=function(n){n.b().b(_Ewa.wC.$$(_Ewa.hf),310,new _Ewa.xc(n))};_Ewa.xc.prototype={a:null,p:function(){this.d(this.a.b().a(_Ewa.hf,309,!1,null)||new _Ewa.OB(this.a))}};_Ewa.OE=function(n){this.e=Function.createDelegate(this,this.Z);_Ewa.OE.initializeBase(this,[n,null,!1,!1,!1,!1])};_Ewa.OE.prototype={b:null,d:null,R:function(){var n,t;return this.g(4),this.d=this.a.p().a("UserAction","ShowNamedSheetViewTeachingDialog"),n=_Ewa.ClientStringManager.a().a(1627),this.p=_Ewa.qr.b(),this.b=new($$sc.D.$$(Boolean)),t={},this.j(n,this.e,t),this.b.a},Z:function(n){var t,r,u,i;n===1?(r=this.a.h().a(new _Ewa.R(-2050946363,_Ewa.D.a,2,0,null),null,null),u=this,r.CW(function(n){u.b.b(!_Ewa.cn.b(n)&&n.a())}),t="Yes"):(i=n===2,this.b.b(i),t=n===2?"No":"Close",i&&this.bc());this.Y(t);this.i()},t:function(n){CommonUI.b.prototype.t.call(this,n);CommonUI.c.prototype.h.call(this,1,_Ewa.ClientStringManager.a().a(1629));CommonUI.c.prototype.h.call(this,2,_Ewa.ClientStringManager.a().b(384))},bc:function(){this.a.c().bA(!1)},Y:function(n){var i=this.a.f().a(),t={};t.a=this.a.e().UserSessionId;t.b="NamedSheetViewTeachingDialogClose";t.c=n;t.e=!0;this.d&&(this.d.a(),t.d=this.d.b());_Ewa.A.a().a(53,t,!0)}};_Ewa.lL=function(n){this.f=n;n.b().b(_Ewa.iV,322,this)};_Ewa.lL.a=function(){return document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv")};_Ewa.lL.b=function(){return _Ewa.o.a()?document.querySelector("[data-unique-id=Ribbon-NamedSheetViewExit]"):document.querySelector("[id^=m_excelWebRenderer_ewaCtl_NamedSheetView\\.Exit]")};_Ewa.lL.prototype={f:null,j:null,i:null,h:null,g:null,k:0,n:function(n){var b,t,u,f,e,o,s,h,i,c,l,a,v,y,p,r,w;this.k=n;t=(b=new($$sc.u.$$(_Ewa.hg)),b);n&&n!==1?n===2?(l=this,t.b(new _Ewa.hg(_Ewa.ClientStringManager.a().a(1659),_Ewa.ClientStringManager.a().b(377),_Ewa.ClientStringManager.a().a(1656),function(){l.e(!1);l.d(1,"EnterTempViewAfterPersistedView")},null,null,_Ewa.lK.a()))):n===3&&(a=this,v=this,t.b(new _Ewa.hg(_Ewa.ClientStringManager.a().b(374),_Ewa.ClientStringManager.a().a(1669),_Ewa.ClientStringManager.a().a(1657),function(){a.d(2,"AutoOptInExitCalloutContinue");a.e(!0)},_Ewa.ClientStringManager.a().a(1658),function(){v.e(!1);v.d(1,"AutoOptInExitGuide")},_Ewa.lL.b())),y=this,p=this,t.b(new _Ewa.hg(_Ewa.ClientStringManager.a().a(1659),_Ewa.ClientStringManager.a().b(377),_Ewa.ClientStringManager.a().a(1657),function(){y.d(2,"Continue");y.e(!0)},_Ewa.ClientStringManager.a().a(1658),function(){p.e(!1);p.d(1,"ExitGuide")},_Ewa.lK.a())),r=this,w=this,t.b(new _Ewa.hg(_Ewa.ClientStringManager.a().a(1661),_Ewa.ClientStringManager.a().b(376),_Ewa.ClientStringManager.a().a(1662),function(){r.m();r.e(!1);r.d(1,"LearnMore")},_Ewa.ClientStringManager.a().a(1663),function(){w.e(!1);w.d(1,"Done")},_Ewa.lL.a()))):(u=this,f=this,t.b(new _Ewa.hg(_Ewa.ClientStringManager.a().b(374),_Ewa.ClientStringManager.a().b(375),_Ewa.ClientStringManager.a().a(1657),function(){u.d(2,"Continue");u.e(!0)},_Ewa.ClientStringManager.a().a(1658),function(){f.e(!1);f.d(1,"ExitGuide")},_Ewa.lK.a())),n===1&&(e=this,o=this,t.b(new _Ewa.hg(_Ewa.ClientStringManager.a().a(1659),_Ewa.ClientStringManager.a().b(377),_Ewa.ClientStringManager.a().a(1657),function(){e.d(2,"FirstEnterTempViewContinueSecond");e.e(!0)},_Ewa.ClientStringManager.a().a(1658),function(){o.e(!1);o.d(1,"FirstEnterTempViewExitGuideSecond")},_Ewa.lK.a()))),s=this,h=this,t.b(new _Ewa.hg(_Ewa.ClientStringManager.a().b(378),_Ewa.ClientStringManager.a().a(1660),_Ewa.ClientStringManager.a().a(1657),function(){s.d(2,"FirstEnterExitCalloutContinue");s.e(!0)},_Ewa.ClientStringManager.a().a(1658),function(){h.e(!1);h.d(1,"FirstEnterExitCalloutGuide")},_Ewa.lL.b())),i=this,c=this,t.b(new _Ewa.hg(_Ewa.ClientStringManager.a().a(1661),_Ewa.ClientStringManager.a().b(376),_Ewa.ClientStringManager.a().a(1662),function(){i.m();i.e(!1);i.d(1,"LearnMore")},_Ewa.ClientStringManager.a().a(1663),function(){c.e(!1);c.d(1,"Done")},_Ewa.lL.a())));this.j=new _Ewa.OD(t)},m:function(){var n=new _Ewa.R(-859308420,_Ewa.D.a,this.f.t(),9,"Help"),t={CommandValueId:"HelpID=SheetViews",InputMethod:_Ewa.D.a,MenuItemId:"HelpArticle",ShouldCanvasTakeFocus:!0};this.f.h().a(n,t,null)},c:function(n){this.n(n);this.l()},b:function(n){this.h=n},l:function(){var n=this.j.c(),i,e,u,r;if(n){e=(i=new Common.cx,i.label=n.c,i.onExecute=n.d,i);u=null;n.a&&(u=(r=new Common.cx,r.label=n.a,r.onExecute=n.e,r));var t,o=(t=new Common.cy,t.target=n.f,t.content=n.b,t.title=n.g,t.showCloseIcon=!0,t.primaryButtonProps=e,t.secondaryButtonProps=u,t.useTeachingStyles=!0,t),s=this.h.callout(o),f,h=this,c=(f=new Common.cO,f.onShow=function(){h.d(0,null)},f);this.i=this.h.addNotification(s,c);this.f.cC(!0)}},a:function(){this.e(!1);this.d(1,"DismissedByOthers")},e:function(n){this.i&&(this.f.cC(!1),this.h.removeNotification(this.i),this.i=null);n&&this.l()},d:function(n,t){var i={};i.a=this.f.e().UserSessionId;i.b=this.k;i.c=this.j.a;i.d=n;i.e=t;n?(this.g&&(this.g.a(),i.f=this.g.b(),this.g=null),n===2&&(this.g=this.f.p().a("UserAction","ShowNamedSheetViewTeachingCalloutNext"))):this.g=this.f.p().a("UserAction","ShowNamedSheetViewTeachingCallout");_Ewa.A.a().a(52,i,!0)}};_Ewa.OD=function(n){this.b=n};_Ewa.OD.prototype={b:null,a:0,c:function(){return this.a<this.b.e.length?this.b.a(this.a++):null}};_Ewa.hg=function(n,t,i,r,u,f,e){this.g=n;this.b=t;this.c=i;this.d=r;this.e=f;this.a=u;this.f=e};_Ewa.hg.prototype={g:null,b:null,c:null,d:null,a:null,e:null,f:null};_Ewa.xd=function(n){_Ewa.xd.initializeBase(this);this.a=n;this.e()};_Ewa.xd.a=function(n){n.b().b(_Ewa.wC.$$(_Ewa.iV),323,new _Ewa.xd(n))};_Ewa.xd.prototype={a:null,p:function(){this.d(this.a.b().a(_Ewa.iV,322,!1,null)||new _Ewa.lL(this.a))}};_Ewa.xc.registerClass("_Ewa.xc",_Ewa.qV.$$(_Ewa.hf));_Ewa.OE.registerClass("_Ewa.OE",_Ewa.FD);_Ewa.hg.registerClass("_Ewa.hg");_Ewa.xd.registerClass("_Ewa.xd",_Ewa.qV.$$(_Ewa.iV));_Ewa.qr.a="<div class='namedsheetview_teaching_dialog_control' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_description_label' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_textarea' id='TextArea'> <label id='TeachingDescriptionId' class='WACDialogLabel' >{0}<\/label> <\/div> <\/div> <\/div>";Type.registerNamespace("_Ewa");_Ewa.bfU=function(){};_Ewa.bfU.a=function(){_Ewa.k.a(function(n){_Ewa.xc.a(n);_Ewa.xd.a(n)})};_Ewa.bfU.a();Type.registerNamespace("_Ewa");_Ewa.OL=function(n){_Ewa.OL.initializeBase(this);this.a=n;this.e()};_Ewa.OL.prototype={a:null,p:function(){var n=this;_Ewa.f.cw(_Ewa.l.a(Sys.IDisposable,this.a.b(),164,this.b(),this.c,null),function(){n.d(new Common.App.NewAndOpen.UX.f)},this.b(),3)}};_Ewa.OL.registerClass("_Ewa.OL",_Ewa.qV.$$(Sys.IDisposable));Type.registerNamespace("_Ewa");_Ewa.bfY=function(){};_Ewa.bfY.a=function(){_Ewa.k.a(function(n){n.b().b(_Ewa.wC.$$(Sys.IDisposable),165,new _Ewa.OL(n))})};_Ewa.bfY.a();Type.registerNamespace("_Ewa");_Ewa.Pt=function(n,t){this.a=t;this.b=n};_Ewa.Pt.prototype={a:null,b:null,x:function(n,t,i){var u=t.a,r=2;switch(u){case 1959943459:r=this.a.b(1959943459,2,i,null);break;case 2155708348:r=this.a.b(2155708348,2,i,null)}return r!==2?$$sc.a.a(Boolean,!0):_Ewa.L.a(t.a)},w:function(n,t){return t.a===1959943459||t.a===2155708348},y:function(n,t,i){return t==="PopulateMruMenu"?(this.a.b(2799130311,2,i,null),!0):!1},z:function(){return!1}};_Ewa.xz=function(n){_Ewa.xz.initializeBase(this,[n])};_Ewa.xz.a=function(n){_Ewa.Z.a(88,new _Ewa.xz(n))};_Ewa.xz.prototype={g:function(){var t=_Ewa.l.a(Object,this.a.b(),155,this.b(),this.c,null),i=_Ewa.l.a(Sys.IDisposable,this.a.b(),165,this.b(),this.c,null),n=this;_Ewa.f.cw(_Ewa.f.ws([t,i],this.b(),3),function(){n.f([new _Ewa.Pt(n.a,Common.a.c())],null)},this.b(),3)}};_Ewa.Pt.registerClass("_Ewa.Pt",null,_Ewa.kh);_Ewa.xz.registerClass("_Ewa.xz",_Ewa.Z);Type.registerNamespace("_Ewa");_Ewa.bgv=function(){};_Ewa.bgv.a=function(){_Ewa.k.a(_Ewa.xz.a)};_Ewa.bgv.a();Type.registerNamespace("_Ewa");_Ewa.NG=function(n,t){this.sheetName=n;this.printSettings=t};_Ewa.NG.prototype={sheetName:null,printSettings:null};_Ewa.Nx=function(n,t){this.appliedRange=n;this.addToPrintArea=t};_Ewa.Nx.prototype={appliedRange:null,addToPrintArea:!1};_Ewa.Nw=function(n){this.sheetName=n};_Ewa.Nw.prototype={sheetName:null};_Ewa.bgX=function(){};_Ewa.bgU=function(){};_Ewa.bgV=function(){};_Ewa.bgW=function(){};_Ewa.bgW.registerInterface("_Ewa.bgW");_Ewa.Qi=function(){};_Ewa.Qi.prototype={whatToPrintOptions:null,orientationOptions:null,paperSizeOptions:null,scalingOptions:null,selectedPrintSettingsValues:null,printSettingsTaskPaneCallbacks:null,logger:null,ewaUtils:null,shouldDisableCurrentSelection:!1};_Ewa.cN=function(){};_Ewa.cN.prototype={printSettingOptionKey:0,printSettingOptionText:null};_Ewa.Qj=function(){};_Ewa.Qj.prototype={selectedWhatToPrint:0,selectedOrientation:0,selectedPaperSize:0,selectedScaling:0,selectedIgnorePrintArea:!1};_Ewa.Qh=function(){};_Ewa.Qh.prototype={onSettingChange:null,onPrint:null,onDropdownSettingsFocus:null};_Ewa.bgT=function(n,t,i,r,u,f){_Ewa.bgT.initializeBase(this,[n,t,i,f,!1]);this.y=r;this.bU=u};_Ewa.bgT.prototype={A:null,bU:null,y:null,I:function(){this.A.checked?_Ewa.a.c(this.A,!1):_Ewa.a.c(this.n(0).get_element(),!1)}};_Ewa.nQ=function(n,t,i,r,u){_Ewa.nQ.initializeBase(this,[n,t,i,r,u,!1])};_Ewa.nQ.b=function(n){return String.format("<div class='ewa-dlg-body-sectionlabel'>{0}<\/div>\r\n\t<div class='ewa-dlg-bodyitem-indent'>\r\n\t\t<input type='radio' id='{1}' name='print' /> <label for='{1}'>{2}<\/label><br />\r\n\t\t<input type='radio' id='{3}' name='print' /> <label for='{3}'>{4}<\/label>\r\n\t<\/div>\r\n<\/div>",_Ewa.ClientStringManager.a().a(1051),"printCurrentSelection",_Ewa.ClientStringManager.a().a(1054),"printEntireItem",n?_Ewa.ClientStringManager.a().a(1053):_Ewa.ClientStringManager.a().a(1052))};_Ewa.nQ.a=function(n){return(n.LastColumn-n.FirstColumn+1)*(n.LastRow-n.FirstRow+1)};_Ewa.nQ.prototype={b:null,e:function(){return"HtmlPrintDialog"},E:function(){Diag.a.a(51499289,0,50,"HtmlPrintDialog:Initialize - Preparing dialog for HTML Legacy print");this.R();this.bM(1050);this.K(1,0,!1,!1);_Ewa.bU.prototype.E.call(this)},bs:function(){var n=this;return function(t,i){return _Ewa.jc.e(n.B.d().a(),n.y,n.bB(t),n.bt(i),n.bU,null)}},O:function(){return this.z(),!0},L:function(n,t,i){var r=n.Result,u,f,e;r&&(u=t,u&&(f=0,e=0,r.SelectedRanges&&r.SelectedRanges.Ranges&&r.SelectedRanges.Ranges.length>0&&r.SelectedRanges.Ranges[0]&&(f=Math.min(_Ewa.nQ.a(r.SelectedRanges.Ranges[0]),65535)),r.UsedRange&&(e=Math.min(_Ewa.nQ.a(_Ewa.g.w(_Ewa.g.b(r.UsedRange))),65535)),u.k=f,u.p=e));this.y=r;_Ewa.bjx.prototype.L.call(this,n,t,i)},I:function(){this.b.checked?_Ewa.a.c(this.b,!1):_Ewa.bgT.prototype.I.call(this)},R:function(){this.D.innerHTML=_Ewa.nQ.b(this.B.c().b());this.A=_Ewa.a.a(this.D,"printCurrentSelection");this.b=_Ewa.a.a(this.D,"printEntireItem");this.y.Type&&this.y.UseSelection?(this.A.checked=!0,this.b.disabled=!this.y.SheetName):(this.b.checked=!0,this.A.disabled=!this.y.Type||!_Ewa.b.a(this.B).a().a().d())},z:function(){var n,t;Diag.a.a(51499290,0,50,"HtmlPrintDialog:CommitWithGenerateHtml - CommitWithGenerateHtml called");n=new Sys.StringBuilder;this.Q(n);t=String.format("location=0,scrollbars=1,resizable=1,menubar=1,toolbar={0},status=0",Common.c.b()?0:1);_Ewa.i.f(n.toString(),"",t,"PrintDialog.PrintViewUrl")||Diag.a.a(51499291,0,10,"HtmlPrintDialog:CommitWithGenerateHtml - A browser blocked the xlprintview.aspx page!")},Q:function(n){var i=this.B.e(),r,t,u,f;n.append(this.B.bh()+i.LayoutsRelativeUri+"/xlprintview.aspx?");_Ewa.bf.a(n,"sessionId",this.y.SessionId);_Ewa.bf.a(n,"useSelection",this.A.checked?"1":"0");this.y.Type?(this.y.UsedRangeTooBig||(r=_Ewa.g.b(this.y.UsedRange),t=_Ewa.g.l(r,this.y.SheetName,!1,!1,!1),t&&_Ewa.bf.a(n,"usedRange",t)),this.y.Type===1?_Ewa.bf.a(n,"imageId",this.y.ObjectId):(u=_Ewa.g.r(this.y.SelectedRanges.Ranges[0]),f=_Ewa.g.l(u,this.y.SheetName,!1,!1,!1),_Ewa.bf.a(n,"selectedRange",f))):_Ewa.bf.a(n,"chartSheet",this.y.ObjectId);_Ewa.X.b(n,i);_Ewa.bf.a(n,"title",this.y.Title)}};_Ewa.bS=function(n,t,i,r,u,f,e,o){this.bZ=Function.createDelegate(this,this.ev);this.ca=Function.createDelegate(this,this.ew);this.bY=Function.createDelegate(this,this.dC);this.bX=Function.createDelegate(this,this.dB);this.bJ=Function.createDelegate(this,this.dA);this.bp=Function.createDelegate(this,this.dD);this.cX=Function.createDelegate(this,this.et);this.cY=Function.createDelegate(this,this.eu);_Ewa.bS.initializeBase(this,[n,t,i,r,u,n.a(544)]);this.bV=f;this.cb=this.B.j().p().toString();this.y.SelectedRanges&&this.y.SelectedRanges.Ranges&&this.y.SelectedRanges.Ranges.length>0&&this.y.SelectedRanges.Ranges[0]&&(this.cz=_Ewa.g.r(this.y.SelectedRanges.Ranges[0]).toString());this.cW=e;this.bA=o;this.bT={};for(var s=0,h=_Ewa.bS.b.length;s<h;++s)this.bT[_Ewa.bS.b[s].toString()]=s;this.cy=window.navigator.browserLanguage||window.navigator.language||this.B.e().UICultureTag};_Ewa.bS.a=function(n,t){var i=document.createElement("div");return!n||!n.length||(i.className=n),t&&(i.innerHTML=_Ewa.ClientStringManager.a().a(t)),i};_Ewa.bS.c=function(n,t,i,r,u,f,e,o){var s=document.createElement("input"),h,a,c,l;s.setAttribute("type","radio");s.setAttribute("id",i);s.setAttribute("name",u);s.setAttribute("aria-labelledby",o+" "+e);s.style.height="16px";s.style.width="16px";t?s.style.marginRight="0px":s.style.marginLeft="0px";n.appendChild(s);h=document.createElement("label");h.setAttribute("for",i);h.style.position="relative";n.appendChild(h);a=Common.D.a(32,32,f,"PrintRadioButtonIcon",!0,_Ewa.ClientStringManager.a().a(r));c=_Ewa.bS.a("PrintRadioButtonElementInnerDiv",r);c.setAttribute("id",e);c.setAttribute("aria-hidden",!0);l=_Ewa.bS.a("PrintRadioButtonElementOuterDiv",0);l.appendChild(c);h.appendChild(l);h.appendChild(a)};_Ewa.bS.prototype={bA:null,bT:null,S:null,Q:null,bW:!1,ba:null,bc:null,bb:null,bj:null,bk:1,Y:1,z:0,dp:!1,bq:1,b:null,bI:0,bH:0,cy:null,R:null,U:null,bV:null,cz:null,cb:null,bG:0,bS:null,bR:null,cW:null,e:function(){return"PdfPrintDialog"},E:function(){this.F()?this.ee(880,null):(this.H(),this.bM(880));_Ewa.bU.prototype.E.call(this)},dispose:function(){this.eD();_Ewa.bjx.prototype.dispose.call(this)},c:function(n){if(Diag.a.a(591196544,0,50,"PdfPrintDialog.Close: User changed printSettings {0} times before exiting dialog {1} printing done",this.bG,n?"without":"with"),this.eA(),this.b){var t=this.du();!this.bW&&!this.Q.checked&&this.B.k()&&this.dv(t)&&this.ez(t)}_Ewa.bU.prototype.c.call(this,n)},bs:function(){var n=this;return function(t,i){return _Ewa.jc.a(n.B.d().a(),n.B.f().a().a,n.cy,n.bB(t),n.bt(i),null,null)}},L:function(n,t,i){this.b=n.Result;this.bI=this.b.ScalingWidth;this.bH=this.b.ScalingHeight;this.dt();this.dw();_Ewa.bjx.prototype.L.call(this,n,t,i)},H:function(){Diag.a.a(51499292,0,50,"PdfPrintDialog:InitializeDialogElements - Preparing dialog for Print Pdf");this.dx();_Ewa.bU.prototype.H.call(this)},O:function(){return this.dq(),!0},I:function(){this.F()?_Ewa.bU.c(this.S):this.S.checked?_Ewa.a.c(this.S,!1):_Ewa.bgT.prototype.I.call(this)},dy:function(){switch(this.bA.a){case 1:this.S.checked=!0;break;case 0:this.A.disabled?this.S.checked=!0:this.A.checked=!0;break;case 2:this.Q.checked=!0;break;default:Diag.a.a(595194763,0,10,"Invalid what to print state {0}. Resetting to defaults.",this.bA.a);this.bA.c(1);this.S.checked=!0}return},eA:function(){this.bA.c(this.cw())},dt:function(){(this.b.ScalingPercent!==100||this.b.FitToPage&&(this.b.ScalingWidth>1||this.b.ScalingHeight>1))&&(this.bW=!0,this.b.ScalingWidth=1,this.b.ScalingHeight=0,this.b.ScalingPercent=100,this.b.FitToPage=!0);this.b.PaperSize.toString()in this.bT||(this.bW=!0,this.b.PaperSize=this.b.PaperSize===13?34:9)},dw:function(){this.bk=this.b.IsLandscape?2:1;this.z=this.b.FitToPage?this.b.ScalingWidth===1&&this.b.ScalingHeight===1?1:this.b.ScalingWidth||this.b.ScalingHeight!==1?2:3:0;this.Y=this.b.PaperSize;this.cx(this.Q.checked?!0:!1);this.cA(this.Q.checked?!0:!1)},ds:function(n){var t,i,r,u;for(this.U=document.createElement("select"),this.U.style.width="224px",this.U.style.height="32px",this.U.setAttribute("aria-labelledby","scalingElementId"),this.bj=new _Ewa.da(this.U,!0),t=0,i=_Ewa.bS.d.length;t<i;++t)r=_Ewa.ClientStringManager.a().a(_Ewa.bS.g[t]),u=this.bj.c(r,_Ewa.bS.d[t].toString(),!1,null);n.appendChild(this.U)},dr:function(n){var t,i,r;for(this.R=document.createElement("select"),this.R.style.width="224px",this.R.style.height="32px",this.R.setAttribute("aria-labelledby","paperSizeElementId"),this.bb=new _Ewa.da(this.R,!0),t=0,i=_Ewa.bS.b.length;t<i;++t)r=_Ewa.ClientStringManager.a().a(_Ewa.bS.f[t]),this.bb.c(r,_Ewa.bS.b[t].toString(),!1,null);n.appendChild(this.R)},du:function(){var n={};return n.IsLandscape=this.bk===2,n.PaperSize=this.Y,n.ScalingWidth=this.bI,n.ScalingHeight=this.bH,n.ScalingPercent=100,n.FitToPage=this.z?!0:!1,n},dn:function(){var n=new Sys.StringBuilder;return n.append(_Ewa.nl.a(this.B,"Pdf",!0)),this.bV.a()&&_Ewa.bf.a(n,"una","1"),_Ewa.bf.a(n,"wtp",""+this.bq),_Ewa.bf.a(n,"ssn",this.B.f().a().a),this.bq||(_Ewa.bf.a(n,"srange",this.cz),_Ewa.bf.a(n,"acell",this.cb)),_Ewa.bf.a(n,"ori",""+this.bk),_Ewa.bf.a(n,"psz",""+this.Y),_Ewa.bf.a(n,"scl",""+this.z),_Ewa.bf.a(n,"rv",this.B.a(342)?"1":"0"),this.B.isChangeGateEnabled("VSO:4381415_IgnorePrintAreaPrintSetting")&&_Ewa.bf.a(n,"ipa",this.dp?"1":"0"),Diag.a.a(51499296,0,50,"PdfPrintDialog: Print Pdf Url {0}",n.toString()),n.toString()},dz:function(){var r=12e4,t=null,n,i;Diag.a.a(51676162,0,50,"PdfPrintDialog:InvokeGetFileCopyFileHandler - Invoking GetFileCopyFileHandler");n=this;i=function(i,u){var f=new _Ewa.hs(i,null,u,null,!0,!1,"GetFileCopyFileHandler","","",!1);return f.e=Common.z.a().a,t=f,Common.a.d.d(n.dn(),1,null,null,_Ewa.bS.e,!1,2,n.cY,n.cX,t,null,!1,null,r,null,null,!1,null,!1,null,null),$$sc.a.a(Boolean,!0)};this.B.g().a(new _Ewa.F(223,0,i,16,null),null)},dx:function(){Diag.a.a(51499293,0,50,"PdfPrintDialog:InitializeForPrintPdf - Preparing full print pdf dialog");this.ex(this.D);this.cx(!0);this.cA(!0);this.A=_Ewa.a.a(this.D,"printCurrentSelection");this.S=_Ewa.a.a(this.D,"printActiveSheet");this.Q=_Ewa.a.a(this.D,"printEntireWorkbook");this.eC()&&(this.A.disabled=!0,this.y.SheetName=this.cW);this.dy();this.ey()},eC:function(){return!!this.y.ObjectId||!_Ewa.b.a(this.B).a().a().d()},ey:function(){Common.o.a().a("change",this.S,this.bp);Common.o.a().a("change",this.Q,this.bp);Common.o.a().a("change",this.A,this.bp);Common.o.a().a("change",this.ba,this.bJ);Common.o.a().a("change",this.bc,this.bJ);Common.o.a().a("change",this.R,this.bX);Common.o.a().a("change",this.U,this.bY);this.B.isChangeGateEnabled("OfficeVSO:4342264_PreviewerPerfOptimizationTelemetry")&&(Common.o.a().a("focus",this.U,this.ca),Common.o.a().a("focus",this.R,this.bZ))},dD:function(){return this.bG++,this.bq=this.cw(),this.cx(this.Q.checked?!0:!1),this.cA(this.Q.checked?!0:!1),Diag.a.a(595194762,0,50,"PdfPrintDialog:OnChangeWhatToPrint What to print option changed to {0}",this.bq.toString()),!0},dA:function(){return this.bG++,this.bk=this.dm(),Diag.a.a(595079450,0,50,"PdfPrintDialog:OnChangeOrienation orientation option changed to {0}",this.bk.toString()),!0},dB:function(){this.bR&&(this.bR.a(),this.bR=null);this.bG++;var n=this.Y;return this.Y=_Ewa.bS.b[this.bb.a.selectedIndex],Diag.a.a(595079449,0,50,"PdfPrintDialog:OnChangePaperSize paperSize option changed from {0} to {1}",n.toString(),this.Y.toString()),!0},dC:function(){this.bS&&(this.bS.a(),this.bS=null);this.bG++;var n=this.z;return this.z=_Ewa.bS.d[this.bj.a.selectedIndex],this.z===2?(this.bI=1,this.bH=0):this.z===3?(this.bI=0,this.bH=1):this.z===1&&(this.bI=1,this.bH=1),Diag.a.a(595079448,0,50,"PdfPrintDialog:OnChangeScaling scaling option changed from {0} to {1}",n.toString(),this.z.toString()),!0},ew:function(){return this.bS=this.B.p().a("UserAction","MeasureTimeGapBetweenScalingFocusedAndChangedEvents"),Diag.a.a(589632598,0,50,"PdfPrintDialog:OnFocusScaling invoked with current selected scaling as {0}",this.z.toString()),!0},ev:function(){return this.bR=this.B.p().a("UserAction","MeasureTimeGapBetweenPaperSizeFocusedAndChangedEvents"),Diag.a.a(588395289,0,50,"PdfPrintDialog:OnFocusPaperSize invoked with current selected paperSize as {0}",this.Y.toString()),!0},eD:function(){Common.o.a().b("change",this.S,this.bp);Common.o.a().b("change",this.Q,this.bp);Common.o.a().b("change",this.A,this.bp);Common.o.a().b("change",this.ba,this.bJ);Common.o.a().b("change",this.bc,this.bJ);Common.o.a().b("change",this.R,this.bX);Common.o.a().b("change",this.U,this.bY);this.B.isChangeGateEnabled("OfficeVSO:4342264_PreviewerPerfOptimizationTelemetry")&&(Common.o.a().b("focus",this.U,this.ca),Common.o.a().b("focus",this.R,this.bZ))},ex:function(n){var p,r,t,u,s,h,c,f,l,i,e,a,v,o,y,w;Sys.UI.DomElement.addCssClass(n,"PrintDialogBody");this.F()||(p=document.getElementById("ewaDialogTitle"),Sys.UI.DomElement.addCssClass(p,"PrintDialogTitle"),r=document.getElementById("ewaDialogCloseButtonLink"),r.style.top="32px",this.bd()?r.style.left="32px":r.style.right="32px");t=_Ewa.bS.a("PrintDialogLeftContainer",0);n.appendChild(t);u=_Ewa.bS.a("PrintDialogTitleSection",1058);u.style.marginBottom="12px";u.setAttribute("id","whatToPrintTitleElementId");t.appendChild(u);s=_Ewa.bS.a("PrintDialogRadioButtonContainer",0);t.appendChild(s);_Ewa.bS.c(s,this.bd(),"printActiveSheet",1062,"whatToPrintRbName","PrintWhatExcelActiveSheets_32x32x32","activeSheetRadioButtonInnerLabelElementId","whatToPrintTitleElementId");t.appendChild(document.createElement("BR"));h=_Ewa.bS.a("PrintDialogRadioButtonContainer",0);t.appendChild(h);_Ewa.bS.c(h,this.bd(),"printEntireWorkbook",1055,"whatToPrintRbName","PrintWhatExcelEntireWorkbook_32x32x32","entireWorkbookRadioButtonInnerLabelElementId","whatToPrintTitleElementId");t.appendChild(document.createElement("BR"));c=_Ewa.bS.a("PrintDialogRadioButtonContainer",0);t.appendChild(c);_Ewa.bS.c(c,this.bd(),"printCurrentSelection",1054,"whatToPrintRbName","PrintWhatExcelSelection_32x32x32","currentSelectionRadioButtonInnerLabelElementId","whatToPrintTitleElementId");f=_Ewa.bS.a("PrintDialogTitleSection",1060);f.style.marginTop="24px";f.setAttribute("id","paperSizeElementId");t.appendChild(f);l=_Ewa.bS.a("PrintDialogComboBoxContainer",0);this.dr(l);t.appendChild(l);i=_Ewa.bS.a("PrintDialogRightContainer",0);n.appendChild(i);e=_Ewa.bS.a("PrintDialogTitleSection",1059);e.style.marginBottom="12px";e.setAttribute("id","orientationTitleElementId");i.appendChild(e);a=_Ewa.bS.a("PrintDialogRadioButtonContainer",0);i.appendChild(a);_Ewa.bS.c(a,this.bd(),"portraitRadioButtonId",1065,"orientationRbName","Portrait_32x32x32","portraitRadioButtonInnerLabelElementId","orientationTitleElementId");i.appendChild(document.createElement("BR"));v=_Ewa.bS.a("PrintDialogRadioButtonContainer",0);i.appendChild(v);_Ewa.bS.c(v,this.bd(),"landscapeRadioButtonId",1064,"orientationRbName","Landscape_32x32x32","landscapeRadioButtonInnerLabelElementId","orientationTitleElementId");o=_Ewa.bS.a("PrintDialogTitleSection",1061);o.style.marginTop="74px";o.setAttribute("id","scalingElementId");i.appendChild(o);y=_Ewa.bS.a("PrintDialogComboBoxContainer",0);this.ds(y);i.appendChild(y);this.F()||(w=document.getElementById("buttonarea"),Sys.UI.DomElement.addCssClass(w,"PrintButtonArea"));this.ba=_Ewa.a.a(this.D,"landscapeRadioButtonId");this.bc=_Ewa.a.a(this.D,"portraitRadioButtonId")},dq:function(){Diag.a.a(51499294,0,50,"PdfPrintDialog:CommitWithConvertPdf - CommitWithConvertPdf called");this.bq=this.cw();var n=this.bq!==2;n&&(this.bk=this.dm(),this.bb&&(this.Y=_Ewa.bS.b[this.bb.a.selectedIndex]),this.bj&&(this.z=_Ewa.bS.d[this.bj.a.selectedIndex]));this.dz()},eu:function(n){var t,r,i;n&&n.b&&n.b.a&&n.b.d&&n.b.a.length?(n.b.d["Content-Type"]&&_Ewa.e.c(n.b.d["Content-Type"].toString(),"application/pdf",!0)?(Diag.a.a(51676164,0,50,"PdfPrintDialog:OnFileHandlerSuccessCallback - pdf converted successfully"),t={},this.dE(t,null,null)):(t=_Ewa.H.b(n.b.a),Diag.a.a(51676165,0,15,"PdfPrintDialog:OnFileHandlerSuccessCallback - Failed to convert workbook. Error message Id: {0}",t.Errors[0].MessageId)),i=n.b.f,i.j(t,i.f,i.a)):(r=n?n.b?n.b.a?n.b.d?n.b.a.length?null:"requestSucceededEventArgs.Data.ResponseData.Length":"requestSucceededEventArgs.Data.ResponseHeaders":"requestSucceededEventArgs.Data.ResponseData":"requestSucceededEventArgs.Data":"requestSucceededEventArgs",Diag.a.a(51676163,0,10,"PdfPrintDialog:OnFileHandlerSuccessCallback - Invalid Parameter : {0}",r))},et:function(n){var i=_Ewa.X.a(n.b),t;Diag.a.a(51676166,0,15,"PdfPrintDialog:OnFileHandlerFailureCallback has failed - Errors: [{0}]",_Ewa.h.a(i,","));t=n.b.f;t.i(n,t.f,t.a)},cx:function(n){this.bc.disabled=n;this.ba.disabled=n;this.bb.a.disabled=n;this.bj.a.disabled=n},cA:function(n){n?(this.ba.checked=!1,this.bc.checked=!1,this.bb.e(-1),this.bj.e(-1)):(this.bk===2?this.ba.checked=!0:this.bc.checked=!0,this.bb.e(this.bT[this.Y.toString()]),this.bj.e(this.z))},ez:function(n){Diag.a.a(595079447,0,50,"PdfPrintDialog:SavePrintSettingsToFile - We should make a set SheetPrintSettings call here to set print Settings.");var t=this.B.f().a().a,e=this,i=function(){return new _Ewa.NG(t,n)},r=this.B.d().a().b(!1),u=this,f=function(i,f){return _Ewa.jc.b(u.B.d().a(),t,n,i,f,r,null)};this.B.g().a(new _Ewa.F(226,0,f,0,i),null)},dv:function(n){return this.b.IsLandscape!==n.IsLandscape||this.b.PaperSize!==n.PaperSize||this.b.FitToPage!==n.FitToPage||this.b.ScalingHeight!==n.ScalingHeight||this.b.ScalingWidth!==n.ScalingWidth?!0:!1},dm:function(){return this.ba&&this.ba.checked?2:(this.bc&&this.bc.checked,1)},cw:function(){return this.A.checked?0:this.S.checked?1:this.Q.checked?2:1},dE:function(n){if(n.Errors&&n.Errors.length>0){Diag.a.a(51499295,0,50,"PdfPrintDialog: Failed to convert workbook. Error message Id: {0}",n.Errors[0].MessageId);return}this.bU.b===6&&Common.a.b().b().b(_Ewa.b.a(this.B).cW());this.bV.b(this.dn(),!1,null)}};_Ewa.xZ=function(n,t){this.c(n);this.d(t)};_Ewa.xZ.prototype={a:0,b:!1,c:function(n){return n>=0&&n<=2?this.a=n:(Diag.a.a(595194761,0,10,"Attempt to set invalid state. Setting ActiveSheets instead."),this.a=1),n},d:function(n){return n||!n?this.b=n:Diag.a.a(588777489,0,10,"Attempt to set invalid ignorePrintArea"),n}};_Ewa.Qe=function(n,t){this.b=n;this.c=n.c();this.f=t;this.e=new _Ewa.xZ(1,this.h);this.g=new _Ewa.qL(n,t);(this.b.a(844)||this.b.a(865))&&(this.b.b().b(_Ewa.xY,384,this),this.d=0)};_Ewa.Qe.prototype={b:null,c:null,f:null,e:null,g:null,h:!1,d:0,a:function(){return this.d},z:function(){return!1},x:function(n,t){return t.j=!0,this.i(t)?$$sc.a.a(Boolean,!0):_Ewa.L.a(t.a)},w:function(n,t){return this.b.Y()?!1:this.b.l().IsPasswordProtected?!1:t.a===1588554917},y:function(){return!1},i:function(n){return this.b.c().a()?this.j(n):!1},j:function(n){var a,v,o,u,p,w,b,k,d;Diag.a.a(21099871,0,50,"PrintCommandHandler:DoPrintHtml");var s=this.b.p().a("UserAction","DoPrintHtml"),i=this.b,f=this.c.b()?i.n().a().c():i.f().a().a,h=!this.c.b()&&i.a(95),t=null;if(this.b.isChangeGateEnabled("OfficeVSO:4250589_RefactorDoPrintHtmlToReduceComplexity"))t=this.k(i,f,h);else{t={};t.SessionId=this.c.j();t.UsedRangeTooBig=!1;var l=_Ewa.b.a(i),r=l.a(),e=r.c();if(_Ewa.z.e(i.j()))t.Type=0,t.ObjectId=i.j().a,t.UseSelection=!1;else if(_Ewa.z.j(i.j()))t.Type=1,t.ObjectId=i.j().i,t.UseSelection=!0;else if(e===2||e===4||e===64)a=r.b().a().a(),t.Type=1,t.SheetName=f,t.ObjectId=a.b,t.UseSelection=!0;else if(h&&e&470)v=r.b().a().a(),t.ObjectId=v.b,t.SheetName=f;else if(_Ewa.z.d(i.j())){if(t.Type=2,t.SheetName=f,r.a().d()){var y=2,c=r.a().b();if(t.SelectedRanges=_Ewa.g.e(c,i),c.A()>20)t.UseSelection=!0;else{o=0;u=l.q("PrintCommandHandler.DoPrintHtml",c,2,!0);try{for(u.$$rst();u.$$mn()&&o<y;)p=u.$$cu(),_Ewa.e.a(p.c())||o++;t.UseSelection=o>=y}finally{u&&u.dispose()}}}else t.UseSelection=!1,t.SelectedRanges=_Ewa.g.e(r.a().e(),i);this.c.b()&&(t.UsedRange=_Ewa.g.a(i.j().b,i))}t.Title=i.l().WorkbookFileName}return w=this.b.a(720)&&!Common.c.n()&&!(_Ewa.bn.a(this.b.e(),25)&&this.b.isChangeGateEnabled("OfficeVSO:4427359_DisableForUIEmbedMode")),h?w?(this.g.k(t,this.e),Diag.a.a(591196515,0,50,"PrintCommandHandler:DoPrintHtml Print previewer opened")):(b=new _Ewa.bS(this.b,_Ewa.ClientStringManager.a().a(1056),3,t,n,this.f,f,this.e),b.x(!1),Diag.a.a(595194760,0,50,"PrintCommandHandler:DoPrintHtml Print dialog shown in pdf mode in {0} ms.",s.b())):(k=new _Ewa.nQ(this.b,_Ewa.ClientStringManager.a().a(1056),3,t,n),k.x(!1),Diag.a.a(591196514,0,50,"PrintCommandHandler:DoPrintHtml Print dialog shown in html mode in {0} ms.",s.b())),s.a(),(this.b.a(844)||this.b.a(865))&&(this.d++,d=_Ewa.b.a(this.b).b(),this.d===1&&d.e()&&this.l()),!0},k:function(n,t,i){var r={},c,l,o,f,v;r.SessionId=this.c.j();r.UsedRangeTooBig=!1;var h=_Ewa.b.a(n),u=h.a(),e=u.c();if(_Ewa.z.e(n.j()))r.Type=0,r.ObjectId=n.j().a,r.UseSelection=!1;else if(_Ewa.z.j(n.j()))r.Type=1,r.ObjectId=n.j().i,r.UseSelection=!0;else if(e===2||e===4||e===64)c=u.b().a().a(),r.Type=1,r.SheetName=t,r.ObjectId=c.b,r.UseSelection=!0;else if(i&&e&470)l=u.b().a().a(),r.ObjectId=l.b,r.SheetName=t;else if(_Ewa.z.d(n.j())){if(r.Type=2,r.SheetName=t,u.a().d()){var a=2,s=u.a().b();if(r.SelectedRanges=_Ewa.g.e(s,n),s.A()>20)r.UseSelection=!0;else{o=0;f=h.q("PrintCommandHandler.DoPrintHtml",s,2,!0);try{for(f.$$rst();f.$$mn()&&o<a;)v=f.$$cu(),_Ewa.e.a(v.c())||o++;r.UseSelection=o>=a}finally{f&&f.dispose()}}}else r.UseSelection=!1,r.SelectedRanges=_Ewa.g.e(u.a().e(),n);this.c.b()&&(r.UsedRange=_Ewa.g.a(n.j().b,n))}return r.Title=n.l().WorkbookFileName,r},l:function(){for(var f,n,i=_Ewa.b.a(this.b).b(),r=i.p(),u=!1,t=0;t<r.length;t++)f=r[t],n=f.a(),n&&n.hasPageLayout()&&(u=!0,n.setDirty());u&&i.H()}};_Ewa.yb=function(n){_Ewa.yb.initializeBase(this,[n])};_Ewa.yb.a=function(n){_Ewa.Z.a(73,new _Ewa.yb(n))};_Ewa.yb.prototype={g:function(){var n=Common.a.a.j.g,t;this.a.a(95)&&(t=this.a.e().DirectPrintSetting,n.DirectPrintIsEnabled=t.DirectPrintIsEnabled.toString(),n.DirectPrintProbeIsEnabled=t.DirectPrintProbeIsEnabled.toString(),n.DirectPrintEnabledForInternetExplorer=t.DirectPrintEnabledForInternetExplorer.toString(),n.DirectPrintSupportedMimeTypes=t.DirectPrintSupportedMimeTypes,n.DirectPrintSupportedPlugins=t.DirectPrintSupportedPlugins,n.DirectPrintImmersivePreviewPlugins=t.DirectPrintImmersivePreviewPlugins,n.DirectPrintMinimalSupportedEdgeVersion=t.DirectPrintMinimalSupportedEdgeVersion,n.DirectPrintEnabledForEdge=t.DirectPrintEnabledForEdge.toString());var i=new Common.App.DirectPrint.b(n),u=this,r=new Common.App.DirectPrint.a(i,window.navigator.mimeTypes,window.navigator.plugins,Common.App.DirectPrint.a.b,Common.App.DirectPrint.a.c,new Common.App.DirectPrint.c(Common.a.b().j()),Common.a.b().c(),Common.App.DirectPrint.a.d,function(n,t){return new CADWLTR.c(n,!1,t)},!1);this.f([new _Ewa.Qe(this.a,r)],null)}};_Ewa.Qd=function(n,t){this.b=n;this.a=t};_Ewa.Qd.prototype={b:null,a:null,z:function(n,t){var i=!1;switch(t){case 78661008:case-13332329:i=!this.a.a(866)}return i},x:function(n,t){var i=!1,r=t.a;switch(r){case 78661008:this.d(t);i=!0;break;case-13332329:this.c(t);i=!0}return i?$$sc.a.a(Boolean,!0):_Ewa.L.a(r)},w:function(n,t){switch(t.a){case 78661008:case-13332329:return!0}return!1},y:function(){return!1},d:function(){var n=_Ewa.g.d(_Ewa.b.a(this.a).a().a().c(),this.a),f=this,t=function(){return new _Ewa.Nx(n,!1)},i=this.a.d().a(),e=this,r=function(t,r){return _Ewa.jc.d(i,n,!1,t,r,null,null)},o=this,u=function(n){return new _Ewa.F(243,0,n,0,t)};_Ewa.M.a(this.a.g(),r,u,null)},c:function(){var n=this,t=function(){return new _Ewa.Nw(n.a.f().a().a)},i=this.a.d().a(),r=this,u=function(n,t){return _Ewa.jc.c(i,r.a.f().a().a,n,t,null,null)},e=this,f=function(n){return new _Ewa.F(243,0,n,0,t)};_Ewa.M.a(this.a.g(),u,f,null)}};_Ewa.ya=function(n){_Ewa.ya.initializeBase(this,[n])};_Ewa.ya.a=function(n){_Ewa.Z.a(397,new _Ewa.ya(n))};_Ewa.ya.prototype={g:function(){var n=_Ewa.l.a(_Ewa.dr,this.a.b(),102,this.a.i(),this.c,null),t=this;_Ewa.f.c(_Ewa.f.ws([n],this.b(),3),function(){t.f([new _Ewa.Qd(n.a(),t.a)],null)},this.a.i())}};_Ewa.qL=function(n,t){this.w=Function.createDelegate(this,this.E);this.x=Function.createDelegate(this,this.F);this.o=new _Ewa.lR;this.n=new _Ewa.lR;this.l=n;this.z=t};_Ewa.qL.prototype={l:null,z:null,m:null,v:null,u:null,r:0,q:null,p:null,s:!1,t:!1,a:function(n){return this.t=n,n},k:function(n,t){this.p=n;this.u=this.l.j().p().toString();this.r=0;this.s=!1;this.t=!1;this.l.l().IsPrintPreviewOpened=!0;this.p.SelectedRanges&&this.p.SelectedRanges.Ranges&&this.p.SelectedRanges.Ranges.length>0&&this.p.SelectedRanges.Ranges[0]&&(this.v=_Ewa.g.r(this.p.SelectedRanges.Ranges[0]).toString());Diag.a.b(593294042,0,!this.q,"PrintPreviewManager.ShowPrintPreviewer: printSettingsManager should be null.");this.q=new _Ewa.Qg(this,this.l,t,this.l.f().a().a,_Ewa.ClientStringManager.a());Diag.a.b(593294041,0,!this.m,"PrintPreviewManager.ShowPrintPreviewer: printPreviewPane should be null.");this.m=new _Ewa.Qf(this.l,this);this.l.isChangeGateEnabled("OfficeVSO:4444457_LazyDisposalOfPrintPreviewerContainer")&&this.m.b();var i=this;this.q.q().then(function(n){n?(!n.a&&i.j()&&(Diag.a.a(591927431,0,50,"PrintPreviewManager.ShowPrintPreviewer: Falling back to ActiveSheet because current selection is a ${0}.",i.p.ObjectId?"floatingObject":"discontinuousRange"),n.a=1),_Ewa.lR.a(n,i.o),_Ewa.lR.a(n,i.n),Diag.a.b(593294040,0,!!i.m,"PrintPreviewManager.ShowPrintPreviewer: printPreviewPane should not be null"),i.m.g()):(Diag.a.a(593294039,0,10,"PrintPreviewManager.ShowPrintPreviewer: printSettings fetched from server is null."),i.dispose(),i.K())})},h:function(){return this.q.k},b:function(){return this.q.i},c:function(){return this.q.d},g:function(){return this.q.j},j:function(){return!!this.p.ObjectId||!_Ewa.b.a(this.l).a().a().d()},f:function(){var n,t=(n=new _Ewa.Qj,n.selectedWhatToPrint=1,n.selectedOrientation=1,n.selectedPaperSize=9,n.selectedScaling=2,n.selectedIgnorePrintArea=!1,n);return this.o?(t.selectedWhatToPrint=this.o.a,t.selectedOrientation=this.o.b,t.selectedPaperSize=this.o.c,t.selectedScaling=this.o.d,this.l.isChangeGateEnabled("OfficeVSO:4381415_IgnorePrintAreaPrintSetting")&&(t.selectedIgnorePrintArea=this.o.e)):Diag.a.a(593294038,0,10,"PrintPreviewManager.GetPrintSettingsSelectedOnPaneOpen: initialPrintSettings is null."),t},d:function(){var n,t=this;return n=new _Ewa.Az,n.onBackToSheet=function(){t.C()},n},e:function(){var n,t=this,i=this;return n=new _Ewa.Qh,n.onSettingChange=function(n){t.H(n)},n.onPrint=function(){i.G()},n},H:function(n){if(this.r++,!n){Diag.a.a(593294037,0,10,"PrintPreviewManager.OnPrintSettingsChange: changedPrintSettings passed as input is null.");return}this.m&&this.m.h();this.n.a=n.selectedWhatToPrint;this.n.d=n.selectedScaling;this.n.b=n.selectedOrientation;this.n.c=n.selectedPaperSize;this.n.e=n.selectedIgnorePrintArea;this.i()},C:function(){this.t&&(this.l.g().h("PrintPreviewManager.OnCloseButtonClick"),this.s=!0);Diag.a.a(591196513,0,50,"PrintPreviewManager.OnCloseButtonClick: User changed printSettings {0} times before clicking on backToWorkbook icon",this.r);this.A();this.dispose()},G:function(){Diag.a.a(591196512,0,50,"PrintPreviewManager.OnPrintButtonClick: User changed printSettings {0} times before clicking on print button.",this.r);this.A();this.m.f();this.dispose()},dispose:function(){Diag.a.b(594106396,0,!!this.m,"PrintPreviewManager.Dispose: printPreviewPane should not be null");this.m.c();this.m=null;this.p=null;this.q=null;this.l.l().IsPrintPreviewOpened=!1},i:function(){var r=12e4,t=null,n,i;Diag.a.a(593266766,0,50,"PrintPreviewManager:InvokeGetFileCopyFileHandler - Invoking GetFileCopyFileHandler");n=this;i=function(i,u){var f=new _Ewa.hs(i,null,u,null,!0,!1,"GetFileCopyFileHandler","","",!1);return f.e=Common.z.a().a,t=f,Common.a.d.d(n.y(),1,null,null,_Ewa.qL.a,!1,2,n.x,n.w,t,null,!1,null,r,null,null,!1,null,!1,null,null),$$sc.a.a(Boolean,!0)};this.l.g().a(new _Ewa.bh(223,0,i,16,null),null)},J:function(){return this.l.k()&&!!this.o&&!!this.n&&this.n.a!==2&&this.B()},I:function(){this.q.r(this.n,this.J())},y:function(){var n=new Sys.StringBuilder;return n.append(_Ewa.nl.a(this.l,"Pdf",!0)),_Ewa.bf.a(n,"wtp",""+this.n.a),_Ewa.bf.a(n,"ssn",this.l.f().a().a),this.n.a||(_Ewa.bf.a(n,"srange",this.v),_Ewa.bf.a(n,"acell",this.u)),_Ewa.bf.a(n,"ori",""+this.n.b),_Ewa.bf.a(n,"psz",""+this.n.c),_Ewa.bf.a(n,"scl",""+this.n.d),_Ewa.bf.a(n,"rv",this.l.a(342)?"1":"0"),this.l.isChangeGateEnabled("VSO:4381415_IgnorePrintAreaPrintSetting")&&_Ewa.bf.a(n,"ipa",this.n.e?"1":"0"),this.l.isChangeGateEnabled("OfficeVSO:4362441_ServeGetFileCopyFileHandlerDocumentFetchingCallFromCache")&&n.append("&#toolbar=0"),Diag.a.a(593266760,0,50,"PrintPreviewManager: Print Pdf Url {0}",n.toString()),n.toString()},F:function(n){var t,r,i;n&&n.b&&n.b.a&&n.b.d&&n.b.a.length?(n.b.d["Content-Type"]&&_Ewa.e.c(n.b.d["Content-Type"].toString(),"application/pdf",!0)?(Diag.a.a(593266764,0,50,"PrintPreviewManager:OnFileHandlerSuccessCallback - pdf converted successfully"),t={},this.D(t,null,null)):(t=_Ewa.H.b(n.b.a),_Ewa.N.a(this.l).a().h(t.Errors[0].MessageId),this.m&&this.m.a(t.Errors[0].Description.replace("&#39;","'"),!0),Diag.a.a(593266763,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - Failed to convert workbook. Error message Id: {0}",t.Errors[0].MessageId)),i=n.b.f,i.j(t,i.f,i.a)):(r=n?n.b?n.b.a?n.b.d?n.b.a.length?null:"requestSucceededEventArgs.Data.ResponseData.Length":"requestSucceededEventArgs.Data.ResponseHeaders":"requestSucceededEventArgs.Data.ResponseData":"requestSucceededEventArgs.Data":"requestSucceededEventArgs",this.m&&this.m.a(_Ewa.ClientStringManager.a().a(1048),!0),Diag.a.a(593266765,0,10,"PrintPreviewManager:OnFileHandlerSuccessCallback - Invalid Parameter : {0}",r))},E:function(n){var i=_Ewa.X.a(n.b),t,r;this.m&&this.m.a(i[0].Description.replace("&#39;","'"),!1);Diag.a.a(593266762,0,15,"PrintPreviewManager:OnFileHandlerFailureCallback has failed - Errors: [{0}]",_Ewa.h.a(i,","));t=n.b.f;t.i(n,t.f,t.a);r=this;this.l.g().f().a.e(function(){return r.s})},D:function(n){if(n.Errors&&n.Errors.length>0){Diag.a.a(593266761,0,50,"PrintPreviewManager: Failed to convert workbook. Error message Id: {0}",n.Errors[0].MessageId);return}this.m&&this.m.e(this.y())},B:function(){return!this.o.f(this.n)},A:function(){this.s||this.I();this.m.d()},K:function(){Diag.a.a(593294036,0,50,"PrintPreviewManager.ShowErrorDialog: Error Dialog displayed.");var n=_Ewa.h.b(1,0,23,0,1,-1100324317,"GetPrintSettingsFailedError"),t=new _Ewa.dc(this.l,n);t.x(!1)}};_Ewa.Qf=function(n,t){this.E=Function.createDelegate(this,this.W);this.F=Function.createDelegate(this,this.Y);this.A=Function.createDelegate(this,this.X);this.D=Function.createDelegate(this,this.V);this.i=n;this.k=t;this.i.isChangeGateEnabled("OfficeVSO:4368963_PrintPreviewPaneKeyboardAccessibility")&&this.M()};_Ewa.Qf.prototype={p:null,o:null,l:null,m:null,q:null,j:null,s:null,k:null,i:null,t:null,r:null,v:null,w:null,u:null,n:null,B:null,y:null,x:null,z:null,g:function(){this.J()},d:function(){this.m.style.display="none"},c:function(){this.i.isChangeGateEnabled("OfficeVSO:4368963_PrintPreviewPaneKeyboardAccessibility")&&this.bf();this.be();this.m=null;this.p=null;this.o=null;this.l=null;this.n=null},e:function(n){this.i.isChangeGateEnabled("OfficeVSO:4362441_ServeGetFileCopyFileHandlerDocumentFetchingCallFromCache")||(n+="&#toolbar=0");this.s=this.i.p().a("UserAction","loadPdfStopwatch");this.s||Diag.a.a(590700560,0,10,"PrintPreviewPane:LoadPdf - loadPdfStopwatch is null.");this.i.isChangeGateEnabled("OfficeVSO:4397623_AfterErrorPreviewBugFix")&&this.n&&this.C();this.j&&(this.j.src=n)},f:function(){this.j.contentWindow.print()},h:function(){this.bc();this.bd()},U:function(){this.S();this.T()},a:function(n,t){this.n||(this.l.showPreviewError(t),this.k.a(!0),this.n=_Ewa.a.a(this.m,"errorMessageId"),this.i.isChangeGateEnabled("OfficeVSO:4397623_AfterErrorPreviewBugFix")&&this.j&&(this.j.src=""));this.n.innerText!==n&&(this.n.innerText=n);this.Q()},C:function(){this.k.a(!1);this.n=null;this.l.hidePreviewError();this.R()},b:function(){this.q=document.getElementById("PrintPreviewerContainer");this.q&&this.q.parentNode&&this.q.parentNode.removeChild(this.q)},bc:function(){this.n?this.C():(this.j.style.visibility="hidden",this.i.isChangeGateEnabled("OfficeVSO:4397623_AfterErrorPreviewBugFix")||this.l.showSpinner());this.i.isChangeGateEnabled("OfficeVSO:4397623_AfterErrorPreviewBugFix")&&this.l.showSpinner()},S:function(){this.l.hideSpinner();!this.i.isChangeGateEnabled("OfficeVSO:4397623_AfterErrorPreviewBugFix")&&this.n&&this.C()},R:function(){this.o.enablePrintButton()},Q:function(){this.o.disablePrintButton()},bd:function(){this.o.showWaitCursor()},T:function(){this.o.hideWaitCursor()},V:function(){Diag.a.a(590700559,0,50,"PrintPreviewPane:OnIframeContentChange API invoked");this.U();this.j.style.visibility="visible";this.s?this.s.a():Diag.a.a(590700558,0,10,"PrintPreviewPane:OnIframeContentChange - loadPdfStopwatch is null.")},K:function(){this.m?Diag.a.a(591927430,0,10,"PrintPreviewerPane:CreatePrintPreviewerContainer - printPreviewerContainer should be null"):(this.m=document.createElement("div"),this.m.id="PrintPreviewerContainer",Sys.UI.DomElement.addCssClass(this.m,"PrintPreviewerContainer"),this.i.ba().insertBefore(this.m,this.i.ba().firstChild))},W:function(n){n.keyCode===80&&(n.ctrlKey||n.rawEvent.metaKey&&Common.c.e())&&(n.preventDefault(),n.stopPropagation())},X:function(){this.G()},Y:function(){this.H()},G:function(){this.p.enterPrintPreviewHeaderFocusTrapZone()},H:function(){this.p.enterPrintSettingsTaskPaneFocusTrapZone()},Z:function(){var n=this;this.i.b().c(_Ewa.fP,15,function(t){n.B=t;n.B.b(3)},null)},M:function(){this.z=new _Ewa.Qf.c(this);this.y=new _Ewa.Qf.b(this);this.x=new _Ewa.Qf.a(this)},bb:function(){this.z.b();this.y.b();this.x.b();this.Z()},bf:function(){this.z.c();this.y.c();this.x.c();_Ewa.b.a(this.i).be()},ba:function(){this.t=_Ewa.bJ.a().a(this.j);this.t.a("load",this.D,!1);this.i.isChangeGateEnabled("OfficeVSO:4397612_SuppressPrintKeydownEvent")&&(this.v=_Ewa.bJ.a().a(document.getElementById("printPreviewHeaderId")),this.v.a("click",this.A,!1),this.w=_Ewa.bJ.a().a(document.getElementById("printSettingsTaskPaneId")),this.w.a("click",this.F,!1),this.r=_Ewa.bJ.a().a(this.i.q()),this.r.a("keydown",this.E,!1),this.u=_Ewa.bJ.a().a(document.getElementById("previewId")),this.u.a("click",this.A,!1))},be:function(){this.t&&this.j&&this.t.b("load",!1);this.i.isChangeGateEnabled("OfficeVSO:4397612_SuppressPrintKeydownEvent")&&(this.v&&this.v.b("click",!1),this.w&&this.w.b("click",!1),this.r&&this.r.b("keydown",!1),this.u&&this.u.b("click",!1))},J:function(){var t=_Ewa.l.b(Common.bm,this.i.b(),283,284,0,null).a().a().loadScript("excelPrintPreviewer"),n=this;t.then(function(){var f=n.i.p().a("UserAction","createEmptyPreviewerStopwatch"),t,i,r,u;n.K();n.L();n.p.createEmptyPrintPreviewPane(n.m,n.N());f.a();t=n.i.p().a("UserAction","createSettingsPaneStopwatch");i=document.getElementById("printSettingsTaskPaneId");n.O();n.o.createPrintSettingsTaskPane(i,n.P());t.a();r=n.i.p().a("UserAction","createPdfPreviewPaneStopwatch");u=document.getElementById("previewId");n.I();n.l.createPrintPreview(u);r.a();n.j=_Ewa.a.a(n.m,"printpreviewiframe");n.ba();n.k.i();n.i.isChangeGateEnabled("OfficeVSO:4368963_PrintPreviewPaneKeyboardAccessibility")?n.bb():_Ewa.a.c(n.j,!1)})},L:function(){this.p||(this.p=printPreviewer.PrintPreviewPaneControllerFactoryGlobal.createPrintPreviewPaneController());this.p||Diag.a.a(591927429,0,10,"PrintPreviewerPane:CreatePrintPreviewerController - printPreviewerController should not be null")},O:function(){this.o||(this.o=excelPrintPreviewer.PrintUIControllerFactoryGlobal.createPrintSettingsTaskPaneController());this.o||Diag.a.a(591927428,0,10,"PrintPreviewerPane:CreatePrintSettingsPaneController - printSettingsPaneController should not be null")},I:function(){this.l||(this.l=excelPrintPreviewer.PrintUIControllerFactoryGlobal.createPrintPreviewController());this.l||Diag.a.a(591927427,0,10,"PrintPreviewerPane:CreatePdfPreviewPaneController - pdfPreviewerPaneController should not be null")},P:function(){var n;return n=new _Ewa.Qi,n.whatToPrintOptions=this.k.h(),n.orientationOptions=this.k.b(),n.paperSizeOptions=this.k.c(),n.scalingOptions=this.k.g(),n.selectedPrintSettingsValues=this.k.f(),n.printSettingsTaskPaneCallbacks=this.k.e(),n.logger=new UlsExternalLogger,n.ewaUtils=this.i,n.shouldDisableCurrentSelection=this.k.j(),n},N:function(){var n;return n=new _Ewa.AA,n.backActionButtonText=_Ewa.ClientStringManager.a().a(1047),n.printPreviewPaneCallbacks=this.k.d(),n.logger=new UlsExternalLogger,n}};_Ewa.Qf.b=function(n){this.a=n};_Ewa.Qf.b.prototype={a:null,b:function(){_Ewa.be.a(this.a.i).b("PP")||_Ewa.be.a(this.a.i).a(this)},c:function(){_Ewa.be.a(this.a.i).b("PP")&&_Ewa.be.a(this.a.i).c(this)},bg:function(){return"PP"},D:function(){return document.getElementById("printpreviewiframe")},by:function(){return!0},dG:function(n){return _Ewa.a.e(this.D(),n)},cE:function(){var n=this.a.i.s().Y.n;this.a.i.s().Y.b(n)},bK:function(){},P:function(n,t){return t?!1:(_Ewa.a.c(this.a.j,!1),!0)}};_Ewa.Qf.a=function(n){this.a=n};_Ewa.Qf.a.prototype={a:null,b:function(){_Ewa.be.a(this.a.i).b("PPH")||_Ewa.be.a(this.a.i).a(this)},c:function(){_Ewa.be.a(this.a.i).b("PPH")&&_Ewa.be.a(this.a.i).c(this)},bg:function(){return"PPH"},D:function(){return document.getElementById("printPreviewHeaderId")},by:function(){return!0},dG:function(n){return _Ewa.a.e(this.D(),n)},cE:function(){var n=this.a.i.s().Y.n;this.a.i.s().Y.b(n)},bK:function(){},P:function(n,t){return t?!1:(this.a.G(),!0)}};_Ewa.Qf.c=function(n){this.a=n};_Ewa.Qf.c.prototype={a:null,b:function(){_Ewa.be.a(this.a.i).b("PSTP")||_Ewa.be.a(this.a.i).a(this)},c:function(){_Ewa.be.a(this.a.i).b("PSTP")&&_Ewa.be.a(this.a.i).c(this)},bg:function(){return"PSTP"},D:function(){return document.getElementById("printSettingsTaskPaneId")},by:function(){return!0},dG:function(n){return _Ewa.a.e(this.D(),n)},cE:function(){var n=this.a.i.s().Y.n;this.a.i.s().Y.b(n)},bK:function(){},P:function(n,t){return t?!1:(this.a.H(),!0)}};_Ewa.lR=function(){};_Ewa.lR.a=function(n,t){n&&t&&(t.a=n.a,t.b=n.b,t.c=n.c,t.d=n.d,t.e=n.e)};_Ewa.lR.prototype={a:0,b:0,c:0,d:0,e:!1,f:function(n){return n?this.a===n.a&&this.b===n.b&&this.c===n.c&&this.d===n.d:!1}};_Ewa.Qg=function(n,t,i,r,u){this.l=Function.createDelegate(this,this.y);this.m=Function.createDelegate(this,this.z);_Ewa.Qg.initializeBase(this,[u]);this.p=n;this.c=i;this.b=t;this.e=r;this.f=window.navigator.browserLanguage||window.navigator.language||this.b.e().UICultureTag;this.g=this.s()};_Ewa.Qg.prototype={b:null,e:null,f:null,g:null,c:null,p:null,h:!1,q:function(){var n=null,t=null,r=this.c.a,u=this.c.b,i=this;return this.v().then(function(f){return f&&(i.x(f)?(i.h=!0,t=i.t(f)):t=f,n=new _Ewa.lR,n.a=r,n.e=u,n.b=t.IsLandscape?2:1,n.c=t.PaperSize,n.d=i.u(t)),Promise.resolve(n)})},r:function(n,t){var r,i;if(!n){Diag.a.a(593294035,0,10,"PrintSettingsManager.SavePrintSettings: printSettingsContainer passed as parameter is null");return}if(r=new _Ewa.xZ(n.a,n.e),this.B(r),!t||this.h){Diag.a.a(593294034,0,50,"PrintSettingsManager.SavePrintSettings: Saving of print settings skipped because {0}",t?"skipSaveToFile is true":"shouldFilePersistedPrintSettingsBeSaved is false");return}i=this.w(n.d);i.IsLandscape=n.b===2;i.PaperSize=n.c;this.A(i)},B:function(n){this.c.c(n.a);this.c.d(n.b)},v:function(){var n=this;return new Promise(function(t){var i=function(n){Diag.a.a(593294033,0,50,"PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings succeeded.");var i=_Ewa.T.a(n)?null:n.Result;t(i)},r=function(n){var i=_Ewa.X.a(n.b);Diag.a.a(593294032,0,10,"PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings failed. Errors: {0}.",_Ewa.h.a(i,","));t(null)};_Ewa.jc.a(n.b.d().a(),n.e,n.f,i,r,null,null)})},A:function(n){Diag.a.a(593294031,0,50,"PrintSettingsManager.SavePrintSettingsPersistedInFile: Make server call to save print settings to file");var i=this.b.d().a().b(!1),t=this,r=function(r,u){return _Ewa.jc.b(t.b.d().a(),t.e,n,_Ewa.n.a(r,t.m),_Ewa.n.b(u,t.l),i,null)};this.b.g().a(new _Ewa.F(226,0,r,0,null),null)},x:function(n){return this.n(n)||!this.o(n.PaperSize)},t:function(n){var t=n;return this.n(n)&&(Diag.a.a(593294028,0,50,"PrintSettingsManager.FixPrintSettingsNotSupportedInXlo: Custom scaling present in file."),t.ScalingWidth=1,t.ScalingHeight=0,t.ScalingPercent=100,t.FitToPage=!0),this.o(n.PaperSize)||(Diag.a.a(593294027,0,15,"PrintSettingsManager.FixPrintSettingsNotSupportedInXlo: Paper size {0} present in file which is unsupported by XLO.",n.PaperSize.toString()),t.PaperSize=n.PaperSize===13?34:9),t},u:function(n){if(n.FitToPage){if(n.ScalingWidth===1&&n.ScalingHeight===1)return 1;if(!n.ScalingWidth&&n.ScalingHeight===1)return 3}else return 0;return 2},w:function(n){var t={};return t.ScalingPercent=100,t.FitToPage=!!n,n===2?(t.ScalingWidth=1,t.ScalingHeight=0):n===3?(t.ScalingWidth=0,t.ScalingHeight=1):n===1&&(t.ScalingWidth=1,t.ScalingHeight=1),t},o:function(n){return this.g.b(n.toString())},n:function(n){return n.ScalingPercent!==100||n.FitToPage&&(n.ScalingWidth>1||n.ScalingHeight>1)},s:function(){for(var t=new($$sc.m.$$(String))($$sc.e.a()),n=0;n<this.d.length;n++)t.a(this.d[n].printSettingOptionKey.toString());return t},z:function(){Diag.a.a(593294030,0,50,"PrintSettingsManager.OnSavePrintSettingsToFileSuccess: Saving print settings to file successful.")},y:function(n){var t=_Ewa.X.a(n.b);Diag.a.a(593294029,0,10,"PrintSettingsManager.OnSavePrintSettingsToFileFailure: Save print settings to file failed. Errors: {0}.",_Ewa.h.a(t,","))}};_Ewa.bhb=function(n){this.a=n;this.C()};_Ewa.bhb.prototype={a:null,k:null,i:null,d:null,j:null,C:function(){var n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt;this.k=[(n=new _Ewa.cN,n.printSettingOptionKey=1,n.printSettingOptionText=this.a.a(1062),n),(t=new _Ewa.cN,t.printSettingOptionKey=2,t.printSettingOptionText=this.a.a(1055),t),(i=new _Ewa.cN,i.printSettingOptionKey=0,i.printSettingOptionText=this.a.a(1054),i)];this.i=[(r=new _Ewa.cN,r.printSettingOptionKey=1,r.printSettingOptionText=this.a.a(1065),r),(u=new _Ewa.cN,u.printSettingOptionKey=2,u.printSettingOptionText=this.a.a(1064),u)];this.d=[(f=new _Ewa.cN,f.printSettingOptionKey=1,f.printSettingOptionText=this.a.a(1067),f),(e=new _Ewa.cN,e.printSettingOptionKey=5,e.printSettingOptionText=this.a.a(1068),e),(o=new _Ewa.cN,o.printSettingOptionKey=6,o.printSettingOptionText=this.a.a(1074),o),(s=new _Ewa.cN,s.printSettingOptionKey=7,s.printSettingOptionText=this.a.a(1069),s),(h=new _Ewa.cN,h.printSettingOptionKey=8,h.printSettingOptionText=this.a.a(1070),h),(c=new _Ewa.cN,c.printSettingOptionKey=9,c.printSettingOptionText=this.a.a(1071),c),(l=new _Ewa.cN,l.printSettingOptionKey=11,l.printSettingOptionText=this.a.a(1072),l),(a=new _Ewa.cN,a.printSettingOptionKey=12,a.printSettingOptionText=this.a.a(1073),a),(v=new _Ewa.cN,v.printSettingOptionKey=3,v.printSettingOptionText=this.a.a(1066),v),(y=new _Ewa.cN,y.printSettingOptionKey=20,y.printSettingOptionText=this.a.a(1075),y),(p=new _Ewa.cN,p.printSettingOptionKey=27,p.printSettingOptionText=this.a.a(1076),p),(w=new _Ewa.cN,w.printSettingOptionKey=28,w.printSettingOptionText=this.a.a(1077),w),(b=new _Ewa.cN,b.printSettingOptionKey=34,b.printSettingOptionText=this.a.a(1078),b),(k=new _Ewa.cN,k.printSettingOptionKey=37,k.printSettingOptionText=this.a.a(1079),k),(d=new _Ewa.cN,d.printSettingOptionKey=43,d.printSettingOptionText=this.a.a(1080),d),(g=new _Ewa.cN,g.printSettingOptionKey=14,g.printSettingOptionText=this.a.a(1081),g)];this.j=[(nt=new _Ewa.cN,nt.printSettingOptionKey=0,nt.printSettingOptionText=this.a.a(1082),nt),(tt=new _Ewa.cN,tt.printSettingOptionKey=1,tt.printSettingOptionText=this.a.a(1083),tt),(it=new _Ewa.cN,it.printSettingOptionKey=2,it.printSettingOptionText=this.a.a(1084),it),(rt=new _Ewa.cN,rt.printSettingOptionKey=3,rt.printSettingOptionText=this.a.a(1085),rt)]}};_Ewa.jc=function(){};_Ewa.jc.e=function(n,t,i,r,u,f){var e=n.a(1,f);return e.printOptions=t,_Ewa.j.a(n,"ValidatePrint",e,i,r,u,0,null)};_Ewa.jc.b=function(n,t,i,r,u,f,e){var o=n.a(9,e);return o.sheetName=t,o.printSettings=i,_Ewa.j.a(n,"SetSheetPrintSettings",o,r,u,f,0,null)};_Ewa.jc.a=function(n,t,i,r,u,f,e){var o=n.a(1,e);return o.sheetName=t,o.locale=i,_Ewa.j.a(n,"GetPrintSettings",o,r,u,f,4,null)};_Ewa.jc.d=function(n,t,i,r,u,f,e){var o=n.a(1,e);return o.selectedRanges=t,o.addToPrintArea=i,_Ewa.j.a(n,"SetPrintArea",o,r,u,f,0,null)};_Ewa.jc.c=function(n,t,i,r,u,f){var e=n.a(1,f);return e.sheetName=t,_Ewa.j.a(n,"ClearPrintArea",e,i,r,u,0,null)};_Ewa.UX=function(){};_Ewa.AA=function(){};_Ewa.AA.prototype={backActionButtonText:null,printPreviewPaneCallbacks:null,logger:null};_Ewa.Az=function(){};_Ewa.Az.prototype={onBackToSheet:null};_Ewa.NG.registerClass("_Ewa.NG");_Ewa.Nx.registerClass("_Ewa.Nx");_Ewa.Nw.registerClass("_Ewa.Nw");_Ewa.bgT.registerClass("_Ewa.bgT",_Ewa.bjx);_Ewa.nQ.registerClass("_Ewa.nQ",_Ewa.bgT);_Ewa.bS.registerClass("_Ewa.bS",_Ewa.bgT);_Ewa.Qe.registerClass("_Ewa.Qe",null,_Ewa.kh,_Ewa.xY);_Ewa.yb.registerClass("_Ewa.yb",_Ewa.Z);_Ewa.Qd.registerClass("_Ewa.Qd",null,_Ewa.kh);_Ewa.ya.registerClass("_Ewa.ya",_Ewa.Z);_Ewa.Qf.b.registerClass("_Ewa.Qf.b",null,_Ewa.wi);_Ewa.Qf.a.registerClass("_Ewa.Qf.a",null,_Ewa.wi);_Ewa.Qf.c.registerClass("_Ewa.Qf.c",null,_Ewa.wi);_Ewa.lR.registerClass("_Ewa.lR");_Ewa.bhb.registerClass("_Ewa.bhb");_Ewa.Qg.registerClass("_Ewa.Qg",_Ewa.bhb);_Ewa.bS.b=[1,5,6,7,8,9,11,12,3,20,27,28,34,37,43,14];_Ewa.bS.f=[1067,1068,1074,1069,1070,1071,1072,1073,1066,1075,1076,1077,1078,1079,1080,1081];_Ewa.bS.d=[0,1,2,3];_Ewa.bS.g=[1082,1083,1084,1085];_Ewa.bS.e=["Content-Type"];_Ewa.qL.a=["Content-Type"];Type.registerNamespace("_Ewa");_Ewa.bgZ=function(){};_Ewa.bgZ.a=function(){_Ewa.k.a(_Ewa.yb.a);_Ewa.k.a(_Ewa.ya.a)};_Ewa.bgZ.a();Type.registerNamespace("_Ewa");_Ewa.NJ=function(n,t){this.isRow=n;this.autoFitRange=t};_Ewa.NJ.prototype={isRow:!1,autoFitRange:null};_Ewa.NK=function(n){this.resizeParameters=n};_Ewa.NK.prototype={resizeParameters:null};_Ewa.lT=function(){};_Ewa.lT.c=function(){return CommonUI.b.a(_Ewa.lT.a,_Ewa.ClientStringManager.a().a(429),_Ewa.ClientStringManager.a().a(431),_Ewa.ClientStringManager.a().a(432),_Ewa.ClientStringManager.a().a(433),"")};_Ewa.lT.b=function(){return CommonUI.b.a(_Ewa.lT.a,_Ewa.ClientStringManager.a().a(430),_Ewa.ClientStringManager.a().a(431),_Ewa.ClientStringManager.a().a(432),_Ewa.ClientStringManager.a().a(434),"")};_Ewa.fB=function(n,t){this.k=Function.createDelegate(this,this.bf);this.z=Function.createDelegate(this,this.bj);this.l=Function.createDelegate(this,this.S);this.y=Function.createDelegate(this,this.bi);this.t=Function.createDelegate(this,this.bh);this.s=Function.createDelegate(this,this.bg);this.r=Function.createDelegate(this,this.be);_Ewa.fB.initializeBase(this,[t.d(),null]);this.d=t;this.b=t.l();this.h=t.f().d();this.a=n;this.w=this.b?546:1790;this.D=_Ewa.ClientStringManager.a().a(388);this.F=_Ewa.ClientStringManager.a().a(387);this.E=_Ewa.ClientStringManager.a().a(389);var i=this;_Ewa.bA.b(this.a.c(),function(n){i.v=n.b(_Ewa.S.H,!1)});Common.i.a().a("dblclick",this.dH,this.r);Common.f.a().a("msospPointerUp",this.dH.ownerDocument.body,this.s);Common.l.a().a("touchend",this.dH.ownerDocument.body,this.s);Common.c.d()||(Common.f.a().a("msospPointerDown",this.dH,this.t),Common.f.a().a("msospPointerMove",this.dH,this.y));this.a.c().a(948)?this.a.a().p(this.l):this.a.a().k(this.l);this.a.a().v(this.z);this.a.u(this.l)};_Ewa.fB.b=function(n,t){return new _Ewa.fB(n,t)};_Ewa.fB.e=function(n,t){var i,r;if(!n||!n.b(!1))return Diag.a.b(25571525,2,!1,"header after hidden headers is null"),!1;if(i=n.a(!1),r=n.b(!1).style,!i||!r)return Diag.a.b(25571526,2,!1,"header range or style is null"),!1;var u=t?i.a:i.b,f=t?r.height:r.width,e=t?1048576:16384;return u===e&&f==="0px"};_Ewa.fB.c=function(n,t,i){var u,r,f,e,o;return n?(u=n.b(!1),!u||!u.style)?(Diag.a.b(25571528,2,!1,"header after hidden element or style is null"),null):(r=document.createElement("div"),f=u.style,r.style.top=t?f.top:"0px",t||(i?r.style.right=f.right:r.style.left=f.left),Sys.UI.DomElement.addCssClass(r,t?"ewa-resizehdr-row-hidden":"ewa-resizehdr-col-hidden"),Sys.UI.DomElement.addCssClass(r,t?"ewrch-row-nosel":"ewrch-col-nosel"),e=document.createElement("div"),Sys.UI.DomElement.addCssClass(e,t?"ewr-rhc":"ewr-chc"),o=t?Number.parseInvariant(u.innerText):_Ewa.p.d(u.innerText),e.innerText=t?(o-1).toString():_Ewa.p.b(o-1),r.appendChild(e),r):(Diag.a.b(25571527,2,!1,"header after hidden is null"),null)};_Ewa.fB.f=function(n,t,i){var u,e;if(t){n.ColumnWidth=-1;n.RowHeight=i;for(var o=n.SheetMultiRange.Ranges,h=o.length,r=0;r<h;++r)u=o[r],u.FirstColumn=0,u.LastColumn=0}else{n.RowHeight=-1;n.ColumnWidth=i;for(var s=n.SheetMultiRange.Ranges,c=s.length,f=0;f<c;++f)e=s[f],e.FirstRow=0,e.LastRow=0}};_Ewa.fB.prototype={J:!1,d:null,m:!1,q:null,p:null,c:null,w:0,x:0,j:0,u:0,g:null,i:null,f:null,D:null,F:null,E:null,Q:"headerResizeTooltip",v:null,e:null,n:!1,o:!1,a:null,b:!1,h:!1,N:function(){var n=new _Ewa.bX(this.a.c().f()),t=n.a(this.b?16:8),i=this.a.c().bu();return t&&!i},Z:function(){return this.Y(),_Ewa.fB.a},dispose:function(){this.A();this.a.a()&&(this.a.c().a(948)?this.a.a().r(this.l):this.a.a().i(this.l),this.a.a().w(this.z));this.a.y(this.l);Common.i.a().b("dblclick",this.dH,this.r);Common.f.a().b("msospPointerUp",this.dH.ownerDocument.body,this.s);Common.l.a().b("touchend",this.dH.ownerDocument.body,this.s);Common.c.d()||(Common.f.a().b("msospPointerDown",this.dH,this.t),Common.f.a().b("msospPointerMove",this.dH,this.y));this.n&&(Common.f.a().b("msospPointerMove",this.dH.ownerDocument.body,this.k),Common.l.a().b("touchmove",this.dH.ownerDocument.body,this.k),this.n=!1);this.e&&(Common.f.a().b("msospPointerDown",this.e,this.t),Common.i.a().b("dblclick",this.e,this.r),this.A(),this.e=null);this.J&&(_Ewa.a.h(_Ewa.fB.a),_Ewa.fB.a=null);this.d=null;_Ewa.hR.prototype.dispose.call(this)},Y:function(){if(!_Ewa.fB.a){var n=document.getElementById("ewa-rszrbg");this.J=!0;n=_Ewa.fB.a=document.createElement("div");this.a.c().s().z().appendChild(n);n.id="ewa-rszrbg";n.className="ewa-resizerbackground";_Ewa.a.b(n,!1,!0)}},bh:function(n){if((n=_Ewa.s.a(this.a.c()).a(n),n.b===3&&!this.R(n.a))||!this.T(n,!1))return!1;Diag.a.a(25281678,2,50,"HeaderResizeBehavior.OnMouseDown: About to generate tooltip");var t=this.K(0);return this.L(n,t,!0),this.n||(Common.f.a().a("msospPointerMove",this.dH.ownerDocument.body,this.k),Common.l.a().a("touchmove",this.dH.ownerDocument.body,this.k),this.n=!0),!1},bg:function(n){var t,i,u,f,r;return(n=_Ewa.s.a(this.a.c()).a(n),n.a.button||!this.m)?!1:(_Ewa.C.a(n.a,!0),this.n&&(Common.f.a().b("msospPointerMove",this.dH.ownerDocument.body,this.k),Common.l.a().b("touchmove",this.dH.ownerDocument.body,this.k),this.n=!1),this.m=!1,t=this.a,t.k().a([this.b?13:14]),t.k().i(),this.I(),i=-1,this.c&&(i=this.o?this.B():this.c.c()),u=i!==this.j,this.q&&u&&i!==-1?(f=this.P(t),r={},r.SheetMultiRange=_Ewa.g.d(f,t.c()),_Ewa.fB.f(r,this.b,this.j),this.X(r),t.dp(!0)):(this.S(null,null),this.H()),this.o=!1,!1)},be:function(n){var i=Common.dz.a(n.d,n.c,n.a,n.b);if(i=_Ewa.s.a(this.a.c()).a(i),!this.T(i,!0))return!1;var t=this.a,r=this.P(t),u=_Ewa.g.d(r,t.c());return t.k().a([this.b?13:14]),t.k().i(),this.H(),t.c().B(this.b?146338636:1391094586,_Ewa.D.a,30,{autoFitRanges:u}),!1},bf:function(n){var t,r,f;if(n=_Ewa.s.a(this.a.c()).a(n),!this.m)return!1;if(_Ewa.C.a(n.a,!0),t=this.b,!this.g){for(this.g=document.createElement("div"),this.g.style.cssText="position: relative; width: inherit; height: inherit;"+(t?"top: 0px; ":this.h?"right: 0px:":"left: 0px:"),r=this.c.b(!1);r.nextSibling;)this.g.appendChild(r.nextSibling);r.parentNode.appendChild(this.g)}var e=t?n.get_clientPoint().y-this.p.y:(this.h?-1:1)*(n.get_clientPoint().x-this.p.x),i=t?n.get_clientPoint().y-this.q.y:(this.h?-1:1)*(n.get_clientPoint().x-this.q.x),u=this.c.c();return u===-1?!1:(e&&(this.j>0||u+i>0)&&u+i<=this.w&&(this.j=this.K(i),this.L(n,this.j,!1),_Ewa.a.M(this.c.b(!1),!t,Math.max(this.u+i,0),!1),this.g.style[t?"top":this.h?"right":"left"]=Math.max(i,-this.u)+"px",f=t?this.c.d().O():this.c.d().P(),_Ewa.a.M(this.c.d().d(),!t,f+Math.max(i,-this.u),!1),this.p=new Sys.UI.Point(n.get_clientPoint().x,n.get_clientPoint().y),_Ewa.a.b(this.e,!1,!0)),!0)},L:function(n,t,i){var o,u,f,r,e;this.f&&i&&(Diag.a.a(23666761,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement already created, creating a new element instead"),this.I());this.f||i||Diag.a.a(23666762,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement is null, creating a new element instead");this.v&&(o=this,this.v(function(){return{}}));this.f?this.M(t):(this.f=document.createElement("div"),this.f.id=this.Q,this.M(t),this.f.className="ewa-headerresize-dragtooltip",u=document.getElementById(this.a.c().m()+"msospAFrameContainer"),u.insertBefore(this.f,u.firstChild),r=_Ewa.s.a(this.a.c()).f(n.get_clientPoint()),f=this.h?Math.max(r.x-this.f.offsetWidth,0):r.x-Math.max(r.x+this.f.offsetWidth-u.offsetWidth,0),this.f.style.left=f.toString()+"px",e=document.getElementById("AppHeaderPanel"),this.f.style.top=(r.y-e.offsetHeight-this.f.offsetHeight).toString()+"px")},I:function(){_Ewa.a.h(this.f);this.f=null},M:function(n){var t=new _Ewa.yw(this.a.c().l().DxDigitNormal),i=this.b?t.c(n).toFixed(2):t.b(n).toFixed(2),r=this.b?this.D:this.F;this.f.innerText=String.format("{0} {1} ({2} {3})",r,i,n.toString(),this.E)},T:function(n,t){var i;return this.a.a().u()!==-1||n.b===2&&n.a.button||!this.G(i=this.O(n),!1)||!this.N()?!1:(_Ewa.C.a(n.a,!0),this.q=this.p=new Sys.UI.Point(n.get_clientPoint().x,n.get_clientPoint().y),this.V(i,t),!this.c)?!1:(this.m=!0,this.bd(this.c,i)&&this.bc(),_Ewa.bA.a(this.a.c()).a(_Ewa.S.G,{IsResizingHiddenHeader:this.o,IsAutoFitting:t,NumberOfSelectedRanges:this.a.a().a().f()},null,!1),this.u=this.B(),this.x=this.c.g(),this.j=this.c.c(),this.j===-1)?!1:!0},bd:function(n,t){var f=!1,e=this.c.b(!1),i,o;if(!e)return Diag.a.b(42062210,2,!1,"cell being resized element received is null"),!1;if(i=e.nextSibling,!i)return!1;var r=n.a(!1),s=this.d.c(i),u=s.a(!1);return(!r||!u)&&this.a.c().isChangeGateEnabled("OfficeVSO:4307391_ColumnResizeOnSnappingHeaders_IsResizingHidden")?(Diag.a.b(590128395,2,!1,"IsResizingHidden: range is null"),!1):(o=r.d===u.d,f=r.d+1!==u.d&&!o,f&&this.G(t,!0))},bc:function(){var i=this.c.b(!1),t=this.d.c(i.nextSibling),n;_Ewa.fB.e(t,this.b)?(this.c=t,this.i=this.c.a(!1)):(this.U(i),this.c=t,n=this.c.a(!1),this.i=this.b?new _Ewa.p(n.a-1,n.b,n.a-1,n.d,!1,!0):new _Ewa.p(n.a,n.b-1,n.c,n.b-1,!1,!0),this.o=!0)},U:function(n){var t=this.d.c(n.nextSibling),i=_Ewa.fB.c(t,this.b,this.h);i&&n.parentNode.insertBefore(i,t.b(!1))},P:function(n){var i=this.i,t=n.a().a().c(),r,u;if(n.a().a().n(i))if(this.b){if(r=this,Common.P.b(t,function(n){return n.j()}))return t}else if(u=this,Common.P.b(t,function(n){return n.m()}))return t;return[i]},B:function(){var t=this.c.b(!1),n=t.style;return Math.max(0,Math.min(this.w,0|parseInt(this.b?n.height:n.width)))},K:function(n){var i=this.a,f=this.d.f().B(),e,r,t;e=this.b?f===3?[3,2]:[1,4]:f===4?[2,4]:[1,3];r=i.i().a().b;t=this.c.c();t===-1&&(t=0);var u=this.o?Math.max(this.B(),0):Math.max(t+n,0),s=this.b?new _Ewa.W(0,this.x,r.a,u):new _Ewa.W(this.x,0,u,r.b),o=[this.b?13:14];return i.k().b(_Ewa.p.a(1,1,!1),o,!1),i.k().c(o,s,e),u},bi:function(n){if(n=_Ewa.s.a(this.a.c()).a(n),!this.N()||this.a.a().u()!==-1)return!1;if(this.m)return this.bb(),!1;var t=this.O(n);return t?(t.a.style.cursor=!this.a.m()&&this.G(t,!1)?this.b?"row-resize":"col-resize":"",_Ewa.C.a(n.a,!0),!0):!1},A:function(){if(this.q=this.p=null,this.i=null,this.g){var n=this.g.parentNode;if(n)for(n.removeChild(this.g);this.g.firstChild;)n.appendChild(this.g.firstChild);this.g=null}this.c=null;_Ewa.a.b(_Ewa.fB.a,!1,!0);this.m=!1;this.I();_Ewa.a.b(this.e,!1,!0)},O:function(n){var i,r,u;if(_Ewa.a.n(n.c,"a")||(r=this.R(n.a),r&&this.a.a().a().d()?(u=this.a.a().a().b(),i=this.d.m(_Ewa.p.a(u.c,u.d,!1),!1,!1)):i=this.d.c(n.c),!i))return null;var t=i.b(!1),f=new Sys.UI.Bounds(t.offsetLeft,t.offsetTop,t.offsetWidth,t.offsetHeight),o=_Ewa.a.i(n.c),e=new Sys.UI.Point(n.get_clientPoint().x-o.x,n.get_clientPoint().y-o.y);return this.b&&!r&&(e.y=e.y+_Ewa.i.d(n.c,t,this.h,this.a.c().isChangeGateEnabled("OfficeVSO:4071894_IeAndEdgeMisplacedEditorInRtlEnabled"),!1,!1).y),new _Ewa.fB.d(t,e,f,i.a(!1),Math.max(0,Math.min(5,(this.b?f.height:f.width)*.1)),r,!this.b&&t.getElementsByTagName("input").length>0)},G:function(n,t){if(!n||this.a.m())return!1;if(n.f)return!0;var o=n.d,u=n.b,f=this.d.f().B(),i=this.a.n(f).p(),p=!!i&&i.a===n.e.a,s=!!i&&i.b===n.e.b,w=!!i&&i.c===n.e.c&&(f===3||f===2),e,b=this.b;if(b){var h=n.c.y,c=h<=u&&!p,k=h>=o.height-u-(w?3:0);e=t?c:k||c}else{var l=n.g,r=this.h,a=n.c.x,v=a<=u&&(!s||r)&&(!l||!r),y=a>=o.width-u&&(!r||!s)&&(!l||r);e=t?r?y:v:v||y}return e},V:function(n,t){var r=this.b,u,i;if(n.f){this.c=this.d.c(n.a);!this.i&&this.c&&(this.i=this.c.a(!1));return}r&&n.c.y<=n.b&&n.d.height>n.b||!r&&n.d.width>n.b&&(!this.h&&n.c.x<=n.b||this.h&&n.c.x>=n.d.width-n.b)?(this.c=n.a.previousSibling?this.d.c(n.a.previousSibling):this.ba(),t&&Sys.UI.DomElement.containsCssClass(n.a,r?"ewrch-row-hidden":"ewrch-col-hidden")&&(u=this.d.c(n.a),u&&(i=u.a(!1),this.i=r?new _Ewa.p(i.a-1,i.b,i.a-1,i.d,!1,!0):new _Ewa.p(i.a,i.b-1,i.c,i.b-1,!1,!0)))):this.c=this.d.c(n.a);!this.i&&this.c&&(this.i=this.c.a(!1))},ba:function(){var n=this.b?1:0,i=_Ewa.bt.a(this.d.j().X+n-1,this.d.j().Y-n,this.d.j().PaneType),t=this.d.f().O(this.d.f().b().t(this.a.c().j(),i));return t?t.p():null},bb:function(){var n=this.Z();_Ewa.a.b(n,!0,!0);n.style.cursor=this.b?"ewa-rowresizer":"ewa-colresizer";this.K(0)},X:function(n){this.a.c().B(this.b?745189930:-445963340,_Ewa.D.a,30,{resizeRowColumnParameters:n})},bj:function(){this.H()},S:function(){var n,t,i,r;(_Ewa.D.a===3||Common.c.d())&&this.a.a().a().d()&&(n=this.a.a().a().b(),(n.j()||n.m())&&this.dH&&(!n.j()||!this.b||Array.contains(this.d.b(),n.a))&&(!n.m()||this.b||Array.contains(this.d.b(),n.b)))&&(t=this.a.x(n,this.d.f().B(),!1,!1),t)&&(this.e||this.W(),n.j()&&this.b?(_Ewa.a.b(this.e,!0,!0),i=t.b.b-this.e.offsetHeight/2,this.e.style.top=i+"px"):n.j()||this.b||(_Ewa.a.b(this.e,!0,!0),r=t.b.a-this.e.offsetWidth/2,_Ewa.du.a(this.e.style,this.a.d(),r+"px")))},W:function(){var n=document.createElement("div"),t,i;n.className="ewa-touch-resizer";t=document.createElement("div");t.className="clip16x16";n.appendChild(t);i=document.createElement("img");i.src=_Ewa.r.a(0);i.className=this.b?"ewa-resize-row":"ewa-resize-col";t.appendChild(i);this.d.n().a().parentNode.insertBefore(n,this.d.n().a());Common.f.a().a("msospPointerDown",n,this.t);Common.i.a().a("dblclick",n,this.r);_Ewa.a.b(n,!1,!0);this.e=n},H:function(){this.A();this.e&&(this.d.n().a().parentNode.removeChild(this.e),this.e=null)},R:function(n){return _Ewa.a.e(this.e,n.target)}};_Ewa.fB.d=function(n,t,i,r,u,f,e){this.a=n;this.c=t;this.d=i;this.e=r;this.b=u;this.f=f;this.g=e};_Ewa.fB.d.prototype={a:null,c:null,d:null,e:null,b:0,f:!1,g:!1};_Ewa.yu=function(){_Ewa.yu.initializeBase(this);this.e()};_Ewa.yu.a=function(n){n.b().b(_Ewa.wC.$$(Function),136,new _Ewa.yu)};_Ewa.yu.prototype={p:function(){this.d(_Ewa.fB.b)}};_Ewa.QP=function(n){this.a=n};_Ewa.QP.prototype={a:null,z:function(n,t){var i=!0;switch(t){case-445963340:case 1391094586:i=this.b(8);break;case 745189930:case 146338636:i=this.b(16)}return!i},x:function(n,t,i){var o=$$sc.a.a(Boolean,!1),f,r=t.a,e,v,u,s,y,c,a,d;switch(r){case 1391094586:case 146338636:f=r===1391094586;e=i.autoFitRanges;e&&e.Ranges&&e.Ranges.length||(v=_Ewa.b.a(this.a).a().a().c(),e=_Ewa.g.d(v,this.a));o=this.c(f?1:0,e,t);break;case-445963340:case 745189930:case-706918724:case 1051390410:case 369708605:case 1542466017:if(f=r===-445963340||r===-706918724||r===369708605,r===-445963340||r===745189930)u=i.resizeRowColumnParameters;else{if(s=r===369708605||r===1542466017?-2:0,y=_Ewa.b.a(this.a).a().a().c(),u={},u.SheetMultiRange=_Ewa.g.d(y,this.a),f)for(var p=u.SheetMultiRange.Ranges,b=p.length,h=0;h<b;++h)c=p[h],c.FirstRow=0,c.LastRow=0;else for(var w=u.SheetMultiRange.Ranges,k=w.length,l=0;l<k;++l)a=w[l],a.FirstColumn=0,a.LastColumn=0;u.RowHeight=f?-1:s;u.ColumnWidth=f?s:-1}o=this.d(u,t);break;case 957527587:case 2040891415:d=new _Ewa.jf(this.a,t)}return o},w:function(n,t,i,r){var u=!!i&&!!r&&r.a===1;if(u)switch(t.a){case 1391094586:case 146338636:case-445963340:case 745189930:case-706918724:case 1051390410:case 369708605:case 1542466017:case 957527587:case 2040891415:break;default:u=!1}return u},y:function(){return!1},b:function(n){return new _Ewa.bX(this.a.f()).a(n)},c:function(n,t,i){var u=this.a.d().a().b(!1),r=!n,o=this,f=function(){return new _Ewa.NJ(r,t)},e=this,s=this;return _Ewa.M.a(this.a.g(),function(n,i){return _Ewa.QR.a(e.a.d().a(),r,t,n,i,null,u)},function(n){return new _Ewa.F(135,0,n,0,f)},i)},d:function(n,t){var i=this,r=function(t,r){i.a.M();var u=_Ewa.g.s(n.SheetMultiRange.Ranges),f=_Ewa.g.k(u,",",i.a,!1,!1,!1);return _Ewa.QQ.a(i.a.d().a(),n,t,r,null,null)},f=this,u=function(){return new _Ewa.NK(n)},e=this;return _Ewa.M.a(this.a.g(),r,function(n){return new _Ewa.F(136,0,n,0,u)},t)}};_Ewa.yv=function(n){_Ewa.yv.initializeBase(this,[n])};_Ewa.yv.a=function(n){_Ewa.Z.a(113,new _Ewa.yv(n))};_Ewa.yv.prototype={g:function(){this.f([new _Ewa.QP(this.a)],null)}};_Ewa.yw=function(n){this.a=n};_Ewa.yw.prototype={a:0,c:function(n){var t=_Ewa.i.l(n);return Math.max(0,Math.min(409,t))},b:function(n){return this.g(n)},e:function(n){var t=this.d();return Math.round(this.a*n+2*t+1)},g:function(n){var t=Math.max(0,Math.min(1790,n)),i=this.d(),r=(t-i*2-1)/this.a;return Math.max(0,Math.min(255,r))},d:function(){return Math.floor(Math.max((this.a+3)/4,2))},f:function(n,t){return t?n?409:546:n?255:1790}};_Ewa.jf=function(n,t){var i,r;this.bG=Function.createDelegate(this,this.cX);this.bw=Function.createDelegate(this,this.cW);this.bv=Function.createDelegate(this,this.cV);this.R=Function.createDelegate(this,this.cU);this.bH=Function.createDelegate(this,this.cY);_Ewa.jf.initializeBase(this,[n,null,!1,!1,!1,!1]);this.b=Common.o.a();this.d=t.a===2040891415;this.Y=_Ewa.b.a(this.a);this.p=this.d?_Ewa.lT.c():_Ewa.lT.b();this.bd=new _Ewa.yw(this.a.l().DxDigitNormal);i=-1;r=this.cc();try{i=this.cd(r)}finally{r&&r.dispose()}i!==-1&&(this.bp=i.toString(),this.bu=this.cw(i),this.bt=!0);this.v=!1;this.bq=!1;var u=this.d?429:430,f=_Ewa.ClientStringManager.a().a(u),e=this.cu();this.j(f,this.bH,e);this.cx();this.e.select();Diag.a.a(21030553,0,50,"ResizeHeaders Dialog opened, isRow = {0}.",this.d)};_Ewa.jf.b=function(n,t,i){var u,e;if(t){n.ColumnWidth=-1;n.RowHeight=i;for(var o=n.SheetMultiRange.Ranges,h=o.length,r=0;r<h;++r)u=o[r],u.FirstColumn=0,u.LastColumn=0}else{n.RowHeight=-1;n.ColumnWidth=i;for(var s=n.SheetMultiRange.Ranges,c=s.length,f=0;f<c;++f)e=s[f],e.FirstRow=0,e.LastRow=0}};_Ewa.jf.prototype={d:!1,Y:null,bp:"",bu:"",e:null,Z:null,bc:null,bq:!1,bt:!1,b:null,bd:null,dispose:function(){this.bL();this.bK();_Ewa.FD.prototype.dispose.call(this)},B:function(){CommonUI.b.prototype.B.call(this);var n=document.getElementById(this.n+"WACDialogPanel");n.style.minWidth="0"},bY:function(){return"errorMessage"},cu:function(){return{resizeInput:_Ewa.jf.a?this.bp:this.bu,radioDefault:!_Ewa.jf.a,radioPx:_Ewa.jf.a}},cY:function(n,t){var r,i,u;if(n===1){if(r=this.cv(t),r){this.bZ(this.cb(r));this.da();return}this.i();_Ewa.jf.a=t.radioPx;i=this.bJ(t);u=i!==parseInt(this.bp);Diag.a.a(21030554,0,50,"ResizeHeadersDialog OK button pressed with valid input, isRow = {0}, isDefault = {1}, inputPx = {2}, inputChanged = {3}.",this.d,t.radioDefault,i,u);u&&this.ca(i)}else this.i(),Diag.a.a(21030555,0,50,"ResizeHeadersDialog Cancel button pressed, isRow = {0}.",this.d)},ca:function(n){var t={},i;t.SheetMultiRange=_Ewa.g.d(this.Y.a().a().c(),this.a);_Ewa.jf.b(t,this.d,n);i=this.d?745189930:-445963340;this.a.B(i,_Ewa.D.a,30,{resizeRowColumnParameters:t})},bJ:function(n){var i=n.resizeInput;if(!_Ewa.e.h(i))return-1;var t=parseFloat(i),r=Math.floor(t),u=n.radioDefault;return u&&t>0&&(r=this.d?_Ewa.i.be(t):this.bd.e(t)),r},cw:function(n){return n===-1?"":this.d?this.bd.c(n).toString():this.bd.b(n).toFixed(2)},cd:function(n){var t,r,i,u;if(!n||!n.$$mn()||!n.a()||(t=$$as(_Ewa.gn,n.a()),!t))return-1;for(r=this.d?t.q():t.p();n.$$mn();)if(i=$$as(_Ewa.gn,n.a()),i&&(u=this.d?i.q():i.p(),u!==r))return-1;return r},cc:function(){for(var t=new Array(0),u=this.Y.a().a().c(),f=u.length,i=0;i<f;++i){var e=u[i],n=e.g(),o=this.Y.h(),s=this.Y.n(o.c(n)),r=n.l(s.p());if(!r)return null;this.d?n.d=n.b=r.b:n.a=n.c=r.a;Array.add(t,n)}return t.length?this.Y.bl("ResizeHeadersDialog.GetActiveRowColumnLoadedRangeEnumerator",t,2,!0):null},bI:function(n){return this.bd.f(n,this.d)},cy:function(n,t){return n>=0&&n<=this.bI(t)},cv:function(n){var r=n.resizeInput,t,i;return _Ewa.e.h(r)?(t=this.bJ(n),!t&&(i=this.Y.a().a().c(),_Ewa.g.J(i)||_Ewa.g.L(i)))?3:this.cy(t,!1)?0:2:1},cb:function(n){var t="",i;switch(n){case 1:t=_Ewa.ClientStringManager.a().a(676);break;case 2:i=this.Z.checked;t=String.format(_Ewa.ClientStringManager.a().c(93),0,this.bI(i));break;case 3:t=_Ewa.ClientStringManager.a().a(677)}return t},da:function(){this.b.a("change",this.e,this.R);this.b.a("keydown",this.e,this.R);this.b.a("change",this.Z,this.R);this.b.a("change",this.bc,this.R);this.bq=!0},bL:function(){this.bq&&(this.b.b("change",this.e,this.R),this.b.b("keydown",this.e,this.R),this.b.b("change",this.Z,this.R),this.b.b("change",this.bc,this.R),this.bq=!1)},cZ:function(){this.bt&&(this.b.a("change",this.Z,this.bv),this.b.a("change",this.bc,this.bw),this.b.a("change",this.e,this.bG))},bK:function(){this.bt&&(this.b.b("change",this.e,this.bG),this.b.b("change",this.Z,this.bv),this.b.b("change",this.bc,this.bw),this.bt=!1)},cU:function(){return this.bW(),this.bL(),!1},cX:function(){return this.bK(),!1},cV:function(){return Diag.a.a(21377494,0,50,"UserInput converted to default units"),this.e.value=this.bu,!1},cW:function(){return Diag.a.a(21377496,0,50,"UserInput converted to px units"),this.e.value=this.bp,!1},cx:function(){this.Z=document.getElementById("radioDefault");this.bc=document.getElementById("radioPx");this.e=document.getElementById("resizeInput");this.cZ()}};_Ewa.QQ=function(){};_Ewa.QQ.a=function(n,t,i,r,u,f){var e=n.a(41,f);return e.resizeRowColumnParameters=t,_Ewa.j.a(n,"ResizeRowsColumns",e,i,r,u,0,null)};_Ewa.QR=function(){};_Ewa.QR.a=function(n,t,i,r,u,f,e){var o=n.a(41,e);return o.isRow=t,o.autoFitRanges=i,_Ewa.j.a(n,"AutoFit",o,r,u,f,0,null)};_Ewa.NJ.registerClass("_Ewa.NJ");_Ewa.NK.registerClass("_Ewa.NK");_Ewa.fB.registerClass("_Ewa.fB",_Ewa.hR);_Ewa.yu.registerClass("_Ewa.yu",_Ewa.qV.$$(Function));_Ewa.QP.registerClass("_Ewa.QP",null,_Ewa.kh);_Ewa.yv.registerClass("_Ewa.yv",_Ewa.Z);_Ewa.jf.registerClass("_Ewa.jf",_Ewa.FD);_Ewa.lT.a="<div class='WACDialogRow' id='HeaderResize'> <label id='resizeLabel' class='WACDialogLabel' for='resizeInput' >{0}:<\/label> <input type='text' id='resizeInput' class='WACDialogInput ewa-resizehdr-dlg-input' maxlength='5' autocomplete=\"off\"/> <\/div> <div class='WACDialogRow' id='ResizeDefaultUnitsRadio'> <input type='radio' id='radioDefault' name='units' class='WACDialogRadio ewa-resizehdr-dlg-radio' alt='{3}' title='{3}'><\/input> <label id='radioDefaultSpan' class='WACDialogLabel ewa-resizehdr-dlg-radio-label' for='radioDefault' title='{3}' >{1}<\/label> <\/div> <div class='\\''' id='ResizePxUnitsRadio'> <input type='radio' id='radioPx' name='units' class='WACDialogRadio ewa-resizehdr-dlg-radio' alt='{2}' title='{2}'><\/input> <label id='radioPxSpan' class='WACDialogLabel ewa-resizehdr-dlg-radio-label' for='radioPx'>{2}<\/label> <\/div> <div class='ewa-resizehdr-dlg-err-label WACDialogRowNoBreak' id='errorContainer'> <label id='errorMessage' class='WACDialogLabel' for='resizeLabel' role='alert' >{4}<\/label> <\/div>";_Ewa.fB.a=null;_Ewa.jf.a=!1;Type.registerNamespace("_Ewa");_Ewa.bhw=function(){};_Ewa.bhw.a=function(){_Ewa.k.a(function(n){_Ewa.yu.a(n);_Ewa.yv.a(n)})};_Ewa.bhw.a();Type.registerNamespace("_Ewa");_Ewa.QY=function(n,t){this.b=n;this.a=t};_Ewa.QY.prototype={b:null,a:null,z:function(){return!1},x:function(n,t,i){var u=t.a,r=2;switch(u){case-309686558:r=this.a.b(4246497969,2,i,null);break;case 617689800:r=this.a.b(617689800,2,i,null);break;case-1244760097:r=this.a.b(3050207199,2,i,null)}return r!==2||!t?$$sc.a.a(Boolean,!0):_Ewa.L.a(t.a)},w:function(n,t){return this.b.Y()?!1:this.b.l().IsPasswordProtected?!1:!!t&&(t.a===-1244760097||t.a===-309686558||t.a===617689800)},y:function(){return!1}};_Ewa.yJ=function(n){this.k=Function.createDelegate(this,this.l);_Ewa.yJ.initializeBase(this,[n]);this.i=n};_Ewa.yJ.a=function(n){_Ewa.Z.a(267,new _Ewa.yJ(n))};_Ewa.yJ.prototype={i:null,g:function(){var n=this;_Ewa.f.cw(_Ewa.l.a(Object,this.a.b(),155,this.b(),this.c,null),function(){n.f([new _Ewa.QY(n.i,Common.a.c())],null)},this.b(),3);Common.a.c().a(3070187925,2147483648,this.k)},l:function(n,t,i,r,u){var f=u,e;return i===1?32:n===3070187925&&i===2?(e=this.i.d().a().b(!1),_Ewa.j.w(this.i.d().a(),f[0],f[1],null,e),32):8}};_Ewa.SaveToHostManager=function(n,t){this.c=n;this.b=t;this.c.b().b(_Ewa.iP,393,this)};_Ewa.SaveToHostManager.prototype={c:null,b:null,a:function(n){switch(n){case-309686558:return this.b.d(4246497969,1,null)===8;case 617689800:return this.b.b(617689800,1,null,null)===8;case-1244760097:return this.b.b(3050207199,1,null,null)===8}return!1},dispose:function(){this.c=null}};_Ewa.yI=function(n){_Ewa.yI.initializeBase(this);this.a=n;this.e()};_Ewa.yI.a=function(n){n.b().b(_Ewa.wC.$$(_Ewa.iP),394,new _Ewa.yI(n))};_Ewa.yI.prototype={a:null,p:function(){this.d(this.a.b().a(_Ewa.iP,393,!1,null)||new _Ewa.SaveToHostManager(this.a,Common.a.c()))}};_Ewa.QY.registerClass("_Ewa.QY",null,_Ewa.kh);_Ewa.yJ.registerClass("_Ewa.yJ",_Ewa.Z);_Ewa.SaveToHostManager.registerClass("_Ewa.SaveToHostManager",null,_Ewa.iP,Sys.IDisposable);_Ewa.yI.registerClass("_Ewa.yI",_Ewa.qV.$$(_Ewa.iP));Type.registerNamespace("_Ewa");_Ewa.bhI=function(){};_Ewa.bhI.a=function(){_Ewa.k.a(_Ewa.yJ.a);_Ewa.k.a(_Ewa.yI.a)};_Ewa.bhI.a();Type.registerNamespace("_Ewa");_Ewa.NE=function(n,t){this.sheetName=n;this.value=t};_Ewa.NE.prototype={sheetName:null,value:!1};_Ewa.zh=function(n){this.a=n};_Ewa.zh.a=function(n,t,i,r){_Ewa.h.e(n.Errors)&&t.O(i,!r)};_Ewa.zh.prototype={a:null,z:function(){return!1},x:function(n,t){var e={},o,i,r,u,s,f,h;if(this.a.C(e),o=t.a,i=$$as(_Ewa.J,this.a.f().b(e.SheetName)),!i)return _Ewa.L.a(o);switch(o){case-1411193626:r=16;u=!i.P();s=_Ewa.qZ.b;h=183;f=i.P();break;case 515737500:r=4;u=!i.H();s=_Ewa.qZ.c;h=184;f=!i.H();break;case-1478455630:r=2;u=!i.r();s=_Ewa.qZ.a;h=185;f=!i.r();break;default:return _Ewa.L.a(o)}i.O(r,u);var v=this,c=function(){return new _Ewa.NE(e.SheetName,f)},l=this.a.d().a(),y=this,a=function(n,t){return s(l,e.SheetName,f,_Ewa.n.a(n,function(n){_Ewa.zh.a(n,i,r,u)}),_Ewa.n.b(t,function(){i.O(r,!u)}),null,null)},p=this;return _Ewa.M.a(this.a.g(),a,function(n){return new _Ewa.F(h,0,n,0,c)},t)},w:function(n,t){var i=!1;switch(t.a){case-1411193626:case 515737500:case-1478455630:i=!0}return i},y:function(){return!1}};_Ewa.zi=function(n){_Ewa.zi.initializeBase(this,[n])};_Ewa.zi.a=function(n){_Ewa.Z.a(100,new _Ewa.zi(n))};_Ewa.zi.prototype={g:function(){this.f([new _Ewa.zh(this.a)],null)}};_Ewa.qZ=function(){};_Ewa.qZ.b=function(n,t,i,r,u,f,e){var o=n.a(9,e);return o.sheetName=t,o.show=i,_Ewa.j.a(n,"ShowGridlines",o,r,u,f,0,null)};_Ewa.qZ.c=function(n,t,i,r,u,f,e){var o=n.a(9,e);return o.sheetName=t,o.show=i,_Ewa.j.a(n,"ShowHeadings",o,r,u,f,0,null)};_Ewa.qZ.a=function(n,t,i,r,u,f,e){var o=n.a(9,e);return o.sheetName=t,o.directionRtl=i,_Ewa.j.a(n,"ChangeSheetDirection",o,r,u,f,0,null)};_Ewa.NE.registerClass("_Ewa.NE");_Ewa.zh.registerClass("_Ewa.zh",null,_Ewa.kh);_Ewa.zi.registerClass("_Ewa.zi",_Ewa.Z);Type.registerNamespace("_Ewa");_Ewa.bic=function(){};_Ewa.bic.a=function(){_Ewa.k.a(_Ewa.zi.a)};_Ewa.bic.a();Type.registerNamespace("_Ewa");_Ewa.JR=function(n){this.selection=n};_Ewa.JR.prototype={selection:null};_Ewa.Ne=function(n){this.selection=n};_Ewa.Ne.prototype={selection:null};_Ewa.Nr=function(n){this.filterRange=n};_Ewa.Nr.prototype={filterRange:null};_Ewa.SG=function(){};_Ewa.SG.registerInterface("_Ewa.SG");_Ewa.SH=function(){};_Ewa.SH.registerInterface("_Ewa.SH");_Ewa.SK=function(){};_Ewa.SK.registerInterface("_Ewa.SK");_Ewa.biw=function(){};_Ewa.bix=function(){};_Ewa.bix.registerInterface("_Ewa.bix");_Ewa.biy=function(){};_Ewa.biy.registerInterface("_Ewa.biy");_Ewa.jm=function(){};_Ewa.jm.prototype={vertical:0,horizontal:1,horizontalRTL:2};_Ewa.jm.registerEnum("_Ewa.jm",!1);_Ewa.zy=function(){};_Ewa.zy.prototype={color:null,gradient:null,isGradient:!1,label:null};_Ewa.ds=function(){};_Ewa.ds.h=function(){return _Ewa.ds.a=0,CommonUI.b.a(_Ewa.ds.c,_Ewa.ClientStringManager.a().a(162),_Ewa.ClientStringManager.a().a(163),_Ewa.ClientStringManager.a().a(164),_Ewa.ClientStringManager.a().a(165),_Ewa.ClientStringManager.a().a(166),_Ewa.ClientStringManager.a().a(167),_Ewa.ClientStringManager.a().b(17),"")};_Ewa.ds.k=function(){return CommonUI.b.a(_Ewa.ds.f,_Ewa.ClientStringManager.a().a(177),_Ewa.ClientStringManager.a().a(179),_Ewa.ClientStringManager.a().a(180))};_Ewa.ds.i=function(){return CommonUI.b.a(_Ewa.ds.d,_Ewa.ds.b())};_Ewa.ds.j=function(){return CommonUI.b.a(_Ewa.ds.e,"0",_Ewa.oe.a(0),"1",_Ewa.oe.a(1),"2",_Ewa.oe.a(2),"3",_Ewa.oe.a(3),_Ewa.ds.b())};_Ewa.ds.l=function(){return CommonUI.b.a(_Ewa.ds.g,_Ewa.ClientStringManager.a().a(172))};_Ewa.ds.b=function(){return"tdColorOrIconDivId"+_Ewa.ds.a++};_Ewa.ri=function(){};_Ewa.ri.b=function(){return CommonUI.b.a(_Ewa.ri.a)};_Ewa.zw=function(n,t,i,r){_Ewa.zw.initializeBase(this,[n,t,i,r])};_Ewa.zw.a=function(){return _Ewa.ClientStringManager.a().a(196)};_Ewa.zw.prototype={l:function(){return 193},i:function(){return this.n()===1&&!this.k()&&!this.g()},h:function(n){return n?n.CellColors:null},a:function(n,t,i){if(this.k()){var r=new _Ewa.zy;r.isGradient=!0;r.gradient=this.k();r.label=_Ewa.zw.a();dialogControls.renderDialogColorOrIconComboBox(this.f,this.e,null,r,"colors",null,!1,t,i,32,120,_Ewa.ClientStringManager.a().a(180),null,null,null)}else _Ewa.rf.prototype.a.call(this,n,t,i)},k:function(){return Diag.a.b(595096291,0,!!this.d,"CellColorComboBoxBehavior.FillGradient.get: sortCondition is null."),this.d?this.d.FillGradient:null}};_Ewa.re=function(n,t,i,r){_Ewa.re.initializeBase(this,[n,t,i,r])};_Ewa.re.a=function(){return _Ewa.ClientStringManager.a().a(196)};_Ewa.re.prototype={b:function(){return this.k()?_Ewa.re.a():_Ewa.rg.prototype.b.call(this)},p:function(n){return n.CellColors},m:function(){return 193},j:function(){return this.r()===1&&!this.k()&&!this.i()},n:function(n){this.k()?(n.innerHTML=String.format("<svg xmlns='http://www.w3.org/2000/svg' version='1.1' width='{0}' height='{1}'>{2}<rect x='4' y='4' width='{3}' height='{4}' fill='url(#{5})' vector-effect='non-scaling-stroke' shape-rendering='geometricPrecision'/><\/svg>",100,32,_Ewa.hq.h(this.k(),this.l),92,24,"fgrad"+this.l),n.setAttribute(Common.u.a.a,_Ewa.re.a())):_Ewa.rg.prototype.n.call(this,n)},o:function(n){return n?n.CellColors:[0]},k:function(){return Diag.a.b(590975880,0,!!this.h,"CellColorComboBoxBehaviorOld.FillGradient.get: sortCondition is null."),this.h?this.h.FillGradient:null}};_Ewa.rf=function(n,t,i,r){this.f=n;this.e=t;this.d=i;this.j=r;dialogControls.renderDialogColorOrIconComboBox(this.f,this.e,null,null,"colors",null,!1,!0,!1,32,120,_Ewa.ClientStringManager.a().a(180),r,null,null)};_Ewa.rf.a=function(n){var t=new _Ewa.zy;return t.color=_Ewa.Q.c(n),t.label=_Ewa.fc.a(_Ewa.bu.a(n)),t};_Ewa.rf.b=function(n){var t=_Ewa.fc.a(_Ewa.bu.a(n));return dialogControls.colorPickerCell(n.toString(),_Ewa.Q.c(n),t)};_Ewa.rf.prototype={e:null,d:null,f:null,j:null,g:function(){return Diag.a.b(39334723,0,!!this.d,"ColorComboBoxBehavior.SortColor.get: sortCondition is null."),this.d?this.d.SortColor:0},m:function(n){return Diag.a.b(39334724,0,!!this.d,"ColorComboBoxBehavior.SortColor.set: sortCondition is null."),this.d&&(this.d.SortColor=n),n},n:function(){return Diag.a.b(39342867,0,!!this.d,"ColorComboBoxBehavior.SortConditionType.get: sortCondition is null."),this.d?this.d.SortConditionType:0},a:function(n,t,i){var u=this.g(),h=this.i()?null:_Ewa.rf.a(u),r=null,e=null,f=!1,s;if(r=this.h(n),r){e=new Array(0);for(var c=r,l=c.length,o=0;o<l;++o)s=c[o],s?e.push(_Ewa.rf.b(s)):f=!0;this.i()&&(u=f?0:r[0],h=f?null:_Ewa.rf.a(r[0]));u!==this.g()&&this.j(u.toString())}dialogControls.renderDialogColorOrIconComboBox(this.f,this.e,e,h,"colors",_Ewa.ClientStringManager.a().a(this.l()),f,t,i,32,120,_Ewa.ClientStringManager.a().a(180),this.j,_Ewa.bO.b,_Ewa.bO.c)},b:function(n,t){t&&this.m(0);var i=this.h(n);i&&Array.indexOf(i,this.g())===-1&&this.m(i[0])},c:function(n){this.m(Number.parseInvariant(n))}};_Ewa.rg=function(n,t,i,r){this.l=t;this.h=n;dialogControls.renderDialogColorOrIconPickerFlyoutAnchor(i,[],r,null,!0,"colors",null,null,null)};_Ewa.rg.a=function(n){return n?"black":"none"};_Ewa.rg.b=function(n){return n?"0.2":"none"};_Ewa.rg.c=function(n){var t=_Ewa.bu.a(n);return t.c>_Ewa.of.a.c&&t.b>_Ewa.of.a.b&&t.a>_Ewa.of.a.a};_Ewa.rg.prototype={l:0,h:null,i:function(){return Diag.a.b(590975879,0,!!this.h,"ColorComboBoxBehaviorOld.SortColor.get: sortCondition is null."),this.h?this.h.SortColor:0},q:function(n){return Diag.a.b(590975878,0,!!this.h,"ColorComboBoxBehaviorOld.SortColor.set: sortCondition is null."),this.h&&(this.h.SortColor=n),n},r:function(){return Diag.a.b(590975877,0,!!this.h,"ColorComboBoxBehavior.SortConditionType.get: sortCondition is null."),this.h?this.h.SortConditionType:0},d:function(n){var t=this,i=this;dialogControls.renderDialogColorOrIconPickerFlyoutAnchor(n,null,null,null,!1,"colors",function(){Common.n.a().f("ReactTransientUI",!0)},function(){Common.n.a().i("ReactTransientUI",!0)},null)},c:function(n,t,i){var f,r,o,e,u,c,a,v;if(Diag.a.b(590975876,0,!!n,"ColorComboBoxBehaviorOld.PopulateOptions: flyoutAnchor is null."),f=this.o(i),r=this.i(),!f){this.d(n);return}o=new Array(0);e=!1;for(var h=f,l=h.length,s=0;s<l;++s)u=h[s],u?(c=_Ewa.fc.a(_Ewa.bu.a(u)),o.push(dialogControls.colorPickerCell(u.toString(),_Ewa.Q.c(u),c))):e=!0;this.j()&&(r=e?0:f[0]);a=this;v=this;dialogControls.renderDialogColorOrIconPickerFlyoutAnchor(n,o,t,e?_Ewa.ClientStringManager.a().a(this.m()):null,!1,"colors",function(){Common.n.a().f("ReactTransientUI",!0)},function(){Common.n.a().i("ReactTransientUI",!0)},r.toString());r!==this.i()&&t(r.toString())},e:function(n,t){t&&this.q(0);var i=this.p(n);return i&&Array.indexOf(i,this.i())===-1?(this.q(i[0]),this.i().toString()):null},g:function(n){this.q(Number.parseInvariant(n))},a:function(n,t){if(!n||!t){Diag.a.b(590975875,0,!!n,"ColorComboBoxBehaviorOld.Display: comboBox is null");Diag.a.b(590975874,0,!!t,"ColorComboBoxBehaviorOld.Display: selectedElement is null");return}n.T();this.j()?this.f(n,t):this.n(t)},b:function(){return this.j()?"":this.s()},f:function(n,t){var i=_Ewa.ClientStringManager.a().a(this.m());n.c(i,"0",!0,null);_Ewa.a.L(t);t.setAttribute(Common.u.a.a,i)},n:function(n){var t=_Ewa.rg.c(this.i()),i=_Ewa.bu.a(this.i());n.innerHTML=String.format("<svg xmlns='http://www.w3.org/2000/svg' version='1.1' width='{0}' height='{1}'><rect x='4' y='4' width='{2}' height='{3}' fill='{4}' stroke='{5}' stroke-width='{6}' vector-effect='non-scaling-stroke' shape-rendering='geometricPrecision'/><\/svg>",100,32,92,24,_Ewa.Q.b(i),_Ewa.rg.a(t),_Ewa.rg.b(t));n.setAttribute(Common.u.a.a,this.s())},s:function(){return _Ewa.fc.a(_Ewa.bu.a(this.i()))}};_Ewa.SB=function(n,t,i,r){this.c=Function.createDelegate(this,this.g);_Ewa.SB.initializeBase(this,[n,null]);this.a=t;this.e=r;this.f(i)};_Ewa.SB.prototype={e:null,a:null,d:null,b:function(){return!this.a||!this.a.SortConditionType||!this.d.d(this.a.SortConditionType)?null:this.d.a(this.a.SortConditionType)},dispose:function(){this.a=null;_Ewa.YQ.prototype.dispose.call(this)},h:function(n,t,i){this.b()&&this.b().a(n,t,i)},i:function(n,t){this.b()&&this.b().b(n,t)},f:function(n){var t;this.d=(t=new($$sc.q.$$(_Ewa.Av,_Ewa.SG)),t.c(1,new _Ewa.zw(this.co(),n,this.a,this.c)),t.c(2,new _Ewa.SE(this.co(),n,this.a,this.c)),t.c(3,new _Ewa.rh(this.co(),n,this.a,this.c)),t)},g:function(n){this.b()&&(this.b().c(n),this.e(),Diag.a.a(594641886,0,50,"ColorOrIconComboBox.OnSelectionChanged"))}};_Ewa.SC=function(n,t,i,r){this.f=Function.createDelegate(this,this.m);_Ewa.SC.initializeBase(this,[n,null]);this.i=i;this.c=t;this.e=_Ewa.a.a(this.co(),"tdSelectColorOrIcon");var u="tdColorOrIconDivId"+i;this.g=_Ewa.a.a(this.co(),u);this.b=_Ewa.a.a(this.co(),"tdColorOrIconFlyoutAnchor");this.e.setAttribute(Common.u.d.a,"true");this.e.tabIndex=-1;this.d=new _Ewa.da(this.e,!0);this.k=r};_Ewa.SC.prototype={d:null,k:null,i:0,c:null,h:null,l:function(n){return this.get_isInitialized()&&this.d&&(this.d.a.disabled=n),n},e:null,b:null,g:null,a:function(){return!this.c||!this.c.SortConditionType||!this.h.d(this.c.SortConditionType)?null:this.h.a(this.c.SortConditionType)},dispose:function(){this.d=null;this.c=null;_Ewa.YQ.prototype.dispose.call(this)},initialize:function(){this.p();this.j();Sys.Component.prototype.initialize.call(this)},o:function(n){this.n(n);this.j()},n:function(n){this.a()&&this.a().c(this.b,this.f,n)},r:function(n,t){if(this.a()){var i=this.a().e(n,t);i?this.m(i):this.j()}},q:function(){this.a().d(this.b)},s:function(){this.a()&&(this.d.T(),this.a().f(this.d,this.g))},p:function(){var n;this.h=(n=new($$sc.q.$$(_Ewa.Av,_Ewa.SH)),n.c(1,new _Ewa.re(this.c,this.i,this.b,this.f)),n.c(2,new _Ewa.SF(this.c,this.i,this.b,this.f)),n.c(3,new _Ewa.SI(this.c,this.b,this.f)),n)},m:function(n){this.a()&&(this.a().g(n),this.a().a(this.d,this.g),this.b.setAttribute(Common.u.c.a,this.a().b()),this.k(),Diag.a.a(590975872,0,50,"ColorOrIconComboBoxOld.OnSelectionChanged"))},j:function(){this.a()&&(this.a().a(this.d,this.g),this.b.setAttribute(Common.u.c.a,this.a().b()))}};_Ewa.cU=function(n,t,i,r){this.fh=Function.createDelegate(this,this.gJ);this.fi=Function.createDelegate(this,this.gK);this.fg=Function.createDelegate(this,this.gI);this.fe=Function.createDelegate(this,this.gE);this.ff=Function.createDelegate(this,this.gF);this.fd=Function.createDelegate(this,this.gz);this.fj=Function.createDelegate(this,this.gQ);this.dQ=Function.createDelegate(this,this.gD);this.dR=Function.createDelegate(this,this.gL);this.dN=Function.createDelegate(this,this.gA);this.cY=Function.createDelegate(this,this.gG);this.cZ=Function.createDelegate(this,this.gH);this.dP=Function.createDelegate(this,this.gC);this.dO=Function.createDelegate(this,this.gB);this.dM=Function.createDelegate(this,this.gy);this.fc=Function.createDelegate(this,this.gu);this.bL=[];_Ewa.cU.initializeBase(this,[t,i,null]);Diag.a.b(593823835,0,!!n.ActiveCell,null);Diag.a.b(593823834,0,!!n.SelectedRange,null);Diag.a.b(41542339,0,_Ewa.g.b(n.SelectedRange).i(_Ewa.g.h(n.ActiveCell)),null);Diag.a.b(41542340,0,_Ewa.e.b(n.SelectedRange.SheetName,n.ActiveCell.SheetName,!0),null);this.bc=n.SelectedRange;this.e=this.cx=n.ActiveCell;this.dS=n.ExpandSelection;this.dc=!n.FromAutoFilter;this.da=r;this.p=_Ewa.ds.h();this.v=!1;_Ewa.b.a(this.a).r().a();_Ewa.baN.prototype.j.call(this,_Ewa.ClientStringManager.a().a(161),this.fc,null);Diag.a.a(36263243,0,50,"CustomSortDialog: Dialog opened {0}, Calling GetSortInfo. activeCell ({1}, {2}), selectedRange ({3}-{4}, {5}-{6})",n.FromAutoFilter?"from filter menu":"",this.e.FirstRow,this.e.FirstColumn,this.bc.FirstRow,this.bc.LastRow,this.bc.FirstColumn,this.bc.LastColumn)};_Ewa.cU.d=function(n){dialogControls.renderCustomSortDialogShimmer(n,!1)};_Ewa.cU.c=function(n){var t=document.getElementById("disclaimerContainer");_Ewa.a.N(t,"div");_Ewa.a.b(t,n,!0)};_Ewa.cU.e=function(n){dialogControls.renderCustomSortDialogShimmer(n,!0)};_Ewa.cU.b=function(n,t,i,r,u,f){var e=document.getElementById(n),o=Common.D.c(t,t,i,_Ewa.r.a(3),f?"ewa-customsort-dlg-icon-text":"ewa-customsort-dlg-icon","ewa-dlg-unselectable",!0,_Ewa.ClientStringManager.a().a(r),null,null);return f?e.insertBefore(o,e.firstChild):e.appendChild(o),_Ewa.cU.a(e,!0),Common.j.a(e,"click",u),e};_Ewa.cU.f=function(n,t){for(var r=new Array(n.length),i=0;i<n.length;i++)r[i]=_Ewa.hN.a(t[i],n[i]);return r};_Ewa.cU.a=function(n,t){n.disabled!==t&&(n.disabled=t)};_Ewa.cU.prototype={bp:null,bI:null,bH:null,bw:null,bv:null,b:null,Z:null,bK:!1,cv:!0,cd:!1,R:0,e:null,cx:null,bc:null,d:null,bd:0,cy:null,bq:null,bt:null,bu:!1,dc:!1,dS:null,da:null,cb:function(){return"GetSortInfo"},dF:function(){return document.getElementById("sortConditions")},eW:function(){return["sortConditionTableDiv"]},cu:function(){return _Ewa.b.a(this.a).a()},bJ:function(){return this.R?!1:this.bK},dispose:function(){this.bu||(this.bu=!0,this.bp&&(Common.j.c(this.bp,"click",this.dM),this.bp=null),this.bH&&(Common.j.c(this.bH,"click",this.dO),this.bH=null),this.bI&&(Common.j.c(this.bI,"click",this.dP),this.bI=null),this.bw&&(Common.j.c(this.bw,"click",this.cZ),this.bw=null),this.bv&&(Common.j.c(this.bv,"click",this.cY),this.bv=null),this.b&&(this.b.p(this.dN),this.b.q(this.dR),this.b.dispose(),this.b=null),isNullOrUndefined(this.bL)||(this.gp(),this.bL=null),Common.h.a().b("keydown",this.V(),this.dQ));_Ewa.baN.prototype.dispose.call(this)},bR:function(n){return n.c.tagName.toLowerCase()==="button"?!1:CommonUI.c.prototype.bR.call(this,n)},bY:function(){return"errMessage"},dE:function(){var t=this.fk(0),n=this;return function(i,r){return _Ewa.j.s(n.a.d().a(),t,n.dH(i),n.dG(r),null)}},dK:function(n,t,i){_Ewa.T.b(n,-901005882)?(_Ewa.N.a(this.a).a().h(-901005882),this.gO()):_Ewa.baN.prototype.dK.call(this,n,t,i)},dJ:function(n){var t=n.Result;this.gS(t);this.b.m()&&(Diag.a.a(592307713,0,50,"CustomSortDialog.OnInitWebMethodSuccessInner: Range contains sort conditions on fill gradient"),_Ewa.cU.c(!0));this.gU();this.dU();this.db(this.cv,this.bJ());this.dV(!1);Diag.a.a(37336265,0,50,"CustomSortDialog.OnInitWebMethodSuccessInner: GetSortInfo succeeded. is initialization call : {0}, duration: {1}, range type: {2}",!this.ca,this.cU,_Ewa.zz.a(this.bd))},dL:function(n){var t=n.Result;return _Ewa.ig.c(t)},dI:function(){return _Ewa.h.b(1,0,23,0,1,-1517197771,"CustomSortValidationError")},eY:function(){this.b.n();this.b.j()},gu:function(n){if(n===1){var t=this.b.o();if(t){this.bZ(t.a());Diag.a.a(41194904,0,50,"CustomSortDialog.CustomSortDialogHandler: Validation failed. Error: {0}",t.b());return}Diag.a.a(42006476,0,50,"CustomSortDialog.CustomSortDialogHandler: OK button pressed. Going to perform sort.");this.fl(!0);this.gM()}else this.dW(),this.fl(!1),Diag.a.a(36263244,0,50,"CustomSortDialog.CustomSortDialogHandler: Cancel button pressed");this.i()},t:function(n){CommonUI.b.prototype.t.call(this,n);this.bp=_Ewa.cU.b("addBtn",16,"ewaother_sort_add16",163,this.dM,!0);this.bI=_Ewa.cU.b("dltBtn",16,"ewaother_sort_delete16",165,this.dP,!0);this.bH=_Ewa.cU.b("copyBtn",16,"ewaother_sort_copy16",167,this.dO,!0);this.a.isChangeGateEnabled("OfficeVSO:4207862_CustomSortHighContrastIcons")?(this.bw=_Ewa.cU.b("mvupBtn",16,"ewaother_sort_reorder_up16",168,this.cZ,!1),this.bv=_Ewa.cU.b("mvdwnBtn",16,"ewaother_sort_reorder_down16",169,this.cY,!1)):(this.bw=_Ewa.cU.b("mvupBtn",16,"ewaother_sort_arrow_up16",168,this.cZ,!1),this.bv=_Ewa.cU.b("mvdwnBtn",16,"ewaother_sort_arrow_down16",169,this.cY,!1));this.dV(!0);this.db(!0,!1);_Ewa.cU.c(!1);var t=document.getElementById("sortConditionTableDiv");this.b=this.gt(t);this.b.h(this.dN);this.b.i(this.dR);Common.h.a().a("keydown",this.V(),this.dQ)},ez:function(n){Diag.a.b(42841927,0,!!n&&(n.type==="focus"||n.type==="blur"),null);return},fa:function(){this.ca||this.b.r()},eX:function(){return this.cV.i(this.dF(),this.eV(),_Ewa.cU.d,_Ewa.cU.e)},gt:function(n){return new _Ewa.rj(n,this.fj,this.a.a(848))},dV:function(n){var i=document.getElementById("sortOptionsDiv"),t=this;dialogControls.renderDialogFlyoutAnchor(i,_Ewa.ClientStringManager.a().a(170),n,String.format("{0} {1}","WACButton","ewa-customsort-dlg-button"),"ewa-customsort-dlg-options-dropdown-menu",function(i){i.innerHTML=_Ewa.ds.l();var r=_Ewa.a.a(i,"caseSensitiveDiv");dialogControls.renderDialogCheckbox(r,"caseSensitiveCheckbox",_Ewa.ClientStringManager.a().a(171),n,t.cd,t.fd);t.gP(i,n);Common.n.a().f("ReactTransientUI",!0)},_Ewa.bO.e)},db:function(n,t){var i=document.getElementById("hasHeadersDiv");dialogControls.renderDialogCheckbox(i,"hasHeadersCheckbox",_Ewa.ClientStringManager.a().a(176),n,t,this.ff)},gS:function(n){this.d=n.SortRange;this.bd=n.SortRangeType;n.SortTopToBottom&&(this.bK=n.HasHeaders,this.Z=n.HeaderRowSize);this.ca||(this.cd=n.IsCaseSensitive);this.cv=!_Ewa.ig.a(n);this.gT(n.SortTopToBottom);this.gR(n);this.go(n);this.gN(n.SortConditions)},gQ:function(n,t,i){var o=this,u=new Promise(function(n){n(!0)});n===3&&(u=_Ewa.l.b(Common.bm,this.a.b(),283,284,0,null).a().a().loadScript("excel-uiSlice20-sprite"));var r=this,e=new Promise(function(f){var e=r.gr(n,t),o=_Ewa.j.I(r.a.d().a(),e,r.gq(e,i,u),r.fe,t);Array.add(r.bL,o);f(!0)}),f=this;Promise.all([u,e]).catch(function(n){f.S&&Diag.a.a(595100099,0,10,"CustomSortDialog.SendPopulateColorsOrIconsRequest: Error occured while trying to populate color or icons {0}",n);f.cX()})},gP:function(n,t){var i=_Ewa.b.a(this.a).d(),r,u;t=t||this.bd!==2;r=[dialogControls.choiceGroupOption(_Ewa.ff.b(0),_Ewa.ff.c(0),t),dialogControls.choiceGroupOption(i?_Ewa.ff.b(2):_Ewa.ff.b(1),i?_Ewa.ff.c(2):_Ewa.ff.c(1),t)];u=_Ewa.a.a(n,"orientationDiv");dialogControls.renderDialogChoiceGroup(u,_Ewa.jm.toString(this.R),r,this.fg)},go:function(n){_Ewa.ig.a(n)&&!n.HasHeaders&&(this.d.FirstRow-=n.HeaderRowSize,this.e=_Ewa.g.c(_Ewa.g.b(this.d).e(),this.a))},dT:function(){return this.bd!==2?this.bq:this.R?this.cy:this.bt?this.bJ()?this.bq:this.bt:this.bq},gR:function(n){n.SortRangeType===2?n.SortTopToBottom?(this.bq=n.SortColumnInfoItems,n.HeaderColumnInfoItems&&(this.bt=_Ewa.cU.f(n.SortColumnInfoItems,n.HeaderColumnInfoItems))):this.cy=n.SortColumnInfoItems:this.bq=n.SortColumnInfoItems;this.b.b(this.dT())},gp:function(){for(var n=0;n<this.bL.length;n++)this.bL[n]&&this.a.d().a().h(this.bL[n].d)},gr:function(n,t){var i={};return i.ConditionType=n,i.SortTopToBottom=!this.R,i.HeaderRowSize=this.Z||0,i.RangeType=this.bd,i.Range=this.gs(t,i.SortTopToBottom),i},gs:function(n,t){var i={};return i.SheetName=this.e.SheetName,i.FirstColumn=this.d.FirstColumn,i.LastColumn=this.d.LastColumn,i.FirstRow=this.bK?this.d.FirstRow:this.d.FirstRow+(this.Z||0),i.LastRow=this.d.LastRow,t?i.FirstColumn=i.LastColumn=this.d.FirstColumn+n:i.FirstRow=i.LastRow=this.d.FirstRow+n,i},gq:function(n,t,i){var r=this;return function(u,f){var e;if(!u||_Ewa.T.a(u)){Diag.a.a.apply(null,[50671833,0,10,"CustomSortDialog.CreateOnGetSortConditionColorsOrIconsRequestSuccess: Unexpected error: {0}"].concat(u.Errors));r.a.c().r(u.Errors);r.i();return}if(r.bu||isNullOrUndefined(t)||t.h()){Diag.a.a(50671834,0,50,"CustomSortDialog.CreateOnGetSortConditionColorsOrIconsRequestSuccess: response was received after dialog is disposed or the condition was deleted");return}if(e=u.Result,!_Ewa.pB.a(e,n.ConditionType,n.RangeType,n.HeaderRowSize,n.SortTopToBottom)){Diag.a.a(50671835,0,10,"CustomSortDialog.CreateOnGetSortConditionColorsOrIconsRequestSuccess: sortConditionColorsOrIconsResult is not valid");r.cX();return}var s=f,h=e.ColumnInfo,o=e.HeaderColumnInfo;h.ColumnOffset=s;isNullOrUndefined(o)||(o.ColumnOffset=s);r.gV(n,h,o);i.then(function(){t.n()})}},gE:function(){Diag.a.a(50671836,0,10,"CustomSortDialog.OnGetSortConditionColorsOrIconsRequestFailure: GetSortConditionColorsOrIcons request failed.");this.cX()},gV:function(n,t,i){var r=t.ColumnOffset,u=n.SortTopToBottom?this.bq:this.cy;switch(n.ConditionType){case 1:u[r].CellColors=t.CellColors;i&&(this.bt[r].CellColors=_Ewa.hN.a(i,t).CellColors);break;case 2:u[r].TextColors=t.TextColors;i&&(this.bt[r].TextColors=_Ewa.hN.a(i,t).TextColors);break;case 3:u[r].Icons=t.Icons;i&&(this.bt[r].Icons=_Ewa.hN.a(i,t).Icons);break;default:Diag.a.a(50671837,0,10,"CustomSortDialog.UpdateColumnInfoCacheOnGetColorOrIconSuccess: Unexpected sort condition type.")}},gT:function(n){var t=_Ewa.ff.f(n,_Ewa.b.a(this.a).d());this.R!==t&&this.fm(t)},fm:function(n){this.R=n;this.b.s(n)},gM:function(){var n={},u;n.OperationType=1;n.SelectedRange=this.d;n.ActiveCell=this.e;n.HasHeader=this.bJ();n.GuessHeader=!1;n.IsCaseSensitive=this.cd;n.SortConditions=this.b.e();this.bd===2&&!this.R&&this.bJ()&&(n.SelectedRange.FirstRow-=this.Z);n.SortTopToBottom=!this.R||!this.b.k();var t=this,i=function(i,r){return _Ewa.rk.a(t.a.d().a(),n,_Ewa.n.a(i,t.fi),_Ewa.n.b(r,t.fh),n,null)},e=this,f=function(){return new _Ewa.Nj(n)},o=this,r=function(n){return new _Ewa.F(187,0,n,0,f)};this.a.a(359)&&this.da&&(_Ewa.b.a(this.a).e().j(this.cu().a().b(),!0)||this.bd===3)?(u=this,this.da.a().CW(function(n){var t=n.a();t&&_Ewa.M.a(u.a.g(),i,r,null)})):_Ewa.M.a(this.a.g(),i,r,null)},gO:function(){var n=this,t=new _Ewa.zx(function(t){var i={};i.ActiveCell=n.cx;i.SelectedRange=n.bc;i.ExpandSelection=t;i.FromAutoFilter=!1;n.a.B(-207540907,_Ewa.D.a,8,{SortCommandData:i})});t.d()},gy:function(n){this.cw(0,n)},gC:function(n){this.cw(1,n)},gB:function(n){this.cw(2,n)},gH:function(n){this.cw(3,n)},gG:function(n){this.cw(4,n)},cw:function(n,t){if(this.bu){Diag.a.b(36475981,0,!1,"CustomSortDialog.OnButtonClick: Dialog is disposed. Aborting operation {0}",n);return}switch(n){case 0:this.b.a(null,!0);break;case 1:this.b.d(!0,!0);break;case 2:this.b.c();break;case 3:this.b.g();break;case 4:this.b.f();break;default:Diag.a.b(36475982,0,!1,"CustomSortDialog.OnButtonClick: Unsupported operation {0}",n)}t.preventDefault();t.stopPropagation()},gD:function(n){if(this.bu)return Diag.a.b(40132938,0,!1,"CustomSortDialog.OnDialogKeyDown: Dialog is disposed. Aborting short key operation"),!1;var t=n.a.keyCode;return t===65&&n.a.shiftKey?(this.b.a(null,!0),!0):t===68&&n.a.shiftKey||t===127?(this.b.d(!0,!0),!0):t===67&&n.a.shiftKey?(this.b.c(),!0):t===38&&n.a.shiftKey?(this.b.g(),!0):t===40&&n.a.shiftKey?(this.b.f(),!0):!1},gz:function(n){this.cd=n},gI:function(n){var t=_Ewa.ff.d(n),u,i;if(this.fm(t),u=t?2:1,i=this.gw(t),Diag.a.a(42750474,0,50,"CustomSortDialog.OnOrientationChoiceGroupClick: Switching orientation mode to: {0} , isColumnInfoExist: {1}",_Ewa.jm.toString(t),i),i)this.cv=!!t||!this.bt,this.db(this.cv,this.bJ()),this.gW(t),this.b.a(null,!1),this.b.b(this.dT());else{_Ewa.baN.prototype.eZ.call(this);this.gv();var f=this.fk(u),r=this,e=function(n,t){return _Ewa.j.s(r.a.d().a(),f,r.dH(n),r.dG(t),null)},o=this;_Ewa.M.a(this.a.g(),e,function(n){return new _Ewa.F(214,0,n,16,null)},null)}},gv:function(){_Ewa.cU.a(this.bp,!0);_Ewa.cU.a(this.bI,!0);_Ewa.cU.a(this.bH,!0);_Ewa.cU.a(this.bw,!0);_Ewa.cU.a(this.bv,!0);this.db(!0,this.bJ());this.dV(!0)},gW:function(n){var t;t=n?this.bK?-1*this.Z:0:this.bK?this.Z:0;this.d.FirstRow+=t;this.e=_Ewa.g.c(_Ewa.g.b(this.d).e(),this.a);this.dU()},gw:function(n){return n?!!this.cy:!!this.bq},gF:function(n){this.bK=n;var t=n?this.Z:-1*this.Z;this.d.FirstRow+=t;this.e=_Ewa.g.c(_Ewa.g.b(this.d).e(),this.a);this.dU();this.b.b(this.dT())},gL:function(){this.bW()},gA:function(n,t){if(this.bu){Diag.a.b(36475983,0,!1,"CustomSortDialog.OnConditionsStateChanged: Dialog is disposed. Aborting.");return}_Ewa.cU.a(this.bp,t.a>=64);_Ewa.cU.a(this.bI,t.a<=0);_Ewa.cU.a(this.bH,t.a<=0||t.a>=64);_Ewa.cU.a(this.bw,t.a<2||!t.b);_Ewa.cU.a(this.bv,t.a<2||t.b===t.a-1);t.a<=0&&Common.n.a().j().a.a(this.bp)},gK:function(){this.dW();Diag.a.a(36701972,0,50,"CustomSortDialog.OnSortSuccessCallback: Custom Sort succeeded.")},gJ:function(){this.dW();Diag.a.a(36701973,0,10,"CustomSortDialog.OnSortFailedCallback: Custom Sort failed.")},gN:function(n){var r;if(n&&n.length)for(var i=n,u=i.length,t=0;t<u;++t)r=i[t],this.b.a(r,!1);else this.b.a(null,!1)},gU:function(){Diag.a.b(41542341,0,_Ewa.e.b(this.d.SheetName,this.e.SheetName,!0),null);var n=_Ewa.g.b(this.d),t=_Ewa.g.h(this.e);n.i(t)||(Diag.a.a(41542342,0,50,"CustomSortDialog.UpdateActiveCell: Active cell [{0}] is outside sort range [{1}]. Using range's top-left cell instead.",t,n),this.e=_Ewa.g.c(n.e(),this.a))},dU:function(){var n=_Ewa.g.b(this.d);this.dc&&!this.cu().a().b().f(n)&&this.cu().d(n,_Ewa.g.h(this.e),0,0,!0,"",!0,!0,!0)},dW:function(){var n=_Ewa.g.b(this.bc);this.dc&&!this.cu().a().b().f(n)&&this.cu().d(n,_Ewa.g.h(this.cx),0,0,!0,"",!0,!0,!0)},fl:function(n){if(this.bu){Diag.a.b(42006477,0,!1,"CustomSortDialog.LogUsageData: Dialog is disposed. Skipping usage logging");return}if(!this.ca){Diag.a.a(40436371,0,50,"CustomSortDialog.LogUsageData: Dialog was closed before initialized. Skipping usage logging.");return}if(!this.b){Diag.a.b(42006478,0,!1,"CustomSortDialog.LogUsageData: Unexpected error: conditionsControl is null. Skipping usage logging");return}n&&this.gx()&&Diag.a.a(594616911,0,50,'CustomSortDialog sorted on "no cell color"');var t=this.b.l();t.g=this.cd;t.c=!this.R;t.b=this.bJ();t.a=_Ewa.zz.a(this.bd);t.d=this.d.LastColumn-this.d.FirstColumn+1;t.e=this.d.LastRow-this.d.FirstRow+1;t.f=this.R?t.e>200:t.d>200;t.h=this.cU;t.u=n;_Ewa.A.a().a(50,t,!0)},gx:function(){for(var t,i=this.b.e(),r=i.length,n=0;n<r;++n)if(t=i[n],t.SortConditionType===1&&!t.SortColor)return!0;return!1},fk:function(n){var t={};return t.SelectedRange=this.bc,t.ActiveCell=this.cx,t.SortInfoMode=n,t.ExpandSortSelection=this.dS,t.ExpandSortSelectionSupported=!0,t}};_Ewa.SD=function(n){this.b=Function.createDelegate(this,this.d);_Ewa.SD.initializeBase(this,[n,null,!1,!1,!1]);this.j(_Ewa.ClientStringManager.a().a(161),this.b,{id:"CustomSortDialog"})};_Ewa.SD.prototype={d:function(){}};_Ewa.zx=function(n){this.c=Function.createDelegate(this,this.e);this.a=n};_Ewa.zx.prototype={a:null,d:function(){var n=new CommonUI.d;n.g(11);n.h(1,_Ewa.ClientStringManager.a().a(1814));n.h(2,_Ewa.ClientStringManager.a().a(1815));n.eI(_Ewa.ClientStringManager.a().a(1813),_Ewa.ClientStringManager.a().b(558),this.c)},e:function(n){switch(n){case 0:this.b("Cancel");break;case 1:this.b("Expand and sort");this.a(!0);break;case 2:this.b("Just sort");this.a(!1)}},b:function(n){Diag.a.a(594125219,0,50,"ExpandSortSelectionDialog: user operation: {0}",n)}};_Ewa.SE=function(n,t,i,r){_Ewa.SE.initializeBase(this,[n,t,i,r])};_Ewa.SE.prototype={l:function(){return 194},i:function(){return this.n()===2&&!this.g()},h:function(n){return n?n.TextColors:null}};_Ewa.SF=function(n,t,i,r){_Ewa.SF.initializeBase(this,[n,t,i,r])};_Ewa.SF.prototype={p:function(n){return n.TextColors},m:function(){return 194},j:function(){return this.r()===2&&!this.i()},o:function(n){return n?n.TextColors:[0]}};_Ewa.rh=function(n,t,i,r){this.h=n;this.g=t;this.d=i;this.i=r;dialogControls.renderDialogColorOrIconComboBox(this.h,this.g,null,null,"icons",null,!1,!0,!1,32,120,_Ewa.ClientStringManager.a().a(180),r,null,null)};_Ewa.rh.a=function(n,t){var i=new _Ewa.uj,r;return i.index=n,i.iconSet=t,r=_Ewa.w.k(t,n),Diag.a.b(594126238,0,!!r,"IconComboBoxBehavior.CreateIcon KpiImage.Lookup returned null, IconsSet={0} , IconIndex={1}",t,n),i.label=r?r.a():"",i};_Ewa.rh.prototype={h:null,i:null,g:null,e:null,d:null,f:-1,b:function(n,t){t&&(this.d.SortIcon=-1,this.d.SortIconSet=-1,this.f=-1);n.Icons&&this.j(n.Icons)&&(this.f=0,this.d.SortIcon=n.Icons[0].Icon,this.d.SortIconSet=n.Icons[0].IconSet)},a:function(n,t,i){var e=this.k()?null:_Ewa.rh.a(this.d.SortIcon,this.d.SortIconSet),o=!1,u,r,f;if(n&&n.Icons){for(this.e=new Array(0),u=0,r=0,n.Icons[0].Icon===-1?(o=!0,u=1,r=-1):this.f===-1&&(r=0),f=0;u<n.Icons.length;++u,++f)this.e[f]=_Ewa.rh.a(n.Icons[u].Icon,n.Icons[u].IconSet),this.d.SortIcon===this.e[f].index&&this.d.SortIconSet===this.e[f].iconSet&&(r=f);e=r!==-1?this.e[r]:null;r!==this.f&&this.i(r.toString())}dialogControls.renderDialogColorOrIconComboBox(this.h,this.g,this.e,e,"icons",_Ewa.ClientStringManager.a().a(195),o,t,i,32,120,_Ewa.ClientStringManager.a().a(180),this.i,_Ewa.bO.b,_Ewa.bO.c)},c:function(n){var t=parseInt(n);this.f=t;this.d.SortIcon=t===-1?-1:this.e[t].index;this.d.SortIconSet=t===-1?-1:this.e[t].iconSet},j:function(n){for(var t=0;t<n.length;++t)if(this.d.SortIconSet===n[t].IconSet&&this.d.SortIcon===n[t].Icon)return!1;return!0},k:function(){return isNullOrUndefined(this.d.SortIcon)||this.d.SortIcon===-1}};_Ewa.SI=function(n,t,i){this.i=n;this.h=null;dialogControls.renderDialogColorOrIconPickerFlyoutAnchor(t,this.h,i,null,!0,"icons",null,null,null)};_Ewa.SI.prototype={h:null,i:null,j:-1,d:function(n){var t=this,i=this;dialogControls.renderDialogColorOrIconPickerFlyoutAnchor(n,null,null,null,!1,"icons",function(){Common.n.a().f("ReactTransientUI",!0)},function(){Common.n.a().i("ReactTransientUI",!0)},this.j.toString())},e:function(n,t){return(t&&(this.i.SortIcon=-1,this.i.SortIconSet=-1,this.j=-1),n.Icons&&this.m(n.Icons))?(this.j=0,this.j.toString()):null},b:function(){if(this.l())return"";var n=this.k();return n?n.a():""},f:function(n,t){var i=_Ewa.ClientStringManager.a().a(195);n.c(i,"-1",!0,null);_Ewa.a.L(t);t.setAttribute(Common.u.a.a,i)},c:function(n,t,i){var r,e,s,h;Diag.a.b(590975843,0,!!n,"IconComboBoxBehaviorOlf.PopulateOptions: flyoutAnchor is null.");this.h=new Array(0);var o=!1,f=0,u=0;for(i.Icons&&i.Icons[0].Icon===-1?(o=!0,f=1,u=-1):this.j===-1&&(u=0),r=0;f<i.Icons.length;++f,++r)this.h[r]=new _Ewa.uj,this.h[r].index=i.Icons[f].Icon,this.h[r].iconSet=i.Icons[f].IconSet,e=_Ewa.w.k(this.h[r].iconSet,this.h[r].index),Diag.a.b(590975842,0,!!e,"IconComboBoxBehaviorOld.PopulateOption KpiImage.Lookup returned null, IconsSet={0} , IconIndex={1}",this.h[r].iconSet,this.h[r].index),this.h[r].label=e?e.a():"",this.i.SortIcon===this.h[r].index&&this.i.SortIconSet===this.h[r].iconSet&&(u=r);s=this;h=this;dialogControls.renderDialogColorOrIconPickerFlyoutAnchor(n,this.h,t,o?_Ewa.ClientStringManager.a().a(195):null,!1,"icons",function(){Common.n.a().f("ReactTransientUI",!0)},function(){Common.n.a().i("ReactTransientUI",!0)},u.toString());u!==this.j&&t(u.toString())},g:function(n){var t=parseInt(n);this.j=t;this.i.SortIcon=t===-1?-1:this.h[t].index;this.i.SortIconSet=t===-1?-1:this.h[t].iconSet},a:function(n,t){var i,r;if(!n||!t){Diag.a.b(590975841,0,!!n,"IconComboBoxBehaviorOld.Display: comboBox is null");Diag.a.b(590975840,0,!!t,"IconComboBoxBehaviorOld.Display: selectedElement is null");return}n.T();this.l()?this.f(n,t):(i=this.k(),i&&(r=Common.D.c(16,16,i.c,_Ewa.r.a(2),"selected-icon",null,!0,i.a(),null,null),t.innerHTML=String.format("<svg xmlns='http://www.w3.org/2000/svg' version='1.1' width='{0}' height='{1}'><rect x='4' y='4' width='{2}' height='{3}' fill='{4}' stroke='{5}' stroke-width='{6}' vector-effect='non-scaling-stroke' shape-rendering='geometricPrecision'/><\/svg>",100,32,92,24,"none","black","0.2"),t.appendChild(r),t.setAttribute(Common.u.a.a,i.a())))},m:function(n){for(var t=0;t<n.length;++t)if(this.i.SortIconSet===n[t].IconSet&&this.i.SortIcon===n[t].Icon)return!1;return!0},k:function(){var n=_Ewa.w.k(this.i.SortIconSet,this.i.SortIcon);return Diag.a.b(590975839,0,!!n,"IconComboBoxBehaviorOld.GetKpiImageOfSelectedIcon: no KpiImage found for ({0},{1})",this.i.SortIconSet,this.i.SortIcon),n},l:function(){return isNullOrUndefined(this.i.SortIcon)||this.i.SortIcon===-1}};_Ewa.SJ=function(n){this.c=n};_Ewa.SJ.prototype={c:0,a:function(){return this.c?_Ewa.ClientStringManager.a().a(198):_Ewa.ClientStringManager.a().a(197)},b:function(){return 1}};_Ewa.w=function(n,t){this.c=n;this.b=t};_Ewa.w.k=function(n,t){return n<0||n>=_Ewa.w.e.length?(Diag.a.b(38281799,0,!1,"KpiImage.Lookup: iconSet is out of bounds. value: {0}",n),null):t<0||t>=_Ewa.w.e[n].length?(Diag.a.b(38281800,0,!1,"KpiImage.Lookup: iconIndex is out of bounds. value: {0}",t),null):_Ewa.w.e[n][t]};_Ewa.w.prototype={c:null,b:0,a:function(){return _Ewa.ClientStringManager.a().a(this.b)}};_Ewa.md=function(){};_Ewa.md.a=function(n){return n.RowColOffset>-1&&n.SortConditionType!==4};_Ewa.md.c=function(n,t){return!_Ewa.md.a(n)||!_Ewa.md.a(t)?!1:n.RowColOffset!==t.RowColOffset?!1:n.SortConditionType!==t.SortConditionType?!1:n.SortConditionType?n.SortConditionType===1?n.FillGradient||t.FillGradient?_Ewa.hq.d(n.FillGradient,t.FillGradient):n.SortColor===t.SortColor:n.SortConditionType===2?n.SortColor===t.SortColor:n.SortConditionType===3?n.SortIconSet===t.SortIconSet&&n.SortIcon===t.SortIcon:!1:!0};_Ewa.md.b=function(n){var t={};return t.CustomOrder=n.CustomOrder,t.IsAscending=n.IsAscending,t.RichProperty=n.RichProperty,t.RowColOffset=n.RowColOffset,t.SortColor=n.SortColor,t.SortConditionType=n.SortConditionType,t.SortIcon=n.SortIcon,t.SortIconSet=n.SortIconSet,t.FillGradient=_Ewa.hq.c(n.FillGradient),t};_Ewa.oe=function(){};_Ewa.oe.a=function(n){switch(n){case 0:return _Ewa.ClientStringManager.a().a(183);case 1:return _Ewa.ClientStringManager.a().a(184);case 2:return _Ewa.ClientStringManager.a().a(185);case 3:return _Ewa.ClientStringManager.a().a(186);default:return Diag.a.b(36475984,0,!1,"SharedSortConditionTypeExtension.ToJsString: Unsupported type {0}",n),""}};_Ewa.ig=function(){};_Ewa.ig.c=function(n){return!!n&&_Ewa.ig.f(n)&&_Ewa.ig.e(n)&&_Ewa.ig.d(n)};_Ewa.ig.a=function(n){return n.SortRangeType===2&&n.SortTopToBottom&&!!n.HeaderColumnInfoItems};_Ewa.ig.f=function(n){return n.SortRange?n.SortRangeType===4?(Diag.a.a(42321667,0,10,"SharedSortInfoResultExtension.VerifySortRange: Unsupported sort range type: {0}",n.SortRangeType),!1):n.SortRangeType===2&&n.SortTopToBottom&&(!(n.HeaderRowSize!=null)||n.HeaderRowSize<0)?(Diag.a.a(41952774,0,10,"SharedSortInfoResultExtension.VerifySortRange: header row size must be equal or greater than 1, when range is sheetrange"),!1):!0:(Diag.a.a(37336266,0,10,"SharedSortInfoResultExtension.VerifySortRange: sort range is null"),!1)};_Ewa.ig.e=function(n){var t;if(!n.SortConditions)return!0;for(var r=n.SortConditions,u=r.length,i=0;i<u;++i){if(t=r[i],!_Ewa.ig.b(n,t.RowColOffset))return Diag.a.a(37336267,0,10,"SharedSortInfoResultExtension.VerifySortConditions: offset [{0}] is out of bounds. sort range: {1}",t.RowColOffset,n.SortRange),!1;if(t.SortConditionType===1&&t.FillGradient&&!_Ewa.hq.g(t.FillGradient))return Diag.a.a(595096285,0,10,"SharedSortInfoResultExtension.VerifySortConditions: sortCondition contains invalid fillGradient"),!1}return!0};_Ewa.ig.d=function(n){var u,t,o,r,i;if(!n.SortColumnInfoItems)return Diag.a.a(38848454,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: SortColumnInfoItems is null"),!1;u=new($$sc.u.$$(Number));for(var s=n.SortColumnInfoItems,c=s.length,f=0;f<c;++f){if(t=s[f],!_Ewa.ig.b(n,t.ColumnOffset))return Diag.a.a(38848455,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: offset [{0}] is out of bounds. sort range: {1}",t.ColumnOffset,n.SortRange),!1;if(_Ewa.e.a(t.Name))return Diag.a.a(38848456,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: invalid column name for offset [{0}]",t.ColumnOffset),!1;if(t.CellColors&&!t.CellColors.length)return Diag.a.a(42076109,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: cell colors are not null but length = [{0}]",t.CellColors.length),!1;if(t.TextColors&&!t.TextColors.length)return Diag.a.a(50671874,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: text colors are not null but length = [{0}]",t.TextColors.length),!1;if(t.Icons&&!t.Icons.length)return Diag.a.a(50671875,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: icons are not null but length = [{0}]",t.Icons.length),!1;u.b(t.ColumnOffset)}if(n.SortConditions)for(var h=n.SortConditions,l=h.length,e=0;e<l;++e)if(o=h[e],!u.c(o.RowColOffset))return Diag.a.b(38848457,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: missing column info item for sort condition [{0}]",o.RowColOffset),!1;if(n.HeaderColumnInfoItems){if(n.HeaderColumnInfoItems.length!==n.SortColumnInfoItems.length)return Diag.a.b(41760733,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: header columnInfo length doesn't match sort column info length"),!1;for(r=0;r<n.HeaderColumnInfoItems.length;++r){if(i=n.HeaderColumnInfoItems[r],i.ColumnOffset!==i.ColumnOffset)return Diag.a.b(41760734,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: header columnInfo item offset doesn't match sort columnInfo item offset."),!1;if(i.CellColors&&i.CellColors.length>1)return Diag.a.a(50671876,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.CellColors is not null and has more than 1 background color"),!1;if(i.TextColors&&i.TextColors.length>1)return Diag.a.a(50671877,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.TextColors is not null and has more than 1 font color"),!1;if(i.Icons&&i.Icons.length>1)return Diag.a.a(50671878,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.Icons is not null and has more than 1 icon"),!1}}return!0};_Ewa.ig.b=function(n,t){var i=n.SortRange,r=n.SortTopToBottom?i.LastColumn-i.FirstColumn:i.LastRow-i.FirstRow;return t>=0&&t<=r};_Ewa.zz=function(){};_Ewa.zz.a=function(n){switch(n){case 0:return"Table";case 1:return"QueryTable";case 2:return"SheetRange";case 3:return"AutoFilterRange";default:return Diag.a.b(37839704,0,!1,"SharedSortRangeTypeExtension.Name: Unsupported type {0}",n),"Unsupported"}};_Ewa.SL=function(n,t){_Ewa.SL.initializeBase(this,[n,t])};_Ewa.SL.prototype={Z:function(){return _Ewa.ClientStringManager.a().a(200)},Y:function(){return _Ewa.ClientStringManager.a().a(201)}};_Ewa.biB=function(n,t){this.d=Function.createDelegate(this,this.bq);this.e=Function.createDelegate(this,this.bt);this.R=Function.createDelegate(this,this.bw);_Ewa.biB.initializeBase(this,[n,null,!1,!1,!1,!1]);this.b=t;this.p=_Ewa.ri.b()};_Ewa.biB.prototype={b:null,bc:function(){return _Ewa.b.a(this.a).a()},bp:function(){this.j(this.Z(),this.R,null)},t:function(n){CommonUI.b.prototype.t.call(this,n);this.bv()},bw:function(n){n===1&&this.bu();this.i()},bv:function(){this.bd()},bu:function(){var n,t,i,r,u;_Ewa.b.a(this.a).r().a();n={};n.OperationType=2;n.SelectedRange=_Ewa.g.a(this.bc().a().b(),this.a);n.SelectedRange.FirstColumn=this.b.FirstColumn;n.SelectedRange.LastColumn=this.b.FirstColumn;n.SelectedRange.FirstRow=this.b.FirstRow;n.SelectedRange.LastRow=this.b.FirstRow;n.ActiveCell=_Ewa.g.c(this.bc().a().a(),this.a);n.ActiveCell.FirstColumn=this.b.FirstColumn;n.ActiveCell.FirstRow=this.b.FirstRow;n.HasHeader=!0;n.GuessHeader=!0;n.SortTopToBottom=!0;n.SortConditions=new Array(1);t={};t.RowColOffset=0;t.IsAscending=!0;t.SortConditionType=1;t.SortColor=-16776961;n.SortConditions[0]=t;i=this;r=function(t,r){return _Ewa.rk.a(i.a.d().a(),n,_Ewa.n.a(t,i.e),_Ewa.n.b(r,i.d),n,null)};Diag.a.a(37535958,0,50,"SortByColorDialogBase.PerformSort: Sending sort by color request.");u=this;_Ewa.M.a(this.a.g(),r,function(n){return new _Ewa.F(186,0,n,0,null)},null)},bt:function(){Diag.a.a(37535959,0,50,"SortByColorDialogBase.OnSortSuccessCallback: Sort by color succeeded.")},bq:function(){Diag.a.a(37535960,0,50,"SortByColorDialogBase.OnSortFailedCallback: Sort by color failed.")},bd:function(){var n=document.getElementById("sortByColorDialogSubtitleText");n.innerText=this.Y()}};_Ewa.zA=function(n,t){this.n=Function.createDelegate(this,this.E);this.j=Function.createDelegate(this,this.D);this.a=n;this.h="";this.d=t;this.c=_Ewa.b.a(this.a);this.g=this.a.p().b("LoadResource","LoadDialogControlsStopwatch")};_Ewa.zA.prototype={a:null,c:null,d:null,i:null,f:null,e:null,h:null,m:!1,g:null,z:function(){return!1},x:function(n,t,i,r){var u=null,f=t.a;switch(f){case-864298118:u=this.v(t,i);break;case-1010737776:u=this.k(!0,t,i);break;case 2123420468:u=this.k(!1,t,i);break;case-207540907:case-1677817820:u=this.u(t,i,r.b());break;case 368460465:u=this.B(t);break;case 529856798:u=this.t(t);break;case 644342024:u=this.A(t);break;case-1194920897:u=this.C(i)}return u||_Ewa.L.a(f)},w:function(n,t){var i=n===1;if(i)switch(t.a){case-864298118:case-1010737776:case 2123420468:case 368460465:case 529856798:case 644342024:case-207540907:case-1677817820:break;case-1194920897:i=this.a.a(230);break;default:i=!1}return i},y:function(){return!1},b:function(){return this.a&&this.c?this.c.a():null},q:function(n){n?this.c.u(this.j):this.c.y(this.j);this.m=n},H:function(n){return!!this.e&&_Ewa.e.b(this.h,n.t(),!0)},k:function(n,t,i){var r={},u;return r.OperationType=0,r.IsAscending=n,r.HasHeader=!0,r.GuessHeader=!0,r.SortTopToBottom=!0,r.ExpandSortSelectionSupported=!0,i&&!isNullOrUndefined(i.SortCommandData)?(u=i.SortCommandData,r.ActiveCell=u.ActiveCell,r.SelectedRange=u.SelectedRange,r.ExpandSortSelection=u.ExpandSelection):(r.ActiveCell=_Ewa.g.c(this.b().a().a(),this.a),r.SelectedRange=_Ewa.g.a(this.b().a().b(),this.a),r.ExpandSortSelection=null),this.p(r,t)},v:function(n,t){var i=null,r=this.b();return r&&(this.H(r)?(this.e.IsAscending=!this.e.IsAscending,i=this.p(this.e,n)):i=this.k(!0,n,t)),i},r:function(n){var t;if(this.a.isChangeGateEnabled("OfficeVSO:4112173_MacroRecorderTableSortOnRange")&&(t=this.c.e().b(this.b().a().b(),!1),t)){var i=t.a,r=t.b,u=this.b().a().a(),f=u.b-r.b;return new _Ewa.qh(i,f,n.IsAscending)}return new _Ewa.qg(n)},p:function(n,t){this.c.r().a();var r=this,u=function(){return r.r(n)},i=this,f=function(t,r){return _Ewa.rk.a(i.a.d().a(),n,_Ewa.n.a(t,i.n),r,n,null)},o=this,e=function(n){return new _Ewa.F(141,0,n,0,u)};return this.o(f,e,t,this.G(n))},G:function(n){if(!this.d)return!1;var t=this.b().a().b(),i=_Ewa.g.a(this.b().a().b(),this.a),r=this.a.isChangeGateEnabled("SendLastRowOfAFilterSerializationVSO3765715"),u=this.c.e().j(t,!0),f=r&&this.b().a().j()&&this.c.e().p(i),e=r&&this.c.e().A(i),o=r&&(t.H()||t.E())&&!t.p()&&n.ExpandSortSelection==null?!1:n.ExpandSortSelection&&this.c.e().p(i);return u||f||e||o},u:function(n,t,i){var f=null,h,u,e,r;if(f=n.b===8&&t&&!isNullOrUndefined(t.SortCommandData)?t.SortCommandData:n.b===19&&t&&!isNullOrUndefined(t.CommandValueId)?_Ewa.H.b(t.CommandValueId):this.s(),_Ewa.B.a().f()&&this.a.a(997))return h=new _Ewa.SD(this.a),$$sc.a.a(Boolean,!0);u=new($$sc.D.$$(Boolean));e=this;this.a.X(function(n){_Ewa.f.cw(n.b(),function(){u.b(!0)},e.a.i(),3)});var c=u.a,o=_Ewa.l.a(_Ewa.cW,this.a.b(),12,this.a.i(),i,null),s=new($$sc.D.$$(Boolean));return this.g.d(),r=this,_Ewa.f.cw($$sc.a.WAA(o,c),function(){r.g.a();var n=o.a(),t=new _Ewa.cU(f,r.a,n,r.d);s.b(!0)},this.a.i(),3),s.a},s:function(){var n={};return n.ActiveCell=_Ewa.g.c(this.b().a().a(),this.a),n.SelectedRange=_Ewa.g.a(this.b().a().b(),this.a),n.FromAutoFilter=!1,n.ExpandSelection=null,n},B:function(n){var t=this.l();if(!t)return $$sc.a.a(Boolean,!1);var i=this.a.d().a().b(!1),f=this,r=function(){return new _Ewa.JR(t)},u=this,e=this;return _Ewa.M.a(this.a.g(),function(n,r){return _Ewa.oH.c(u.a.d().a(),t,n,r,null,i)},function(n){return new _Ewa.bh(516,0,n,0,r)},n)},t:function(n){var t=this.l(),i;if(!t)return $$sc.a.a(Boolean,!1);i=this.c.e().b(this.b().a().b(),!0);i&&Diag.a.a(42038165,0,50,"DoClearAutoFilter for namedObject: Type : {0}",i.e.toString());var r=this.a.d().a().b(!1),s=this,u=function(){return new _Ewa.Ne(t)},f=this,e=function(n,i){return _Ewa.oH.a(f.a.d().a(),t,n,i,null,r)},h=this,o=function(n){return new _Ewa.bh(517,0,n,0,u)};return this.o(e,o,n,!!this.d)},o:function(n,t,i,r){var u,f;return this.a.a(359)&&r?(f=this,u=this.d.a().CW(function(r){var u=r.a();u&&_Ewa.M.a(f.a.g(),n,t,i)})):u=_Ewa.M.a(this.a.g(),n,t,i),u},A:function(n){var t=this.l();if(!t)return $$sc.a.a(Boolean,!1);var i=this.a.d().a().b(!1),f=this,r=function(){return new _Ewa.Nr(t)},u=this,e=this;return _Ewa.M.a(this.a.g(),function(n,r){return _Ewa.oH.b(u.a.d().a(),t,n,r,null,i)},function(n){return new _Ewa.bh(518,0,n,0,r)},n)},C:function(n){var t=_Ewa.H.b(n.CommandValueId),i=new _Ewa.SL(this.a,t);return i.bp(),$$sc.a.a(Boolean,!0)},E:function(n,t){if(_Ewa.T.b(n,-901005882))_Ewa.N.a(this.a).a().h(-901005882),this.F(t);else{if(_Ewa.T.a(n)||!n.Result)return;this.e=t;var i=n.Result,r=i.ActualSortRange;this.f=_Ewa.g.b(r);this.h=this.b().t();this.m||(this.i=this.b().a().b(),this.i.f(this.f)||this.I())}},F:function(n){var t=this,i=new _Ewa.zx(function(i){var r={};r.ActiveCell=n.ActiveCell;r.SelectedRange=n.SelectedRange;r.ExpandSelection=i;t.a.B(n.IsAscending?-1010737776:2123420468,_Ewa.D.a,8,{SortCommandData:r})});i.d()},I:function(){var n=this.b();n.d(this.f,n.a().a(),0,0,!0,"",!0,!0,!0);this.q(!0)},D:function(){this.q(!1);var n=this.b();n.a().d()&&n.a().b().f(this.f)&&n.d(this.i,n.a().a(),0,0,!0,"",!0,!0,!0)},l:function(){var n=this.b();return n?(this.c.r().a(),_Ewa.g.a(n.a().b(),this.a)):(Diag.a.b(23666764,0,!!n,"SelectionManger is null"),null)}};_Ewa.SM=function(n,t){this.d=n;this.c=t};_Ewa.SM.prototype={d:null,c:0,a:function(){var n;switch(this.c){case 0:n=_Ewa.ClientStringManager.a().c(101);break;case 1:case 2:n=_Ewa.ClientStringManager.a().c(102);break;case 3:n=_Ewa.ClientStringManager.a().c(103);break;default:return Diag.a.b(36701974,0,!1,"SortConditionConflictError.GetMessage: unexpected sort condition type: {0}",this.c),""}return String.format(n,this.d)},b:function(){return 2}};_Ewa.kx=function(n,t,i,r,u,f,e,o,s){this.V=Function.createDelegate(this,this.bw);this.S=Function.createDelegate(this,this.bq);this.T=Function.createDelegate(this,this.bs);this.Y=Function.createDelegate(this,this.bA);this.X=Function.createDelegate(this,this.by);this.U=Function.createDelegate(this,this.bu);this.W=Function.createDelegate(this,this.bx);this.be=Function.createDelegate(this,this.br);this.bi=Function.createDelegate(this,this.bB);this.bh=Function.createDelegate(this,this.bz);this.bg=Function.createDelegate(this,this.bv);this.bf=Function.createDelegate(this,this.bt);_Ewa.kx.resolveInheritance();this.a=this.co;_Ewa.kx.initializeBase(this,[n,null]);this.bH(t);this.s=i;this.Q=r;this.M=u;this.E=e;this.t=f;this.bc=o;this.q=-1;this.co().innerHTML=_Ewa.ds.i();this.co().tabIndex=-1;this.co().setAttribute("role","listitem");this.co().setAttribute("aria-label",_Ewa.ClientStringManager.a().a(199));var h=s.toString();this.L="columnDropdown"+h;this.P="sortOnDropdown"+h;this.R="valuesOrderDropdown"+h;this.J="colorOrIconComboBox"+h;this.K="colorOrIconOrderDropdown"+h;this.d();this.bp();this.bD()};_Ewa.kx.b=function(){var n={};return n.RowColOffset=-1,n.SortConditionType=0,n.IsAscending=!0,n};_Ewa.kx.a=function(n,t){for(var e,u,i=0,f=n,o=f.length,r=0;r<o;++r)e=f[r],i=Math.max(i,e.text.length);return u=Math.min(i*8,1e3),u<t?t:u};_Ewa.kx.prototype={E:null,t:null,bc:null,M:null,s:null,q:0,p:null,v:null,x:null,y:null,z:null,H:null,B:null,A:null,w:null,C:null,L:null,P:null,R:null,J:null,K:null,Q:0,G:0,Z:!1,h:function(){return this.Z},e:function(){return!!this.G},b:function(){return this.p},bH:function(n){return this.p=n||_Ewa.kx.b(),n},j:function(){return this.r().sectionRowIndex},i:function(){return!!this.p&&this.p.SortConditionType===1&&!!this.p.FillGradient},r:function(){return this.co()},u:function(){return this.q===-1?null:this.q<0||this.q>=this.s.length?(Diag.a.b(39334726,0,!1,"SortConditionControl.SelectedColumnInfo: selected column index is out of bounds."),null):this.s[this.q]},dispose:function(){this.Z=!0;this.bI();this.v&&(this.v.dispose(),this.v=null);this.x=null;this.y=null;this.z=null;this.H=null;this.B=null;this.w=null;this.C=null;_Ewa.YQ.prototype.dispose.call(this)},k:function(){return this.q<0||this.q>=this.s.length?(Diag.a.b(592061199,0,!1,"SortConditionControl.GetColumnName: selectedColumnIndex is out of bound."),null):this.s[this.q].Name},l:function(){return[this.x,this.y,this.z,this.A,this.w]},f:function(n){_Ewa.a.g(this.co(),"ewa-customsort-dlg-selected",n)},g:function(){},d:function(){var n=this.r().sectionRowIndex?182:181;this.r().cells[0].innerText=_Ewa.ClientStringManager.a().a(n)},o:function(n){this.s=n;this.O(!1,!1);this.ba(!1)},c:function(n){this.G=n;this.bl(!0)},m:function(){this.bl(!1);this.G=0},n:function(){this.F(this.i(),!1)},bl:function(n){switch(this.G){case 1:this.O(!1,n);break;case 2:this.O(!1,n);this.bj(!1,n);this.F(!1,n)}},bd:function(n){_Ewa.a.b(this.H,n,!1);_Ewa.a.b(this.B,!n,!1);_Ewa.a.b(this.C,!n,!1)},bp:function(){var n=this.i();this.O(n,!1);this.x=this.D(this.L);this.bj(n,!1);this.y=this.D(this.P);this.bb();this.z=this.D(this.R);this.B=_Ewa.a.a(this.co(),"tdColorOrIcon");this.v=new _Ewa.SB(this.B,this.p,this.J,this.bf);this.bm();this.A=this.D(this.J);this.N(!1);this.w=this.D(this.K);this.bd(!this.p.SortConditionType)},D:function(n){return _Ewa.a.a(this.co(),n)},bE:function(n){this.v.i(this.u(),n);this.bm()},F:function(n,t){this.v.h(this.u(),n,t)},bm:function(){this.i()||this.bo()||!this.p.SortConditionType||this.bc(this.p.SortConditionType,this.u().ColumnOffset,this);this.F(this.i(),!1)},bo:function(){if(isNullOrUndefined(this.u()))return!1;switch(this.p.SortConditionType){case 1:return!!this.u().CellColors;case 2:return!!this.u().TextColors;case 3:return!!this.u().Icons;default:return!0}},O:function(n,t){var e=_Ewa.a.a(this.r(),"tdSelectColumn"),r,i,u,f;for(this.q=-1,r=new Array(this.s.length),i=0;i<this.s.length;++i)u=this.s[i].ColumnOffset,f=this.s[i].Name,r[i]=dialogControls.dropdownOption(i,f),u===this.p.RowColOffset&&(this.q=i);dialogControls.renderDialogDropdown(e,r,this.q,this.L,32,180,_Ewa.kx.a(r,180),n,t,null,_Ewa.ClientStringManager.a().a(177),this.bg,_Ewa.bO.b,_Ewa.bO.c)},bj:function(n,t){var r=_Ewa.a.a(this.co(),"tdSelectSortOn"),i=[dialogControls.dropdownOption(0,_Ewa.ClientStringManager.a().a(183)),dialogControls.dropdownOption(1,_Ewa.ClientStringManager.a().a(184)),dialogControls.dropdownOption(2,_Ewa.ClientStringManager.a().a(185)),dialogControls.dropdownOption(3,_Ewa.ClientStringManager.a().a(186))];dialogControls.renderDialogDropdown(r,i,this.p.SortConditionType,this.P,32,120,_Ewa.kx.a(i,120),n,t,null,_Ewa.ClientStringManager.a().a(179),this.bh,_Ewa.bO.b,_Ewa.bO.c)},bb:function(){var n,t;this.H=_Ewa.a.a(this.co(),"tdSelectOrder");n=[];this.I(n,1,null);this.I(n,2,null);t=this.M[this.p.RowColOffset.toString()];!t||!t.length||(this.I(n,5,t),this.I(n,6,t));dialogControls.renderDialogDropdown(this.H,n,this.bn(),this.R,32,248,_Ewa.kx.a(n,248),!1,!1,null,_Ewa.ClientStringManager.a().a(180),this.bi,_Ewa.bO.b,_Ewa.bO.c)},I:function(n,t,i){var r=_Ewa.og.b(t,i);if(!r||!r.length){Diag.a.b(38622819,0,!1,"SortConditionControl.AddOrderOption: order text is null or empty.");return}n.push(dialogControls.dropdownOption(t,r))},bn:function(){return this.p.CustomOrder?this.p.IsAscending?5:6:this.p.IsAscending?1:2},N:function(n){this.C=_Ewa.a.a(this.co(),"tdSelectColorOrIconOrder");var t=[dialogControls.dropdownOption(0,_Ewa.ff.a(this.Q,!0)),dialogControls.dropdownOption(1,_Ewa.ff.a(this.Q,!1))],i=!this.p.SortConditionType||this.p.IsAscending?0:1;dialogControls.renderDialogDropdown(this.C,t,i,this.K,32,120,_Ewa.kx.a(t,120),n,!1,null,_Ewa.ClientStringManager.a().a(180),this.be,_Ewa.bO.b,_Ewa.bO.c)},ba:function(n){this.p.SortConditionType&&(isNullOrUndefined(this.u())?(this.F(!0,!1),this.N(!0)):(this.bE(n),this.N(!1)))},bD:function(){Common.f.a().a("msospPointerDown",this.co(),this.W);Common.f.a().a("msospPointerDown",this.x,this.U);Common.f.a().a("msospPointerDown",this.y,this.X);Common.f.a().a("msospPointerDown",this.z,this.Y);Common.f.a().a("msospPointerDown",this.A,this.T);Common.f.a().a("msospPointerDown",this.w,this.S);Common.h.a().a("keydown",this.co(),this.V)},bI:function(){Common.f.a().b("msospPointerDown",this.co(),this.W);Common.f.a().b("msospPointerDown",this.x,this.U);Common.f.a().b("msospPointerDown",this.y,this.X);Common.f.a().b("msospPointerDown",this.z,this.Y);Common.f.a().b("msospPointerDown",this.A,this.T);Common.f.a().b("msospPointerDown",this.w,this.S);Common.h.a().b("keydown",this.co(),this.V)},bv:function(n){this.q=n;this.p.RowColOffset=this.u().ColumnOffset;this.p.SortConditionType?this.ba(!0):this.bF();this.e()&&this.E()},bz:function(n){var t=this.p.SortConditionType;this.p.SortConditionType=n;this.p.SortConditionType&&t||this.bG();this.p.SortConditionType?(this.bd(!1),this.ba(!0)):this.bd(!0);this.e()&&this.E()},bB:function(n){var t=n,i=(t&1)>0,r=(t&4)>0?this.M[this.p.RowColOffset.toString()]:null;this.p.IsAscending=i;this.p.CustomOrder=r},bt:function(){this.e()&&this.E();this.F(!1,!1)},br:function(n){this.p.IsAscending=!n},bG:function(){this.bk();this.p.SortConditionType?this.N(!1):this.bb()},bF:function(){this.p.CustomOrder&&this.bk();this.p.SortConditionType||this.bb()},bk:function(){this.p.IsAscending=!0;this.p.CustomOrder=null},bx:function(){return this.t(this.r().sectionRowIndex,null),!1},bu:function(){return this.t(this.r().sectionRowIndex,this.x),!1},by:function(){return this.t(this.r().sectionRowIndex,this.y),!1},bA:function(){return this.t(this.r().sectionRowIndex,this.z),!1},bs:function(){return this.t(this.r().sectionRowIndex,this.A),!1},bq:function(){return this.t(this.r().sectionRowIndex,this.w),!1},bw:function(n){return _Ewa.a.n(n.a.target,"tr")?n.a.keyCode===38&&!n.a.shiftKey?(this.t(this.r().sectionRowIndex-1,null),!0):n.a.keyCode===40&&!n.a.shiftKey?(this.t(this.r().sectionRowIndex+1,null),!0):!1:!1}};_Ewa.zC=function(n,t,i,r,u,f,e,o,s){this.J=Function.createDelegate(this,this.bd);this.M=Function.createDelegate(this,this.bh);this.O=Function.createDelegate(this,this.bj);this.K=Function.createDelegate(this,this.bf);this.L=Function.createDelegate(this,this.bg);this.N=Function.createDelegate(this,this.bi);this.U=Function.createDelegate(this,this.be);_Ewa.zC.resolveInheritance();this.a=this.co;_Ewa.zC.initializeBase(this,[n,null]);this.bo(t);this.x=i;this.G=r;this.F=u;this.B=e;this.A=f;this.S=o;this.co().innerHTML=_Ewa.ds.j();this.co().tabIndex=-1;this.co().setAttribute("role","listitem");this.co().setAttribute("aria-label",_Ewa.ClientStringManager.a().a(199));this.d();this.bc(s);this.bl()};_Ewa.zC.a=function(){var n={};return n.RowColOffset=-1,n.SortConditionType=0,n.IsAscending=!0,n};_Ewa.zC.prototype={B:null,A:null,S:null,F:null,x:null,y:0,p:null,q:null,t:null,u:null,r:null,s:null,I:null,z:null,E:null,G:0,C:0,P:!1,h:function(){return this.P},e:function(){return!!this.C},b:function(){return this.p},bo:function(n){return this.p=n||_Ewa.zC.a(),n},j:function(){return this.v().sectionRowIndex},i:function(){return!!this.p&&this.p.SortConditionType===1&&!!this.p.FillGradient},v:function(){return this.co()},w:function(){return this.y===-1?null:this.y<0||this.y>=this.x.length?(Diag.a.b(592061198,0,!1,"SortConditionControl.SelectedColumnInfo: selected column index is out of bounds."),null):this.x[this.y]},dispose:function(){this.P=!0;this.bp();System.a.b([this.q,this.t,this.u,this.s,this.r]);this.q=this.t=this.u=this.r=null;this.s=null;this.I=this.z=this.E=null;_Ewa.YQ.prototype.dispose.call(this)},k:function(){return this.q&&this.q.b()?this.q.b().text:null},l:function(){return[this.q.f,this.t.f,this.u.f,this.s.b.getElementsByTagName("button")[0],this.r.f]},f:function(n){_Ewa.a.g(this.co(),"ewa-customsort-dlg-selected",n)},g:function(){this.q.a.selectedIndex!==this.p.RowColOffset&&this.q.e(this.p.RowColOffset)},d:function(){var n=this.v().sectionRowIndex?182:181;this.v().cells[0].innerText=_Ewa.ClientStringManager.a().a(n)},o:function(n){this.x=n;this.q.T();this.W();this.Q(!1)},c:function(n){this.C=n;this.Y(!0)},m:function(){this.Y(!1);this.C=0},n:function(){this.s.o(this.x[this.p.RowColOffset])},Y:function(n){switch(this.C){case 1:_Ewa.a.g(this.q.a,"ewa-dlg-list-error",n);break;case 2:_Ewa.a.g(this.q.a,"ewa-dlg-list-error",n);_Ewa.a.g(this.t.a,"ewa-dlg-list-error",n);_Ewa.a.g(this.s.e,"ewa-dlg-list-error",n)}},T:function(n){_Ewa.a.b(this.I,n,!1);_Ewa.a.b(this.z,!n,!1);_Ewa.a.b(this.E,!n,!1)},bc:function(n){var f=_Ewa.a.a(this.v(),"tdSelectColumn"),r,t,u,i;this.q=new _Ewa.da(f,!0);this.W();r=_Ewa.a.a(this.v(),"tdSelectSortOn");this.t=new _Ewa.da(r,!0);this.t.e(this.p.SortConditionType);t=_Ewa.a.a(this.v(),"tdSelectOrder");this.I=t.parentNode;this.u=new _Ewa.da(t,!0);this.R();u=_Ewa.a.a(this.v(),"tdSelectColorOrIcon");this.z=u.parentNode;this.s=new _Ewa.SC(this.z,this.p,n,this.U);this.s.initialize();this.V();i=_Ewa.a.a(this.v(),"tdSelectColorOrIconOrder");this.E=i.parentNode;this.r=new _Ewa.da(i,!0);this.bk();this.T(!this.p.SortConditionType);this.i()&&this.Z()},Z:function(){this.q.a.disabled=!0;this.t.a.disabled=!0;this.s.l(!0)},V:function(){this.i()||(this.bb()?this.s.o(this.w()):this.p.SortConditionType&&this.w()&&(this.s.q(),this.S(this.p.SortConditionType,this.w().ColumnOffset,this)))},bb:function(){if(isNullOrUndefined(this.w()))return!1;switch(this.p.SortConditionType){case 1:return!!this.w().CellColors;case 2:return!!this.w().TextColors;case 3:return!!this.w().Icons;default:return!0}},W:function(){var n,t,i;for(this.y=-1,n=0;n<this.x.length;++n)t=this.x[n].ColumnOffset,i=this.x[n].Name,this.q.c(Common.d.b(i),n.toString(),t===this.p.RowColOffset,null),t===this.p.RowColOffset&&(this.y=n);this.p.RowColOffset===-1&&this.q.N()},R:function(){this.u.T();this.D(1,null);this.D(2,null);var n=this.F[this.p.RowColOffset.toString()];n&&(this.D(5,n),this.D(6,n))},D:function(n,t){var r=n.toString(),i=_Ewa.og.b(n,t);if(!i||!i.length){Diag.a.b(592061195,0,!1,"SortConditionControl.AddOrderOption: order text is null or empty.");return}this.u.c(i,r,n===this.ba(),null)},ba:function(){return this.p.CustomOrder?this.p.IsAscending?5:6:this.p.IsAscending?1:2},bk:function(){this.r.T();this.r.c(_Ewa.ff.a(this.G,!0),"true",!1,null);this.r.c(_Ewa.ff.a(this.G,!1),"false",!1,null);this.r.e(!this.p.SortConditionType||this.p.IsAscending?0:1)},Q:function(n){if(this.p.SortConditionType){if(isNullOrUndefined(this.w())){this.s.l(!0);this.s.s();this.r.a.disabled=!0;return}this.V();this.s.r(this.w(),n);this.s.l(!1);this.r.a.disabled=!1}},bl:function(){Common.f.a().a("msospPointerDown",this.co(),this.N);Common.h.a().a("keydown",this.co(),this.L);this.q&&this.q.o(this.K);this.t&&this.t.o(this.O);this.u&&this.u.o(this.M);this.r&&this.r.o(this.J)},bp:function(){Common.f.a().b("msospPointerDown",this.co(),this.N);Common.h.a().b("keydown",this.co(),this.L);this.q&&this.q.s(this.K);this.t&&this.t.s(this.O);this.u&&this.u.s(this.M);this.r&&this.r.s(this.J)},bf:function(){this.H(0);this.p.SortConditionType?this.Q(!0):this.bm();this.e()&&this.B()},bj:function(){var n=this.p.SortConditionType;this.H(1);this.p.SortConditionType&&n||this.bn();this.p.SortConditionType?(this.T(!1),this.Q(!0)):this.T(!0);this.e()&&this.B()},bh:function(){this.H(2)},be:function(){this.e()&&this.B();this.s.n(this.w())},bd:function(){this.H(4)},H:function(n){switch(n){case 0:this.q&&(this.y=Number.parseInvariant(this.q.b().value),this.p.RowColOffset=this.w().ColumnOffset);break;case 1:this.t&&(this.p.SortConditionType=Number.parseInvariant(this.t.b().value));break;case 2:if(this.u){var t=Number.parseInvariant(this.u.b().value),i=(t&1)>0,r=(t&4)>0?this.F[this.p.RowColOffset.toString()]:null;this.p.IsAscending=i;this.p.CustomOrder=r}break;case 4:this.r&&(this.p.IsAscending=Boolean.parse(this.r.b().value))}},bn:function(){this.X();this.p.SortConditionType?this.r.e(0):this.R()},bm:function(){this.p.CustomOrder&&this.X();this.p.SortConditionType||this.R()},X:function(){this.p.IsAscending=!0;this.p.CustomOrder=null},bi:function(n){var t=n.a.target,i=_Ewa.a.n(t,"select")?t:null;return this.A(this.v().sectionRowIndex,i),!1},bg:function(n){return _Ewa.a.n(n.a.target,"tr")?n.a.keyCode===38&&!n.a.shiftKey?(this.A(this.v().sectionRowIndex-1,null),!0):n.a.keyCode===40&&!n.a.shiftKey?(this.A(this.v().sectionRowIndex+1,null),!0):!1:!1}};_Ewa.bO=function(n,t){var i,r;this.l=Function.createDelegate(this,this.q);this.k=Function.createDelegate(this,this.p);this.g=n;_Ewa.a.N(t,"table");this.j=t.getElementsByTagName("tbody")[0];i=t.getElementsByTagName("thead")[0];_Ewa.a.N(i,"thead");Diag.a.b(40411935,0,i.rows.length===2,"expecting 2 rows in <thead> of sort conditions table");this.f=i.rows[1];_Ewa.a.bs(this.f,"tr","tabindex","0");r=t.getElementsByTagName("tfoot")[0];_Ewa.a.N(r,"tfoot");Diag.a.b(40411936,0,r.rows.length===1,"expecting 1 row in <tfoot> of sort conditions table");this.e=r.rows[0];_Ewa.a.bs(this.e,"tr","tabindex","0");Common.j.a(this.f,"focus",this.k);Common.j.a(this.e,"focus",this.l);_Ewa.bO.a().a("sortconditions").c(Common.h.b(27,0),844297214)};_Ewa.bO.a=function(){return Common.n.a()};_Ewa.bO.b=function(){Common.n.a().f("ReactTransientUI",!0)};_Ewa.bO.c=function(){Common.n.a().i("ReactTransientUI",!0)};_Ewa.bO.f=function(){Diag.a.b(40411974,0,_Ewa.bO.d(),null);_Ewa.bO.a().i("sortconditions",!1)};_Ewa.bO.e=function(){_Ewa.bO.a().d().a==="ReactTransientUI"&&_Ewa.bO.a().i("ReactTransientUI",!0)};_Ewa.bO.d=function(){return _Ewa.e.b(_Ewa.bO.a().d().a,"sortconditions",!0)};_Ewa.bO.prototype={f:null,e:null,i:!1,j:null,g:null,h:function(){return this.g?this.g.w():null},dispose:function(){this.i||(this.i=!0,Common.j.c(this.f,"focus",this.k),Common.j.c(this.e,"focus",this.l),_Ewa.bO.a().k("sortconditions"),this.f=null,this.e=null,this.j=null,this.g=null)},c:function(){this.m(!0)?_Ewa.bO.a().j().d():Diag.a.a(40411937,0,10,"SortConditionFocusManager.SetFocusOnSelectedCondition: Failed setting focus on selected condition")},d:function(n){this.m(!1)?_Ewa.bO.a().j().a.a(n):Diag.a.a(40411938,0,10,"SortConditionFocusManager.TrySetCurrentElement: Failed setting target as current element")},b:function(){this.f.tabIndex=0;this.e.tabIndex=0},a:function(){this.f.tabIndex=-1;this.e.tabIndex=-1;_Ewa.bO.d()&&_Ewa.bO.f()},p:function(){if(this.i){Diag.a.b(40411939,0,!1,"Dialog is disposed. Aborting");return}if(!this.g.t.e.length){Diag.a.b(40411968,0,!1,"No sort conditions, element shouldn't be focusable");return}_Ewa.bO.d()?this.o(!1):this.n(!0)},q:function(){if(this.i){Diag.a.b(40411969,0,!1,"Dialog is disposed. Aborting");return}if(!this.g.t.e.length){Diag.a.b(40411970,0,!1,"No sort conditions, element shouldn't be focusable");return}_Ewa.bO.d()?this.o(!0):this.n(!1)},n:function(n){if(!this.h()){Diag.a.b(40411971,0,!1,"selected sort condition is null");return}this.m(n)?n?_Ewa.bO.a().j().d():(_Ewa.bO.a().j().a.b(this.e),_Ewa.bO.a().j().e()):Diag.a.a(40411972,0,10,"SortConditionFocusManager.EnterSortConditionsFocusRegion: Failed entering region on level {0}",this.h().j())},o:function(n){_Ewa.bO.f();_Ewa.bO.a().j().a.b(n?this.e:this.f);n?_Ewa.bO.a().j().d():_Ewa.bO.a().j().e()},m:function(n){var t,i;return(_Ewa.bO.e(),!this.h())?(Diag.a.b(40411973,0,!1,"Selected sort condition is null"),!1):(t=[],Array.add(t,this.f),Array.add(t,this.h().a()),Array.addRange(t,this.h().l()),Array.add(t,this.e),i=new CommonUI.l(t),_Ewa.bO.d()?_Ewa.bO.a().j().a=i:(_Ewa.bO.a().bf(this.j,_Ewa.bO.a().a("sortconditions"),i),_Ewa.bO.a().f("sortconditions",n)),!0)}};_Ewa.rj=function(n,t,i){this.I=Function.createDelegate(this,this.N);this.H=Function.createDelegate(this,this.W);this.t=new($$sc.u.$$(_Ewa.SK));this.F={};_Ewa.rj.initializeBase(this,[n,null]);this.K=i;this.co().innerHTML=_Ewa.ds.k();var r=_Ewa.a.a(this.co(),"sortConditionTable");this.v=r.getElementsByTagName("tbody")[0];_Ewa.a.N(this.v,"tbody");this.y=r.getElementsByTagName("thead")[0];_Ewa.a.N(this.y,"thead");this.x=this.V(r);this.u=-1;this.G=t};_Ewa.rj.b=function(n){n.c(1);n.a().scrollIntoView()};_Ewa.rj.a=function(n,t){n.c(2);t.c(2);n.a().scrollIntoView()};_Ewa.rj.prototype={K:!1,J:!1,v:null,y:null,D:null,B:null,C:0,x:null,L:0,G:null,u:0,k:function(){return this.t.e.length},b:function(n){var t,i;for(this.B=n,t=this.t.$$lge();t.$$mn();)i=t.$$cu(),i.o(n);return n},e:function(){if(!this.D){this.D=new Array(this.t.e.length);for(var n=0;n<this.t.e.length;++n)this.D[n]=this.t.a(n).b()}return this.D},w:function(){return this.u>=0&&this.u<this.t.e.length?this.t.a(this.u):null},h:function(n){this.get_events().addHandler("cstmsrtscek",n)},p:function(n){this.get_events().removeHandler("cstmsrtscek",n)},i:function(n){this.get_events().addHandler("cstmsrtvcek",n)},q:function(n){this.get_events().removeHandler("cstmsrtvcek",n)},dispose:function(){this.J||(this.J=!0,this.v=null,this.y=null,this.x.dispose(),this.x=null,System.a.b(this.t.f()),this.t=null);_Ewa.YQ.prototype.dispose.call(this)},a:function(n,t){if(this.t.e.length<64){this.Q(n);var i=this.u+1,r=this.v.insertRow(i),u=this.U(r,n);this.t.i(i,u);this.M();this.t.e.length===1&&this.x.b();this.z(i,t);this.A();Diag.a.a(36304911,0,50,"SortConditionTableControl.AddLevel: added new condition. total number of conditions: {0}",this.t.e.length)}else Diag.a.a(591180751,0,50,"SortConditionTableControl.AddLevel: Can't add level since we reached the maximum level allowed.")},c:function(){if(this.w()){var n=_Ewa.md.b(this.w().b());this.a(n,!0);Diag.a.a(40977235,0,50,"SortConditionTable.CopyLevel: condition copied")}else Diag.a.a(41218625,0,50,"SortConditionTableControl.CopyLevel: No selected level (table is empty), Nothing to copy.")},d:function(n,t){var i,r,u;this.w()?(this.w().e()&&this.N(),i=this.u,r=this.t.e.length-1,this.v.deleteRow(i),u=this.t.a(i),this.t.h(i),u.dispose(),this.M(),this.u=-1,i<r?this.z(i,n):r>0&&this.z(r-1,n),!i&&r>0&&this.t.a(0).d(),this.t.e.length||this.x.a(),t&&this.A(),Diag.a.a(36304913,0,50,"SortConditionTable.DeleteLevel: condition deleted. total number of conditions: {0}",this.t.e.length)):Diag.a.a(591180750,0,50,"SortConditionTableControl.DeleteLevel: No selected level (table is empty), Nothing to delete.")},g:function(){this.u>0?(this.O(this.u),this.z(this.u-1,!0),this.A(),Diag.a.a(36475986,0,50,"SortConditionTable.MoveLevelUp: condition moved up")):Diag.a.a(41218594,0,50,"SortConditionTable.MoveLevelUp: Current selected level is {0}, cannot perform MoveLevelUp",this.u)},f:function(){this.u<this.t.e.length-1?(this.O(this.u+1),this.z(this.u+1,!0),this.A(),Diag.a.a(36475988,0,50,"SortConditionTable.MoveLevelDown: condition moved down")):Diag.a.a(41218595,0,50,"SortConditionTableControl.MoveLevelDown: Current selected level is {0}, cannot perform MoveLevelDown",this.u)},o:function(){for(var f=this.t.$$lge(),r,n,t,i,u;f.$$mn();)if(r=f.$$cu(),!_Ewa.md.a(r.b()))return _Ewa.rj.b(r),new _Ewa.SJ(this.C);for(n=0;n<this.t.e.length;++n)for(t=this.t.a(n),i=n+1;i<this.t.e.length;++i)if(u=this.t.a(i),_Ewa.md.c(t.b(),u.b()))return _Ewa.rj.a(t,u),new _Ewa.SM(t.k(),t.b().SortConditionType);return null},n:function(){var n=this.t.e.length-1;this.z(n,!1);this.t.a(n).a().scrollIntoView();this.A()},s:function(n){this.C=n;_Ewa.a.a(this.y,"thColumn").innerText=_Ewa.ff.e(n);this.S()},l:function(){var n={};return n.i=this.t.e.length,n.j=this.E(0),n.k=this.E(1),n.l=this.E(2),n.m=this.E(3),n.n=this.T(),this.R(n),n},j:function(){this.v.rows.length>0&&this.P()},r:function(){this.x.c()},m:function(){for(var n=this.t.$$lge(),t;n.$$mn();)if(t=n.$$cu(),t.i())return!0;return!1},V:function(n){return new _Ewa.bO(this,n)},U:function(n,t){return this.K?new _Ewa.kx(n,t,this.B,this.C,this.F,this.H,this.I,this.G,this.L++):new _Ewa.zC(n,t,this.B,this.C,this.F,this.H,this.I,this.G,this.L++)},W:function(n,t){this.u!==n&&n>=0&&n<this.t.e.length&&(this.z(n,!t),this.A());t&&this.x.d(t)},N:function(){this.Y();this.X()},R:function(n){for(var t,i=0,r=0,u=0,h=0,f=0,c=0,e=0,l=0,o=0,a=this.B,v=a.length,s=0;s<v;++s)t=a[s],t.CellColors&&(h+=t.CellColors.length,i++,t.CellColors.length>f&&(f=t.CellColors.length)),t.TextColors&&(c+=t.TextColors.length,r++,t.TextColors.length>e&&(e=t.TextColors.length)),t.Icons&&(l+=t.Icons.length,u++,t.Icons.length>o&&(o=t.Icons.length));n.o=i>0?h/i:-1;n.p=f;n.q=r>0?c/r:-1;n.r=e;n.s=u>0?l/u:-1;n.t=o},S:function(){while(this.t.e.length>0)this.d(!1,!1)},O:function(n){this.v.deleteRow(n);this.v.insertBefore(this.t.a(n).a(),this.t.a(n-1).a());var t=this.t.a(n);this.t.l(n,this.t.a(n-1));this.t.l(n-1,t);this.t.a(n-1).g();n===1&&(this.t.a(0).d(),this.t.a(1).d())},A:function(){this.cq("cstmsrtscek",new _Ewa.SN(this.t.e.length,this.u))},X:function(){this.cq("cstmsrtvcek",null)},Y:function(){for(var t=this.t.$$lge(),n;t.$$mn();)n=t.$$cu(),n.e()&&n.m()},z:function(n,t){if(n<0||n>=this.t.e.length){Diag.a.b(36304914,0,!1,"SortConditionTableControl.UpdateSelection: index out of boundaries");return}this.w()&&this.w().f(!1);this.u=n;this.w()&&this.w().f(!0);t&&this.r()},M:function(){switch(this.v.rows.length){case 0:var n=this.y.rows[0];_Ewa.a.t(n.cells[0],60);break;case 1:case 2:this.P();break;default:return}},P:function(){if(this.v.rows.length>0){var n=this.v.rows[0],t=this.y.rows[0];_Ewa.a.t(t.cells[0],n.cells[0].clientWidth)}},E:function(n){for(var u,i=0,r=this.e(),f=r.length,t=0;t<f;++t)u=r[t],i+=u.SortConditionType===n?1:0;return i},T:function(){for(var t,u,i=0,r=this.e(),f=r.length,n=0;n<f;++n)t=r[n],u=!t.SortConditionType&&!_Ewa.e.a(t.CustomOrder),i+=u?1:0;return i},Q:function(n){n&&!_Ewa.e.a(n.CustomOrder)&&(this.F[n.RowColOffset.toString()]=n.CustomOrder)}};_Ewa.SN=function(n,t){_Ewa.SN.initializeBase(this);this.a=n;this.b=t};_Ewa.SN.prototype={a:0,b:0};_Ewa.of=function(){};_Ewa.og=function(){};_Ewa.og.b=function(n,t){switch(n){case 1:return _Ewa.ClientStringManager.a().a(187);case 2:return _Ewa.ClientStringManager.a().a(188);case 5:return _Ewa.og.a(t,!0);case 6:return _Ewa.og.a(t,!1);default:return Diag.a.b(38622848,0,!1,"SortOrder.Text: Unsupported type {0}",n),null}};_Ewa.og.a=function(n,t){var r,f;if(!n||!n.length)return Diag.a.b(38622849,0,!1,"SortOrder.GetTextForCustomOrder: CustomOrder is null or empty"),"";var i=n.split(","),e=t?0:i.length-1,u=new Sys.StringBuilder(i[e]);for(r=1;r<i.length;++r)f=t?r:i.length-r-1,u.append(","),u.append(" "),u.append(i[f]);return Common.d.b(u.toString())};_Ewa.ff=function(){};_Ewa.ff.e=function(n){var t=n?178:177;return _Ewa.ClientStringManager.a().a(t)};_Ewa.ff.b=function(n){return _Ewa.jm.toString(n)};_Ewa.ff.c=function(n){var t;switch(n){case 0:t=_Ewa.ClientStringManager.a().a(173);break;case 1:t=_Ewa.ClientStringManager.a().a(174);break;case 2:t=_Ewa.ClientStringManager.a().a(175);break;default:t="";Diag.a.b(41423047,0,!1,"SortOrientationExtension.OptionLabel: Unsupported orientation value: {0}",n)}return t};_Ewa.ff.a=function(n,t){var i;switch(n){case 0:i=t?_Ewa.ClientStringManager.a().a(189):_Ewa.ClientStringManager.a().a(190);break;case 1:i=t?_Ewa.ClientStringManager.a().a(191):_Ewa.ClientStringManager.a().a(192);break;case 2:i=t?_Ewa.ClientStringManager.a().a(192):_Ewa.ClientStringManager.a().a(191);break;default:i="";Diag.a.b(41423048,0,!1,"SortOrientationExtension.OrderOptionLabel: Unsupported orientation value: {0}",n)}return i};_Ewa.ff.f=function(n,t){return n?0:t?2:1};_Ewa.ff.d=function(n){return Enum.parse(_Ewa.jm,n)};_Ewa.zB=function(n){_Ewa.zB.initializeBase(this,[n])};_Ewa.zB.a=function(n){_Ewa.Z.a(160,new _Ewa.zB(n))};_Ewa.zB.prototype={g:function(){if(this.a.a(359)){var n=this;_Ewa.f.cw(_Ewa.l.b(_Ewa.hf,this.a.b(),309,310,this.c,null),function(t){n.f([new _Ewa.zA(n.a,t.a())],null)},this.a.i(),3)}else this.f([new _Ewa.zA(this.a,null)],null)}};_Ewa.rk=function(){};_Ewa.rk.a=function(n,t,i,r,u,f){var e=n.a(41,f);return e.options=t,_Ewa.j.a(n,"Sort",e,i,r,u,0,null)};_Ewa.oH=function(){};_Ewa.oH.c=function(n,t,i,r,u,f){var e=n.a(41,f);return e.filterRange=t,_Ewa.j.a(n,"ToggleAutoFilter",e,i,r,u,0,null)};_Ewa.oH.a=function(n,t,i,r,u,f){var e=n.a(41,f);return e.selectedRange=t,_Ewa.j.a(n,"ClearAutoFilter",e,i,r,u,0,null)};_Ewa.oH.b=function(n,t,i,r,u,f){var e=n.a(41,f);return e.filterRange=t,_Ewa.j.a(n,"ReapplyAutoFilter",e,i,r,u,0,null)};_Ewa.hN=function(){};_Ewa.hN.d=function(n){var t={};return t.CellColors=n.CellColors,t.ColumnOffset=n.ColumnOffset,t.Name=n.Name,t.Icons=n.Icons,t.TextColors=n.TextColors,t};_Ewa.hN.a=function(n,t){var i=_Ewa.hN.d(n),r;return n.CellColors&&(i.CellColors=_Ewa.hN.b(n.CellColors,t.CellColors)),n.TextColors&&(i.TextColors=_Ewa.hN.b(n.TextColors,t.TextColors)),n.Icons&&(t.Icons&&_Ewa.hN.c(n.Icons[0],t.Icons)?i.Icons=t.Icons:(i.Icons=(r=n.Icons).concat.apply(r,t.Icons),i.Icons.sort(function(n,t){return n.IconSet===-1?-1:t.IconSet===-1?1:0}))),i};_Ewa.hN.b=function(n,t){return t&&Array.indexOf(t,n[0])<0?n.concat.apply(n,t):t};_Ewa.hN.c=function(n,t){for(var r,i=0;i<t.length;i++)if(r=t[i],r.IconSet===n.IconSet&&r.Icon===n.Icon)return!0;return!1};_Ewa.pB=function(){};_Ewa.pB.a=function(n,t,i,r,u){return!!n&&_Ewa.pB.b(n,t)&&_Ewa.pB.c(n,i,r,u)};_Ewa.pB.b=function(n,t){var i=n.ColumnInfo;switch(t){case 1:return!i.CellColors||!i.CellColors.length?(Diag.a.a(50671838,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on cell color result cell colors is null or there are no colors (must have at least 1)."),!1):!0;case 2:return!i.TextColors||!i.TextColors.length?(Diag.a.a(50671839,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on font color result text colors is nullor there are no colors (must have at least 1)."),!1):!0;case 3:return!i.Icons||!i.Icons.length?(Diag.a.a(50671840,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on icon result icons is nullor there are no icons (must have at least 1)."),!1):!0;default:return Diag.a.a(50671841,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: illeagl sort condition type."),!1}};_Ewa.pB.c=function(n,t,i,r){var u=n.HeaderColumnInfo;return!r&&!u?!0:t!==2||!i?u?(Diag.a.a(50671842,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo should be null when range type is not SheetRange, or when headerRowSize{0} == 0.",i),!1):!0:u.CellColors&&u.CellColors.length!==1?(Diag.a.a(50671843,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.CellColors should be null or have exactly 1 color."),!1):u.TextColors&&u.TextColors.length!==1?(Diag.a.a(50671872,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.TextColors should be null or have exactly 1 color"),!1):u.Icons&&u.Icons.length!==1?(Diag.a.a(50671873,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.Icons should be null or have exactly 1 icon"),!1):!0};_Ewa.JR.registerClass("_Ewa.JR");_Ewa.Ne.registerClass("_Ewa.Ne");_Ewa.Nr.registerClass("_Ewa.Nr");_Ewa.zy.registerClass("_Ewa.zy");_Ewa.rf.registerClass("_Ewa.rf",null,_Ewa.SG);_Ewa.zw.registerClass("_Ewa.zw",_Ewa.rf);_Ewa.rg.registerClass("_Ewa.rg",null,_Ewa.SH);_Ewa.re.registerClass("_Ewa.re",_Ewa.rg);_Ewa.SB.registerClass("_Ewa.SB",_Ewa.YQ);_Ewa.SC.registerClass("_Ewa.SC",_Ewa.YQ);_Ewa.cU.registerClass("_Ewa.cU",_Ewa.baN);_Ewa.SD.registerClass("_Ewa.SD",_Ewa.FE);_Ewa.SE.registerClass("_Ewa.SE",_Ewa.rf);_Ewa.SF.registerClass("_Ewa.SF",_Ewa.rg);_Ewa.w.registerClass("_Ewa.w");_Ewa.biB.registerClass("_Ewa.biB",_Ewa.FD);_Ewa.SL.registerClass("_Ewa.SL",_Ewa.biB);_Ewa.zA.registerClass("_Ewa.zA",null,_Ewa.kh);_Ewa.kx.registerClass("_Ewa.kx",_Ewa.YQ,_Ewa.SK,Sys.IDisposable);_Ewa.zC.registerClass("_Ewa.zC",_Ewa.YQ,_Ewa.SK,Sys.IDisposable);_Ewa.rj.registerClass("_Ewa.rj",_Ewa.YQ,_Ewa.bix,Sys.IDisposable);_Ewa.SN.registerClass("_Ewa.SN",Sys.EventArgs);_Ewa.zB.registerClass("_Ewa.zB",_Ewa.Z);_Ewa.ds.a=0;_Ewa.ds.c="<div class='ewa-customsort-dlg-controls' id='customSortControls'> <button id='addBtn' class='WACButton ewa-customsort-dlg-icon-and-label-button' aria-label='{1}'>{0}<\/button> <button id='dltBtn' class='WACButton ewa-customsort-dlg-icon-and-label-button' aria-label='{3}'>{2}<\/button> <button id='copyBtn' class='WACButton ewa-customsort-dlg-icon-and-label-button' aria-label='{5}'>{4}<\/button> <button id='mvupBtn' class='WACButton ewa-customsort-dlg-button'><\/button> <button id='mvdwnBtn' class='WACButton ewa-customsort-dlg-button'><\/button> <div id='sortOptionsDiv' class='ewa-customsort-dlg-options-button'><\/div> <div id='hasHeadersDiv' class='ewa-customsort-dlg-has-headers-checkbox'><\/div> <\/div> <hr class='ewa-customsort-dlg-hr' /> <div class='ewa-customsort-dlg-disc-msg WACDialogRowNoBreak' id='disclaimerContainer'> <label id='disclaimerMessage' class='ewa-customsort-dlg-disc-msg-label' tabindex='0' role='note' aria-label='{6}' >{6}<\/label> <\/div> <div class='WACDialogRow ewa-customsort-dlg-sort-conditions' id='sortConditions'> <div id='sortConditionTableDiv'><\/div> <\/div> <div class='ewa-customsort-dlg-err-msg WACDialogRowNoBreak' id='errContainer'> <label id='errMessage' class='WACDialogLabel' role='alert' >{7}<\/label> <\/div>";_Ewa.ds.f="<table id='sortConditionTable' class='ewa-customsort-dlg-table' cellpadding=5 width='100%' role='presentation'> <thead> <tr> <th class='ewa-customsort-dlg-level'> <\/th> <th class='ewa-customsort-dlg-column ewa-dlg-unselectable'> <span id='thColumn' class='WACDialogSpan'>{0}<\/span> <\/th> <th class='ewa-customsort-dlg-sorton ewa-dlg-unselectable'> <span id='thSortOn' class='WACDialogSpan'>{1}<\/span> <\/th> <th class='ewa-customsort-dlg-order ewa-dlg-unselectable' colspan='2'> <span id='thOrder' class='WACDialogSpan'>{2}<\/span> <\/th> <\/tr> <tr tabindex='0'> <\/tr> <\/thead> <tbody> <\/tbody> <tfoot> <tr tabindex='0'> <\/tr> <\/tfoot> <\/table>";_Ewa.ds.d="<tr> <th class='ewa-customsort-dlg-level ewa-dlg-unselectable'> <\/th> <td class='ewa-customsort-dlg-column' id='tdSelectColumn'> <\/td> <td class='ewa-customsort-dlg-sorton' id='tdSelectSortOn'> <\/td> <td class='ewa-customsort-dlg-order' id='tdSelectOrder' colspan='2'> <\/td> <td class='ewa-customsort-dlg-color-or-icon' id='tdColorOrIcon'> <\/td> <td class='ewa-customsort-dlg-color-or-icon-order' id='tdSelectColorOrIconOrder'> <\/td> <\/tr>";_Ewa.ds.e="<tr> <th class='ewa-customsort-dlg-level ewa-dlg-unselectable'> <\/th> <td class='ewa-customsort-dlg-column'> <select class='WACDialogList ewa-dlg-list ewa-customsort-dlg-list' id='tdSelectColumn' aria-labelledby='thColumn'> <\/select> <\/td> <td class='ewa-customsort-dlg-sorton'> <select class='WACDialogList ewa-dlg-list ewa-customsort-dlg-list' id='tdSelectSortOn' aria-labelledby='thSortOn'> <option value='{0}'>{1}<\/option> <option value='{2}'>{3}<\/option> <option value='{4}'>{5}<\/option> <option value='{6}'>{7}<\/option> <\/select> <\/td> <td class='ewa-customsort-dlg-order' colspan='2'> <select class='WACDialogList ewa-dlg-list ewa-customsort-dlg-list' id='tdSelectOrder' aria-labelledby='thOrder'> <\/select> <\/td> <td class='ewa-customsort-dlg-color-or-icon'> <select class='WACDialogList ewa-dlg-list ewa-customsort-dlg-list color-or-icon-combobox' id='tdSelectColorOrIcon'> <\/select> <div id='{8}' class='selected-color-or-icon'><\/div> <div id='tdColorOrIconFlyoutAnchor' class='color-or-icon-flyout-anchor' aria-labelledby='thOrder {8}'><\/div> <\/td> <td class='ewa-customsort-dlg-color-or-icon-order'> <select class='WACDialogList ewa-dlg-list ewa-customsort-dlg-list' id='tdSelectColorOrIconOrder' aria-labelledby='thOrder'> <\/select> <\/td> <\/tr>";_Ewa.ds.g="<div id='caseSensitiveDiv'><\/div> <hr class='ewa-customsort-dlg-hr' /> <label id='orientationLabel' class='ewa-customsort-orientation-label ewa-dlg-unselectable WACDialogLabel' >{0}<\/label> <div id='orientationDiv'><\/div>";_Ewa.ri.a="<div class='WACDialogSubtitle' id='sortByColorDialogSubtitle'> <label id='sortByColorDialogSubtitleText' class='WACDialogLabel' >&nbsp;<\/label> <\/div>";_Ewa.w.a=new _Ewa.w("ewaism_200",1550);_Ewa.w.f=new _Ewa.w("ewaism_201",1551);_Ewa.w.q=new _Ewa.w("ewaism_202",1552);_Ewa.w.d=new _Ewa.w("ewaism_203",1553);_Ewa.w.c=new _Ewa.w("ewaism_204",1554);_Ewa.w.i=new _Ewa.w("ewaism_205",1555);_Ewa.w.D=new _Ewa.w("ewaism_206",1556);_Ewa.w.O=new _Ewa.w("ewaism_207",1557);_Ewa.w.X=new _Ewa.w("ewaism_208",1558);_Ewa.w.b=new _Ewa.w("ewaism_209",1559);_Ewa.w.m=new _Ewa.w("ewaism_210",1560);_Ewa.w.s=new _Ewa.w("ewaism_211",1561);_Ewa.w.E=new _Ewa.w("ewaism_212",1562);_Ewa.w.P=new _Ewa.w("ewaism_213",1563);_Ewa.w.Z=new _Ewa.w("ewaism_214",1564);_Ewa.w.N=new _Ewa.w("ewaism_215",1565);_Ewa.w.ba=new _Ewa.w("ewaism_216",1566);_Ewa.w.C=new _Ewa.w("ewaism_217",1567);_Ewa.w.M=new _Ewa.w("ewaism_218",1568);_Ewa.w.V=new _Ewa.w("ewaism_219",1569);_Ewa.w.r=new _Ewa.w("ewaism_220",1570);_Ewa.w.p=new _Ewa.w("ewaism_221",1571);_Ewa.w.j=new _Ewa.w("ewaism_222",1572);_Ewa.w.h=new _Ewa.w("ewaism_223",1573);_Ewa.w.v=new _Ewa.w("ewaism_224",1574);_Ewa.w.J=new _Ewa.w("ewaism_225",1575);_Ewa.w.G=new _Ewa.w("ewaism_226",1576);_Ewa.w.u=new _Ewa.w("ewaism_231",1577);_Ewa.w.t=new _Ewa.w("ewaism_227",1577);_Ewa.w.z=new _Ewa.w("ewaism_227",1578);_Ewa.w.w=new _Ewa.w("ewaism_232",1579);_Ewa.w.T=new _Ewa.w("ewaism_233",1580);_Ewa.w.H=new _Ewa.w("ewaism_234",1581);_Ewa.w.L=new _Ewa.w("ewaism_235",1582);_Ewa.w.B=new _Ewa.w("ewaism_236",1583);_Ewa.w.R=new _Ewa.w("ewaism_237",1584);_Ewa.w.W=new _Ewa.w("ewaism_238",1585);_Ewa.w.bb=new _Ewa.w("ewaism_247",1586);_Ewa.w.l=new _Ewa.w("ewaism_239",1587);_Ewa.w.o=new _Ewa.w("ewaism_240",1588);_Ewa.w.n=new _Ewa.w("ewaism_241",1589);_Ewa.w.g=new _Ewa.w("ewaism_242",1590);_Ewa.w.bc=new _Ewa.w("ewaism_248",1591);_Ewa.w.K=new _Ewa.w("ewaism_249",1592);_Ewa.w.U=new _Ewa.w("ewaism_250",1593);_Ewa.w.S=new _Ewa.w("ewaism_251",1594);_Ewa.w.y=new _Ewa.w("ewaism_252",1595);_Ewa.w.x=new _Ewa.w("ewaism_253",1596);_Ewa.w.I=new _Ewa.w("ewaism_254",1597);_Ewa.w.A=new _Ewa.w("ewaism_255",1598);_Ewa.w.Q=new _Ewa.w("ewaism_256",1599);_Ewa.w.Y=new _Ewa.w("ewaism_257",1600);_Ewa.w.F=new _Ewa.w("ewaism_258",1601);_Ewa.w.e=[[_Ewa.w.f,_Ewa.w.q,_Ewa.w.a],[_Ewa.w.c,_Ewa.w.i,_Ewa.w.d],[_Ewa.w.O,_Ewa.w.X,_Ewa.w.D],[_Ewa.w.m,_Ewa.w.s,_Ewa.w.b],[_Ewa.w.P,_Ewa.w.Z,_Ewa.w.E],[_Ewa.w.N,_Ewa.w.ba,_Ewa.w.b],[_Ewa.w.M,_Ewa.w.V,_Ewa.w.C],[_Ewa.w.R,_Ewa.w.W,_Ewa.w.B],[_Ewa.w.f,_Ewa.w.p,_Ewa.w.r,_Ewa.w.a],[_Ewa.w.c,_Ewa.w.h,_Ewa.w.j,_Ewa.w.d],[_Ewa.w.t,_Ewa.w.G,_Ewa.w.J,_Ewa.w.v],[_Ewa.w.l,_Ewa.w.o,_Ewa.w.n,_Ewa.w.g],[_Ewa.w.u,_Ewa.w.m,_Ewa.w.s,_Ewa.w.b],[_Ewa.w.f,_Ewa.w.p,_Ewa.w.q,_Ewa.w.r,_Ewa.w.a],[_Ewa.w.c,_Ewa.w.h,_Ewa.w.i,_Ewa.w.j,_Ewa.w.d],[_Ewa.w.bb,_Ewa.w.l,_Ewa.w.o,_Ewa.w.n,_Ewa.w.g],[_Ewa.w.w,_Ewa.w.L,_Ewa.w.H,_Ewa.w.T,_Ewa.w.z],[_Ewa.w.x,_Ewa.w.I,_Ewa.w.A],[_Ewa.w.Q,_Ewa.w.Y,_Ewa.w.F],[_Ewa.w.bc,_Ewa.w.K,_Ewa.w.U,_Ewa.w.S,_Ewa.w.y]];_Ewa.of.a=_Ewa.bu.b(240,240,235);Type.registerNamespace("_Ewa");_Ewa.biA=function(){};_Ewa.biA.a=function(){_Ewa.k.a(_Ewa.zB.a)};_Ewa.biA.a();Type.registerNamespace("_Ewa");_Ewa.TM=function(n){this.a=n};_Ewa.TM.prototype={a:null,x:function(n,t,i){var r=this.a.b(215809929,2,i,null);return r!==2?$$sc.a.a(Boolean,!0):_Ewa.L.a(t.a)},w:function(n,t){return t.a===215809929},y:function(){return!1},z:function(){return!1}};_Ewa.Ad=function(n){_Ewa.Ad.initializeBase(this,[n])};_Ewa.Ad.a=function(n){_Ewa.Z.a(207,new _Ewa.Ad(n))};_Ewa.Ad.prototype={g:function(){this.f([new _Ewa.TM(Common.a.c())],null)}};_Ewa.TM.registerClass("_Ewa.TM",null,_Ewa.kh);_Ewa.Ad.registerClass("_Ewa.Ad",_Ewa.Z);Type.registerNamespace("_Ewa");_Ewa.bjm=function(){};_Ewa.bjm.a=function(){_Ewa.k.a(_Ewa.Ad.a)};_Ewa.bjm.a();Type.registerNamespace("_Ewa");_Ewa.hB=function(n,t){if(this.s=Function.createDelegate(this,this.S),this.x=Function.createDelegate(this,this.X),this.t=Function.createDelegate(this,this.T),this.A=Function.createDelegate(this,this.H),this.C=Function.createDelegate(this,this.ba),this.B=Function.createDelegate(this,this.Z),this.w=Function.createDelegate(this,this.W),this.v=Function.createDelegate(this,this.V),this.u=Function.createDelegate(this,this.U),this.q=Function.createDelegate(this,this.R),this.z=Function.createDelegate(this,this.Y),this.y=Function.createDelegate(this,this.G),this.D=new _Ewa.ci(!1),this.r=[],_Ewa.hB.initializeBase(this,[!1]),this.n=n,this.p=t,this.K(),Common.a.d&&Common.a.d.i(this),t){var i=n.d(),r=i.f();i.g(this.y);i.d(this.z);i.k(this.q);i.m(this.q);r.e(this.u);r.c(this.v);n.c().g(this.w);n.c().w(this.B);n.E(this.C);n.H(this.A);n.c().D(this.t);n.g().c(this.x);_Ewa.h.e(n.c().p())&&this.G(this,new _Ewa.rx(n.c().p(),null,!1,-1,-1,-1,"",-1,"",-1));this.F(_Ewa.bp.a(n))}n.b().b(_Ewa.cQ,5,this)};_Ewa.hB.a=function(){return _Ewa.hB.b||(_Ewa.hB.b=[0,1,2,3,4])};_Ewa.hB.prototype={o:null,p:!1,f:function(n){this.D.dK("bBarAttached",n)},e:function(){return this.r},d:function(){return this.o?this.o.co():null},n:null,dispose:function(){if(this.n){var n=this.n,t=n.d(),i=t.f();t.h(this.y);t.e(this.z);t.l(this.q);t.s(this.q);i.d(this.v);i.f(this.u);n.c().h(this.w);n.c().y(this.B);n.G(this.C);n.I(this.A);n.c().J(this.t);n.g().e(this.x);_Ewa.b.a(n).g().d(this.s)}System.a.a(this.o);this.o=null;this.n=null;_Ewa.bbv.prototype.dispose.call(this)},P:function(n){switch(n){case 5:case 6:case 10:case 39:case 8:case 30:return!0;default:return!1}},a:function(n,t,i){(!this.n.bs()||this.P(n))&&(this.p&&!this.c(n)&&(this.o.h(n,t),this.D.dJ("bBarAttached",new _Ewa.CY(n,i),null)),t&&t.Appearance===32&&_Ewa.N.a(this.n).a().g(t))},j:function(n,t,i,r){Diag.a.a(51222467,0,50,"BusinessBar.ShowGdprPrivacyNotice: Called");_Ewa.eg.e(n,t,i,r);this.a(31,null,null)},h:function(n,t,i,r){_Ewa.ey.e(n,t,i,r);this.a(32,null,null)},m:function(n,t,i,r){_Ewa.ez.e(n,t,i,r);this.a(33,null,null)},b:function(n){this.p&&this.o.c(n)},g:function(n){return this.p?this.o.j(n):!1},c:function(n){return this.p?this.o.f(n):!1},k:function(){Diag.a.a(19965130,0,50,"Network disconnect notification received from the app")},l:function(){Diag.a.a(19965131,0,50,"Network resumed notification received from the app, turning off the TransientServerCommunicationFailures business bar");this.b(20)},K:function(){if(this.p){if(this.o)return;_Ewa.b.a(this.n).g().c(this.s);var t=this.n.m(),n=document.getElementById(t+"businessBar");this.n.R()&&_Ewa.cK.a().h().a("BusinessBar",n);this.o=new _Ewa.jz(this.n,n)}},bb:function(){this.p&&this.o.l()},R:function(){this.n.d().q()?this.b(12):this.a(12,null,null)},V:function(){this.b(20);this.c(40)&&(Diag.a.a(51167832,0,15,"BusinessBar.OnNetworkResumed: removing NetworkDown BB"),this.b(40))},Y:function(n,t){for(var u,i=0,r=_Ewa.hB.a().length;i<r;i++)u=_Ewa.hB.a()[i],this.b(u);t.b&&t.b.c>0&&(Diag.a.a(19965132,0,50,"OnWebMethodSuccess: retry due to previous communication failure succeeded, turning off the TransientServerCommunicationFailures business bar"),this.b(20))},G:function(n,t){for(var i,w,s,l,u,f,a,h,e,v,y,c=this.L(t.b),r=[],o=0,p=c.length;o<p;++o){for(i=c[o],i.Type===1&&i.Appearance&32?r=this.M(i,r):(w=[i],t.d&&(Diag.a.a(19965133,0,50,"OnWebMethodError: Server communication failure detected, turning on the TransientServerCommunicationFailures business bar"),s=t.a&&t.a.b?t.a.b.b():-1,s<5e3?Diag.a.a(20240466,0,50,"OnWebMethodError:  communication errors duration is below the min time for notification, skipping raise of business bar (duration = {0}ms).",s):Common.a.O||this.J(i,t.a.a))),u=(l=[]).concat.apply(l,_Ewa.hB.a()),f=0,a=r.length;f<a;++f)h=r[f],this.a(h,i,null),Array.remove(u,h);for(e=0,v=u.length;e<v;++e)y=u[e],this.b(y)}},L:function(n){for(var u,f,i=[],r=n,e=r.length,t=0;t<e;++t){u=r[t];switch(u.MessageId){case-113742550:f=[757111532,2113407564,1393475740,104919273,-949523941];(this.n.c().b()||_Ewa.h.c(n,f))&&Array.add(i,-113742550)}}return _Ewa.h.g(n,i,null)},U:function(n,t){for(var u,i=0,r=t.b.length;i<r;++i)u=t.b[i],Common.a.O||this.a(40,u,null)},M:function(n,t){var u=!this.n.a(345),r,i;switch(n.MessageId){case 2113407564:for(r=_Ewa.h.n([1821390342,-943219229,-502303485,1437034227]),i=0;i<r.length;i++)r[i].HelpTopicId=n.HelpTopicId,r[i].HelpDescription=n.HelpDescription,Array.add(this.r,r[i])}switch(n.MessageId){case-395951567:this.a(7,n,null);break;case 1643490758:this.a(5,n,null);break;case-907264831:this.a(6,n,null);break;case 757111532:case 2113407564:this.a(8,n,null);break;case 2010656511:this.a(14,n,null);break;case 1977917703:this.n.dn(!0);this.a(9,n,null);break;case 1756116017:this.a(13,n,null);break;case-1703455218:this.a(16,n,null);break;case 1393475740:this.a(24,n,null);break;case-949523941:this.a(25,n,null);break;case 1779381952:this.a(35,n,null);break;case 1421575100:this.a(36,n,null);break;case 1544494907:u&&Array.add(t,0);break;case-655555355:Array.add(t,this.Q()?2:1);break;case-1221382671:Array.add(t,3);break;case 1662282929:Array.add(t,4);break;case 104919273:this.n.c().m()||Array.add(t,28);break;case-37299333:break;case 136737622:Array.add(t,37);break;case-1780327030:this.a(39,n,null);break;case-113742550:this.a(41,n,null);break;default:this.a(10,n,null)}return t},W:function(n,t){this.H(n,t)},H:function(){var n=this.n.c();n.a()||n.m()||(this.bb(),Array.clear(this.r))},O:function(){if(Common.a.a.a("WildFireExcelBizBar")&&!Common.App.WildFire.a.d(Common.App.WildFire.a.c(1))&&(Common.c.h()||Common.c.c())){var n=_Ewa.l.a(Object,this.n.b(),155,this.n.i(),1,null),t=this;_Ewa.f.cw(n,function(){t.a(19,null,null)},this.dM(),3)}},N:function(){var n=this.n.a(85),t=this.n.a(881);_Ewa.i.K(t,n)&&(Common.T.b("NewBrowserSuggestionShown",!0,0,null),Common.M.a("NewBrowserSuggestionShown","true",7),this.a(23,null,null))},ba:function(n,t){(!this.n.c().m()||t.a)&&this.F(t.a)},F:function(n){if(!n&&!this.n.bi()||this.n.z().a(1)){var t=this.n.l().FullDocumentInfo.IrmPolicyDescription;!t||!t.length||(Diag.a.a(39179479,0,50,"BusinessBar.InitBusinessBar: Adding bisinessBar for irm protection."),this.a(15,null,null))}this.O();this.N();this.E()},X:function(){var n=this.n.g().l();n&&n.a.c()&1&&this.I()},S:function(){this.I()},Z:function(){this.E()},E:function(){this.n.l().Options&32768&&this.i()},i:function(){this.a(30,null,null)},I:function(){this.n.r()&8&&this.a(11,null,null)},Q:function(){var n=this.n.b().a(_Ewa.oF,38,!1,null);return n?n.i():!1},J:function(n,t){if(!this.c(20)&&n.MessageId!==-1387426400){Diag.a.a(20240467,0,50,"BusinessBar: raising the transient communication failures notification.");var i={};i.FailedMethod=t;this.a(20,n,i)}},T:function(){if(this.n.L()&&this.n.c().m()&&this.n.c().a())if(this.n.c().C())this.n.isChangeGateEnabled("OfficeVSO:4273335_RemoveCorruptedFileRepairedBizBarEntryOnSwitchToEditMode")&&this.b(36),this.b(11),this.b(28),this.b(21),this.b(41);else{if(this.n.isChangeGateEnabled("OfficeVSO:3843662_ExternalLinksViewEditBizBar")){var n=this.n.b().a(_Ewa.hM,331,!1,null);n&&n.b()||this.b(39)}this.n.isChangeGateEnabled("OfficeVSO:4262834_ExternalLinksDismissShowErrorBizbarInViewMode")&&this.b(6)}}};_Ewa.ey=function(n,t){_Ewa.ey.initializeBase(this,[n,t]);this.d=!0;this.e=_Ewa.ey.d;this.f=_Ewa.ey.b};_Ewa.ey.e=function(n,t,i,r){_Ewa.ey.d=n;_Ewa.ey.b=t;_Ewa.ey.a=i;_Ewa.ey.c=r};_Ewa.ey.prototype={r:function(){return _Ewa.ey.a},b:function(n){_Ewa.is.prototype.b.call(this,n);var t=_Ewa.ey.c;t&&t(null)}};_Ewa.jz=function(n,t){this.d=Function.createDelegate(this,this.k);this.b=new Array(42);_Ewa.jz.initializeBase(this,[t,null]);this.a=n;this.set_visible(!1);this.addCssClass("ewa-bb");Common.h.a().a("keydown",this.D(),this.d);_Ewa.be.a(n).a(this)};_Ewa.jz.b=function(){var n;return n=_Ewa.eQ.a()?231:230,_Ewa.jz.a||(_Ewa.jz.a=[new _Ewa.bv(0,246,247,248,0,0,"ewa-mb-error","BB_UnableToSaveWorkbook"),new _Ewa.bv(1,249,250,251,0,0,"ewa-mb-error","BB_UnableToRefreshLock"),new _Ewa.bv(2,249,250,251,0,0,"ewa-mb-error","BB_UnableToRefreshLockExpected"),new _Ewa.bv(3,238,239,0,0,0,"ewa-mb-warning","BB_WorkbookAlmostTooLarge"),new _Ewa.bv(4,240,241,242,0,0,"ewa-mb-error","BB_WorkbookTooLarge"),new _Ewa.bv(5,229,n,0,0,0,"ewa-mb-warning","BB_ExternalWorkbookLinksDisabled"),new _Ewa.bv(6,233,232,234,0,0,"ewa-mb-error","BB_ExternalWorkbookLinksShowError"),new _Ewa.bv(7,235,236,237,0,0,"ewa-mb-info","BB_EditAndRefreshDisabledOnBIAHostedFiles"),new _Ewa.bv(8,221,222,223,0,0,"ewa-mb-info","BB_UnsupportedFeatures"),new _Ewa.bv(9,0,0,0,0,0,"ewa-mb-info","BB_CollabLocaleMismatch"),new _Ewa.bv(10,252,253,254,0,0,"ewa-mb-error","BB_LastGenericStatusError"),new _Ewa.bv(11,255,256,257,0,0,"ewa-mb-warning","BB_ScratchPadWarning"),new _Ewa.bv(12,258,259,260,0,0,"ewa-mb-error","BB_AuthenticationLost"),new _Ewa.bv(13,261,262,263,0,0,"ewa-mb-warning","BB_OdfCompatibilityIssues"),new _Ewa.bv(14,0,519,0,0,0,"ewa-mb-warning","BB_PivotChartInteractivityMissingWarning"),new _Ewa.bv(15,0,0,0,0,0,"ewa-mb-info","BB_WorkbookIsIrmProtected"),new _Ewa.bv(16,0,0,0,0,0,"ewa-mb-info","BB_BIFeatureNotAvailable"),new _Ewa.bv(17,264,265,260,0,0,"ewa-mb-warning","BB_AnonymousCreateMode"),new _Ewa.bv(18,224,225,0,0,0,"ewa-mb-warning","BB_UnsupportedInteractiveReportEditing"),new _Ewa.bv(19,0,0,0,0,0,"ewa-mb-info","BB_MobileAppCampaignBizBar"),new _Ewa.bv(20,270,271,0,0,0,"ewa-mb-info","BB_TransientServerCommunicationFailures"),new _Ewa.bv(21,1422,1423,1424,0,0,"ewa-mb-info","BB_EditAttemptInReadOnly"),new _Ewa.bv(22,1422,1423,0,0,0,"ewa-mb-info","BB_EditAttemptInReadOnlyNoEditPermissions"),new _Ewa.bv(23,0,1412,1413,0,0,"ewa-mb-info","BB_UnsupportedBrowser"),new _Ewa.bv(24,273,274,0,0,0,"ewa-mb-info","BB_ReadOnlyPermissions"),new _Ewa.bv(25,275,276,0,0,0,"ewa-mb-info","BB_DocumentIsIrmProtectedWarning"),new _Ewa.bv(26,0,0,0,0,0,"ewa-mb-warning","BB_PolicyWarningMessage"),new _Ewa.bv(27,1110,272,0,0,0,"ewa-mb-info","BB_WorkingOnIt"),new _Ewa.bv(28,1425,1426,1427,0,0,"ewa-mb-info","BB_WorkbookIsReadOnlyRecommended"),new _Ewa.bv(29,279,280,0,0,0,"ewa-mb-warning","BB_ThirdPartyAddinDisabled"),new _Ewa.bv(30,1519,1520,0,0,1521,"","BB_FinanceLinkedEntityDisclaimerBar"),new _Ewa.bv(31,0,0,0,0,0,"ewa-mb-info","BB_WacGdprNotice"),new _Ewa.bv(32,0,0,0,0,0,"ewa-mb-info","BB_AutomaticSensitivityLabel"),new _Ewa.bv(33,0,0,0,0,0,"ewa-mb-info","BB_RecommendedSensitivityLabel"),new _Ewa.bv(34,281,282,283,0,0,"ewa-mb-info","BB_LocalStorageDisabled"),new _Ewa.bv(35,576,577,0,0,0,"ewa-mb-info","BB_AutoRefreshDisabled"),new _Ewa.bv(36,877,876,878,1134,0,"ewa-mb-info","BB_CorruptedFileRepaired"),new _Ewa.bv(37,243,244,245,0,0,"ewa-mb-warning","BB_MinorVersionLimitReached"),new _Ewa.bv(38,277,278,0,0,0,"ewa-mb-warning","BB_SensitivityApplicationError"),new _Ewa.bv(39,1807,1808,1809,1812,0,"ewa-mb-info","BB_ExternalWorkbookLinksDisabled"),new _Ewa.bv(40,270,271,0,0,0,"ewa-mb-info","BB_NetworkDown"),new _Ewa.bv(41,284,285,286,0,0,"ewa-mb-info","BB_DefaultToViewDueToCogs")])};_Ewa.jz.prototype={g:"input,button,select,submit,a,textarea,div",e:!1,bg:function(){return"BB"},D:function(){return this.co()},by:function(){return this.get_visible()},a:null,k:function(n){if(n.a.keyCode===9){var t=this.D().querySelectorAll(this.g),i=_Ewa.a.p(t),r=_Ewa.a.w(t);return _Ewa.a.G(n.a,i,r)}return!1},P:function(n,t){return t||_Ewa.a.c(this.co().firstChild,!1),!t},dG:function(n){return _Ewa.a.e(this.D(),n)},cE:function(){},bK:function(){},dispose:function(){this.e||(Common.h.a().b("keydown",this.D(),this.d),System.a.b(this.b),this.b=new Array(42),this.a=null,_Ewa.YQ.prototype.dispose.call(this),this.e=!0)},j:function(n){if(!this.get_visible())return!1;var t=this.b[n];return!!t&&t.cx()},f:function(n){return!!this.b[n]},h:function(n,t){var r,o=!1,i,u,s,f,e,h;this.f(n)?r=this.b[n].get_visible():(this.set_visible(!0),i=n,u=_Ewa.jz.b()[i],this.b[i]=this.i(n,t),s=this.b[i],r=!1,o=!0,f="",e=0,t&&(f=t.MessageIdName,e=t.MessageId),h=u.d,Diag.a.a(38887428,0,50,"BusinessBarControl.AddEntry of type: {0}",n),_Ewa.fg.a(this.a).j(u.a,f,e,0,!0,1,t,s.e,h));!r&&(Array.contains(_Ewa.hB.a(),n)||o)&&(this.b[n].set_visible(!0),this.a.be())},c:function(n){this.m(n,!0)},l:function(){System.a.b(this.b);this.b=new Array(42);this.set_visible(!1)},m:function(n,t){this.f(n)&&(System.a.a(this.b[n]),this.b[n]=null,this.co().hasChildNodes()||this.set_visible(!1),t&&this.a.be())},i:function(n,t){var r=_Ewa.jz.b()[n],u=!!(this.a.r()&64),i;switch(n){case 3:case 5:case 22:case 24:case 25:case 29:i=new _Ewa.is(this,r);break;case 11:case 28:case 41:i=u?new _Ewa.sP(this,r,-8805455):new _Ewa.is(this,r);break;case 21:i=new _Ewa.CZ(this,r,-8805455);break;case 36:i=u?new _Ewa.Da(this,r,t,0,-8805455):new _Ewa.mD(this,r,t,0);break;case 10:case 34:case 8:case 0:case 1:case 2:case 4:i=new _Ewa.mD(this,r,t,0);break;case 18:i=new _Ewa.is(this,r);break;case 37:i=new _Ewa.mD(this,r,t,0);break;case 7:case 13:i=new _Ewa.Dd(this,r,t.HelpTopicId);break;case 30:i=new _Ewa.De(this,r,"XLWAEndUser_DataTypeFinanceSources");break;case 15:i=new _Ewa.is(this,r);i.e=Common.d.b(this.a.l().FullDocumentInfo.IrmPolicyTitle);i.f=Common.d.b(this.a.l().FullDocumentInfo.IrmPolicyDescription);break;case 17:i=new _Ewa.sP(this,r,-1762562205);i.x=!0;break;case 19:i=new _Ewa.Dh(this,r);break;case 20:case 40:i=new _Ewa.is(this,r);break;case 27:i=new _Ewa.is(this,r);break;case 23:i=new _Ewa.Dg(this,r);break;case 26:i=new _Ewa.Df(this,r);break;case 31:i=new _Ewa.eg(this,r);break;case 32:i=new _Ewa.ey(this,r);break;case 33:i=new _Ewa.ez(this,r);break;case 38:i=new _Ewa.is(this,r);break;case 39:i=new _Ewa.Db(this,r);break;case 6:i=new _Ewa.Dc(this,r);break;default:i=new _Ewa.mD(this,r,t,7)}return i.H(),i}};_Ewa.is=function(n,t){this.D=Function.createDelegate(this,this.L);this.C=Function.createDelegate(this,this.h);this.v=Function.createDelegate(this,this.M);this.u=Function.createDelegate(this,this.K);this.t=Function.createDelegate(this,this.J);_Ewa.is.initializeBase(this,[document.createElement("div"),null]);this.a=n;this.c=t;this.o=t.b.toString();this.e=t.o();this.f=t.n();this.set_visibilityMode(1)};_Ewa.is.prototype={c:null,p:null,g:null,k:null,l:null,q:null,y:null,z:null,A:null,a:null,e:null,o:null,f:null,x:!1,d:!1,j:!1,n:!1,r:function(){return this.c?this.c.j():""},E:function(){return this.c?this.c.l():""},G:function(){return this.c?this.c.m():""},F:function(){return this.c?this.c.c:""},I:function(){return this.c?this.c.k():""},dispose:function(){System.a.b([this.q,this.g,this.k]);this.d&&this.g&&(Common.i.a().b("click",this.g.co(),this.t),Common.h.a().d(this.co(),this.y));this.j&&this.k&&(Common.i.a().b("click",this.k.co(),this.u),Common.h.a().d(this.co(),this.z));this.n&&this.l&&(Common.i.a().b("click",this.l,this.v),Common.h.a().d(this.co(),this.A));this.g=null;this.k=null;this.a=null;this.p=null;this.l=null;_Ewa.YQ.prototype.dispose.call(this)},H:function(){var n="<div class='ewa-bb-entry-body' id='{0}'><div class='ewa-bb-content'><a class='ewa-bb-icon' title='{1}'><span class='clip24x24 ewa-bb-entry-icon' id='{2}'>";this.F().length&&(n+="<img class='{3}' src='{4}'/>");n+="<\/span><\/a><span class='ewa-bb-entry-title' id='{5}'>{6}<\/span><span class='ewa-bb-entry-message' id='message'>{7}<\/span><a id='link' href='#' class='ewa-bb-entry-link'>{8}<\/a><span class='ewa-bb-entry-button-holder'><button type='button' id='action' class='ewa-bb-entry-button'>{9}<\/button><\/span><span class='ewa-bb-entry-button-holder'><button type='button' id='altAction' class='ewa-bb-entry-button'>{10}<\/button><\/span><\/div><a class='ewa-bb-entry-close' tabindex='0' role='button'><span id='close' class='clip16x16'><img class='ewadialogs_closePaneGlyph16' src='{11}' alt='{12}' title='{12}' role='button'/><\/span><\/a><\/div>";this.co().tabIndex=0;this.a.co().appendChild(this.co());var t=this.a.a.m(),i=t+"ewaBusinessBarEntryBody"+this.o,r=t+"ewaBusinessBarEntryTitle"+this.o,u=t+"ewaBusinessBarEntryIcon"+this.o;this.co().className="ewa-bb-entry";this.co().innerHTML=String.format(n,i,this.I(),u,this.F(),_Ewa.r.a(0),r,this.e,this.f,this.G(),this.r(),this.E(),_Ewa.r.a(13),_Ewa.ClientStringManager.a().a(698));_Ewa.a.j(this.co(),"alert",r,i,null);this.l=$get("link",this.co());_Ewa.a.b(this.l,this.n,!0);this.n&&(Common.i.a().a("click",this.l,this.v),this.A=Common.h.a().c(this.l,this.v,13,32));this.g=new _Ewa.hC(_Ewa.a.a(this.co(),"action"));this.g.ct(this.d);this.k=new _Ewa.hC(_Ewa.a.a(this.co(),"altAction"));this.k.ct(this.j);this.d&&(Common.i.a().a("click",this.g.co(),this.t),this.y=Common.h.a().c(this.g.co(),this.t,13,32),this.j&&(Common.i.a().a("click",this.k.co(),this.u),this.z=Common.h.a().c(this.g.co(),this.u,13,32)));this.p=$get("close",this.co());this.q=this.cu.a(this.p);this.q.a("click",this.C,!1);this.q.a("keydown",this.D,!1);_Ewa.a.b(this.p,!this.x,!0)},b:function(){Diag.a.a(21517968,0,50,"BusinessBar [{0}]: BusinessBarEntry.OnActionClick()",this.c.a);_Ewa.b.a(this.a.a).t(!0)},m:function(){Diag.a.a(21517969,0,50,"BusinessBar [{0}]: BusinessBarEntry.OnAltActionClick()",this.c.a);_Ewa.b.a(this.a.a).t(!0)},s:function(){Diag.a.a(21517970,0,50,"BusinessBar [{0}]: BusinessBarEntry.OnLinkClick()",this.c.a);_Ewa.b.a(this.a.a).t(!0)},h:function(n){Diag.a.a(21517971,0,50,"BusinessBar [{0}]: BusinessBarEntry.OnCloseClick()",this.c.a);this.set_visible(!1);this.a.c(this.c.b);_Ewa.C.a(n,!0)},L:function(n){var t=n.keyCode;t===13&&this.h(n)},J:function(n){return this.b(n.b),!0},K:function(n){return this.m(n.b),!0},M:function(n){return this.s(n.b),!0}};_Ewa.sP=function(n,t,i){_Ewa.sP.initializeBase(this,[n,t]);this.d=!0;this.i=i};_Ewa.sP.prototype={i:0,b:function(n){_Ewa.is.prototype.b.call(this,n);this.a.a.h().a(new _Ewa.R(this.i,n,this.a.a.t(),10,null),null,null)}};_Ewa.CZ=function(n,t,i){_Ewa.CZ.initializeBase(this,[n,t,i])};_Ewa.CZ.prototype={h:function(n){var t=this.a.a;!t.L()||t.k()||_Ewa.o.a()?_Ewa.is.prototype.h.call(this,n):this.a.c(21)}};_Ewa.Da=function(n,t,i,r,u){_Ewa.Da.initializeBase(this,[n,t,i,r]);this.B=u;this.j=!0};_Ewa.Da.prototype={B:0,m:function(n){_Ewa.is.prototype.m.call(this,n);this.a.a.h().a(new _Ewa.R(this.B,n,this.a.a.t(),10,null),null,null)}};_Ewa.mD=function(n,t,i,r){_Ewa.mD.initializeBase(this,[n,t]);this.i=i;this.w=r;this.i&&this.w&2&&(this.f=this.i.Description);this.i&&this.w&1&&(this.e=this.i.Caption);this.d=!(r&4)};_Ewa.mD.prototype={i:null,w:0,b:function(n){_Ewa.is.prototype.b.call(this,n);this.i.Appearance&=-33;_Ewa.I.a(this.a.a).c([this.i])}};_Ewa.Db=function(n,t){_Ewa.Db.initializeBase(this,[n,t]);this.d=!0;this.j=!0};_Ewa.Db.prototype={b:function(n){_Ewa.is.prototype.b.call(this,n);this.set_visible(!1);this.a.a.be();this.a.a.h().a(new _Ewa.R(1038998010,n,this.a.a.t(),10,null),null,null)},m:function(n){_Ewa.is.prototype.m.call(this,n);this.a.a.h().a(new _Ewa.R(-722953877,n,this.a.a.t(),10,null),null,null)},h:function(n){this.a.c(39);_Ewa.C.a(n,!0)}};_Ewa.Dc=function(n,t){_Ewa.Dc.initializeBase(this,[n,t]);this.d=!0;this.j=!1};_Ewa.Dc.prototype={b:function(n){_Ewa.is.prototype.b.call(this,n);this.a.a.h().a(new _Ewa.R(-722953877,n,this.a.a.t(),10,null),null,null)},h:function(n){this.a.c(6);_Ewa.C.a(n,!0)}};_Ewa.Dd=function(n,t,i){_Ewa.Dd.initializeBase(this,[n,t]);this.i=i;this.d=!0};_Ewa.Dd.prototype={i:null,b:function(n){_Ewa.is.prototype.b.call(this,n);_Ewa.i.k(this.a.a.V(),this.i,this.a.a.bj())}};_Ewa.De=function(n,t,i){_Ewa.De.initializeBase(this,[n,t]);this.i=i;this.n=!0};_Ewa.De.prototype={i:null,s:function(n){_Ewa.is.prototype.s.call(this,n);_Ewa.i.k(this.a.a.V(),this.i,this.a.a.bj())}};_Ewa.Df=function(n,t){if(_Ewa.Df.initializeBase(this,[n,t]),this.i=n.a.b().a(_Ewa.ko,274,!1,null),!this.i){Diag.a.a(34402885,306,50,"Tried creating PolicyBusinessBarEntry but policyManager service has not been registered.");return}this.f=this.i.c();this.e=this.i.e();this.d=!0};_Ewa.Df.prototype={i:null,r:function(){return this.i.a()},b:function(n){_Ewa.is.prototype.b.call(this,n);var t=this.i.b();t&&t(null)}};_Ewa.ez=function(n,t){_Ewa.ez.initializeBase(this,[n,t]);this.d=!0;this.e=_Ewa.ez.d;this.f=_Ewa.ez.b};_Ewa.ez.e=function(n,t,i,r){_Ewa.ez.d=n;_Ewa.ez.b=t;_Ewa.ez.a=i;_Ewa.ez.c=r};_Ewa.ez.prototype={r:function(){return _Ewa.ez.a},b:function(n){_Ewa.is.prototype.b.call(this,n);var t=_Ewa.ez.c;t&&t(null)}};_Ewa.Dg=function(n,t){_Ewa.Dg.initializeBase(this,[n,t]);this.d=!0;this.e=""};_Ewa.Dg.prototype={b:function(n){_Ewa.is.prototype.b.call(this,n);!0&&(Common.T.a(3734060499,!0,"",0,0,0,null),window.open("https://www.microsoft.com/edge?form=MI13FQ&OCID=MI13FQ","_blank"))}};_Ewa.eg=function(n,t){_Ewa.eg.initializeBase(this,[n,t]);Diag.a.a(51222469,0,50,"WacGdprNoticeBusinessBarEntry.WacGdprNoticeBusinessBarEntry: Called");this.e="";this.f=_Ewa.eg.d;this.n=!0};_Ewa.eg.e=function(n,t,i,r){Diag.a.a(51222468,0,50,"WacGdprNoticeBusinessBarEntry.Initialize: Called");_Ewa.eg.d=n;_Ewa.eg.c=t;_Ewa.eg.b=i;_Ewa.eg.a=r};_Ewa.eg.prototype={G:function(){return _Ewa.eg.c},s:function(n){_Ewa.is.prototype.s.call(this,n);Common.g.n(4,Common.k.b(_Ewa.eg.b),!0,36e5,null)},h:function(n){_Ewa.is.prototype.h.call(this,n);_Ewa.eg.a&&_Ewa.eg.a(null)}};_Ewa.Dh=function(n,t){_Ewa.Dh.initializeBase(this,[n,t]);this.i=Common.App.WildFire.c.a();this.d=!0;this.j=this.i.b;this.e=this.i.r();this.f=this.i.q()};_Ewa.Dh.prototype={i:null,r:function(){return this.i.o()},E:function(){return this.i.p()},b:function(n){_Ewa.is.prototype.b.call(this,n);this.i.s(null)},m:function(n){_Ewa.is.prototype.m.call(this,n);this.i.t(null)},h:function(n){_Ewa.is.prototype.h.call(this,n);this.i.n(null)}};_Ewa.bv=function(n,t,i,r,u,f,e,o){this.b=n;this.i=t;this.h=i;this.c=e;this.a=Common.d.e(o);this.d=o;r&&(this.e=r);u&&(this.f=u);f&&(this.g=f)};_Ewa.bv.a=function(n){return _Ewa.ClientStringManager.a().a(n)};_Ewa.bv.prototype={i:0,h:0,e:0,f:0,g:0,o:function(){return _Ewa.bv.a(this.i)},n:function(){return _Ewa.bv.a(this.h)},b:0,j:function(){return _Ewa.bv.a(this.e)},l:function(){return _Ewa.bv.a(this.f)},m:function(){return _Ewa.bv.a(this.g)},c:null,a:0,k:function(){switch(this.c){case"ewa-mb-error":return _Ewa.bv.a(23);case"ewa-mb-warning":return _Ewa.bv.a(22);case"ewa-mb-info":return _Ewa.bv.a(21);case"":return _Ewa.bv.a(0);default:return _Ewa.bv.a(0)}},d:null};_Ewa.hB.registerClass("_Ewa.hB",_Ewa.bbv,_Ewa.cQ,Sys.IDisposable,Common.jT);_Ewa.is.registerClass("_Ewa.is",_Ewa.YQ);_Ewa.ey.registerClass("_Ewa.ey",_Ewa.is);_Ewa.jz.registerClass("_Ewa.jz",_Ewa.YQ,_Ewa.wi);_Ewa.sP.registerClass("_Ewa.sP",_Ewa.is);_Ewa.CZ.registerClass("_Ewa.CZ",_Ewa.sP);_Ewa.mD.registerClass("_Ewa.mD",_Ewa.is);_Ewa.Da.registerClass("_Ewa.Da",_Ewa.mD);_Ewa.Db.registerClass("_Ewa.Db",_Ewa.is);_Ewa.Dc.registerClass("_Ewa.Dc",_Ewa.is);_Ewa.Dd.registerClass("_Ewa.Dd",_Ewa.is);_Ewa.De.registerClass("_Ewa.De",_Ewa.is);_Ewa.Df.registerClass("_Ewa.Df",_Ewa.is);_Ewa.ez.registerClass("_Ewa.ez",_Ewa.is);_Ewa.Dg.registerClass("_Ewa.Dg",_Ewa.is);_Ewa.eg.registerClass("_Ewa.eg",_Ewa.is);_Ewa.Dh.registerClass("_Ewa.Dh",_Ewa.is);_Ewa.bv.registerClass("_Ewa.bv");_Ewa.hB.b=null;_Ewa.ey.d=null;_Ewa.ey.b=null;_Ewa.ey.a=null;_Ewa.ey.c=null;_Ewa.jz.a=null;_Ewa.ez.d=null;_Ewa.ez.b=null;_Ewa.ez.a=null;_Ewa.ez.c=null;_Ewa.eg.d=null;_Ewa.eg.c=null;_Ewa.eg.b=null;_Ewa.eg.a=null;Type.registerNamespace("_Ewa");_Ewa.Zc=function(){};_Ewa.Zc.a=function(){_Ewa.k.a(_Ewa.sO.a)};_Ewa.sO=function(n){_Ewa.sO.initializeBase(this);this.a=n;this.e()};_Ewa.sO.a=function(n){n.b().b(_Ewa.wC.$$(_Ewa.cQ),4,new _Ewa.sO(n))};_Ewa.sO.prototype={a:null,p:function(){this.d(this.a.b().a(_Ewa.cQ,5,!1,null)||new _Ewa.hB(this.a,!this.a.bg()))}};_Ewa.sO.registerClass("_Ewa.sO",_Ewa.qV.$$(_Ewa.cQ));_Ewa.Zc.a();var MSOJS;typeof MSOJS=="undefined"&&(MSOJS={});window.MSOJS=MSOJS;MSOJS.ClientUtils=function(){function cr(n,t,i){wt=n;bt=i;kt=t}function lr(){return f()&&(it()||si())}function ar(){return it()}function vr(){return"ActiveXObject"in window&&!a()}function yr(){return br()&&!kr()&&(v()||it()||o())}function ii(){return window.navigator.userAgent.indexOf("Windows")>=0}function a(){return window.navigator.userAgent.indexOf("Windows Phone")>=0}function pr(){Boolean(dt)||(dt=!0,gt=ri("Windows NT"))}function wr(){Boolean(ni)||(ni=!0,ti=ri("Windows Phone"))}function ri(n){var r=new RegExp(n+"\\s+(\\d+(\\.\\d*)?)"),i=r.exec(window.navigator.userAgent),t=-1;return i!=null&&i.length>=2&&(t=parseFloat(i[1]),isNaN(t)&&(t=-1)),t}function br(){return pr(),gt>=6.1}function ui(){return wr(),ti>=8}function kr(){return window.navigator.userAgent.indexOf("ARM;")>=0}function p(){return typeof navigator.msLaunchUri=="function"&&!a()&&!oi()&&!fi()}function dr(){return!a()}function f(){return window.navigator.userAgent.indexOf("Macintosh")>=0}function gr(){return window.navigator.userAgent.indexOf("iPhone")>=0||window.navigator.userAgent.indexOf("iPad")>=0||navigator.maxTouchPoints>0&&f()}function nu(){return window.navigator.userAgent.indexOf("PPC Mac")>=0}function fi(){return window.navigator.userAgent.indexOf("Edge/")>=0}function v(){return window.navigator.userAgent.indexOf(" MSIE ")>=0||window.navigator.userAgent.indexOf("Trident/")>=0}function ei(){return v()?window.document.documentMode==8:!1}function w(){return window.navigator.userAgent.indexOf(" Firefox/")>=0}function tu(){return window.navigator.userAgent.indexOf(" AppleWebKit/")>=0}function o(){var n=window.navigator.userAgent.toLowerCase();return n.indexOf("chrome")>=0}function oi(){var n=window.navigator.userAgent.toLowerCase();return n.indexOf("android")>=0&&n.indexOf("chrome")>=0}function it(){return iu()>=3}function si(){return ru()>=3}function iu(){return w()?hi("firefox/"):0}function ru(){return tu()?hi("version/"):0}function uu(n){return o()&&n}function hi(n){var t=window.navigator.userAgent.toLowerCase(),i=t.indexOf(n),r,u;return i>=0?(r=i+n.length,u=t.length,parseInt(t.substring(r,u))):0}function rt(n,t,i,r,u){if(!!r&&t!=null){t();return}p()?navigator.msLaunchUri(n,t,i):fu()?li(n,t,i):uu(u)?eu(n,t,i):ci(n,t,i)}function fu(){return!o()&&!gr()||fi()}function eu(n,t,i){try{window.open(n,"_self")}catch(r){i!=null&&i();return}t!=null&&t()}function ci(n,t,i){var f="OICLinkTag",u=document.getElementById(f);u==null&&(u=document.createElement("a"),u.id=f,u.style.visibility="hidden",u.href="",u.target=ou(r)?"_top":"_blank",document.body.appendChild(u),u.addEventListener!=null&&u.addEventListener("click",function(n){n.stopPropagation!=null&&n.stopPropagation()},!1));try{u.href=n;u.click()}catch(e){i!=null&&i();return}t!=null&&t()}function li(n,t,i){var u="OICFrame",r=document.getElementById(u);r==null&&(r=document.createElement("iframe"),r.className="ObjectInDialog",r.style.visibility="hidden",r.src="about:blank",document.body.appendChild(r),r.id=u);try{r.contentWindow.location.href=n}catch(f){i!=null&&i();return}t!=null&&t()}function ai(n){return(n.Options&i.SkipProtocolHandler)!=0||ei()}function ou(n){return(n.Options&i.SupportsTopTargetNavigation)!=0}function su(t){return f()&&(t.Application==n.OneNote||ot(di,!1)||ot(gi,!1))}function hu(n){return ai(n)?!1:su(n)?!0:p()?!0:oi()?!0:!of()||k()>=15}function ut(){return lr()||ar()}function ft(n){return n===e.ReadOnly||n===e.ReadWrite}function cu(n,t,i,r){try{var u=new ActiveXObject(ht);if(u)return u.ViewDocument3(window.self,n,t,r)}catch(f){}return!1}function lu(n,r,f,e){var o,s;try{if(o=new ActiveXObject(ct),o)return s=o.ViewDocument3(window.self,n,r,e),s?(l(u.O14ActiveX),t.None):t.Failed}catch(h){}if(i.O14Only===(f&i.O14Only))return t.Unattempted;try{if(o=new ActiveXObject(lt),o)return s=o.ViewDocument3(window.self,n,r,e),s?(l(u.O12ActiveX),t.None):t.Failed}catch(h){}if(i.O12UpOnly===(f&i.O12UpOnly))return t.Unattempted;try{if(o=new ActiveXObject(at),o)return s=ft(r)?o.ViewDocument2(window.self,n,e):o.EditDocument2(window.self,n,e),s?(l(u.O11ActiveX),t.None):t.Failed}catch(h){}return t.Unattempted}function au(n,i,r){var e=pi(),f;if(e==null)return t.Unattempted;f=!1;try{f=e.ViewDocument3(window.self,n,i,r)}catch(o){}if(!f)try{f=ft(i)?e.ViewDocument2(window.self,n,r):e.EditDocument2(window.self,n,r)}catch(o){}return f?(l(u.NpapiPlugin),t.None):t.Failed}function vi(t,i,r,u,f){var o,h,c,s;if(t==n.Visio&&r==e.ReadWrite&&(r=e.WriteOnly),o=f,u=u||a()&&!ui(),u||(h="",h+=ft(r)?ir+rr:ur,h+=fr,o+=yi(h)),o+=yi(i),c=vu(window.location.href,or),c!=null&&typeof c!="undefined"){s="";try{s=decodeURIComponent(c)}catch(l){}s.length>0&&yu(s)&&(o+=er,o+=s)}return o}function vu(n,t){var u=n.toLowerCase().indexOf("&"+t+"="),i,r;return u==-1?undefined:(i=u+(t.length+2),r=n.indexOf("&",i),r==-1)?n.substr(i):n.substring(i,r)}function yu(n){var t=RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}");return t.test(n)}function et(n,i,u,f,e,o){var h=wi(n),c;return h==null?(s(t.Unattempted,r.Application),!1):(c=vi(n,i,u,f,h),rt(c,wu,bu,e,o),!0)}function pu(n,i,u,f){var e=wi(n),o;return e==null?(s(t.Unattempted,r.Application),!1):(o=vi(n,i,u,f,e),rt(o,null,null,!1,!1),!0)}function yi(n){if(f()&&o()){var t="";try{t=decodeURI(n)}catch(i){}if(t==n)return encodeURI(n)}return n}function wu(){l(u.ProtocolHandler)}function bu(){r.Options|=i.SkipProtocolHandler;bi(r,h,c)}function ku(){var n,t,i;if(p())return!0;if(o())return typeof navigator.plugins.refresh!="undefined"&&navigator.plugins.refresh(!1),Boolean(navigator.mimeTypes[sr]);if(w())return n=document.createElement("RoamingExtensionElement"),document.documentElement.appendChild(n),t=document.createEvent("Events"),t.initEvent("RoamingOfficeInstalled",!0,!1),n.dispatchEvent(t),Boolean(n.getAttribute("installed"));if(v())try{return i=new ActiveXObject(pt),i.HrExists()}catch(r){}return!1}function du(n,t,i,r,u,f){MSOJS.ClientUtils.LaunchRoamingApps2(n,t,ff(i),r,"x86",wt,u,f)}function gu(n,i,r,f,e,s,h,c){var y="",l,a,b,k;if(f!=null&&(y+=" "+f),n!=null&&(y+=' "'+n+'"'),p()||o())nt=h,tt=c,l=hr,l+=' "'+s+'"',l+=' "'+r+'"',l+=' "ROAMING"',l+=' "'+i+'"',l+=' "'+e+'"',l+=" "+y,rt(l,nf,tf,!1,!1);else if(w())a=document.createElement("RoamingExtensionElement"),a.setAttribute("cabUrl",s),a.setAttribute("app",r),a.setAttribute("licensingEntitlements",i),a.setAttribute("platform",e),a.setAttribute("args",y),document.documentElement.appendChild(a),b=document.createEvent("Events"),b.initEvent("RoamingOfficeLaunch",!0,!1),a.dispatchEvent(b),h!=null&&h(u.RoamingFFExtension);else if(v()){if(k=new ActiveXObject(pt),k!=null)try{k.HrConfigureSingle(s,r,i,e,y);h!=null&&h(u.RoamingActiveX)}catch(d){}}else c!=null&&c(t.Failed)}function nf(){nt!=null&&nt(u.RoamingProtocolHandler)}function tf(){tt!=null&&tt(t.ControlNeeded)}function rf(n){if(typeof n.RoamingAppsLauncher=="undefined"||n.RoamingAppsLauncher==null){s(t.Unattempted,r.Application);return}typeof n.RoamingBitsUrl=="undefined"||n.RoamingBitsUrl==null?MSOJS.ClientUtils.LaunchRoamingApps(n.DocumentUrl,n.RoamingAppsLauncher,n.Application,n.ApplicationParameters,h,c):MSOJS.ClientUtils.LaunchRoamingApps2(n.DocumentUrl,n.RoamingAppsLauncher,n.RoamingApplicationExe,n.ApplicationParameters,n.RoamingPlatform,n.RoamingBitsUrl,h,c)}function pi(){var i=document.getElementById(g),t,n;if(i==null){if(t=vt,f()&&si()&&y(d)&&(t=d),!y(t))if(f()&&y(yt))t=yt;else return null;n=document.createElement("object");n.id=g;n.type=t;n.style.width="0px";n.style.height="0px";n.style.setProperty("visibility","hidden","");document.body.appendChild(n);i=document.getElementById(g)}return i}function ot(n,t){var r=window.navigator.mimeTypes,i;return r==null?!1:(i=r[n],!i)?!1:t&&!i.enabledPlugin?!1:!0}function y(n){return ot(n,!0)}function b(n){try{var t=new ActiveXObject(n);if(t!=null)return!0}catch(i){}return!1}function uf(){try{var n=new ActiveXObject(nr);n!=null&&n.SaveSSOCreds()}catch(t){}}function st(t){switch(t){case n.OneNote:return tr;default:return""}}function wi(t){if(t!=n.OneNote&&a()&&!ui())return"office:";switch(t){case n.Excel:return"ms-excel:";case n.OneNote:return"onenote:";case n.PowerPoint:return"ms-powerpoint:";case n.Visio:return"ms-visio:";case n.Word:return"ms-word:";case n.Project:return"ms-project:";case n.Publisher:return"ms-publisher:";case n.Infopath:return"ms-infopath:";case n.Access:return"ms-access:";default:return""}}function ff(t){switch(t){case n.Excel:return"root\\office15\\excel.exe";case n.PowerPoint:return"root\\office15\\powerpnt.exe";case n.Visio:return"root\\office15\\visio.exe";case n.Word:return"root\\office15\\winword.exe";case n.Project:return"root\\office15\\winproj.exe";case n.Publisher:return"root\\office15\\mspub.exe";case n.Infopath:return"root\\office15\\infopath.exe";case n.Access:return"root\\office15\\msaccess.exe";default:return null}}function ef(){this.DocumentUrl="";this.Mode=0;this.Options=0;this.Application=n.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=!1;this.ApplicationParameters="";this.RoamingPlatform="";this.RoamingApplicationExe="";this.RoamingBitsUrl="";this.SilentExternalHandler=!1;this.EncodeUrl=!1;this.CorrelationIdForWinClient="";this.NavigateUsingWindowOpen=!1}function bi(o,a,y){var k;if(r=o,h=a,c=y,!o.DocumentUrl){s(t.Unattempted,r.Application);return}var p=o.DocumentUrl,b=o.DocumentUrl,w=o.DocumentUrl;try{w=decodeURIComponent(o.DocumentUrl)}catch(d){}try{b=encodeURI(o.DocumentUrl)}catch(d){}if(p=p+""+o.CorrelationIdForWinClient,w=w+o.CorrelationIdForWinClient,b=b+o.CorrelationIdForWinClient,o.Mode===e.ReadWrite&&i.CheckoutRequired===(o.Options&i.CheckoutRequired)&&(o.Mode=e.ForceCheckout),i.HostIsEditOnly===(o.Options&i.HostIsEditOnly)&&(o.Mode=e.WriteOnly),hu(o)){et(o.Application,o.EncodeUrl?b:p,o.Mode,o.Application==n.OneNote,o.SilentExternalHandler,o.NavigateUsingWindowOpen);return}if(ei()&&cu(o.EncodeUrl?p:w,o.Mode,o.Options,st(o.Application))){l(u.O15ActiveX);return}if(ut()?k=au(o.EncodeUrl?p:w,o.Mode,st(o.Application)):(uf(),k=lu(o.EncodeUrl?p:w,o.Mode,o.Options,st(o.Application))),k!=t.None){if(o.CouldUseRoamingApps&&yr()&&o.Application!=n.OneNote){if(!MSOJS.ClientUtils.CanUseRoamingControl()){s(t.ControlNeeded,r.Application);return}if(o.RoamingAppsLauncher){rf(o);return}if(!o.ContinueIfLauncherIsNull){s(t.LauncherNeeded,r.Application);return}}if(i.NoProtocolHandlerFallback!=(o.Options&i.NoProtocolHandlerFallback)&&!ai(o)&&!v()&&(!f()||k==t.Unattempted)){et(o.Application,o.EncodeUrl?b:p,o.Mode,o.Application==n.OneNote,o.SilentExternalHandler,o.NavigateUsingWindowOpen);return}s(k,r.Application)}}function l(n){h!=null&&h(n)}function s(n,t){typeof t=="undefined"&&(t=null);c!=null&&c(n,t)}function of(){return ut()||vr()||o()}function k(){var n=0,t;if(ut()||o()){t=pi();try{t!=null&&(n=t.GetOfficeVersion())}catch(i){}}else b(ht)?n=15:b(ct)?n=14:b(lt)?n=12:b(at)&&(n=11);return n}function ki(){return f()&&(y(vt)||y(d))}function sf(){return ii()&&k()<=11}function hf(){return ii()&&k()<15}function cf(){return f()&&!nu()&&!ki()}function lf(){w()?window.InstallTrigger.install({Office:{URL:bt}}):li(kt,null,null)}var ht="SharePoint.OpenDocuments.5",ct="SharePoint.OpenDocuments.4",lt="SharePoint.OpenDocuments.3",at="SharePoint.OpenDocuments.2",vt="application/x-sharepoint",d="application/x-sharepoint-webkit",di="application/x-sharepoint-protocolhandler",gi="application/x-sharepoint-webkit-protocolhandler",yt="application/officelive",g="npSharePointPlugin",nr="IDBHO.IDBHOCtrl",tr="OneNote.Notebook",ir="ofv|",rr="ofc|",ur="ofe|",fr="u|",er="|f|",or="wdlor",pt="RoamingOfficeActiveX.RoamingOffice",sr="application/x-vnd.officeondemand",hr="office:",wt="",bt="",kt="",h,c,nt,tt,r,dt,gt,ni,ti,e={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},i={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},t={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5},u={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},n={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:e,OpenDocumentOptions:i,OpenDocumentFailureType:t,OpenDocumentControl:u,OfficeApplication:n,EditDocumentInClient:bi,EditDocumentInClientParams:ef,OfficeVersionInstalled:k,IsO14MacPluginInstalled:ki,OfferOfficeInDialog:sf,OfferOfficeNoIntrusive:hf,OfferMacOffice:cf,InstallRoamingControl:lf,CanUseRoamingControl:ku,InitUrls:cr,LaunchRoamingApps:du,LaunchRoamingApps2:gu,ShouldShowDialog:dr,NavigateToUrlUsingClickingOnATag:ci,OpenDocumentWithProtocolHandler:et,OpenDocumentWithProtocolHandlerNoCallBack:pu}}();MSOJS.ClientUtils=MSOJS.ClientUtils;Type.registerNamespace("_Ewa");_Ewa.qC=function(n,t){this.e=Function.createDelegate(this,this.k);this.g=["id","sessionId","workbookType","workbookFileType","dataloss"];_Ewa.qC.initializeBase(this,[n,null]);this.a=n;this.b=t;this.cv().a("load",this.e,!1)};_Ewa.qC.a=function(n){var t=document.createElement("iframe");return t.id="ewaFileLoader",t.style.cssText="height:0;width:0;display:none",t.src="about:blank",t.setAttribute("name","dlfr"),t=n.q().appendChild(t),new _Ewa.qC(t,n)};_Ewa.qC.prototype={a:null,b:null,c:0,i:function(){return!("loading"==this.a.contentDocument.readyState)&&!("uninitialized"==this.a.contentDocument.readyState)},d:function(n,t){var i={},r;this.h(r={val:n},i);n=r.val;n&&Common.g.s("dlfr",n,i);this.c=t},h:function(n,t){var f=n.val.split("?"),e,s,i,r,h;if(f.length!==2){n.val=null;Diag.a.a(38852812,0,15,"FileLoader.ExtractParametersFromUriToDictionary: unable to parse URI (missing '?')");return}e=f[1].split("&");for(var o=e,c=o.length,u=0;u<c;++u){if(s=o[u],i=s.split("=",2),i.length!==2){n.val=null;Diag.a.a(38852813,0,15,"FileLoader.ExtractParametersFromUriToDictionary: unable to parse URI (key value pair has no '=' sign)");return}r=i[0];Array.contains(this.g,r)&&(h=decodeURIComponent(i[1]),t[r]=h,n.val=_Ewa.bf.b(n.val,r))}},f:function(){this.a&&(this.a.src="about:blank");this.c=1461300262},k:function(){var t=this.j(),n;t&&(this.b.W(!0,!1),this.c!==-2028960985&&this.c!==1461300262&&(n=_Ewa.N.a(this.b).a().a(),n.OWMsrra="cw48",n.DAdc=this.c),_Ewa.I.a(this.b).c(t.Errors))},j:function(){var n;try{return this.a.contentWindow.ewaResult}catch(i){if(n=this.b.c().c().e(),!n){var t=window.document.referrer.match(new RegExp("://(.[^/]+)/")),r=t.length>1?t[1]:"",u=escape(window.location.host),f=escape(this.a.contentWindow.location.host);Diag.a.a(39076571,0,50,"FileLoader.OnFrameLoad: parent domain: {0}, current domain: {1}, iframe domain: {2}. ewaControl IsCrossDomain: {3}",r,u,f,this.b.bL());throw i;}return null}}};_Ewa.Px=function(n,t){_Ewa.Px.initializeBase(this,[n,t])};_Ewa.Px.prototype={j:function(n){var t=$$as(_Ewa.y,n.b()),i=this;return _Ewa.f.cw(_Ewa.l.a(_Ewa.gC,t.b(),56,t.i(),0,null),function(i){t.bf()?(n.a().UAAds=!0,i.a().d()):i.a().g()},t.i(),3),1}};_Ewa.qD=function(n,t,i){this.br=Function.createDelegate(this,this.bM);this.bs=Function.createDelegate(this,this.bN);this.Z=Function.createDelegate(this,this.bO);this.bt=new _Ewa.ci(!1);_Ewa.qD.initializeBase(this,[!0]);this.p=n;this.q=n.c();this.w=t;this.ba=i;this.q.g(this.Z);this.D=_Ewa.qC.a(this.p);this.bL();n.b().b(_Ewa.gC,55,this)};_Ewa.qD.a=function(){return _Ewa.B.c().length>1};_Ewa.qD.prototype={p:null,bc:!1,F:!1,bb:null,E:null,ba:null,w:null,z:null,o:function(n){return this.z=n,n},bj:function(){return"EditInExcelWebApp_32x32x32"},G:function(){return this.E=this.E||new _Ewa.fO,this.E.a()},U:function(){return"excel32"},bk:function(){return this.q.c().b()},D:null,q:null,f:function(){this.bn(this.bc)},g:function(){var n=this.p,t=this;_Ewa.f.cw(this.w.a(),function(i){t.v(n.l().ClientUrl,Common.a.z,1,n.k()?2:0,!0,new($$sc.z.$$(Common.V))(function(){return i.a()}))},this.G(),3)},W:function(){_Ewa.B.a().k()&&this.p.bK(!1)},bl:function(){var n={};n.fbError=!1;n.fbOrigin="OpenInExcel";this.p.B(802602464,_Ewa.D.a,8,n)},a:function(){var n,t;this.q.a()&&(n=this.p,n.k())&&(t=this,_Ewa.f.cw(this.w.a(),function(i){t.v(n.l().ClientUrl,Common.a.z,1,2,!1,new($$sc.z.$$(Common.V))(function(){return i.a()}))},this.G(),3))},b:function(){if(this.q.a()){var n=this;_Ewa.f.cw(this.w.a(),function(t){n.v(n.p.l().ClientUrl,Common.a.z,1,n.p.k()?2:0,!1,new($$sc.z.$$(Common.V))(function(){return t.a()}))},this.G(),3)}},n:function(){if(this.q.a()&&!this.p.k()){var n=this;_Ewa.f.cw(this.w.a(),function(t){n.v(n.p.l().ClientUrl,Common.a.z,1,0,!1,new($$sc.z.$$(Common.V))(function(){return t.a()}))},this.G(),3)}},m:function(){if(this.q.a()){var n=this;_Ewa.f.cw(this.w.a(),function(t){n.v(n.p.l().ClientUrl,Common.a.z,1,5,!1,new($$sc.z.$$(Common.V))(function(){return t.a()}))},this.G(),3)}},h:function(n){var t=this.e(n);this.D.d(t,n)},c:function(n,t){if(this.q.a()){var i=this.p;_Ewa.N.a(i).d()?this.bu(n,i):t>0?this.bQ(n,i,t):this.bw(i)}},v:function(n,t,i,r,u,f){return this.p.bK(!0),this.bc=u,this.z=null,this.F=!1,this.bK(n,t,r,u,f),1},H:function(n){var t=this.p.w();return(Diag.a.a(38367435,0,50,"OpenInExcelOperation.CompleteClientLaunch: IsEmbedded:{0}, InWebPart:{1}, DivSyndicated:{2}, Mode:{3}",t.d(),t.b(),t.e(),this.p.k()?"Edit":"View"),_Ewa.qD.a())?(this.L(),Common.el.a(this.u,this.t,this.V(),1,this.bs,this.br,!1,Common.a.a.a("OICEncodeUrlIsEnabled"),"",!1),32):Common.App.OpenInClient.t.prototype.H.call(this,n)},bh:function(){var n,t,i;this.bv();n=this.p;this.q.c().b()||!this.q.a()||n.k()||(t=new _Ewa.R(2145659238,_Ewa.D.a,this.p.t(),0,null),i=this,this.bb=_Ewa.x.a().a(function(){n.h().a(t,null,null)},0,_Ewa.m.bE,!0,!1))},dispose:function(){this.q&&this.q.h(this.Z);System.a.b([this.bt,this.bb,this.E]);this.q=null;this.p=null},bi:function(){if(this.bv(),this.z){var n=this,t=function(){n.p.W(!0,!0);var t=_Ewa.N.a(n.p).a().a();t.PUOAudna="cw26";t.CWMods=n.F};_Ewa.I.a(this.p).a(new _Ewa.cJ("cw8",5,t))}},X:function(){var n=this;_Ewa.x.a().a(function(){n.p.h().a(new _Ewa.R(-2028960985,_Ewa.D.a,0,30,null),null,null)},0,_Ewa.m.bF,!0,!0)},bf:function(n){var t=this.p,i,r;return!t.k()||!this.q.a()?this.bn(n):(this.L(),i=this,r=function(){t.W(!1,!1);var r=_Ewa.N.a(i.p).a().a();r.PUOAudna="cw35";r.openInExcelClient_ForceClose=n;r.CWMfocc=!0;t.k()&&(r.CWMsbc=1,r.CWMfsc=!0,r.SAWMuoe=!0,r.SAWMoc=!0);r.openInExcelClient_Mode=1455037301},_Ewa.I.a(t).a(new _Ewa.cJ("cw8",5,r)),32)},d:function(){var t=Common.a.z,i,n;this.p.bf()?(i=this.p.s().E(!0,t,!0),i===8&&(n=this.p.A().c(),Diag.a.a(7353228,0,50,"Url:[{0}] IsEmbedded:[{1}] InWebPart:[{2}] DivSyndicated:[{3}], Mode:[{4}]",t,n.d(),n.b(),n.e(),this.p.k()?"Edit":"View"))):this.D.d(t,-2028960985);this.F=!0;this.L()},i:function(){this.I().a()&&this.I().b(1)},j:function(){this.I().a()&&_Ewa.i.f(Common.k.f(33),"_blank",null,"OpenExcelOperation.XLSViewerUnknownTryOffice")},k:function(){_Ewa.i.f(Common.k.f(31),"_blank",null,"OpenExcelOperation.XLSBackstageUnknownTryMacOffice")},l:function(){_Ewa.i.f(Common.k.f(34),"_blank",null,"OpenExcelOperation.XLSViewerUnknownTryMacOffice")},e:function(n){var t=new Sys.StringBuilder,r=this.p.l(),i=this.p.e();t.append(this.p.bh());t.append(i.FileHandlerRelativeUri);t.append("?id=");t.append(encodeURIComponent(_Ewa.bf.b(r.WorkbookUri,"sc")));this.p.c().a()&&(t.append("&sessionId="),t.append(encodeURIComponent(this.p.c().j())));switch(n){case-974518828:t.append("&workbookType=PublishedItemsSnapshot");break;case-1804063550:t.append("&workbookType=FullWorkbook");break;case-1059172980:t.append("&workbookType=FullWorkbook&workbookFileType=Odf");break;default:t.clear()}return _Ewa.X.b(t,i),t.toString()},bL:function(){Common.cX.b().t(1);var n=this.p.e();MSOJS.ClientUtils.InitUrls(n.RoamingAppsX86RootUrl,n.RoamingAppsControlInstallerUrl,n.RoamingAppsFirefoxExtensionUrl)},bO:function(){var n=_Ewa.v.b(_Ewa.N.a(this.p).a().a(),"CWMods",!1);n||this.D.f()},bv:function(){var n=this.p;this.q.a()||_Ewa.iW.a(n,_Ewa.N.a(n).a());this.L();this.z&&this.z(this,this.F);n.s().bf.e(this.p.s().z());n.s().bh.o(this.p.s().z());n.bK(!1);_Ewa.b.a(n).o()},bK:function(n,t,i,r,u){var f=this.p;return Common.a.b()&&!_Ewa.qD.a()&&(f.s().bf.f(f.s().z()),f.s().bh.p(f.s().z())),Common.App.OpenInClient.t.prototype.v.call(this,n,t,1,i,r,u)},L:function(){var n=this.p;_Ewa.N.a(n).b().b()==="cw38"&&_Ewa.N.a(n).a().e()},bP:function(){var n=_Ewa.h.b(1,0,603,604,0,1341525452,"OpenInExcelActiveXError");_Ewa.I.a(this.p).c([n])},bN:function(n){this.bo(n)},bM:function(){this.bP()},bQ:function(n,t,i){var r=null,u=this,f=function(){_Ewa.N.a(t).f(r);u.bw(t)},e=window.setTimeout(f,i),o=this;r=function(){_Ewa.N.a(t).d()&&(_Ewa.N.a(t).f(r),window.clearTimeout(e),o.bu(n,t))};_Ewa.N.a(t).g(r)},bw:function(n){var t=_Ewa.h.b(1,1,0,618,0,-1753121099,"ProcessingUserChangesFileDownloadIgnored");_Ewa.I.a(n).c([t])},bu:function(n,t){var i=this,r=function(){var u,r,f;t.W(!1,!1);u=_Ewa.N.a(t).a();r=u.a();r.PUOAudna="cw47";r.SAEUAwufl=t.A().c().p();r.DAdc=n;f=[1437034227];u.d(_Ewa.h.k(i.ba.e(),f))};_Ewa.I.a(t).a(new _Ewa.cJ("cw8",5,r))}};_Ewa.Pu=function(n,t){this.e=Function.createDelegate(this,this.i);this.a=t;this.d=n;this.b=t.c();this.b.g(this.e);this.c=_Ewa.qC.a(this.a)};_Ewa.Pu.prototype={a:null,c:null,d:!1,b:null,g:function(){var i=this.f(this.a),n=this.a.g().b(),t;n>0&&Diag.a.a(22590611,0,15,"flushing queue in downloadcopy. Queue is {0}",n);this.a.g().h("DownloadACopyOperation.DownloadForkedFile");this.d&&Diag.a.a(41239586,0,50,"DownloadACopyOperation - Dataloss scenario");this.c.d(i,-21742208);t=this;_Ewa.f.cw($$sc.a.b(1),function(){t.h()},this.c.bC(),3)},dispose:function(){this.b&&this.b.h(this.e);this.b=null;this.a=null},h:function(){return new _Ewa.Pu.a(this)},f:function(n){var t=new Sys.StringBuilder,r=n.l(),i=n.e();return t.append(n.bh()),t.append(i.FileHandlerRelativeUri),t.append("?id="),t.append(encodeURIComponent(_Ewa.bf.b(r.WorkbookUri,"sc"))),n.c().a()&&(t.append("&sessionId="),t.append(encodeURIComponent(n.c().j()))),t.append("&workbookType=FullForkedWorkbook"),t.append("&dataloss="),t.append(this.d?"true":"false"),_Ewa.X.b(t,i),t.toString()},i:function(){var n=_Ewa.v.b(_Ewa.N.a(this.a).a().a(),"CWMods",!1);n||this.c.f()}};_Ewa.Pu.a=function(n){this.f=Function.createDelegate(this,this.moveNext);this.b=n;this.e=this.h;this.moveNext()};_Ewa.Pu.a.prototype={b:null,d:null,c:null,e:null,a:0,h:function(){return this.d=this.b.a.p().a("LoadResource","DownloadACopyOperation"),this.g},g:function(){return(!this.b.c.i()&&this.d.b()<1e5)?(this.c=$$sc.a.b(100).g(),this.c.b.b>3||(this.a=2,this.c.a(this.f)),this.j):this.i},i:function(){this.d.b()>=1e5&&Diag.a.a(22590613,0,15,"Download did not complete after 10 seconds.");_Ewa.N.a(this.b.a).a().e();this.a=3},j:function(){return this.c.c(),this.g},dispose:function(){},moveNext:function(){try{for(this.a=1;this.a===1;)this.e=this.e()}catch(n){this.a=3}}};_Ewa.Pv=function(n){_Ewa.Pv.initializeBase(this);this.a=n;this.e()};_Ewa.Pv.prototype={a:null,p:function(){var n=this;_Ewa.f.c(_Ewa.l.a(Object,this.a.b(),155,this.b(),this.c,null),function(){n.d(new _Ewa.xA("cw71","cw32",!0))},this.b())}};_Ewa.xA=function(n,t,i){this.x=Function.createDelegate(this,this.B);_Ewa.xA.initializeBase(this,[n,t]);this.w=i};_Ewa.xA.prototype={r:null,w:!1,j:function(n){var t=$$as(_Ewa.y,n.b());return t.Y()?(Diag.a.a(50954706,0,50,"DownloadAForkedCopyActivity.Execute: blocking Download action as the workbook is protected"),this.z(n),this.q="cw0",1):(this.r||(this.r=new _Ewa.Pu(this.w,t)),this.r.g(),Diag.a.b(22590615,0,_Ewa.N.a(t).b().a()!==3,"The current activity should not be closed."),1)},z:function(n){var i=$$as(_Ewa.y,n.b()),t=new _Ewa.qM(i),u=this,r=function(n){t.add_disposing(n)};this.t(n,this.x,r);Diag.a.a(50954707,0,50,"DownloadAForkedCopyActivity.ProtectedFileDataLeakErrorDialog: showing alert dialog to user");t.E();t.x(!1)},B:function(n){var t=n,r=this,i=function(n){t.remove_disposing(n)};this.u(i);this.q="cw32";this.n()},dispose:function(){System.a.a(this.r);this.r=null;_Ewa.ci.prototype.dispose.call(this)}};_Ewa.Pw=function(n){_Ewa.Pw.initializeBase(this);this.a=n;this.e()};_Ewa.Pw.prototype={a:null,p:function(){var n=this;_Ewa.f.c(_Ewa.l.a(Object,this.a.b(),155,this.b(),this.c,null),function(){n.d(new _Ewa.xA("cw67","cw59",!1))},this.b())}};_Ewa.bgx=function(){};_Ewa.bgx.a=function(){_Ewa.k.a(function(n){n.b().b(_Ewa.wC.$$(_Ewa.dZ),57,new _Ewa.Py(n));n.b().b(_Ewa.wC.$$(_Ewa.dZ),60,new _Ewa.Pw(n));n.b().b(_Ewa.wC.$$(_Ewa.dZ),63,new _Ewa.Pv(n))})};_Ewa.kn=function(n){_Ewa.kn.initializeBase(this);this.a=n;this.e();_Ewa.kn.b()};_Ewa.kn.b=function(){_Ewa.kn.a||(_Ewa.kn.a=!0,(new Common.App.OpenInClient.k).c(Common.Utils.a.a()),Common.Utils.a.a().a(Common.dV,null).d(),Common.Utils.a.a().a(Common.ez,null).c())};_Ewa.kn.prototype={a:null,p:function(){if(this.a.b().a(_Ewa.gC,55,!1,null)){this.d(this.a.b().a(_Ewa.gC,55,!1,null));return}var i=_Ewa.l.a(Object,this.a.b(),155,this.b(),this.c,null),t=_Ewa.l.b(_Ewa.cQ,this.a.b(),5,4,this.c,null),n=this;_Ewa.f.cw($$sc.a.WAA(i,t),function(){n.d(new _Ewa.qD(n.a,new($$sc.z.$$($$sc.o.$$(Common.V)))(function(){return _Ewa.l.a(Common.V,n.a.b(),137,n.b(),n.c,null)}),t.a()))},this.b(),3)}};_Ewa.Py=function(n){_Ewa.Py.initializeBase(this);this.a=n;n.b().b(_Ewa.kn,56,new _Ewa.kn(n));this.e()};_Ewa.Py.prototype={a:null,p:function(){var n=this;_Ewa.f.c(_Ewa.l.a(Object,this.a.b(),155,this.b(),this.c,null),function(){n.d(new _Ewa.Px("cw38","cw0"))},this.b())}};_Ewa.qC.registerClass("_Ewa.qC",_Ewa.YQ);_Ewa.Px.registerClass("_Ewa.Px",_Ewa.WorkflowActivity);_Ewa.qD.registerClass("_Ewa.qD",Common.App.OpenInClient.t,_Ewa.gC,Sys.IDisposable);_Ewa.Pu.registerClass("_Ewa.Pu",null,Sys.IDisposable);_Ewa.Pv.registerClass("_Ewa.Pv",_Ewa.qV.$$(_Ewa.dZ));_Ewa.xA.registerClass("_Ewa.xA",_Ewa.bcP);_Ewa.Pw.registerClass("_Ewa.Pw",_Ewa.qV.$$(_Ewa.dZ));_Ewa.kn.registerClass("_Ewa.kn",_Ewa.qV.$$(_Ewa.gC));_Ewa.Py.registerClass("_Ewa.Py",_Ewa.qV.$$(_Ewa.dZ));_Ewa.kn.a=!1;_Ewa.bgx.a();Type.registerNamespace("_Ewa");_Ewa.xI=function(n,t,i,r){_Ewa.xI.initializeBase(this);this.f=n;this.g=t;this.i=i;this.a=r;this.e()};_Ewa.xI.a=function(n){n.b().b(_Ewa.wC.$$(_Ewa.dZ),386,new _Ewa.xI("cw75","cw26","cw32",n))};_Ewa.xI.prototype={a:null,f:null,g:null,i:null,p:function(){if(this.a.a(893)){var t=_Ewa.l.b(_Ewa.ih,this.a.b(),388,387,this.c,null),i=_Ewa.l.b(_Ewa.cG,this.a.b(),211,212,this.c,null),n=this;_Ewa.f.cw(_Ewa.f.ws([t,i],this.a.i(),3),function(){n.d(new _Ewa.xH(n.f,n.g,n.i,t.a(),i.a()))},this.a.i(),3)}else this.d(new _Ewa.xH(this.f,this.g,this.i,null,null))}};_Ewa.xH=function(n,t,i,r,u){_Ewa.xH.initializeBase(this,[n,t]);this.z=t;this.B=i;this.x=u;this.D=r};_Ewa.xH.prototype={w:null,x:null,D:null,z:null,r:null,B:null,l:function(n){_Ewa.bcP.prototype.l.call(this,n)},j:function(n){return this.r=n,this.E(),1},E:function(){var n=$$as(_Ewa.y,this.r.b()),t=!1;_Ewa.h.c(this.r.c(),[1217361942])&&(t=!0);var i=new _Ewa.PC(n,t,this.D,this.x),u=this,r=function(n){i.add_disposing(n)};this.t(this.r,this.w||(this.w=Function.createDelegate(this,this.F)),r);i.bI();n.a(1001)&&!n.bH()&&n.cX()},F:function(n){var t=this.s.a(),s=t.b(),r=n,u=t.a(),o,f,i,e;for(u.FileOpenPassword=r.R,o=this,f=function(n){r.remove_disposing(n)},this.u(f),u.OWMem=!1,t.a().OWMwls=0,i=0,e=t.c().length;i<e;i++)(t.c()[i].MessageId===110414285||t.c()[i].MessageId===1217361942)&&t.g(t.c()[i]);Diag.a.a(591136900,0,50,"PasswordProtectedFileOpenActivity.PasswordProtectedFileOpenPasswordInputDialogDisposing: user response: {0}",r.Y);switch(r.Y){case 1:this.q=this.z;this.n();r.R="";break;case 0:this.q=this.B;this.n()}},p:function(n){_Ewa.bcP.prototype.p.call(this,n)}};_Ewa.PC=function(n,t,i,r){this.bu=Function.createDelegate(this,this.ca);this.bq=Function.createDelegate(this,this.bL);this.bt=Function.createDelegate(this,this.bK);this.bv=Function.createDelegate(this,this.cb);this.bw=Function.createDelegate(this,this.bH);_Ewa.PC.initializeBase(this,[n,null,!1,!1,!1,!1]);this.bd=t;this.bc=r;i&&n.a(893)&&(this.Z=i)};_Ewa.PC.prototype={bc:null,Z:null,bd:!1,b:null,e:null,d:null,bp:null,R:null,Y:0,bG:function(){return["CommonControlEyeOpen_16","Hide_16"]},bI:function(){var n,r,t,u,i;this.g(1);this.v=!1;n=this.a.c().f().WorkbookFileName.trim();n=Common.d.b(this.bJ(n));r=String.format(_Ewa.ClientStringManager.a().b(19),n);t="";this.bd&&(t=_Ewa.ClientStringManager.a().a(1690));this.p=_Ewa.lP.c(r,t);u=_Ewa.ClientStringManager.a().a(1689);_Ewa.FD.prototype.j.call(this,u,this.bw,null);this.Z&&(i=_Ewa.ClientStringManager.a().a(1692),this.bp=document.getElementById("passwordInputParent"),this.e=new _Ewa.xG(this.Z).f(this.bp,this.bG()[0],this.bv),this.d=new _Ewa.xG(this.Z).f(this.bp,this.bG()[1],this.bt),_Ewa.a.b(this.d,!1,!0),this.e.title=i,this.d.title=i);this.G(this.b);this.E(1,!1);_Ewa.a.t(this.V(),390);this.bD();this.a.cp()},dispose:function(){this.b=null;_Ewa.FD.prototype.dispose.call(this)},bH:function(n){n===1?(this.Y=1,this.R=this.b.value):n||(this.Y=0,this.R=null);this.i()},t:function(n){CommonUI.b.prototype.t.call(this,n);_Ewa.a.j(this.V(),"dialog",null,null,null);this.b=$get("passwordInput");this.b.maxLength=255;this.b.setAttribute("placeholder",_Ewa.ClientStringManager.a().a(1687));this.b.setAttribute("aria-label",_Ewa.ClientStringManager.a().a(1688));this.bd&&(this.bc.b(!0),this.bc.a(String.format(_Ewa.ClientStringManager.a().a(1690))));this.b.setAttribute("autocomplete","false");Common.j.a(this.b,"input",this.bq);Common.j.a(this.b,"change",this.bq);Common.j.a(this.b,"focus",this.bu)},bL:function(){var n=!!this.b&&this.b.value.length>0;this.E(1,n)},ca:function(){this.d.setAttribute("tabindex",0);this.e.setAttribute("tabindex",0)},bF:function(){var n=this;return function(){n.bH(1,null)}},cb:function(){this.b.type="text";_Ewa.a.b(this.e,!1,!0);_Ewa.a.b(this.d,!0,!0);_Ewa.a.c(this.d,!0);this.d.setAttribute("tabindex",-1)},bJ:function(n){return n&&n.length>28&&(n=n.substring(0,28)+"..."),n},bK:function(){this.b.type="password";_Ewa.a.b(this.d,!1,!0);_Ewa.a.b(this.e,!0,!0);_Ewa.a.c(this.e,!0);this.e.setAttribute("tabindex",-1)}};_Ewa.xG=function(n){this.b=Function.createDelegate(this,this.i);this.e=Function.createDelegate(this,this.j);this.c=n};_Ewa.xG.prototype={c:null,a:null,d:null,f:function(n,t,i){var u,r;return this.d=i,u=this.h(t),u&&(this.a=document.createElement("span"),this.a.className="ewa-ppfo-eye WACDialogCloseAnchor",this.a.style.height="16px",this.a.setAttribute("focusable","true"),this.a.tabIndex=0,this.a.appendChild(u),this.a.setAttribute("aria-pressed","false"),this.a.setAttribute("aria-label",_Ewa.ClientStringManager.a().a(1692)),u.id=t,Common.i.a().a("click",this.a,this.e),Common.h.a().a("keydown",this.a,this.b),Common.h.a().a("keyup",this.a,this.b),Common.h.a().a("keypress",this.a,this.b),r=document.createElement("div"),r.className="eye-icon",r.style.height="16px",r.appendChild(this.a),n.appendChild(r)),this.a},h:function(n){var t=document.createElement("span"),i;return this.c?(i=this.c.b(n,16,16,t,16,16,null,null),i.setAttribute("style",String.format(" height: {0}px; width: {1}px; margin-bottom: {2}px; ","16","16","-3")),t.setAttribute("aria-hidden","true"),t.setAttribute("aria-label",_Ewa.ClientStringManager.a().a(1692)),t.setAttribute("Unselectable","on"),t):(Diag.a.a(590357390,0,10,"PasswordEyeControlButton: svgIconProvider no available and so password show/hide button not provided"),null)},j:function(){return this.g(),!0},i:function(n){return n.d==="keyup"&&(n.a.keyCode===13||n.a.keyCode===32)?(this.g(),!0):!1},g:function(){this.d&&this.d()}};_Ewa.lP=function(){};_Ewa.lP.c=function(n,t){return t===""?CommonUI.b.a(_Ewa.lP.a,n):CommonUI.b.a(_Ewa.lP.b,n,t)};_Ewa.xI.registerClass("_Ewa.xI",_Ewa.qV.$$(_Ewa.dZ));_Ewa.xH.registerClass("_Ewa.xH",_Ewa.bcP);_Ewa.PC.registerClass("_Ewa.PC",_Ewa.FD);_Ewa.lP.a="<div class='PasswordInputLabel' id='passwordInputLabel'> <label id='fileNameDiv' class='WACDialogLabel' >{0}<\/label> <\/div> <div class='ewa-ppfo-label-div' id='passwordInputLabeldiv'> <\/div> <div class='passwordInputParent' id='passwordInputParent'> <input type='password' id='passwordInput' class='ewa-ppfo-input' autocomplete=\"off\"/> <\/div> <div class='ewa-ppfo-input-div' id='passwordInputLabeldiv'> <\/div>";_Ewa.lP.b="<div class='PasswordInputLabel' id='passwordInputLabel'> <label id='fileNameDiv' class='WACDialogLabel' >{0}<\/label> <\/div> <div class='ewa-ppfo-label-div' id='passwordInputLabeldiv'> <\/div> <div class='passwordInputParent' id='passwordInputParent'> <input type='password' id='passwordInput' class='ewa-ppfo-input' autocomplete=\"off\"/> <\/div> <div class='ewa-dlg-err-msg' id='errorDivParent'> <label id='error' class='WACDialogLabel' >{1}<\/label> <\/div>";Type.registerNamespace("_Ewa");_Ewa.bgC=function(){};_Ewa.bgC.a=function(){_Ewa.k.a(_Ewa.xI.a)};_Ewa.bgC.a();Type.registerNamespace("_Ewa");_Ewa.Rp=function(n,t){_Ewa.Rp.initializeBase(this,[n,t])};_Ewa.Rp.prototype={j:function(n){var t=$$as(_Ewa.y,n.b());return Diag.a.b(35985042,0,_Ewa.h.m(n.c()),"SessionReloadActivity.Execute: Only recoverable errors should reach this activity."),t.W(!0,!0),n.a().OWMpsid=t.c().j(),n.a().OWMri=!0,n.a().OWMric=!0,Diag.a.a(35985043,0,50,"SessionReloadActivity.Execute: session is going to reopen from cached state"),3}};_Ewa.yS=function(){_Ewa.yS.initializeBase(this);this.e()};_Ewa.yS.a=function(n){n.b().b(_Ewa.wC.$$(_Ewa.dZ),142,new _Ewa.yS)};_Ewa.yS.prototype={p:function(){this.d(new _Ewa.Rp("cw5","cw10"))}};_Ewa.bhM=function(){};_Ewa.bhM.a=function(){_Ewa.k.a(function(n){_Ewa.yS.a(n);_Ewa.lZ.a(n)})};_Ewa.dh=function(n,t,i,r,u){_Ewa.dh.initializeBase(this,[n,t]);_Ewa.dh.b=[-1468309555,611268539,-2087635043,2100961153,810218235,1112506702];_Ewa.dh.a=[-1468309555,-315732528,-399065540,810218235,1531005923,1593924569,1112506702,-238814601,1220851643];_Ewa.dh.d=[-1468309555,611268539,-1750576502];_Ewa.dh.c=[-1468309555,-315732528,1112506702,-238814601,-1750576502];this.t=i;this.r=r;this.u=u};_Ewa.dh.f=function(n){var i=$$as(_Ewa.y,n.b()),l=i.c(),r=_Ewa.dh.e(n),u=_Ewa.h.c(n.c(),r?_Ewa.dh.a:_Ewa.dh.b),f=_Ewa.h.c(n.c(),r?_Ewa.dh.c:_Ewa.dh.d),a=i.bl(),v=i.F().c(),y=i.e().MaxConsecutiveSilentReloadAllowed,e=i.F().f(),p=_Ewa.h.a(n.c(),","),w=_Ewa.h.a(n.f(),","),b=_Ewa.h.f(function(n){return!n.triggerSilentReopenOnly},n.c(),null).length>0,o=u,s=_Ewa.v.b(n.a(),"RATAtsratr",!1),t,h,c;if(s&&(o=!0),t={},t.name="SessionReloadSilentActivity.GetSilentReloadType",t.editMode=r,t.isSilentReopenError=u,t.isSilentRefreshError=f,t.reloadCount=v,t.maxReloads=y,t.stopSilentReloads=e,t.errorNames=p,t.processedErrorNames=w,t.isClientDirty=a,t.errorsForSilentReopenOnly=b,t.triggerSilentReloadAfterTokenRefresh=s,t.IsReopenDisabled=i.bt(),h=_Ewa.H.a(t),Diag.a.a(21837004,0,50,h),!e){if(o&&(c=r?_Ewa.dh.h(n):_Ewa.dh.i(n),c))return _Ewa.dO.b(n,i)?3:i.bt()?2:1;if(f&&(r||!l.V()))return 2}return 0};_Ewa.dh.j=function(n,t,i){if(!t.a(231))return!1;var r=_Ewa.h.f(function(n){return!n.triggerSilentReopenOnly},n.c(),null);return r.length?i!==3:!1};_Ewa.dh.g=function(n){for(var r,u=_Ewa.h.f(function(n){return!n.triggerSilentReopenOnly},n.c(),null),i=u,f=i.length,t=0;t<f;++t)r=i[t],n.g(r)};_Ewa.dh.e=function(n){var t=$$as(_Ewa.y,n.b());return t.c().a()?t.k()&&!!(t.r()&64):_Ewa.v.b(n.a(),"OWMem",!1)};_Ewa.dh.i=function(n){var i=$$as(_Ewa.y,n.b()),r=_Ewa.h.k(n.c(),_Ewa.dh.b),t;return _Ewa.bw.b(r,function(n){return n.ForceVersionUpgrade})?!1:(t=_Ewa.h.m(n.c()),!i.c().V()||t)?!0:!1};_Ewa.dh.h=function(n){var t=_Ewa.h.k(n.c(),_Ewa.dh.a);return!_Ewa.bw.b(t,function(n){return n.ForceVersionUpgrade})};_Ewa.dh.prototype={t:null,r:null,u:null,j:function(n){var u=$$as(_Ewa.y,n.b()),t,f,i,r,e,o;if(n.a().OWMts=!0,t=_Ewa.dh.f(n),_Ewa.dh.j(n,u,t))return _Ewa.dh.g(n),f=50,n.c().length>0&&(f=15),Diag.a.a(37535887,0,f,"SessionReloadSilentActivity.ShouldCancelReload: ignore session reload, remaining errors : {0}",_Ewa.h.a(n.c(),",")),n.a().OWMts=!1,this.q="cw0",3;switch(t){case 1:case 3:this.x(n,t);break;case 2:this.w(n);break;case 0:n.a().OWMsrra=null}return(Diag.a.a(21837003,0,50,"SessionReloadSilentActivity.Execute: silentReloadType:{0}. activityName:{1}. NextActivityName:{2}. TimeFromLastStatefulResponse:{3}.",t,this.v,this.k(),u.A().bi()),i=_Ewa.v.b(n.a(),"RATAtsratr",!1),Diag.a.b(40502925,0,!i||i&&(t===1||t===3),"triggerSilentReloadAfterTokenRefresh: {0}, silentReloadType: {1}",i,t),r=u.F().c(),t&&r>0)?(e=_Ewa.fD.a(r,200,1e4,!0),Diag.a.a(24404636,0,50,"SessionReloadSilentActivity.Execute: schedule Silent-Type [{0}] retryNum [{1}] delayInMs [{2}] activityName [{3}]",t,r,e,this.v),o=this,_Ewa.x.a().a(function(){n.e()},e,_Ewa.m.cf,!0,!1),1):3},x:function(n,t){var i,r;Diag.a.a(8438495,0,50,"SessionReloadSilentActivity.InitiateSilentReopen: Silent reopen triggered");i=$$as(_Ewa.y,n.b());n.a().OWMri=!0;i.a(1001)&&!i.bH()&&_Ewa.V.a().a("ReopenOnLoad");_Ewa.dh.e(n)||(r=_Ewa.h.m(n.c()),r&&(Diag.a.a(35985044,0,50,"SessionReloadSilentActivity.ShouldAttemptViewSilentReopen: session is going to reopen from cached state"),n.a().OWMpsid=i.c().j(),n.a().OWMric=!0));n.k();t===3?(i.W(!0,!0),this.q=this.u,n.a().OWMpcm=i.l().CalcMode):(n.a().OWMfsr=!1,this.q=this.t)},w:function(n){Diag.a.a(21304145,0,15,"SessionReloadSilentActivity.InitiateSilentRefresh: Silent refresh triggered");n.a().OWMsrra=null;n.k();this.q=this.r;var t=$$as(_Ewa.y,n.b());t.a(1001)&&!t.bH()&&(_Ewa.V.a().a("RefreshOnLoad"),t.cB())}};_Ewa.lZ=function(n,t){_Ewa.lZ.initializeBase(this);this.a=n;this.f=t;this.e()};_Ewa.lZ.a=function(n){n.b().b(_Ewa.wC.$$(_Ewa.dZ),143,new _Ewa.lZ("cw4","cw3"));n.b().b(_Ewa.wC.$$(_Ewa.dZ),144,new _Ewa.lZ("cw55","cw27"));n.b().b(_Ewa.wC.$$(_Ewa.dZ),145,new _Ewa.lZ("cw56","cw44"));n.b().b(_Ewa.wC.$$(_Ewa.dZ),154,new _Ewa.lZ("cw57","cw2"))};_Ewa.lZ.prototype={a:null,f:null,p:function(){this.d(new _Ewa.dh(this.a,this.f,"cw10","cw30","cw69"))}};_Ewa.Rp.registerClass("_Ewa.Rp",_Ewa.WorkflowActivity);_Ewa.yS.registerClass("_Ewa.yS",_Ewa.qV.$$(_Ewa.dZ));_Ewa.dh.registerClass("_Ewa.dh",_Ewa.WorkflowActivity);_Ewa.lZ.registerClass("_Ewa.lZ",_Ewa.qV.$$(_Ewa.dZ));_Ewa.dh.b=null;_Ewa.dh.a=null;_Ewa.dh.d=null;_Ewa.dh.c=null;_Ewa.bhM.a();Type.registerNamespace("_Ewa");_Ewa.Gy=function(n){_Ewa.Gy.initializeBase(this,[n,new Sys.UI.Point(960,680),_Ewa.ClientStringManager.a().a(1088),null]);this.fE="_EwaEmbeddingDialog"};_Ewa.Gy.prototype={e:function(){return"EmbeddingDialog"},bk:function(n){var t=new Sys.StringBuilder(this.B.e().EmbedConfiguratorUrl);return _Ewa.bf.a(t,"edid",n),t.toString()},bm:function(){Diag.a.a(20717841,0,50,"EmbeddingDialog.OnShow: the dialog is being shown");_Ewa.bU.prototype.bm.call(this)}};_Ewa.HZ=function(n,t,i){this.bq=Function.createDelegate(this,this.bR);this.bb=Function.createDelegate(this,this.bI);this.bp=Function.createDelegate(this,this.bK);this.bl=Function.createDelegate(this,this.bJ);this.bs=Function.createDelegate(this,this.bS);this.S=Function.createDelegate(this,this.bT);_Ewa.HZ.initializeBase(this,[n,new Sys.UI.Point(900,1200),_Ewa.ClientStringManager.a().a(t?1093:1092),null]);this.Y=t;this.bc=i};_Ewa.HZ.prototype={R:null,bc:null,b:function(n){this.dK("lightBoxReady",n)},A:function(n){this.dL("lightBoxReady",n)},e:function(){return"FormDialog"},U:!1,y:function(){return this.U},Y:!1,z:function(){return this.Y},dispose:function(){System.a.a(this.R);this.R=null;_Ewa.bdX.prototype.dispose.call(this)},E:function(){_Ewa.bdX.prototype.E.call(this);var n=Common.k.g(this.B.e().FormLightBoxUrl),t=this.R=new Common.dp(this.L.contentWindow,n,null);t.k&&t.g(n)&&(this.Q("FrameDialog_ShareFromEdit",this.S),this.Q("FrameDialog_View",this.S),this.Q("FrameDialog_CloseAndRefresh",this.S),this.Q("FrameDialog_ShareFromView",this.bs),this.Q("FrameDialog_Edit",this.bl),this.Q("FrameDialog_RefreshGrid",this.S),this.Q("FrameDialog_Ready",this.bp),this.Q("FrameDialog_CloseMe",this.bb),this.Q("FrameDialog_CloseMeError",this.bb))},c:function(n){n===this.bi()&&this.U&&this.R.f(new Common.cT("FrameDialog_PleaseClose"),null)||_Ewa.bU.prototype.c.call(this,n)},bk:function(){return this.bt(this.Y)},bt:function(n){var i=this.B.e(),r=i.FormLightBoxUrl,t=new Sys.StringBuilder(r);return _Ewa.bf.a(t,"sid",this.B.c().j()),_Ewa.bf.a(t,"pageMode",n?"preview":"design"),_Ewa.X.b(t,i),t.toString()},bT:function(n){var r=this.B,i=new _Ewa.HZ.a,t;i.a=n.Values.GotoRange;t=!1;switch(n.MessageId){case"FrameDialog_ShareFromEdit":this.d();t=!0;i.b=1334518759;break;case"FrameDialog_View":this.V.innerHTML=_Ewa.ClientStringManager.a().a(1093);this.bB(!0);break;case"FrameDialog_CloseAndRefresh":this.d();t=!0}var e=this,u=function(n,t){return _Ewa.j.d(r.d().a(),_Ewa.n.a(n,e.bq),t,i)},f=t?new _Ewa.F(140,0,u,0,null):new _Ewa.bh(140,0,u,0,null);f.v=16;r.g().a(f,this.bc)},bJ:function(){var n=this.B;n.e().SurveyRedirectUrl?(this.d(),n.B(1305810481,0,8,null)):(this.V.innerHTML=_Ewa.ClientStringManager.a().a(1092),this.bB(!1))},bS:function(){var n=this.B;this.d();n.B(1334518759,0,8,null)},bI:function(n){var t=this.B;this.d();n.MessageId==="FrameDialog_CloseMeError"&&t.c().bd()},bK:function(){this.U=!0;this.dJ("lightBoxReady",null,null)},bB:function(n){this.U=!1;this.L.src=this.bt(n);this.Y=n},Q:function(n,t){this.R.c(n);var i=this.R.b(n,t)},bR:function(n,t){var f,i,r,u,e;_Ewa.T.a(n)||(f=this.B,i=t,i.a&&(r=f.c().u(),r.E(i.a.SheetName)?this.bA(i):(u=null,e=this,u=function(){r.n(u);e.bA(i)},r.l(u))),i.b!==1461300262&&f.B(i.b,0,8,null))},bA:function(n){var i=this.B.c().u(),t=i.b(n.a.SheetName);t&&!t.i&&_Ewa.b.a(this.B).s(n.a,null,null,null,20,_Ewa.E.H,0,!0,!0,null,!1,!0)}};_Ewa.HZ.a=function(){this.b=1461300262};_Ewa.HZ.a.prototype={a:null,b:0};_Ewa.bdX=function(n,t,i,r){this.bG=Function.createDelegate(this,this.bU);this.bj=Function.createDelegate(this,this.bH);_Ewa.bdX.initializeBase(this,[n,i,2,r,"",!1,!1]);this.ba=t;this.B.Q(this.bj);this.dg()};_Ewa.bdX.prototype={ba:null,L:null,E:function(){var n='<iframe id="{0}" frameborder="0" scrolling="auto" src="{1}">\r\n<\/iframe>',t=this.B.m()+"iframeDialog_frame",i=this.B.m()+"iframeDialog";n=String.format(n,t,this.bk(i));this.D.style.margin="0px";this.D.style.marginBottom="-2px";this.D.innerHTML=n;this.L=document.getElementById(t);this.dH.id=i;this.bH(null,Sys.EventArgs.Empty);Common.c.L()&&_Ewa.x.a().a(this.bG,50,_Ewa.m.bi,!0,!0);_Ewa.bU.prototype.E.call(this)},dispose:function(){this.B&&this.B.S(this.bj);_Ewa.bU.prototype.dispose.call(this)},I:function(){_Ewa.a.c(this.L,!1)},dh:function(){this.L.contentWindow.close();_Ewa.a.h(this.L);this.L=null;_Ewa.bU.prototype.dh.call(this)},bH:function(){var n=this.bV();this.L.setAttribute("width",n.x);this.L.setAttribute("height",n.y);this.bW(n);this.cq()},bW:function(n){var t=this.dH.style;t.width=n.x+"px";t.marginLeft=-n.x/2+"px"},bV:function(){var n=_Ewa.a.m(document.body),t=Math.min(Math.floor(n.width*.9),this.ba.x),i=Math.min(Math.floor(n.height*.9),this.ba.y);return new Sys.UI.Point(t,i)},bU:function(){var n=this.T.parentNode.style,t=n.top;n.top="2px";n.top=t}};_Ewa.RV=function(n){this.A=Function.createDelegate(this,this.Q);_Ewa.RV.initializeBase(this,[n,_Ewa.ClientStringManager.a().a(1095),3,!1,!1])};_Ewa.RV.prototype={b:null,z:null,y:null,e:function(){return"ShareFormDialog"},dispose:function(){this.y&&this.y.b(this.A);System.a.b([this.b,this.z,this.y]);this.b=null;this.z=null;this.y=null;_Ewa.bjx.prototype.dispose.call(this)},E:function(){var n="<div class='ewa-dlg-body-sectionlabel'>\r\n\t<span>{0}<\/span>\r\n<\/div>\r\n<div class='ewa-dlg-body-sectionbreak'>\r\n\t<input type='text' id='{1}' class='ewa-dlg-body-fullLine' aria-live='polite' aria-atomic='true'/>\r\n\t<br />\r\n\t<a href='#' id='{2}' class='{3}'>{4}<\/a>\r\n<\/div>";n=String.format(n,_Ewa.ClientStringManager.a().a(1096),"sfd_input","sfd_unshare","ewa-hidden",_Ewa.ClientStringManager.a().a(1097));this.D.innerHTML=n;this.b=new _Ewa.gN(this.dR("sfd_input"),!1,!1,null,!1,null);this.z=new _Ewa.nU(this.b.co(),null,null);this.y=_Ewa.hx.a(this.dR("sfd_unshare"));this.y.a(this.A);this.b.e(_Ewa.ClientStringManager.a().a(653));this.b.cD(!1);this.b.u(!Common.c.c());this.K(1,9,!1,!1);_Ewa.bU.prototype.E.call(this)},bs:function(){var n=this;return function(t,i){var r=n.B.d().a().b(!1);return _Ewa.rd.b(n.B.d().a(),n.bB(t),n.bt(i),null,r)}},L:function(n,t,i){this.b.e(n.Result);this.b.cD(!0);_Ewa.a.b(this.y.dH,!0,!0);_Ewa.bjx.prototype.L.call(this,n,t,i)},I:function(){if(this.b&&this.b.cF())try{this.b.cH();return}catch(n){}_Ewa.bU.prototype.I.call(this)},Q:function(){var n=this.B,i,t;this.d();i=this;t=new _Ewa.Aj(n,1098,1099,1100,function(t,i){var r=n.d().a().b(!1);return _Ewa.rd.c(n.d().a(),t,i,null,r)},16);t.E();t.x(!1)}};_Ewa.Aj=function(n,t,i,r,u,f){_Ewa.Aj.initializeBase(this,[n,_Ewa.ClientStringManager.a().a(t),!1,3,!1,!1]);this.b=i;this.y=r;this.A=u;this.z=f};_Ewa.Aj.prototype={b:0,y:0,A:null,z:0,e:function(){return"WebMethodConfirmationDialog"},S:function(){return 1005},bZ:function(){return this.z},E:function(){var n="<div class='ewa-dlg-body-sectionlabel'>\r\n\t<div class='ewa-dlg-iconarea'>\r\n\t\t<div class='clip32x32'>\r\n\t\t\t<img src='{0}' class='ewadialogs_warning32' alt='{1}' />\r\n\t\t<\/div>\r\n\t<\/div>\r\n\t<div class='ewa-dlg-textarea'>\r\n\t\t<p>{2}<\/p>\r\n\t<\/div>\r\n<\/div>";n=String.format(n,_Ewa.r.a(13),_Ewa.ClientStringManager.a().a(22),_Ewa.ClientStringManager.a().a(this.b));this.D.innerHTML=n;this.K(0,this.y,!1,!1);this.K(1,0,!1,!1);_Ewa.TX.prototype.E.call(this)},Q:function(){return this.A}};_Ewa.hp=function(n,t,i){this.j=Function.createDelegate(this,this.s);_Ewa.hp.initializeBase(this);this.a=n;this.c=t;this.b=i;_Ewa.N.a(this.a).q(new _Ewa.mm("cw52","cw0",_Ewa.hp.a),new _Ewa.dO("cw53","cw28",null,"cw2","cw0"))};_Ewa.hp.prototype={a:null,f:!1,e:!1,c:null,b:null,d:function(){return!!(this.a.x()&32)},h:function(){return this.a.k()&&(this.a.c().cu()||this.a.bl())},z:function(n,t){var r=this.a.l().FullDocumentInfo,i;switch(t){case 869186573:return i=Common.ce.a()&&this.a.c().e().a(5),_Ewa.e.a(r.FileSharingUrl)&&!i;case-1570751769:case 1986648902:return(this.a.U()&131072)!=131072;case 330035228:return!(this.g(!0)&&this.d());case-509039657:return!(this.g(!1)&&this.d());case 1334518759:return!(this.g(!1)&&this.d()&&this.k())}return!1},x:function(n,t,i){var f=this.a.l().FullDocumentInfo,o=2988588587,r=$$sc.a.a(Boolean,!0),u=t.a,e,s;if(u===o||u===-266099)return this.r(t,o,f);switch(u){case 1986648902:this.m();break;case-1570751769:this.p(t);break;case 869186573:e=this;r=_Ewa.f.cw(this.b.a(),function(n){var r=n.a(),t=null;e.a.a(916)&&i&&i.SourceControlId==="CopyLink"&&(t={},t.mode="copy");_Ewa.jb.a(r,"UI_Sharing",t,e.a.c().e().a(5))||_Ewa.i.f(f.FileSharingUrl,"_blank",null,"SocialSharingCommandHandler.FileSharingUrl")},this.dM(),3);break;case-59906385:case 1197060601:this.q(t,f);break;case 1305810481:this.l(!1,t);break;case 330035228:this.l(!0,t);break;case-509039657:this.o();break;case 1334518759:t.j=!0;this.u();break;case 710925581:_Ewa.B.a().x("710925581")&&(s=this,r=_Ewa.f.cw(this.b.a(),function(n){n.a().a("UI_Conversation",{},"")},this.dM(),3));break;default:r=_Ewa.L.a(u)}return r},w:function(n,t){var i=!1,r=t.a;if(r===2988588587)return!0;switch(r){case 1986648902:case-1570751769:case 869186573:case-59906385:case 1197060601:case 1305810481:case 330035228:case-509039657:case 1334518759:case-266099:case 710925581:i=!0}return i},y:function(n,t,i){var f,e,r,u;if(t==="PopulateFormMenu"){for(f=this.d()?this.k()?_Ewa.hp.b:_Ewa.hp.c:_Ewa.hp.d,e=this.c.b(),r=0;r<f.length;r++)Array.add(e.a(),this.c.a(f[r]));return u=this.c.c("Forms.Flyout"),Array.add(u.a(),e),_Ewa.o.a()?i.MenuItems=u.b():i.PopulationXML=this.c.f(u),!0}return!1},r:function(n,t,i){if(this.h()&&n.a===t)return this.i(n,-266099),_Ewa.f.a();var r=this;return _Ewa.f.cw(this.b.a(),function(n){var t=n.a();_Ewa.jb.a(t,"UI_Workflow",null,i.WorkflowPostMessage)||_Ewa.i.f(i.WorkflowUrl,"_blank",null,"SocialSharingCommandHandler.WorkflowUrl")},this.dM(),3)},k:function(){var n=this.a.l().FullDocumentInfo;return!!n.ShareFormCommandUrl||this.a.c().e().a(26)},p:function(n){this.h()?this.i(n,1986648902):this.m()},l:function(n,t){if(!n&&this.a.e().SurveyRedirectUrl){this.t();return}var i=new _Ewa.HZ(this.a,n,t);i.E();i.x(!1)},q:function(n,t){if(this.h()&&n.a===1197060601){this.i(n,-59906385);return}var i=this;_Ewa.f.cw(this.b.a(),function(n){var u=n.a(),r;u&&_Ewa.jb.a(u,"UI_ReplyWithChanges",null,i.a.c().e().a(8))||(r=new Sys.StringBuilder(t.ReplyWithChangesUrl),_Ewa.bf.a(r,"event_source","FileMenu"),_Ewa.Gim.ntw(r.toString(),i.a))},this.dM(),3)},i:function(n,t){var i=_Ewa.N.a(this.a).a().a(),r=new _Ewa.R(t,n.c,n.e,n.b,n.d),u=this,f=function(){i.PUOAudna="cw45";i.ERCAci=r;u.a.F().a("SocialSharingSaveBeforeCommand");u.a.F().d(r.a)};_Ewa.I.a(this.a).a(new _Ewa.cJ("cw8",5,f))},m:function(){var t=this.a.e().DocumentHostInfo,n;t.HostEmbeddedViewUrl||this.f?this.n():this.a.z().a(52)&&(n=this,_Ewa.f.cw(this.b.a(),function(i){n.v(i.a())||_Ewa.Gim.ntw(t.FileEmbedCommandUrl,n.a)},this.dM(),3))},v:function(n){return n.d()?!this.e&&!(this.e=n.b("CanEmbed",this.j))?!1:n.a("UI_FileEmbed",null,""):!1},s:function(){this.f=!0;this.n()},n:function(){if(Common.c.d())_Ewa.Gim.ntw(this.a.e().EmbedConfiguratorUrl,this.a);else{var n=new _Ewa.Gy(this.a);n.E();n.x(!1)}},o:function(){var n=this.a,i=this,t=new _Ewa.Aj(n,1101,1102,1094,function(t,i){var r=n.d().a().b(!1);return _Ewa.rd.a(n.d().a(),t,i,null,r)},0);t.E();t.x(!1)},u:function(){var i=this.a.l().FullDocumentInfo,t,n;this.a.c().e().a(26)?(t=new _Ewa.RV(this.a),t.E(),t.x(!1)):(n=this,_Ewa.f.cw(this.b.a(),function(t){var r=t.a();_Ewa.jb.a(r,"UI_ShareForm",{SurveyTitle:n.a.l().SurveyTitle},n.a.c().e().a(10))||_Ewa.Gim.ntw(i.ShareFormCommandUrl,n.a)},this.dM(),3))},t:function(){var t=this.a,f=t.e().SurveyRedirectUrl,i,r,n,e,u;f.replace(new RegExp("&startupdialog=[formedit|formpreview]","gi"),"");i=new Sys.StringBuilder(t.e().SurveyRedirectUrl);_Ewa.bf.a(i,"startupDialog","FormEdit");r=_Ewa.N.a(this.a);n=r.a().a();n.NPAnu=i.toString();n.NPAnum="ow";this.a.F().a("SocialSharingEnvironmentChange");e=this;u=function(){var t=_Ewa.h.b(3,2,1142,1143,1144,554412057,"FossEnvironmentUnsupported");r.a().d([t]);n.PUOAudna="cw52"};_Ewa.I.a(t).a(new _Ewa.cJ("cw8",5,u))},g:function(n){return(this.a.c().C()||n)&&this.a.c().e().a(25)&&Common.ce.a()}};_Ewa.zv=function(n){_Ewa.zv.initializeBase(this,[n])};_Ewa.zv.a=function(n){_Ewa.Z.a(114,new _Ewa.zv(n))};_Ewa.zv.prototype={g:function(){var n=this,i=new($$sc.z.$$($$sc.o.$$(Common.V)))(function(){return _Ewa.l.a(Common.V,n.a.b(),137,n.b(),n.c,null)}),t=this;_Ewa.f.cw(_Ewa.l.a(_Ewa.dr,this.a.b(),102,this.b(),this.c,null),function(n){t.f([new _Ewa.hp(t.a,n.a(),i)],null)},this.b(),3)}};_Ewa.rd=function(){};_Ewa.rd.b=function(n,t,i,r,u){var f=n.a(1,u);return _Ewa.j.a(n,"ShareForm",f,t,i,r,0,null)};_Ewa.rd.c=function(n,t,i,r,u){var f=n.a(1,u);return _Ewa.j.a(n,"UnshareForm",f,t,i,r,0,null)};_Ewa.rd.a=function(n,t,i,r,u){var f=n.a(9,u);return f.surveyId=null,_Ewa.j.a(n,"DeleteSurvey",f,t,i,r,0,null)};_Ewa.bdX.registerClass("_Ewa.bdX",_Ewa.bU);_Ewa.Gy.registerClass("_Ewa.Gy",_Ewa.bdX);_Ewa.HZ.registerClass("_Ewa.HZ",_Ewa.bdX,_Ewa.wh);_Ewa.HZ.a.registerClass("_Ewa.HZ.a");_Ewa.RV.registerClass("_Ewa.RV",_Ewa.bjx);_Ewa.Aj.registerClass("_Ewa.Aj",_Ewa.TX);_Ewa.hp.registerClass("_Ewa.hp",_Ewa.bcz,_Ewa.kh);_Ewa.zv.registerClass("_Ewa.zv",_Ewa.Z);_Ewa.hp.d=[102];_Ewa.hp.b=[106,103,104,105];_Ewa.hp.c=[103,104];_Ewa.hp.a=[new _Ewa.q("cw53",554412057,0,0,1145,!1,0),new _Ewa.q("cw0",554412057,0,1,0,!1,0)];Type.registerNamespace("_Ewa");_Ewa.biu=function(){};_Ewa.biu.a=function(){_Ewa.k.a(_Ewa.zv.a)};_Ewa.biu.a();