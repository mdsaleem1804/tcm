Type.registerNamespace("Common");Common.eJ=function(n,t){if(isNullOrUndefined(n)||isNullOrUndefined(t))throw Error.argumentNull("appSettingsManager/clientRequestManager");this.e=n;this.g=t;this.d=null;this.f=null};Common.eJ.a=function(n,t){try{return Diag.a.a(50860943,3004,50,"Parsing user privacy settings {0} from {1}",n,t),Common.cv.b(n,t)}catch(i){Diag.a.a(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",i.toString());throw i;}};Common.eJ.prototype={d:null,f:null,e:null,g:null,i:function(n){var i=this.e.j.g.RoamingServiceHandlerWebServiceBase||"",r=String.format("{0}RoamingServiceHandler.ashx?action=",i),t=new Sys.StringBuilder(r);return t.append(n),t.append("&"),t.append(Common.a.j),t.toString()},h:function(n,t,i,r){return this.g.k(n,t,r,null,!1,2,null,i,"33",!1,null,6e4,null,null,!1,null)},b:function(n){var t=this;return new Promise(function(i,r){var e,u,f;try{if(isNullOrUndefined(t.d)||isNullOrUndefined(n)){Diag.a.a(51258443,3004,15,"SaveUserPrivacySettings: Can't determine setting changes to save");r("Can't determine setting changes to save");return}if(e=t.d.a!==n.a,t.d.b===2&&e){t.k(n);i(!0);return}if(u=t.l(n),isNullOrUndefined(u)||!u.length){Diag.a.a(50917389,3004,15,"SaveUserPrivacySettings: returning since nothing changed");r("No changes to save");return}if(t.d.b===1){i(t.j(u));return}t.d.b||(Diag.a.a(51258444,3004,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",u),f=t.h(t.i("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",u),f.CW(function(){if(f.b===4||f.b===5){Diag.a.a(50860929,3004,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed");i(!1);return}var n=f.a();isNullOrUndefined(n.a)||isNullOrUndefined(n.a.a())||n.a.a().c!==200?(Diag.a.a(51258446,3004,10,"SaveUserPrivacySettings: Roaming Request Failed"),i(!1)):(Diag.a.a(51258445,3004,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),i(!0))}))}catch(o){Diag.a.a(50860930,3004,10,"SaveUserPrivacySettings: Exception = {0}",o.toString());i(!1)}})},l:function(n){if(isNullOrUndefined(this.d)||isNullOrUndefined(n))throw Error.invalidOperation("User Privacy settings have not been initialized");var t=new($$sc.u.$$(String));return(n.b?n.b===1&&this.d.a!==n.a&&t.b("CCS"):(this.d.a!==n.a&&(t.b("CCS"),t.b("CCSTime")),this.d.c!==n.c&&t.b("OfficePrivacyRoamedNoticeShown")),!t.e.length)?(Diag.a.a(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),null):n.j(t)},a:function(){if(!this.f){var n=this;this.f=new Promise(function(t){try{if(n.d){t(n.d.e());return}n.o().then(function(i){return n.d=i,t(n.d.e()),null},function(){return n.m().then(function(i){return n.d=i,t(n.d.e()),null},function(){return n.n().then(function(i){return n.d=i,t(n.d.e()),null},function(){return Diag.a.a(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)"),n.d=new Common.cv,t(n.d.e()),null}),null}),null})}catch(i){Diag.a.a(50860932,3004,10,"UserPrivacySettings GetSettings: Exception = {0}",i.toString());n.d=new Common.cv;t(n.d.e())}})}return this.f},o:function(){var n=this;return new Promise(function(t,i){var u,f,r;try{if(u=window.location.href.indexOf("&wd_pn=2")!==-1,f=n.e.a("PrivacyDialogShouldCheckRoaming"),!f&&!u){Diag.a.a(50860933,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used");i("Roaming should not be used");return}r=n.h(n.i("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest",null);r.CW(function(){try{if(r.b===4||r.b===5)Diag.a.a(50860934,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure");else{var n=r.a();if(n&&n.a&&n.a.a())if(n.a.a().c!==200)Diag.a.a(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",n.a.a().c);else{if(n.a.a().a){t(Common.eJ.a(n.a.a().a,0));Diag.a.a(51258447,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",n.a.a().a);return}Diag.a.a(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else Diag.a.a(50860935,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");i("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure");return}}catch(u){Diag.a.a(50860938,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",u.toString());i("UserPrivacySettings TryGetSettingsFromRoaming Request Exception");return}})}catch(e){Diag.a.a(50860939,3004,10,"TryGetSettingsFromRoaming Exception = {0}",e.toString());i("UserPrivacySettings TryGetSettingsFromRoaming Exception");return}})},m:function(){var n=this;return new Promise(function(t,i){var u,r,e,o,s,f;try{if(u=Common.M.b("WacUPToggleState"),r=null,!isNullOrUndefined(u)&&u.length>0&&(r=decodeURIComponent(u)),!isNullOrUndefined(r)&&r.length>0){e=Common.eJ.a(r,1);Diag.a.a(51258448,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",e.toString());t(e);return}if(o=Common.cv.a(1,null),s=new($$sc.u.$$(String)),s.b("CCS"),f=o.j(s),n.j(f)){Diag.a.a(51258449,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",f);t(o);return}Diag.a.a(51258450,3004,15,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",f);i("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie");return}catch(h){Diag.a.a(50860941,3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",h.toString());i("UserPrivacySettings TryGetSettingsFromCookie Eception")}})},n:function(){var n=this;return new Promise(function(n){var r,t,i;try{r=window.location.href.indexOf("&wdccsoff=1")!==-1;t=Common.cv.a(2,null);r?(t.a=2,Common.a.M=!0,Diag.a.a(51258451,3004,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",t.toString())):(t.a=1,Diag.a.a(51258452,3004,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",t.toString()));n(t);return}catch(u){Diag.a.a(50967431,3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",u.toString());i=Common.cv.a(2,null);i.a=1;n(i)}})},k:function(n){return Diag.a.a(51258453,3004,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam"),Common.a.M=n.a===2?!0:!1,Diag.a.a(51258454,3004,50,"SaveSettingsToQueryParam saved settings = {0}",n),!0},j:function(n){try{Diag.a.a(51258455,3004,50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",n);var t=this.e.b("PrivacyCookieDomain")||"";if(!t||!t.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");return Diag.a.a(51258456,3004,50,"SaveUserPrivacySettings to Cookie {0}",n),Common.M.i("WacUPToggleState",n,365,"/",t)}catch(i){return Diag.a.a(50860942,3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",i.toString()),!1}},c:function(n){var t=this,i=this;return this.a().then(function(i){for(var u=t.e.e("ServicesControlsMicrosoftControllerServicesList")?t.e.f("ServicesControlsMicrosoftControllerServicesList"):new Array(0),f=new($$sc.m.$$(String))($$sc.e.b()),r=0;r<u.length;r++)f.a(u[r]);return f.b(n)?i.a!==2:!0},function(){return Diag.a.a(50860945,3004,10,"Failed to get privacy setting for feature {0}",n),!0})}};Type.registerNamespace("Common.App.ApplicationFeatureHelper");Common.App.ApplicationFeatureHelper.j=function(n,t){this.PolicySettings=null;this.ExpirationTime=0;this.PolicySettings=n.PolicySettings;var i=new Date;i.setMinutes(i.getMinutes()+t);this.ExpirationTime=i.getTime()};Common.App.ApplicationFeatureHelper.e=function(){};Common.App.ApplicationFeatureHelper.e.prototype={applicationFeatureHelperHandler:0,cloudPolicySettings:1};Common.App.ApplicationFeatureHelper.e.registerEnum("Common.App.ApplicationFeatureHelper.e",!1);Common.App.ApplicationFeatureHelper.m=function(){};Common.App.ApplicationFeatureHelper.m.prototype={Features:null};Common.App.ApplicationFeatureHelper.f=function(){};Common.App.ApplicationFeatureHelper.f.prototype={PolicySettings:null,ControllerConnectedServicesFeatureNames:null};Common.App.ApplicationFeatureHelper.i=function(){};Common.App.ApplicationFeatureHelper.i.a=function(){Common.App.a.a().a(new Common.App.ApplicationFeatureHelper.i,0,!1)};Common.App.ApplicationFeatureHelper.i.prototype={d:null,a:function(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"},c:function(n){var i,r,t;this.d=n;i=this;this.d.b(Common.App.ApplicationFeatureHelper.b,null).a().b(function(){return new Common.App.ApplicationFeatureHelper.k(Common.a.a,Common.a.d)});r=this;this.d.b(Common.App.ApplicationFeatureHelper.c,null).a().b(function(){return new Common.eJ(Common.a.a,Common.a.d)});t=this;this.d.b(Common.App.ApplicationFeatureHelper.a,null).a().b(function(){return new Common.App.ApplicationFeatureHelper.h(Common.a.a,Common.a.d,t.d.a(Common.App.ApplicationFeatureHelper.b,null),t.d.a(Common.App.ApplicationFeatureHelper.c,null),Common.a.c())})},b:function(){var n=this;Common.a.a.i(function(){var t=n.d.a(Common.App.ApplicationFeatureHelper.a,null);Common.a.a.a("LicensingIsEnabled")&&(t.a("LicensingTestFeature",!1).then(function(n){return Diag.a.a(42513092,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",n,Common.a.a.b("IsAnonymousUser")),null}),t.d("LicensingTestFeature",0).then(function(n){return Diag.a.a(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",n,Common.a.a.b("IsAnonymousUser")),null}));n.e()})},e:function(){try{if(Common.a.a.a("SideCarIsEnabled")){var n=this;Common.bY.b().then(function(n){return Diag.a.a(594057429,3004,50,"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",n),n})}}catch(t){return}}};Common.App.ApplicationFeatureHelper.h=function(n,t,i,r,u){var f,e,o,s;this.D=Function.createDelegate(this,this.K);this.E=Function.createDelegate(this,this.N);this.x=new Common.App.ApplicationFeatureHelper.g(n,t);this.k=n;this.A=n.c("LicensingMaxRetryAttempts",0);this.n=n.a("IsO365ConsumerHost");this.m=n.a("IsO365CommercialHost");this.s=n.a("PremiumUpsellIsEnabled");this.r=i;this.u=r;this.w=u;this.i=n.a("LicensingIsEnabled");this.o=n.a("OcpsIsEnabled")&&this.m;this.p=n.a("ShowPrivacyDialog")&&!!r;this.y=n.a("IsAnonymousUser");f=this;this.q=new Promise(function(n){n(!1)});e=this;this.h=new Promise(function(n){n(!0)});this.g=new($$sc.p.$$(String,$$sc.p.$$(String,Function)))($$sc.e.a());this.z=this.J();this.M()&&!this.y?(isNullOrUndefined(Common.a.b())||(this.t=Common.a.b().c(),isNullOrUndefined(this.t)||(this.l=this.t.b("WebServiceCall","ApplicationFeatureHelperService"))),this.j=this.C(0,!1)):(o=this,this.j=new Promise(function(n){n({})}));s=this;this.j.catch(function(n){Diag.a.a(42513088,3004,10,JSON.stringify(n))})};Common.App.ApplicationFeatureHelper.h.prototype={x:null,k:null,w:null,r:null,u:null,A:0,i:!1,o:!1,p:!1,n:!1,m:!1,s:!1,y:!1,z:null,q:null,h:null,t:null,l:null,j:null,g:null,J:function(){for(var t=this.k.e("AllLicensedFeatures")?this.k.f("AllLicensedFeatures"):new Array(0),i=new($$sc.m.$$(String))($$sc.e.b()),n=0;n<t.length;n++)i.a(t[n]);return i},M:function(){return this.m||this.n},C:function(n,t){var i,r;Diag.a.a(51185368,3004,50,"ApplicationFeatureHelper_TryInitializeLicensing: forceRefresh = {0}",t);i=this.F();i&&(i.set("retryAttempt",n.toString()),i.set("forceRefresh",t.toString()),i.set("isO365ConsumerHost",this.n.toString()),i.set("isO365CommercialHost",this.m.toString()),i.set("isFreemiumUpsellEnabled",this.s.toString()));Common.x.a().recordKpiUsageForAlertableKpi("AFHSLicensingFailedRequest","waclicensing",i);Common.x.a().recordKpiUsage("AFHSLicensingSuccessfulRequest",1,"waclicensing",i);isNullOrUndefined(this.l)||this.l.d();r=null;t&&(r=new($$sc.p.$$(String,String))($$sc.e.a()),r.b("x-LicensingForceRefresh","true"));var f=this.i?this.x.d(this.I("/afhs/ApplicationFeatureHelperHandler.ashx"),this.E,0,r,null,null,null,null):Promise.resolve({}),e=this,u=this;return f.then(function(n){var r,t=(r=new Common.bI,r.durationMs=e.H(),r);return t.extendedProperties=i,t.extendedProperties&&n&&(t.extendedProperties.set("featureCount",Common.N.c(n).toString()),t.extendedProperties.set("licensingTestFeatureEnabled",("LicensingTestFeature"in n).toString()),t.extendedProperties.set("msoPremiumBadgeEnabled",("MsoPremiumBadge"in n).toString())),Common.x.a().recordKpiSuccess("AFHSLicensingSuccessfulRequest",t),n},function(t){var e,r=(e=new Common.bI,e.durationMs=u.H(),e),f=$$as(Common.App.ApplicationFeatureHelper.d,t);return f?(r.extendedProperties=i,r.extendedProperties&&r.extendedProperties.set("status",f.a.toString()),Common.x.a().recordKpiFailure("AFHSLicensingFailedRequest","RequestFailed",!1,!0,r),f.a===408&&++n<=u.A)?u.C(n,!1):new Promise(function(n,t){t(f)}):(Diag.a.a(51491471,3004,10,"ApplicationFeatureHelper_TryInitializeLicensing: Invalid cast to HttpRequestToPromiseRejectData"),Common.x.a().recordKpiFailure("AFHSLicensingFailedRequest","InvalidCastToHttpRequestToPromiseRejectData",!1,!0,r),new Promise(function(n,i){i(t)}))})},N:function(n){var t=JSON.parse(n);return t?(Diag.a.a(50436170,3004,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),Diag.a.a(50938594,3004,50,"{0}",t)):Diag.a.a(50436171,3004,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set. Response was {0}",n),t.Features},I:function(n){return String.format("{0}{1}",this.k.b("WebServiceBase"),n)},a:function(n,t){var i,r,u;if(!this.o&&!this.p&&!this.i)return this.h;if(Diag.a.a(42513091,3004,50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",n),n==="ConnectedServices"){var e=this.o?this.r.a("ControllerConnectedServicesEnabled",!0):this.h,h=this,c=this,o=this.p?this.u.a().then(function(n){return n.a!==2},function(){return t}):this.h,s=this;return e.then(function(n){return n?o:s.q})}i=null;i=this.o?this.r.b(n,!0):this.h;r=null;r=this.i?this.L(n,t):this.h;u=null;u=this.p?this.u.c(n):this.h;var f=this,l=this,a=this;return i.then(function(n){return n?u.then(function(n){return n?r:f.q}):f.q}).then(function(n){return n},function(){return t})},d:function(n,t){var r,i,u;return this.i?(Diag.a.a(42804871,3004,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",n),i=this,u=this,this.j.then(function(r){return n in r?i.v(r[n],t):t},function(){return t})):(r=this,new Promise(function(n){n(2)}))},c:function(){return this.s&&this.n},e:function(n){var t,i,r;Diag.a.a(594564814,3004,50,String.format("ApplicationFeatureHelper_LaunchUpsellExperience: Launching upsell experience for experienceId: {0}",n));t=this.F();t&&t.set("experienceId",n);Common.x.a().recordKpiUsage("AFHCLaunchUpsellSuccess",1,"waclicensing",t);i=Common.Utils.a.a().d(Common.cr,null);i?(r=this.D,i.b(n,r)):(Diag.a.a(594367561,3004,15,"InProductMessaging was not initialized"),Common.x.a().recordKpiFailure("AFHCLaunchUpsellSuccess","InProductMessagingNotInitialized",!1,!0,null),this.w.b(1274543852,2,{experience:n},null))},b:function(n,t){if(!this.i)return null;if(!n||!t)return Diag.a.a(594564813,3004,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),null;var i=Common.z.a().a;return this.g.d(n)?this.g.a(n).c(i,t):(this.g.b(n,new($$sc.p.$$(String,Function))($$sc.e.a())),this.g.a(n).c(i,t)),Diag.a.a(594564812,3004,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",i,n)),i},f:function(n,t){return this.i?!n||!this.g.d(n)?(Diag.a.a(594564811,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid or non registered featureName {0}",n)),!1):!t||!Common.z.f(t)?(Diag.a.a(594564810,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid callbackId {0} for feature {1}",t,n)),!1):this.g.a(n).d(t)?(Diag.a.a(594564808,3004,50,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: Removing callback {0} for feature {1}",t,n)),this.g.a(n).i(t)):(Diag.a.a(594564809,3004,15,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: callbackId {0} not registered for feature {1} ",t,n)),!1):!1},v:function(n,t){switch(n.toLowerCase()){case"unknown":return 0;case"basic":return 1;case"premium":return 2;default:return t}},K:function(){if(Diag.a.a(594367560,3004,50,"ApplicationFeatureHelper_HandleDimeTaskComplete"),this.k.a("LicensingInlineRefreshIsEnabled")&&this.k.a("LicensingShellServiceIsEnabled")){var n=this,t=this;this.j.then(function(t){n.G(t)}).catch(function(){t.G({})})}else Common.a.b().F(null)},G:function(n){Diag.a.a(594051087,3004,50,"ApplicationFeatureHelper_RefreshLicensingAndNotifyUpdatedFeatures");var i=this.C(0,!0),t=this,r=this;i.then(function(r){var e,u,f,o;for(t.j=i,Common.N.c(r)>Common.N.c(n)?Common.x.a().recordKpiSuccess("AFHCLaunchUpsellSuccess",null):Common.x.a().recordKpiFailure("AFHCLaunchUpsellSuccess","FeatureCountNotIncreased",!1,!0,null),e=t.g.j().$$ge();e.$$mn();)u=e.$$cu(),u in r?(f=t.v(r[u],0),u in n?(o=t.v(n[u],0),o!==f&&t.B(u,!0,f)):t.B(u,!0,f)):u in n&&t.B(u,!1,t.v(n[u],0))}).catch(function(n){Common.x.a().recordKpiFailure("AFHCLaunchUpsellSuccess","LicensingRefreshFailed",!1,!0,null);Diag.a.a(594051086,3004,10,JSON.stringify(n))})},B:function(n,t,i){var r;Diag.a.a(594051085,3004,50,"ApplicationFeatureHelper_NotifyFeatureStateChanged: Notify feature state changed callbacks for feature {0}, {1}, {2}",n,t,i);for(var f=new Common.App.ApplicationFeatureHelper.l(n,t,i),e=this.g.a(n),u=e.$$ge();u.$$mn();){r=u.$$cu();try{r.a(f)}catch(o){Diag.a.a(594051084,3004,10,String.format("ApplicationFeatureHelper_NotifyFeatureStateChanged: Exception when calling registered callback: feature: {0} callbackId: {1}, exception {2}",n,r.b,o.message))}}},L:function(n,t){if(this.i){if(this.z.b(n)){var i=this,r=this;return this.j.then(function(t){return n in t},function(){return t})}return Diag.a.a(590385821,3004,50,"ApplicationFeatureHelper_IsFeatureAllowedByUserLicense: Feature '{0}' requested while not in the licensed features set.",n),this.h}return this.h},F:function(){try{return new Map}catch(t){return null}},H:function(){if(!isNullOrUndefined(this.l)){var n=this.l.b();return this.l.a(),n}return null}};Common.App.ApplicationFeatureHelper.k=function(n,t){var r,u,i,f,e,o;for(this.m=Function.createDelegate(this,this.t),this.l=Function.createDelegate(this,this.s),this.j={},this.k=new Common.App.ApplicationFeatureHelper.g(n,t),this.c=n,r=n.b("HostAuthType"),this.e=n.a("OcpsIsEnabled")&&n.a("IsO365CommercialHost")&&!isNullOrUndefined(r)&&r.toLowerCase()==="aad",this.j=JSON.parse(n.b("OcpsDefaultSettings")||"{}"),this.d=this.r(),u=this.c.e("ServicesControlsMicrosoftControllerServicesList")?this.c.f("ServicesControlsMicrosoftControllerServicesList")||new Array(0):new Array(0),this.f=new($$sc.m.$$(String))($$sc.e.b()),i=0;i<u.length;i++)this.f.a(u[i]);f=this.e&&!n.a("IsAnonymousUser")&&n.a("SideCarIsEnabled");this.g=f?this.x():this.w(this.e,this.q("/afhs/CloudPolicySettings.ashx"),this.l);e=this;o=this;this.g.then(function(){return null}).catch(function(n){Diag.a.a(50622685,3004,10,JSON.stringify(n))})};Common.App.ApplicationFeatureHelper.k.prototype={k:null,c:null,f:null,e:!1,d:null,i:0,g:null,a:function(n,t){var r;if(!this.e)return r=this,new Promise(function(t){t(r.h(n))});var i=this,u=this,f=this.g.then(function(r){var u,e,f;try{return u=null,e=Common.bR.toString(0).toLowerCase(),r.PolicySettings&&e in r.PolicySettings&&(u=r.PolicySettings[e]),u?n in u&&!isNullOrUndefined(u[n])?new Promise(function(t){t(u[n]!=="0")}):(f=n.toLowerCase(),f in u&&!isNullOrUndefined(u[f])?new Promise(function(n){n(u[f]!=="0")}):(Diag.a.a(51512667,3004,50,"Policy"+n+" not found, using default"),new Promise(function(t){t(i.h(n))}))):new Promise(function(t){t(i.h(n))})}catch(o){return Diag.a.a(50622686,3004,10,"Failed to get "+n+" policy value. Error Message: {0}",o.message),i.n(o.toString(),t,i.h(n))}},function(i){return u.n(i,t,u.h(n))}),e=this;return f.then(function(t){return Diag.a.a(50651667,3004,50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",n,t),null}),f},b:function(n,t){var f=this,i=new Promise(function(n){n(!0)}),r="",u;return this.f.b(n)&&(r="ControllerConnectedServicesEnabled",i=this.a(r,t)),u=this,i.then(function(t){return Diag.a.a(50651668,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabled: Feature: {0}, enabled or not: {1}, by policy: {2}",n,t,r),null}),i},n:function(n,t,i){var r,u;return t?(r=this,new Promise(function(n){n(i)})):(u=this,new Promise(function(t,i){i(n)}))},w:function(n,t,i){var u,f;if(!n)return Promise.resolve(new Common.App.ApplicationFeatureHelper.f);u=!1;f=null;Common.x.a().recordKpiUsage("GetCloudPolicySettings",1,"jpittsdirects",null);var e=this.o("GetCloudPolicySettings"),r=this,s=new Promise(function(n,f){if(!isNullOrUndefined(r.d)&&r.d.length>0){var e=r.v();if(!isNullOrUndefined(e)){u=!0;n(e);return}}r.k.d(t,i,1,null,r.m,["CheckIn-Interval"],r.c.c("CloudPolicySettingsRequestQueueTimeout",15e3),r.c.c("CloudPolicySettingsRequestSentTimeout",3e4)).then(function(t){return Diag.a.a(51662933,3004,50,"Retrieved CloudPolicySettingsData from OCPS"),r.y(t),n(t),t},function(n){return f(n),null})}),o=this;return s.then(function(n){var r,s,t,i,h;return f=(s=o.u(r={val:e}),e=r.val,s),t=o.p(),t&&t.set("FromCache",u.toString()),h=(i=new Common.bI,i.durationMs=f,i.extendedProperties=t,i),Common.x.a().recordKpiSuccess("GetCloudPolicySettings",h),n})},x:function(){var n=this;return Common.bY.b().then(function(){return Diag.a.a(593282845,3004,50,"CloudPolicySettingsHelper - Retrieving CloudPolicySettingsData Promise from Sidecar"),sidecar.cloudPolicy.GetCloudPolicySettingsData()})},q:function(n){return String.format("{0}{1}",this.c.b("WebServiceBase"),n)},s:function(n){var t=null,i,r;return r=Common.bz.a(n,i={val:t}),t=i.val,r,Diag.a.a(50622687,3004,t?50:10,"ParseCloudPolicySettingsResponse: fetched CloudPolicySettingsData from {0}",n),t},t:function(n){try{if(isNullOrUndefined(n))return;if("CheckIn-Interval"in n){var t=parseInt(n["CheckIn-Interval"]);!isNullOrUndefined(t)&&t>0&&(this.i=t)}}catch(i){Diag.a.a(51662934,3004,10,"ProcessCloudPolicySettingsResponseHeaders Exception {0}",i)}},h:function(n){return n in this.j?this.j[n]!=="0":!0},v:function(){var i,n,u,t,e,r,f;try{if(i=Common.Utils.c.a().d(this.d),isNullOrUndefined(i))return Diag.a.a(51662936,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null"),null;if(Diag.a.a(51662937,3004,50,"TryGetCloudPolicySettingsDataFromCache retrieved data {0} from LocalStorage",i),n=JSON.parse(i),isNullOrUndefined(n))return Diag.a.a(51662938,3004,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null after parsing"),null;if(isNullOrUndefined(n.ExpirationTime))return Diag.a.a(51662939,3004,15,"TryGetCloudPolicySettingsDataFromCache ExpirationTime from LocalStorage is null after parsing"),null;if(u=new Date(n.ExpirationTime),u.getTime()<Date.now())return Diag.a.a(51662940,3004,50,"TryGetCloudPolicySettingsDataFromCache Cache is expired"),null;for(t=new Common.App.ApplicationFeatureHelper.f,t.PolicySettings=n.PolicySettings,t.ControllerConnectedServicesFeatureNames=new($$sc.u.$$(String)),e=this.c.e("ServicesControlsMicrosoftControllerServicesList")?this.c.f("ServicesControlsMicrosoftControllerServicesList"):new Array(0),r=this.f.$$ge();r.$$mn();)f=r.$$cu(),t.ControllerConnectedServicesFeatureNames.b(f);return Diag.a.a(51662941,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage retrieved"),t}catch(o){return Diag.a.a(51662942,3004,10,"TryGetCloudPolicySettingsDataFromCache exception {0}",o.toString()),null}},y:function(n){try{if(isNullOrUndefined(n)||isNullOrUndefined(n.PolicySettings))Diag.a.a(51662944,3004,15,"TrySetCloudPolicySettingsDataIntoCache data/PolicySettings is null");else if(this.i<=0)Diag.a.a(51662945,3004,15,"TrySetCloudPolicySettingsDataIntoCache _checkInInterval is Invalid");else{var i=new Common.App.ApplicationFeatureHelper.j(n,this.i),t=JSON.stringify(i);Diag.a.a(51662946,3004,50,"TrySetCloudPolicySettingsDataIntoCache data to cache {0}",t);Common.Utils.c.a().a(this.d,t);Diag.a.a(51662947,3004,50,"TrySetCloudPolicySettingsDataIntoCache set data to cache")}}catch(r){Diag.a.a(51662976,3004,10,"TrySetCloudPolicySettingsDataIntoCache exception {0}",r.toString())}},r:function(){var i,n;try{if(this.e&&Common.c.bK()&&(i=this.c.b("UserDataSignature"),n=i.split("."),n.length>1)){var r=window.self.atob(n[1]),u=JSON.parse(r),t=u.LocalStorageKey;if(!isNullOrUndefined(t)&&t.length>0)return t}}catch(f){Diag.a.a(51662977,3004,10,"GetLocalStorageCacheKey exception {0}",f.toString())}return null},p:function(){try{return new Map}catch(n){return null}},o:function(n){var t=Common.Utils.a.a().d(DiagUse.a,null);return isNullOrUndefined(t)?null:t.a("WebServiceCall",n)},u:function(n){if(!isNullOrUndefined(n.val)){var t=n.val.b();return n.val.a(),n.val=null,t}return null}};Common.App.ApplicationFeatureHelper.d=function(){};Common.App.ApplicationFeatureHelper.d.prototype={b:null,a:0};Common.App.ApplicationFeatureHelper.g=function(n,t){this.a=n;this.c=t};Common.App.ApplicationFeatureHelper.g.prototype={a:null,c:null,d:function(n,t,i,r,u,f,e,o){var s=Common.App.ApplicationFeatureHelper.e.toString(i),c=s+"RequestFailure",h;return Common.x.a().recordKpiUsage(c,0,"jpittsdirects",null),h=this,new Promise(function(l,a){Diag.a.a(50622688,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing HttpRequest {0}.",s);var v=e!=null?e:h.a.c("ApplicationFeatureHelperRequestQueueTimeout",5e3),y=o!=null?o:h.a.c("ApplicationFeatureHelperRequestSentTimeout",5e3);h.c.d(n,1,null,h.e(i,r),f,!1,1,function(n){var r,f,i,e,o;Diag.a.a(50622689,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",s);try{if(isNullOrUndefined(n)||isNullOrUndefined(n.b)||isNullOrUndefined(n.b.a)){Common.x.a().recordKpiFailure(c,"Invalid RequestSucceededEventArgs",!1,!0,null);r=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",s);a(h.b(r,n));return}if(n.b.c!==200){Common.x.a().recordKpiFailure(c,"HttpStatusCode_"+n.b.c.toString(),!1,!0,null);f=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",n.b.c,s);a(h.b(f,n));return}if(isNullOrUndefined(u)||isNullOrUndefined(n.b.d)||u(n.b.d),i=t(n.b.a),!i){Common.x.a().recordKpiFailure(c,"Parse Failure",!1,!0,null);e=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",s);a(h.b(e,n));return}Diag.a.a(50622690,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",s);l(i)}catch(v){Common.x.a().recordKpiFailure(c,"Unexpected Failure",!1,!0,null);o=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",v,s);a(h.b(o,n))}},function(n){Diag.a.a(50622691,3004,10,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} failed.",s);var t="";if(!n.b){Common.x.a().recordKpiFailure(c,"Invalid RequestFailedEventArgs",!1,!0,null);t=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",s);a(h.b(t,n));return}Common.x.a().recordKpiFailure(c,"HttpStatusCode_"+n.b.c.toString(),!1,!0,null);t=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",n.b.c,n.b.a||"No Data",s);a(h.b(t,n))},null,null,!1,v,y,null,null,!1,null,!1,null,null)})},b:function(n,t){var i=new Common.App.ApplicationFeatureHelper.d;return i.b=n,i.a=t&&t.a()?t.a().c:-1,i},e:function(n,t){var i={},r,u;if(i["x-UserDataSignature"]=this.a.b("UserDataSignature"),i["x-LicensingIsEnabled"]=this.a.a("LicensingIsEnabled").toString(),i["x-CacheIsEnabled"]=this.a.a("LicensingRedisIsEnabled").toString(),i["x-OcpsIsEnabled"]=this.a.a("OcpsIsEnabled").toString(),i["x-LicensingAADIdIsEnabled"]=this.a.a("LicensingAadIdIsEnabled").toString(),n||(i["x-LicensingShellServiceIsEnabled"]=this.a.a("LicensingShellServiceIsEnabled").toString(),i["x-LicensingEduIsEnabled"]=this.a.a("LicensingEduIsEnabled").toString(),i["x-LicenseCheckOnTenantEnabled"]=this.a.a("LicensingForSafeLinksIsEnabled").toString()),t)for(r=t.j().$$ge();r.$$mn();)u=r.$$cu(),i[u]=t.a(u);return i}};Common.App.ApplicationFeatureHelper.j.registerClass("Common.App.ApplicationFeatureHelper.j");Common.App.ApplicationFeatureHelper.m.registerClass("Common.App.ApplicationFeatureHelper.m");Common.App.ApplicationFeatureHelper.f.registerClass("Common.App.ApplicationFeatureHelper.f");Common.App.ApplicationFeatureHelper.d.registerClass("Common.App.ApplicationFeatureHelper.d");Common.App.ApplicationFeatureHelper.i.a();Type.registerNamespace("Common.App.InProductMessaging");Common.App.InProductMessaging.f=function(){};Common.App.InProductMessaging.f.registerInterface("Common.App.InProductMessaging.f");Common.App.InProductMessaging.k=function(){};Common.App.InProductMessaging.c=function(){};Common.App.InProductMessaging.c.prototype={b:!1,a:!1};Common.App.InProductMessaging.d=function(n,t,i){this.d=Function.createDelegate(this,this.h);this.f=Function.createDelegate(this,this.j);this.g=Function.createDelegate(this,this.k);this.e=Function.createDelegate(this,this.i);this.a=n;this.c=t;this.b=i};Common.App.InProductMessaging.d.prototype={a:null,c:null,b:null,l:function(){this.a.c(672565674,2147483648,this.e,64);this.a.a(1501863744,2147483648,this.g);this.a.a(3016992658,2147483648,this.f);this.a.a(4275690876,2147483648,this.d);this.a.a(4142738798,2147483648,Common.w.a);this.a.a(3865601672,2147483648,Common.w.a);this.a.a(2275483468,2147483648,Common.w.a);this.c&&this.c.d(!1)},i:function(n,t,i,r,u){return i===2&&this.b.d(u),32},h:function(n,t,i,r,u){return i===2&&this.b.c(u),32},k:function(n,t,i){return i===2?this.b.f():32},j:function(n,t,i){return i===2?this.b.e():32}};Common.App.InProductMessaging.a=function(){};Common.App.InProductMessaging.a.d=function(n){var t=Common.App.InProductMessaging.a.b(n),i=Common.bs.a(t,null,null);return Common.App.InProductMessaging.a.a(i)};Common.App.InProductMessaging.a.c=function(n){var t=Common.App.InProductMessaging.a.b(n),i=new Common.ff(t);return Common.App.InProductMessaging.a.a(i)};Common.App.InProductMessaging.a.b=function(n){return Common.A.g(String.format("ipm/{0}",n))};Common.App.InProductMessaging.a.a=function(n){return Common.bc.a(n),n.f.a};Common.App.InProductMessaging.a.prototype={c:null,d:null,a:function(){if(!this.c){Diag.a.a(21030598,324,50,"InProductMessagingDependenciesLoad usage");this.c=$$sc.a.WAA(Common.App.InProductMessaging.a.d("inproductmessaging.js"),Common.App.InProductMessaging.a.c("inproductmessaging.css"));var n=this;this.c.CWo(function(n){Diag.a.a(21030599,324,10,"{0}",Common.d.F(n.c))},5)}return this.c},b:function(){var n,t;if(!this.d)try{Diag.a.a(39978390,324,50,"InProductMessagingFreemiumDependenciesLoad usage");n=Common.a.a.b("DimeUrl");this.d=$$sc.a.WAA(Common.App.InProductMessaging.a.a(Common.bs.a(n,null,null)));t=this;this.d.CWo(function(n){Diag.a.a(39978391,324,10,"{0}",Common.d.F(n.c))},5)}catch(i){Diag.a.a(594874951,324,10,"{0}",Common.d.F(i))}return this.d}};Common.App.InProductMessaging.i=function(){};Common.App.InProductMessaging.i.prototype={b:null,a:null,e:null,d:null,c:null};Common.App.InProductMessaging.h=function(){this.a=new Array(5);this.a[0]=10;this.a[1]=15;this.a[2]=50;this.a[3]=100;this.a[4]=200};Common.App.InProductMessaging.h.prototype={b:0,Init:function(n){this.b=n},SendTrace:function(n,t){Diag.a.a(34182235,this.b,this.a[n],"{0}",t)}};Common.App.InProductMessaging.j=function(){};Common.App.InProductMessaging.j.a=function(){Common.App.a.a().a(new Common.App.InProductMessaging.j,0,!1)};Common.App.InProductMessaging.j.prototype={d:null,a:function(){return"Common.App.InProductMessaging"},c:function(n){var e=this,t,i,r,u,f;n.b(Common.App.InProductMessaging.a,null).c(Common.App.InProductMessaging.f,null).a().b(function(){return new Common.App.InProductMessaging.a});t=this;n.b(Common.App.InProductMessaging.g,null).c(Common.fu,null).a().b(function(){return new Common.App.InProductMessaging.g(Common.n.a())});i=this;n.b(Common.App.InProductMessaging.b,null).c(Common.cr,null).a().b(function(){return new Common.App.InProductMessaging.b(Common.a.c(),n.a(Common.fu,null),n.a(Common.App.InProductMessaging.f,null),Common.a.b().a().b(),Common.a.b().a().o())});r=this;n.b(Common.App.InProductMessaging.d,null).a().b(function(){return new Common.App.InProductMessaging.d(Common.a.c(),Common.a.b(),n.a(Common.cr,null))});u=this;n.b(Common.App.InProductMessaging.e,null).c(Common.ha,null).a().b(function(){return new Common.App.InProductMessaging.e});f=this;n.b(Common.App.InProductMessaging.c,null).c(Common.hb,null).a().b(function(){return new Common.App.InProductMessaging.c});this.d=n},b:function(){var t=this.d.a(Common.App.InProductMessaging.d,null),n;t.l();n=this;Common.a.a.i(function(){Common.a.a.a("GoPremiumLicensingIsEnabled")&&Common.a.b().a().c()&&Common.App.AppLifecycleManager.get_instance().a(15,function(){n.d.c(Common.App.ApplicationFeatureHelper.a,null).a(function(t){n.d.a(Common.App.InProductMessaging.b,null).n(t)})},3);Common.a.a.a("FreemiumUpsellShowDialogIsEnabled")&&Common.cZ.a()&&Common.a.b().a().b()!==1&&n.d.c(Common.App.ApplicationFeatureHelper.a,null).a(function(t){t.a("MsoPremiumBadge",!0).then(function(i){return!i&&t.c()&&n.d.a(Common.App.InProductMessaging.b,null).a(),null})})})}};Common.App.InProductMessaging.b=function(n,t,i,r,u){this.i=n;this.g=t;this.l=i;this.k=r;this.m=u};Common.App.InProductMessaging.b.prototype={g:null,l:null,i:null,k:0,m:0,j:!1,h:null,n:function(n){var i,t,r;Common.C.e("getHeaderApi")?(i="MsoPremiumBadge",t=n.c(),t&&(r=this,n.a(i,!0).then(function(r){return appChrome.getHeaderApi().then(function(n){return n.updatePremiumStatus(r,t),null}),n.b(i,function(n){appChrome.getHeaderApi().then(function(i){return i.updatePremiumStatus(n.isEnabled,t),null})}),null}))):Diag.a.a(593859840,324,10,"getHeaderApi not available")},d:function(n){var t=this;this.l.a().CW(function(){t.g.d(n)})},c:function(n){var t=n,i="gopremium",u=this,r=function(){};t?(t.experience&&$$as(String,t.experience)!==""&&(i=$$as(String,t.experience)),t.onTaskComplete&&(r=t.onTaskComplete)):Diag.a.a(51675402,324,50,"Experience not given, using default experience");this.b(i,r)},b:function(n,t){var i;if(this.j&&this.h){i={};i.experience=n||"gopremium";i.campaignId=Common.cZ.b(this.k,this.m,$$as(String,i.experience),!0);this.i.d(4142738798,2,null);Diag.a.a(51675403,324,50,"Launching Freemium Upsell dialog: "+i.experience);try{var r,o=this,s=this,u=this,f=(r=new Common.App.InProductMessaging.i,r.b=this.h,r.a=i,r.e=t||function(){},r.d=function(n){Diag.a.a(51675405,324,50,"Dime launch result: "+n.status)},r.c=function(){Diag.a.a(51675406,324,10,"Dime launch error");u.j=!1;u.h=null},r);this.g.c(f)}catch(e){Diag.a.a(51675407,324,10,"Dime launch error: "+e.message);this.j=!1;this.h=null;this.i.b(1274543852,2,{experience:i.experience},null)}}else Diag.a.a(39978392,324,10,"FreemiumUpsellDialogDependencies not loaded"),this.i.b(1274543852,2,{experience:n},null)},a:function(){var n=this;this.l.b().CWo(function(){var r,i,t;try{if(r=Common.a.J.toLowerCase(),i=Common.cZ.c(n.k),!i){Diag.a.a(51675409,324,15,"App not supported");return}t={};t.partnerId=i;t.language=r;t.sessionId=Common.a.k;t.authHint=Common.a.a.b("UserPrincipalName");n.h=new Dime(t);n.j=!0;Diag.a.a(592721856,324,50,"Dime initialized")}catch(u){Diag.a.a(51675410,324,10,"FreemiumUpsellDialogDependencies failed: "+u.message)}},3)},f:function(){return this.g.b()},e:function(){return this.g.a()}};Common.App.InProductMessaging.g=function(n){this.h=Function.createDelegate(this,this.k);this.e=n};Common.App.InProductMessaging.g.prototype={e:null,f:!1,d:function(n){var t=n;t&&(InProductMessaging.Networking.NetworkingMgr=new Common.App.InProductMessaging.h,InProductMessaging.Networking.NetworkingMgr.Init(387),this.f=!0,InProductMessaging.Init(t.f,t.e,t.d,t.c,t.b,this.h,t.a),this.i("inProductMessagingOverlayDiv",!0))},c:function(n){var t=n,i,r,u;if(t&&t.b&&t.a)i=document.getElementById("wacDimeContainer"),i||(i=document.createElement("div"),i.id="wacDimeContainer",document.body.appendChild(i)),this.i("wacDimeContainer",!1),t.a.parentElementId="wacDimeContainer",r=this,u=this,t.b.launch(t.a,t.e).then(function(n){r.g();document.body.removeChild(i);t.d(n)}).catch(function(n){u.g();document.body.removeChild(i);t.c(n)});else throw Error.argument("DimeExperienceUISettings");},i:function(n,t){var u,i,r;this.e&&n&&(u=document.getElementById(n),this.j("InProductMessagingFocusId",u,!1),i=this.e.g("InProductMessagingFocusId"),i&&(r=this.e.d(),r&&r.a==="InProductMessagingFocusId"||this.e.f("InProductMessagingFocusId",!1),t&&this.l(i.f)))},j:function(n,t,i){var f=this.e.a(n),e,r,o,u;f.d="app";e=this;r=new Common.R(function(){return t});r.m=i;r.i(3);r.i(2);r.i(4);o=this;u=this.e.e(function(){return t},f,r);u.i();u.b=!0;u.c=!0},l:function(n){n.b(Common.n.a().r);n.b(Common.n.a().s);n.c(Common.n.a().r,1501863744);n.c(Common.n.a().s,3016992658)},g:function(){this.e&&(this.e.i("InProductMessagingFocusId",!0),this.e.k("InProductMessagingFocusId"))},k:function(n,t){this.f=!1;this.g();var i,r=(i=new Common.App.InProductMessaging.c,i.a=n,i.b=t,i);Common.a.c().b(1486778386,2,r,null)},b:function(){var t=document.activeElement,n=this.e.j();return t&&n&&n.a&&t===n.a.e()?(n.a.a(t),n.d()?32:8):4},a:function(){var t=document.activeElement,n=this.e.j();return t&&n&&n.a&&t===n.a.d()?(n.a.a(t),n.e()?32:8):4}};Common.App.InProductMessaging.e=function(){this.a={}};Common.App.InProductMessaging.e.prototype={d:!0,e:!0,f:!0,a:null,c:!1,b:null};Common.App.InProductMessaging.c.registerClass("Common.App.InProductMessaging.c",null,Common.hb);Common.App.InProductMessaging.d.registerClass("Common.App.InProductMessaging.d");Common.App.InProductMessaging.a.registerClass("Common.App.InProductMessaging.a",null,Common.App.InProductMessaging.f);Common.App.InProductMessaging.i.registerClass("Common.App.InProductMessaging.i");Common.App.InProductMessaging.b.registerClass("Common.App.InProductMessaging.b",null,Common.cr);Common.App.InProductMessaging.g.registerClass("Common.App.InProductMessaging.g",null,Common.fu);Common.App.InProductMessaging.e.registerClass("Common.App.InProductMessaging.e",null,Common.ha);Common.App.InProductMessaging.j.a();Type.registerNamespace("Common.App.InsertFile");Common.App.InsertFile.a=function(n,t){var i,r;this.br=Function.createDelegate(this,this.cq);this.bI=Function.createDelegate(this,this.cs);this.bF=Function.createDelegate(this,this.cc);this.Z=Function.createDelegate(this,this.cb);this.bG=Function.createDelegate(this,this.cd);this.bH=Function.createDelegate(this,this.cr);this.b=[];Common.App.InsertFile.a.initializeBase(this,[!1,!1,Common.App.InsertFile.a.a(),!1]);this.bd=n;this.bt=t;this.dn=!1;this.v=!1;this.e=null;this.bc=!1;this.p=this.bL();this.k=this.bJ;this.h(1,this.bK());Common.App.InsertFile.a.a()?(this.c={id:this.k,bodyControls:{uploadButtonProps:{label:$a.dB,onExecute:this.bH}},uploadStatusLabel:$a.dF,onFrameReady:this.bG},this.j(this.be(),this.Z,this.c),this.ch=!0):(this.bf(this.be(),this.Z),t&&this.bY(),i=this.W(1),i&&this.b.push(i),r=this.W(0),r&&this.b.push(r),this.bZ(),this.ch=!1)};Common.App.InsertFile.a.a=function(){return Common.a.b().a().f()&&Common.a.a.a("ReactInsertFileDialogIsEnabled")};Common.App.InsertFile.a.b=function(n){var t=document.getElementById("errorText");t.innerText=n;t.style.display="inline-block"};Common.App.InsertFile.a.prototype={bd:null,bJ:"InsertFileDialog",e:null,bc:!1,bt:!1,c:null,bs:!1,a:null,bo:function(){this.a.a||Diag.a.a(25798091,322,10,"UploadFrame.FileInputElement is null");var n=this.a.a.value;return n?!0:(Common.App.InsertFile.a.b($a.bf),!1)},cd:function(n){this.bt&&(this.a=this.bu(n,this.bd))},cr:function(){this.a&&(this.bs||(this.a.ba(this.bF),this.bs=!0),this.a.M())},cc:function(n){this.c.uploadStatusLabel=n;this.de(this.be(),this.Z,this.c)},cb:function(n){if(n===1&&this.bW()){if(Common.App.InsertFile.a.a()&&this.a.a&&!this.a.a.value){this.c.uploadStatusLabel=$a.bf;this.de(this.be(),this.Z,this.c);return}this.dt();this.bd.f(this.a,this.ec)}else n||this.i()},bY:function(){this.bc=!1;this.a=this.bu(document.getElementById("uploadFrameContainer"),this.bd);Common.a.a.a("InsertPictureDialogFocusLoopFixIsEnabled")&&(this.e=this.bI,Common.j.a(this.a.b,"load",this.e));this.a.a||Diag.a.a(25798092,322,15,"UploadFrame.FileInputElement is null");this.bX()},cs:function(){this.bX()},bX:function(){var n,t;this.a&&!this.bc&&(n=this.a.a,n&&(Common.j.a(n,"keydown",this.br),t=[n],this.b=t.concat.apply(t,this.b),this.bZ(),this.bc=!0))},dispose:function(){if(this.a&&!Common.App.InsertFile.a.a()){var n=this.a.a;n&&Common.j.c(n,"keydown",this.br);this.e&&Common.j.c(this.a.b,"load",this.e)}this.a=null;CommonUI.b.prototype.dispose.call(this)},bZ:function(){if(this.b.length>0){var t=new CommonUI.l(this.b),i=Common.n.a(),n=i.j();n&&(this.b[0].focus(),n.a=t,n.b=!0)}},cq:function(n){var t=Common.n.a().U(n);t!==4&&n.preventDefault()}};Common.App.InsertFile.c=function(n,t,i){this.p=Function.createDelegate(this,this.M);this.o=Function.createDelegate(this,this.X);this.E=Function.createDelegate(this,this.W);this.F=n;this.K=t;this.d=i;this.e=!1;this.r=!0;this.Y();this.x=this.d.a("NativeFileOpenDialogIsEnabled")};Common.App.InsertFile.c.prototype={K:null,F:null,d:null,e:!1,q:null,r:!1,b:null,x:!1,G:0,H:0,I:0,J:0,k:null,X:function(n){if(this.b=n,!this.e){if(this.r){if(this.x&&Common.c.l()){this.k=n.K(this.E);return}if(this.k=n.K(null),!this.t(this.k,n))return}this.f(n,null)}},W:function(n){this.t(n,this.b)&&((Common.c.l()||Common.c.b())&&(this.k=n),this.f(this.b,null))},s:function(){this.q&&this.q()},Y:function(){this.G=0;this.H=this.d.c("Box4UploadRetryCount",20);this.I=this.d.c("Box4UploadRetryDelayStart",200);this.J=this.d.c("Box4UploadRetryDelayMax",3200);this.b&&(this.b.dispose(),this.b=null)}};Common.App.InsertFile.b=function(n,t){this.b=n;this.a=t};Common.App.InsertFile.b.prototype={b:null,a:null};Common.App.InsertFile.d=function(n,t,i,r,u,f,e,o,s,h){this.D=Function.createDelegate(this,this.T);this.F=Function.createDelegate(this,this.V);this.v=Function.createDelegate(this,this.bd);this.G=Function.createDelegate(this,this.M);this.E=Function.createDelegate(this,this.U);this.H=Function.createDelegate(this,this.Z);this.j=n;this.w=t;this.s=i;this.q=u;this.t=e;this.n=o;this.o=h;this.l=!1;this.x=r.a("CanaryRenewalForFileUploadIsEnabled");this.m=!1;this.b=document.createElement("iframe");this.b.className=f;this.b.id=f;this.q&&(this.b.style.visibility="visible",this.b.style.height="30px",this.b.setAttribute("frameborder","0"));this.k=this.H;Common.j.a(this.b,"load",this.k);s&&this.J()};Common.App.InsertFile.d.prototype={B:"FileUpload.ashx",b:null,r:!1,w:null,s:null,p:null,j:null,c:null,a:null,i:null,k:null,f:null,e:null,q:!1,t:null,n:null,o:null,d:null,y:!1,l:!1,x:!1,m:!1,u:function(){return Common.a.a?Common.a.a.a("NativeFileOpenDialogIsEnabled"):!1},N:function(){return Common.a.a?Common.a.a.a("FileInputDescriptionAccessibilityIsEnabled"):!1},W:function(){return this.b.contentWindow.location.pathname.endsWith(this.B)},K:function(n){return(Common.a.b().A(),!this.a)?(Diag.a.a(25798093,322,50,"_fileInput is null"),""):(this.u()&&Common.c.l()&&(this.p=n,this.f=this.E,Common.j.a(this.a,"change",this.f)),Common.hS.a(this.G,1,"DoFileOpenDialog"),this.a.value)},U:function(){this.p&&this.p(this.a.value)},V:function(){this.i&&(this.i.innerText=this.O())},ba:function(n){var t=this;Common.j.a(this.a,"change",function(){n(t.O())})},O:function(){var t=null,n,i;return this.a.value&&(n=this.a.value,i=n.lastIndexOf("\\"),i>0&&(t=n.substring(i+1,n.length))),t?t:""},M:function(){try{Diag.a.a(35939520,322,50,"UploadFrame.FileInputClick - Clicking on File input element.");this.a.click()}catch(n){Diag.a.a(36783331,322,10,"UploadFrame.FileInputClick Exception: {0}",n.message);throw n;}},bb:function(){this.Y()?this.R():this.c.submit()},Y:function(){return this.x&&!isNullOrUndefined(window.self.FormData)},R:function(){try{Diag.a.a(594888409,322,50,"SubmitFormWithRequest is preparing to send an upload request");var n=new(Type.parse("FormData"))(this.c),t=this.z();this.d=new XMLHttpRequest;this.d.open("POST",t);this.d.onreadystatechange=this.v;this.d.send(n)}catch(i){Diag.a.a(594888407,322,10,"SubmitFormWithRequest failed to send the request with exception "+i.message);this.g(null)}},bc:function(n){var t,i;try{Diag.a.a(594888406,322,50,"SubmitFormWithBlob is preparing to send an upload request");this.c.removeChild(this.a);t=new(Type.parse("FormData"))(this.c);t.append("applicationfileInput",n.a,n.b);i=this.z();this.d=new XMLHttpRequest;this.d.open("POST",i);this.d.onreadystatechange=this.v;this.d.send(t)}catch(r){Diag.a.a(591267743,322,10,"SubmitFormWithBlob failed to send the request with exception "+r.message);this.g(null)}},bd:function(){if(this.d.readyState===4)if(this.d.status===200){Diag.a.a(594888405,322,50,"UploadResponseReceived received a successful response.");var n=this.d.getResponseHeader("X-NewKey"),i=this.X(this.d),t=!1;if(!isNullOrUndefined(n)&&i&&(t=this.be(n),!this.l&&t)){Diag.a.a(594888404,322,50,"UploadResponseReceived resubmitting the upload request with a fresh canary");this.l=!0;this.A();this.R();return}Diag.a.a(594888403,322,50,"UploadResponseReceived processing the response [retried: {0}] [canaryInvalid: {1}] [gotNewCanary: {2}] [canaryRenewed: {3}]",this.l,i,!isNullOrUndefined(n),t);this.g(this.d.responseText)}else Diag.a.a(42874946,322,15,"Upload request failed with status: "+this.d.status),this.g(null)},X:function(n){var r,t,i,u;try{if(r=JSON.parse(n.responseText),t=r.Responses,!isNullOrUndefined(t)&&t.length===1&&(i=t[0],!isNullOrUndefined(i)&&i.length===2&&(u=i[1].StatusCode,u===28)))return!0}catch(f){}return!1},be:function(n){return(Common.bk.e(n),Common.a.G!==n)?!1:!0},dispose:function(){this.y||(this.j.removeChild(this.b),Common.j.c(this.b,"load",this.k),this.k=null,this.f&&(Common.j.c(this.a,"change",this.f),this.f=null),this.N()&&(this.e&&(Common.j.c(this.a,"change",this.e),this.e=null),this.i=null),this.b=null,this.j=null,this.c=null,this.a=null,this.y=!0,Diag.a.a(25798094,322,50,"UploadFrame disposed"))},T:function(){this.dispose()},S:function(n,t){var i=this.b.contentWindow.document.getElementById(n);if(i){i.value=t;return}i=this.b.contentWindow.document.createElement("input");i.type="hidden";i.id=n;i.name=n;i.value=t;this.c.appendChild(i)},Z:function(){var t,i;try{if(!this.b.contentWindow.document.body)return}catch(f){this.P();return}if(this.r||this.u()&&Common.c.l()){if(!(this.u()&&Common.c.l())||this.W()){t=Common.c.a()?this.b.contentWindow.document.body.innerText:this.m?this.b.contentWindow.document.body.firstChild.innerText:this.b.contentWindow.document.body.firstChild.innerHTML;var n=this.b.contentWindow.document.body.innerText.toLowerCase(),r=n.indexOf("responses")>=0||n.indexOf("wopisrc")>=0,u=n.indexOf("http error")>=0;!r&&u&&(i=this.b.contentWindow.document.body.innerText,Diag.a.a(42551183,322,15,"Couldn't obtain a valid response but the frame contains: "+i));this.g(t)}}else this.L()},L:function(){var n,t,i,r;if(!this.r){var f=this.C("uploadForm"),u=this.C("fileInput"),e=this.z();this.c=this.b.contentWindow.document.createElement("form");this.c.id=f;this.c.method="post";this.c.encoding="multipart/form-data";this.c.action=e;n=this.b.contentWindow.document;this.a=n.createElement("input");this.a.type="file";this.n&&(this.a.accept=this.n,this.o&&(this.a.capture=this.o));this.a.id=u;this.a.name=u;!this.N()||Common.c.a()||Common.c.m()||(this.e=this.F,Common.j.a(this.a,"change",this.e),this.i=Common.F.b(this.c,this.a,"InputFileDescription",""));this.q&&(t=n.body,t.style.margin="0",t.style.overflow="hidden",i=Common.a.b(),this.a.style.fontFamily=i.O(),this.a.style.fontSize=i.P(),this.a.style.margin="0");r=document.getElementById("__REQUESTDIGEST");r&&this.S("__REQUESTDIGEST",r.value);this.A();this.c.appendChild(this.a);n.body.appendChild(this.c);this.r=!0;this.w(this)}},J:function(){this.j.appendChild(this.b);this.u()&&Common.c.l()&&this.L()},z:function(){var t=new Common.bB(this.B),n;return Common.a.bV(t),this.Q(t),n=t.toString(),(Common.c.b()||Common.c.l()||Common.c.m())&&(n=Common.k.q(n)),n},I:function(){var n=new Common.U(2,1,0,this.D,4,null,!1,0);Common.a.i().a(n)}};Common.App.InsertFile.a.registerClass("Common.App.InsertFile.a",CommonUI.b);Common.App.InsertFile.c.registerClass("Common.App.InsertFile.c");Common.App.InsertFile.d.registerClass("Common.App.InsertFile.d",null,Sys.IDisposable);Type.registerNamespace("Common.App.InsertPicture");Common.App.InsertPicture.c=function(n,t){Common.App.InsertPicture.c.initializeBase(this,[n,t])};Common.App.InsertPicture.c.prototype={bK:function(){return $a.eH},be:function(){return $a.eK},bL:function(){return Common.App.InsertPicture.b.b()},bo:function(){var n,t;return(this.a.a||Diag.a.a(25798095,322,10,"UploadFrame.FileInputElement is null"),n=Common.App.InsertPicture.a.b(this.a.a.value),n)?(t=Common.App.InsertPicture.a.c(n),Common.App.InsertFile.a.b(t),!1):!0}};Common.App.InsertPicture.a=function(n,t,i){Common.App.InsertPicture.a.initializeBase(this,[n,t,i])};Common.App.InsertPicture.a.c=function(n){switch(n){case 1:return $a.bj;case 2:return $a.eL;default:return""}};Common.App.InsertPicture.a.d=function(n){for(var i=n.toLowerCase(),t=0;t<Common.App.InsertPicture.a.a.length;++t)if(i.endsWith(Common.App.InsertPicture.a.a[t]))return!0;return!1};Common.App.InsertPicture.a.b=function(n){return n?Common.App.InsertPicture.a.d(n)?0:2:1};Common.App.InsertPicture.a.prototype={c:null,l:null,ba:function(){return Common.a.b().c()},t:function(n,t){var i=Common.App.InsertPicture.a.b(n),r,u;return i?(t.I(),i===2&&(r=Common.App.InsertPicture.a.c(i),u=this.N(i),this.bb(u,r)),!1):!0},f:function(n,t){Diag.a.a(36783360,322,50,"PictureUploader.FinalizeUpload");this.q=t;this.P()&&this.bc();Common.PerfMetrics.a(5576);this.l=this.ba().a("LoadResource","PictureUploadTime");var i=this.Q();i?this.L(n):this.s()},bb:function(n,t){var i=new CommonUI.d;i.g(0);i.j(n,$a.eJ,t,null)},s:function(){Diag.a.a(36783361,322,50,"PictureUploader.OnUploadComplete");Common.App.InsertFile.c.prototype.s.call(this);this.l&&(this.l.a(),this.l=null);this.O()&&this.Z()},bc:function(){var n=new CommonUI.g;this.c=n.a(!1);this.c.d($a.eM);this.c.b(5);this.c.c(!1);this.c.e(null,null,null)},Z:function(){return this.c?(this.c.a(),this.c=null,!0):!1}};Common.App.InsertPicture.b=function(){};Common.App.InsertPicture.b.b=function(){return CommonUI.b.a(Common.App.InsertPicture.b.a,$a.eI,$a.bj)};Common.App.InsertPicture.c.registerClass("Common.App.InsertPicture.c",Common.App.InsertFile.a);Common.App.InsertPicture.a.registerClass("Common.App.InsertPicture.a",Common.App.InsertFile.c);Common.App.InsertPicture.a.a=[".jpg",".jpeg",".png",".gif",".bmp",".tif",".tiff"];Common.App.InsertPicture.b.a="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}<\/label> <\/div> <div class='WACDialogRowNoBreak' id='block2'> <div id='uploadFrameContainer'><\/div> <div class='WACDialogError' id='errorText' role='alert'>{1}<\/div> <\/div>";Type.registerNamespace("Common.App.FirstRunExperienceLauncher");Common.App.FirstRunExperienceLauncher.a=function(){};Common.App.FirstRunExperienceLauncher.a.registerInterface("Common.App.FirstRunExperienceLauncher.a");Common.App.FirstRunExperienceLauncher.e=function(){};Common.App.FirstRunExperienceLauncher.b=function(){this.i=Function.createDelegate(this,this.n);this.j=Function.createDelegate(this,this.o);this.g=Function.createDelegate(this,this.k);this.h=Function.createDelegate(this,this.l)};Common.App.FirstRunExperienceLauncher.b.prototype={b:null,d:null,c:null,a:function(n){if(!n){Diag.a.a(51675531,306,10,"Invalid launcherSettings");return}if(this.b=n,this.m()){Diag.a.a(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service");var t,i=(t=new($$sc.u.$$(String)),t.b(this.b.c()),t);this.d=new Common.App.FirstRunExperienceLauncher.d(this.b,this.h,this.g,null,this.j);this.d.k(i)}this.b.f()&&this.b.a()&&this.f()},m:function(){if(this.b.f()||this.b.a()||this.b.d())return!0;try{var n=Common.a.a.b("FlightId"),i=n?n.toString().toLowerCase():"";return i.indexOf("firstrunexperienceui")!==-1}catch(t){Diag.a.a(0,306,10,"Error checking setting {0}",t?t.toString():null)}return!1},e:function(n,t){var r={},i={};i.FREDisplayedDate=(new Date).toUTCString();i.VersionDisplayed=n;i.RemindMeLater=t;r[this.b.c()]=JSON.stringify(i);Diag.a.a(51675533,306,50,"Initiating call to save FRE data for current user from Roaming Settings Service");this.d.l(r)},l:function(n,t){var i=n?n.i-n.h:-1;if(this.b.d()||this.b.a()){if(i>this.b.b()){Diag.a.a(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",i,this.b.b());return}if(!t){Diag.a.a(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed.");this.f();return}if(this.p(t)){Diag.a.a(51675536,306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",this.b.g());this.f();return}Diag.a.a(51675537,306,100,"Current user has already seen this version of the FRE. No further action required.");return}t&&"FREDisplayedDate"in t?Diag.a.a(51675540,306,100,"UI experience is not enabled and FRE data has already been saved for the current user. No further action required."):(Diag.a.a(51675538,306,50,"UI experience is not enabled. No FRE data found for current user. Registering FRE data."),this.e(this.b.k(),!1),i>this.b.b()&&Diag.a.a(51675539,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. FRE data has been registered regardless.",i,this.b.b()))},k:function(n){Diag.a.a(51675541,306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",n?n.c:-1)},o:function(n){Diag.a.a(51675542,306,10,"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",n?n.c:-1)},f:function(){(this.b.d()||this.b.a())&&this.q()},q:function(){var t=Common.Utils.a.a().d(Common.bG,null),n;return t?(n=this.b.j(),n&&Common.a.I(n),Diag.a.a(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",n),t.a("ShowFirstRunExperienceUIV2",null),window.addEventListener?(this.c=this.i,window.addEventListener("FGWebSurfaceEvent",this.c,!0)):(Diag.a.a(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),this.e(this.b.e(),!1)),!0):(Diag.a.a(51675543,306,50,"Error resolving ISystemInitiatedFeedback"),!1)},n:function(n){var t=n?n.detail:null,i;t&&t.id===this.b.i()&&(i=t.success,i&&(Diag.a.a(51675546,306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.e(this.b.e(),!1)),window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",this.c,!0))},p:function(n){if("RemindMeLater"in n&&"FREDisplayedDate"in n&&n.RemindMeLater.toString()==="true"){var t=new Date(n.FREDisplayedDate.toString()),i=new Date,r=(i-t)/36e5;if(r>this.b.g())return!0}return!1}};Common.App.FirstRunExperienceLauncher.c=function(){};Common.App.FirstRunExperienceLauncher.c.a=function(){Common.App.a.a().a(new Common.App.FirstRunExperienceLauncher.c,0,!1)};Common.App.FirstRunExperienceLauncher.c.prototype={d:null,a:function(){return"Common.App.FirstRunExperienceLauncher"},c:function(n){this.d=n;var t=this;this.d.b(Common.App.FirstRunExperienceLauncher.a,null).a().b(function(){return new Common.App.FirstRunExperienceLauncher.b})},b:function(){}};Common.App.FirstRunExperienceLauncher.d=function(n,t,i,r,u){this.h=Function.createDelegate(this,this.o);this.i=Function.createDelegate(this,this.p);this.f=Function.createDelegate(this,this.j);this.g=Function.createDelegate(this,this.n);this.a=n;this.c=t;this.b=i;this.e=r;this.d=u};Common.App.FirstRunExperienceLauncher.d.prototype={a:null,c:null,b:null,e:null,d:null,k:function(n){var t=new Sys.StringBuilder(this.a.h()),i;t.append("RoamingServiceHandler.ashx?action=");t.append("getFirstRunExperienceSettings");t.append("&");t.append(this.m(n));t.append("&");t.append(Common.a.j);i=t.toString();Common.a.d.a(i,1,null,null,!0,2,this.g,this.f,null,null,!1,null,null,null,null,!1,null,!1,null)},l:function(n){var t=new Sys.StringBuilder(this.a.h()),i,r;t.append("RoamingServiceHandler.ashx?action=");t.append("saveFirstRunExperienceSettings");t.append("&");t.append(Common.a.j);i=t.toString();r=JSON.stringify(n);Common.a.d.a(i,2,r,null,!0,4,this.i,this.h,null,null,!1,null,null,null,null,!1,null,!1,null)},n:function(n){var r=!1,u=null,t,i;try{n.b.a.length>0&&(t=$$as(Object,JSON.parse(n.b.a)),i=t?t[this.a.c()]:null,i&&(u=$$as(Object,JSON.parse(i.toString()))));r=!0}catch(f){this.j(null)}r&&this.c&&this.c(n.b,u)},j:function(n){this.b&&this.b(n?n.b:null)},p:function(n){this.e&&this.e(n?n.b:null)},o:function(n){this.d&&this.d(n?n.b:null)},m:function(n){for(var i=new Sys.StringBuilder("requestedsettings="),t=0;t<n.e.length;t++)i.append(n.a(t)),t<n.e.length-1&&i.append(";");return i.toString()}};Common.App.FirstRunExperienceLauncher.c.a();Type.registerNamespace("_Ewa");_Ewa.Hp=function(n){this.l=n};_Ewa.Hp.prototype={l:null,c:function(){return"Excel"},i:function(){return"e07bf965-183b-43d5-bc09-9e97ba3ddb73"},k:function(){return 1},e:function(){return 0},f:function(){return this.m()&&this.l.a(468)},d:function(){return this.m()&&this.l.a(470)},a:function(){return this.l.a(469)},j:function(){return null},g:function(){return 24},b:function(){return 4e3},h:function(){return this.l.e().WebServiceBase||""},m:function(){var t,n;return this.l.isChangeGateEnabled("OfficeVSO:4435829_DisabledFirstRunExperienceForAnonyomusUsers")&&(t=Common.a.a?Common.a.a.a("IsAnonymousUser"):!0,t)?!1:(n=Common.a.e?$$as(String,Common.a.e.AudienceGroup):"",n!=="Unknown"&&n!=="Automation")}};_Ewa.FirstRunExperienceManager=function(n,t){this.a=n;this.b=t};_Ewa.FirstRunExperienceManager.prototype={a:null,b:null,c:function(){this.a&&this.a.a(this.b)}};_Ewa.vo=function(n){_Ewa.vo.initializeBase(this);this.a=n;this.e()};_Ewa.vo.a=function(n){n.b().b(_Ewa.wC.$$(_Ewa.ls),312,new _Ewa.vo(n))};_Ewa.vo.prototype={a:null,p:function(){this.d(this.a.b().a(_Ewa.ls,311,!1,null)||this.f())},f:function(){var t=new _Ewa.Hp(this.a),n=new _Ewa.FirstRunExperienceManager(Common.Utils.a.a().a(Common.App.FirstRunExperienceLauncher.a,null),t);return n.c(),n}};_Ewa.FirstRunExperienceManager.registerClass("_Ewa.FirstRunExperienceManager",null,_Ewa.ls);_Ewa.vo.registerClass("_Ewa.vo",_Ewa.qV.$$(_Ewa.ls));Type.registerNamespace("_Ewa");_Ewa.bbY=function(){};_Ewa.bbY.a=function(){_Ewa.k.a(function(){_Ewa.k.a(_Ewa.vo.a)})};_Ewa.bbY.a();Type.registerNamespace("_Ewa");_Ewa.wn=function(n){_Ewa.wn.initializeBase(this);this.f=n;this.e()};_Ewa.wn.a=function(n){n.b().b(_Ewa.wC.$$(Common.cr),362,new _Ewa.wn(n))};_Ewa.wn.prototype={f:null,a:null,p:function(){this.d(this.f.b().a(Common.cr,361,!1,null)||this.i())},i:function(){if(this.a=Common.Utils.a.a().d(Common.cr,null),_Ewa.B.a().c()){var n=this;Common.App.AppLifecycleManager.get_instance().a(16,function(){n.g()},3)}else this.g();return this.a},g:function(){if(this.f.a(863)){var n=this;Common.Utils.a.a().c(Common.App.ApplicationFeatureHelper.a,null).a(function(t){t.a("MsoPremiumBadge",!0).then(function(i){return!i&&t.c()&&n.a.a(),null})})}else Common.a.dX()===1&&this.a.a()}};_Ewa.wn.registerClass("_Ewa.wn",_Ewa.qV.$$(Common.cr));Type.registerNamespace("_Ewa");_Ewa.beq=function(){};_Ewa.beq.a=function(){_Ewa.k.a(function(){_Ewa.k.a(_Ewa.wn.a)})};_Ewa.beq.a();Type.registerNamespace("_Ewa");_Ewa.MZ=function(n,t){this.sheetName=n;this.dataUri=t};_Ewa.MZ.prototype={sheetName:null,dataUri:null};_Ewa.wr=function(n,t,i,r,u,f,e){_Ewa.wr.initializeBase(this,[n,t,i,r,u,!1]);this.r=!1;this.h=e;this.g=_Ewa.wr.a(f);var o=this.D(this.g.name,this.g.size);if(o){this.T(o);this.h.SX(Error.create("DataUrlUploaderWrapper: Invlid data url"));this.dispose();return}this.b=new _Ewa.ny(this.a.q(),this.o,this.p,r,!1,this.a)};_Ewa.wr.a=function(n){var i=n.split(","),r,e,u,t,o,f;for(r=i[0].indexOf("base64")>=0?window.self.atob(i[1]):window.self.decodeURI(i[1]),e=i[0].split(":")[1].split(";")[0],u=new Uint8Array(r.length),t=0;t<r.length;t++)u[t]=r.charCodeAt(t);return o=new Blob([u],{type:e}),f=o,f.name="Image.png",f};_Ewa.wr.prototype={h:null,g:null,C:function(n,t,i){_Ewa.nx.prototype.C.call(this,n,t,i);this.h.SX(Error.create("DataUrlUploaderWrapper.TriggerFailedCallback: File upload request failed"))},w:function(n,t,i){_Ewa.nx.prototype.w.call(this,n,t,i);_Ewa.h.d(n.Errors)?this.h.SX(Error.create(String.format("DataUrlUploaderWrapper.TriggerSuccessCallback: File upload request returned with errors: {0}",_Ewa.h.a(n.Errors,",")))):this.h.b(!0)},U:function(n){var t=new Common.App.InsertFile.b(this.g.name,this.g);n.bc(t)}};_Ewa.Jv=function(n,t,i){this.bp=Function.createDelegate(this,this.cu);_Ewa.Jv.initializeBase(this,[n,!1]);this.bw=t;this.Y=n;this.d=Common.o.a();this.bv=i;Common.App.InsertFile.a.prototype.bY.call(this);this.ct()};_Ewa.Jv.prototype={bw:null,Y:null,R:null,bq:!1,d:null,bv:null,bu:function(n,t){return new _Ewa.ny(n,t.o,t.p,this.bv,!0,this.bw)},dispose:function(){this.ca();this.Y=null;this.d=null;Common.App.InsertFile.a.prototype.dispose.call(this)},bo:function(){var i=this.Y.V(this.a),n=this.Y.D(this.a.a.value,i),t;return n?(t=this.Y.z(n).Description,this.R.innerHTML=t,this.cv(),!1):!0},bW:function(){return!0},ct:function(){this.R=document.getElementById("errorText");this.R.style.display="inline-block";this.bq=!1;this.R.innerHTML="";this.V().style.maxWidth=this.V().currentStyle.minWidth},cv:function(){this.d.a("click",this.a.a,this.bp);this.d.a("keydown",this.a.a,this.bp);this.bq=!0},ca:function(){this.bq&&(this.d.b("click",this.a.a,this.bp),this.d.b("keydown",this.a.a,this.bp),this.bq=!1)},cu:function(){return this.R.innerHTML="",this.ca(),!1}};_Ewa.Jw=function(n){this.a=n};_Ewa.Jw.prototype={a:null,x:function(n,t,i){if(i&&"dataUrl"in i){var r=new($$sc.D.$$(Boolean));return new _Ewa.wr(this.a,null,Common.Q.a(),Common.a.a,i,i.dataUrl,r),r.a}return new _Ewa.nx(this.a,t,Common.Q.a(),Common.a.a,i,!0),$$sc.a.a(Boolean,!0)},w:function(n,t){return t.a===1403967063&&this.a.k()},y:function(){return!1},z:function(n,t){return this.a.a(260)&&t===1403967063&&_Ewa.K.a(this.a).m()}};_Ewa.ws=function(n){_Ewa.ws.initializeBase(this,[n])};_Ewa.ws.a=function(n){_Ewa.Z.a(90,new _Ewa.ws(n))};_Ewa.ws.prototype={g:function(){this.f([new _Ewa.Jw(this.a)],null)}};_Ewa.nx=function(n,t,i,r,u,f){this.R=Function.createDelegate(this,this.bg);_Ewa.nx.initializeBase(this,[null,i,r]);this.a=n;this.u=t;this.n=n.p().b("WebServiceCall","InsertPictureOperation");this.i=_Ewa.x.a().a(this.R,1e5,_Ewa.m.bL,!1,!1);this.j=!1;this.m=this.a.e().InsertPictureMaxFileSizeBytes;u&&(this.A="TestOnly"in u);f&&this.bi()};_Ewa.nx.c=function(n){if(n&&n.length&&!_Ewa.e.b(n,"UnknownError",!0)){if(_Ewa.e.b(n,"NoFileSelectedError",!0))return 1;if(_Ewa.e.b(n,"FileTooBig",!0))return 3;if(_Ewa.e.b(n,"MaxConnectionsReached",!0))return 5}else return 2;return 0};_Ewa.nx.b=function(n,t,i,r){return _Ewa.h.b(1,0,0,n,t,i,r)};_Ewa.nx.a=function(n){switch(n){case 1:return 1;case 2:return 6}return 0};_Ewa.nx.prototype={n:null,u:null,B:null,y:null,i:null,j:!1,m:0,A:!1,v:null,a:null,bd:function(){return this.m/1048576},M:function(n){var t,u,i,r;this.n.a();this.i.a();t=n;u=!_Ewa.ny.a(t);u?(i=_Ewa.nx.c(t),i?(Diag.a.a(34193863,0,50,"Server returned error, response: {0}",t),this.S(i)):this.be(t)):(this.j?this.S(4):(r=new Common.fL(0,2,null,null,!1,null,null,null),r.b=8,this.C(new Common.eF(r),null,"InsertPictureWebMethod")),Diag.a.a(33863624,0,50,"Http Error occurred, isTimeoutError: {0}",this.j));Common.App.InsertPicture.a.prototype.s.call(this);this.dispose()},dispose:function(){System.a.a(this.i);this.b&&this.b.I();this.a=null;this.i=null;this.b=null},f:function(n,t){Common.App.InsertPicture.a.prototype.f.call(this,n,t);var i=this,u=function(t,r){return i.B=t,i.y=r,i.n.d(),i.i.b(-1),i.j=!1,i.U(n),i.bh(n)},r=this,f=function(n){var i={};r.a.C(i);var u=i.SheetName,f=function(){return new _Ewa.MZ(u,r.v?r.v:"")},t=new _Ewa.bh(510,0,n,8,f);return t.F=function(){return!0},t.x=r.u,t};_Ewa.M.a(this.a.g(),u,f,this.u)},bh:function(n){if(!this.a.bz())return $$sc.a.a(Boolean,!0);var i=new($$sc.D.$$(Boolean)),t=new FileReader,u=n.a.files[0],f=this,e=function(){f.v=t.result;i.c(!0)},o=this,r=function(){i.c(!0)};return t.onload=e,t.onerror=r,t.onabort=r,t.readAsDataURL(u),i.a},V:function(n){var i=-1,t=n.a;return t&&t.files&&t.files.length>0&&(i=t.files[0].size),i},D:function(n,t){var i=_Ewa.nx.a(Common.App.InsertPicture.a.b(n));return i?i===6&&this.bf(n):t!==-1&&(Diag.a.a(34193864,0,50,"Validating picture, pictureSize: {0}, maxAllowedSize: {1}, remainingWorkbookSize: {2}",t,this.m,this.a.c().bI()),t>this.m?i=3:t>this.a.c().bI()&&(i=7)),Diag.a.a(34193865,0,50,"Validated file on client, validation result: {0}",i),i},N:function(){return 0},Q:function(){return!0},P:function(){return!0},O:function(){return!0},L:function(){},t:function(n,t){var r=this.V(t),i=this.D(n,r);return i?(this.e||i===1||this.T(i),!1):!0},U:function(n){n.bb()},z:function(n){var u=0,t=1,i=-1100324317,r="InsertPictureUnknownError",f=null,e;switch(n){case 1:u=1502;t=0;i=940870981;r="InsertPictureNoFileSelected";break;case 3:t=0;i=1250467391;r="InsertPicturePictureTooBig";f=String.format(_Ewa.ClientStringManager.a().c(114),this.bd().toLocaleString());break;case 6:u=1506;t=0;i=1380041209;r="InsertPictureUnsupportedFormat";break;case 7:u=1503;t=0;i=-903115058;r="InsertPictureExceedWorkbookSize";break;case 4:u=1504;t=0;i=1218352119;r="InsertPictureUploadTimeout";break;case 5:u=1505;t=0;i=1979899005;r="InsertPictureServiceNonDeterministicError"}return e=_Ewa.nx.b(u,t,i,r),f&&(e.Description=f),e},bi:function(){if(Diag.a.a(34193866,0,50,"Showing Insert Picture dialog"),!this.A&&(Common.c.g()||Common.c.l()&&Common.c.bd()<72))this.e=!1,this.b=new _Ewa.ny(this.a.q(),this.o,this.p,this.d,!1,this.a);else{this.e=!0;var n=new _Ewa.Jv(this,this.a,this.d);this.b=n.a}},be:function(n){var t={},r,i;try{t=_Ewa.H.b(n);_Ewa.A.a().c(this.n.c(),t.ServerCorrelationId,_Ewa.bc.toString(0),"ServerActions",!0);!_Ewa.h.d(t.Errors)&&t.Result&&(this.a.c().P(t.StateId,"PictureUploaderWrapper.UploadResponseReceived"),r=t.Result,_Ewa.K.a(this.a).d(1,r,!1),i=this.a.b().a(_Ewa.jp,277,!1,null),i&&i.b(this.a,1,t.Result,t,"InsertPicture"),Diag.a.a(34193867,0,50,"Insert picture completed successfully :)"))}catch(u){Diag.a.a(25801035,0,50,"PictureUploaderWrapper.HandleSuccessCallback: got exception while try to JSON.Parse string length: {0}, errror: {1}",n?n.length:-1,u)}this.w(t,null,"InsertPictureWebMethod")},S:function(n){var i=this.z(n),t={};t.Errors=[i];this.w(t,null,"InsertPictureWebMethod")},w:function(n,t,i){this.B(n,t,i)},C:function(n,t,i){this.y(n,t,i)},T:function(n){var t=this.z(n),i=new _Ewa.dc(this.a,t);i.x(!1)},bg:function(){this.j=!0},bf:function(n){for(var i=this.a.e().InsertPicturUnsupportedExtensionsForLogging,r=n.toLowerCase(),t=0;t<i.length;++t)if(r.endsWith(i[t])){Diag.a.a(34193868,0,50,"Insert picture blocked invalid extension: {0}",i[t]);return}}};_Ewa.ny=function(n,t,i,r,u,f){_Ewa.ny.initializeBase(this,[n,t,i,r,u,"UploadFrame",f.c().j(),"image/*",!1,null]);this.h=f;this.m=!0;Common.App.InsertFile.d.prototype.J.call(this)};_Ewa.ny.a=function(n){return!n||!n.length||_Ewa.e.b(n,"ServerUploadError",!1)};_Ewa.ny.prototype={h:null,C:function(n){return n},Q:function(n){Diag.a.b(33863626,0,!!this.t,"SessionId shouldn't be null.");_Ewa.X.f(n,this.h.e());n.b("sessionId",this.t);var i=_Ewa.b.a(this.h).a(),t=_Ewa.g.c(i.a().g(),this.h);n.b("sheetName",this.h.f().a().a);n.b("row",t.FirstRow.toString());n.b("col",t.FirstColumn.toString())},A:function(){},P:function(){this.s("ServerUploadError")},g:function(n){this.s(n)}};_Ewa.MZ.registerClass("_Ewa.MZ");_Ewa.nx.registerClass("_Ewa.nx",Common.App.InsertPicture.a,Sys.IDisposable);_Ewa.wr.registerClass("_Ewa.wr",_Ewa.nx);_Ewa.Jv.registerClass("_Ewa.Jv",Common.App.InsertPicture.c);_Ewa.Jw.registerClass("_Ewa.Jw",null,_Ewa.kh);_Ewa.ws.registerClass("_Ewa.ws",_Ewa.Z);_Ewa.ny.registerClass("_Ewa.ny",Common.App.InsertFile.d);Type.registerNamespace("_Ewa");_Ewa.bes=function(){};_Ewa.bes.a=function(){_Ewa.k.a(function(n){_Ewa.ws.a(n)})};_Ewa.bes.a();Type.registerNamespace("_Ewa");_Ewa.PD=function(n,t){var i,r;this.a=new($$sc.v.$$(_Ewa.xJ));this.b=n;this.c=t;i=this;this.e=function(n){return Promise.resolve(n)};r=this;this.d=function(n){return Promise.reject(n)}};_Ewa.PD.prototype={a:null,b:null,e:null,d:null,c:null,j:function(n){var t,i;return this.k(n.a)?(Diag.a.a(37364047,5,50,"PasteArtRequestManager.HandleRequest: Enqueued paste request as a result of rapid paste on same destination: {0}",n.a),t=this.a.a(n.a),this.a.b(n.a,n),i=t.g,t.f=!1,this.h(n,i)):(this.a.b(n.a,n),this.l(n))},k:function(n){return this.a.c(n)},l:function(n){var t=this;return new Promise(function(i,r){n.g=t.b.a(n).then(function(r){return i(null),t.f(n,r)},function(n){return r(null),t.d(n)})})},h:function(n,t){var i=this;return new Promise(function(r,u){n.g=t.then(function(t){return i.n(n,t),i.b.a(n).then(function(t){return r(null),i.f(n,t)},function(n){return u(null),i.d(n)})},function(n){return i.d(n)})})},f:function(n,t){return n.f&&(this.g(n.a),this.m(n,t)),this.e(t)},g:function(n){this.a.d(n)},m:function(n,t){var i=this.i();n.a===i&&this.b.c(n.c,t,n.b.b)},i:function(){var n=_Ewa.b.a(this.c).a().b().e(),t;return n||(t=_Ewa.g.a(_Ewa.b.a(this.c).a().a().a(),this.c),n=t.FirstRow+"_"+t.FirstColumn),n},n:function(n,t){n.c=null;n.e=t}};_Ewa.MX=function(n,t,i){this.sourceRange=n;this.destinationRange=t;this.pasteFlags=i};_Ewa.MX.prototype={sourceRange:null,destinationRange:null,pasteFlags:0};_Ewa.MY=function(n,t){this.destinationRange=n;this.content=t};_Ewa.MY.prototype={destinationRange:null,content:null};_Ewa.Nh=function(n){this.parameters=n};_Ewa.Nh.prototype={parameters:null};_Ewa.cD=function(){};_Ewa.cD.b=function(n){if(n.clipboardItems){var t=n.clipboardItems.getItem("metadata/is-last-copy-was-external");if(!(!t||!t.length)&&t==="1")return!0}return!1};_Ewa.cD.d=function(n){return _Ewa.cD.b(n)&&!isNullOrUndefined(n.clipboardItems)&&!!n.clipboardItems.getItem("image/png")&&_Ewa.e.a(n.clipboardItems.getItem("text/plain"))};_Ewa.cD.c=function(n){if(n.clipboardItems){var t=n.clipboardItems.getItem("metadata/is-last-copy-was-external-XLO-source");if(!(!t||!t.length)&&t==="1")return!0}return!1};_Ewa.cD.e=function(n){return n.clipboardItems?n.clipboardItems.getItem("metadata/chrome-extension-id"):null};_Ewa.cD.a=function(n){if(n){var t=n.getCachedMetadata();if(t&&t.lastCopy)return t.lastCopy}return null};_Ewa.gf=function(){};_Ewa.gf.prototype={range:0,art:1};_Ewa.gf.registerEnum("_Ewa.gf",!1);_Ewa.ZL=function(){};_Ewa.oS=function(){};_Ewa.oS.b=function(n){return CommonUI.b.a(_Ewa.oS.a,_Ewa.ClientStringManager.a().a(16),_Ewa.ClientStringManager.a().a(n?18:17),_Ewa.ClientStringManager.a().a(19))};_Ewa.DZ=function(n,t,i,r){_Ewa.DZ.initializeBase(this,[n,t,i,"AcrossSessionRangeCopyPasteHandler",r]);this.h=new _Ewa.tn(n)};_Ewa.DZ.prototype={h:null,serialize:function(n){var r=n.sourceItem,t={},i=this.g.d(r),u,e,f;if(i)t.synchronousResult=i,n.isFromCache=!0,n.clientSideCopyTime=n.commandParameters.stopwatch.b();else{if(u=null,e=_Ewa.g.A(r.a),!_Ewa.o.B(this.c)&&this.w(e)){Diag.a.a(26035413,0,50,"AcrossSessionRangeCopyPasteHandler.Serialize: All data is loaded prepare the data in the client side.");f=this.i.a(e);try{u=f.toString();i=this.f.a();i.setItem("text/plain",u);this.g.e(r,i);t.synchronousResult=i;n.clientSideCopyTime=n.commandParameters.stopwatch.b()}finally{f&&f.dispose()}}else n.isAsyncCopy=!0,t.synchronousResult=this.f.a(),t.synchronousResult.setItem("text/plain",this.p());t.asynchronousResult=this.m(n,r,u)}return n.syncClipboardItemsKeys=_Ewa.hL.a(t.synchronousResult),t},shouldWaitForCopyToComplete:function(n){return!n||!n.copyContextSnapshot?(Diag.a.a(39084501,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: pasteContext or pasteContext.CopyContextSnapshot is not define, return false."),!1):(Diag.a.b(41562511,0,!!this.c.e(),"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: this.EwaControl.BootstrapContext shouldn't be null"),n.copyContextSnapshot.sessionId===this.c.e().UserSessionId)?(Diag.a.a(41562513,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: Same session copy scenario, return false."),!1):(Diag.a.a(41562514,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: returning true"),!0)},onDeferredPasteStarted:function(n){this.h.d(n)},onDeferredPasteCompleted:function(n){this.h.c(n)},deserialize:function(n){var f,i,r,u,t,e,o;if(n.isClipboardDataContainShadowWorkbook=!isNullOrUndefined(n.clipboardItems.getItem("data/shadow-workbook")),this.c.isChangeGateEnabled("OfficeVSO:3782723_EnablePastingImageFromExternalOnFloatingObject")&&(f=!!(_Ewa.b.a(this.c).a().c()&326),f))return _Ewa.cD.b(n)&&(n.isExternalPaste=!0),Promise.reject(new _Ewa.cy(17,null,null,""));if(i=n.copyContextSnapshot,r=this.e.a(i),_Ewa.cD.b(n))return this.l(n);if(u=n.commandParameters.originalDestinations,r&&n.isSameSession)return this.A(n,i,r,u);if(n.commandParameters.commandType!==516){if(t=null,o=this.v(n.clipboardItems,e={val:t}),t=e.val,o)return n.isShadowWorkbookParsedSuccessfully=!0,this.t(n,_Ewa.g.a(_Ewa.g.g(u),this.c),t);if(n.isClipboardInaccessible)return Promise.reject(new _Ewa.cy(8,null,null,""));if(n.commandParameters.commandType!==36)return this.q(n)}return Promise.reject(new _Ewa.cy(6,null,null,""))},beforePaste:function(n){this.c.b().a(_Ewa.oT,373,!1,null).c(n);n.indicationDisplayed=!0},u:function(n,t){if(!n||!n.SourceRanges||!n.SourceRanges.Ranges||!n.SourceRanges.Ranges.length)return t.val=null,!1;var i=n.SourceRanges.Ranges[0];return(t.val=null,_Ewa.e.a(n.ShadowWorkbookBase64)&&!n.ShadowWorkbookSizeExceedsLimit)?!1:(t.val=this.r(n),t.val.rangeRowStart=i.FirstRow,t.val.rangeRowEnd=i.LastRow,t.val.rangeColumnStart=i.FirstColumn,t.val.rangeColumnEnd=i.LastColumn,t.val.sourceClientPath=n.SourceClientPath,t.val.sourceSheetName=n.SourceSheetName,t.val.sourceWorkbookName=n.SourceWorkbookName,!0)},v:function(n,t){t.val=null;var i=n.getItem("data/shadow-workbook");return!i||!i.length?!1:(t.val=JSON.parse(i),this.s(t.val))},s:function(n){return!!n&&(!_Ewa.e.a(n.shadowWorkbookBase64)||n.shadowWorkbookSizeExceedsLimit)&&!isUndefined(n.rangeRowStart)&&!isUndefined(n.rangeRowEnd)&&!isUndefined(n.rangeColumnStart)&&!isUndefined(n.rangeColumnEnd)},t:function(n,t,i){return Diag.a.b(33863617,0,!!i,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadowWorkbookPayload shouldn't be null"),Common.a.q("Microsoft.Office.Excel.Server.Flighting.IDenyListNewCopyPasteExperienceAcrossSessions"),n.pasteResult="CrossSessionPaste",n.payloadOrigin="CrossSession",n.payloadType="ShadowWorkbook",n.shadowWorkbookPayloadSize=_Ewa.gs.b(i),n.shadowWorkbookSizeExceedsLimit=_Ewa.gs.a(i),n.shadowWorkbookSizeExceedsLimit?(Diag.a.a(34415003,0,15,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadow workbook length({0}) is over the limit({1}). reject the paste request. ShadowWorkbookSizeExceedsLimit: {2}",n.shadowWorkbookPayloadSize,4194304,i.shadowWorkbookSizeExceedsLimit),Promise.reject(new _Ewa.cy(1,null,null,""))):(Diag.a.a(33863619,0,50,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: trigger Paste request..."),this.e.j(n.commandParameters.ribbonCommandInfo,t,i,[n.commandParameters.stopwatch],n))},m:function(n,t,i){Diag.a.b(41805027,0,!!n,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: copyContext shouldn't be null");var u=n.commandParameters.stopwatch.b(),r=this;return new Promise(function(f,e){var s=function(o){var h,c,s,l,v,y,p,a;if(n.requestTelemetryData=o.RequestTelemetryData,n.serverRequestTimeInMs=n.commandParameters.stopwatch.b()-u,_Ewa.h.d(o.Errors))_Ewa.h.h(o.Errors)?(n.encounteredDeploymentErrors=!0,Diag.a.a(36538326,0,15,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}. copy Id: {1}",_Ewa.h.a(o.Errors,","),n.id)):(Diag.a.a(26035419,0,10,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}. copy Id: {1}",_Ewa.h.a(o.Errors,","),n.id),e(new _Ewa.jX(2,o.Errors)));else{if(Diag.a.a(26035418,0,50,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeed for copy Id: {0}",n.id),n.markForCancellation){e(new _Ewa.jX(3,o.Errors));return}h=o.Result;c=h.PlainTextResult;isNullOrUndefined(i)||(c=i);isNullOrUndefined(c)||(n.plainTextPayloadSize=c.length);s=r.f.a();(y=r.u(h,v={val:l}),l=v.val,y)&&(n.shadowWorkbookPayloadSize=_Ewa.gs.b(l),n.shadowWorkbookSizeExceedsLimit=_Ewa.gs.a(l),p=JSON.stringify(l),s.setItem("data/shadow-workbook",p));s.setItem("text/plain",c);_Ewa.o.B(r.c)&&(a=h.HtmlResult,n.htmlSizeExceedsLimit=h.HtmlSizeExceedsLimit,isNullOrUndefined(a)||(n.htmlPayloadSize=a.length),s.setItem("text/html",a));n.copyTotalSizeExceedsLimit=h.CopyTotalSizeExceedsLimit;s.setItem("copyId",n.commandParameters.id);r.g.e(t,s);n.asyncClipboardItemsKeys=_Ewa.hL.a(s);f(s)}},h=function(t){n.serverRequestTimeInMs=n.commandParameters.stopwatch.b()-u;var i=_Ewa.X.a(t.b);Diag.a.a(26035420,0,10,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}. copy Id: {1}",_Ewa.h.a(i,","),n.id);e(new _Ewa.jX(2,i))},o;Diag.a.a(26035421,0,50,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data for copy Id: {0}",n.id);o=_Ewa.g.n(t.b,null,t.a);r.e.g(o,n.commandParameters,s,h,[n.commandParameters.stopwatch])})}};_Ewa.tj=function(n,t,i,r,u){_Ewa.tj.initializeBase(this,[n,"ArtCopyPasteHandler"]);this.d=n;this.k=new _Ewa.tn(n);this.h=t;this.j=i;this.f=_Ewa.b.a(n).a();this.i=u||new _Ewa.tl(this.h);this.m=new _Ewa.PD(i,n);this.g=r};_Ewa.tj.a=function(n){return n.b===1||n.b===5};_Ewa.tj.prototype={f:null,d:null,j:null,h:null,i:null,m:null,g:null,k:null,getSourceItem:function(){return Diag.a.b(36227297,0,!!this.f.b().e(),"Expecting a floating object to be currently selected for copy"),Diag.a.a(39682266,0,50,"ArtCopyPasteHandler.GetSourceItem: Creating ArtSourceItem with FloatingObjectId=[{0}]",this.f.b().e()),new _Ewa.hy(this.f.b().e(),this.d.c().q().c(),this.d.c().d(),this.d.e().UserSessionId,this.f.b().a().a().a)},beforeSerialize:function(n){if(!n||!n.commandParameters){Diag.a.a(36227298,0,10,"ArtCopyPasteHandler.BeforeSerialize: copyContext or copyContext.CommandParameters is null.");return}_Ewa.Eb.a(n);n.commandParameters.copyPasteTargetType=2},serialize:function(n){var r=n.sourceItem,t={},i;return r?this.v()?(Diag.a.a(39682267,0,50,"ArtCopyPasteHandler.Serialize: Serializing ArtSourceItem with FloatingObjectId=[{0}]",r.a),this.x(),i=this.i.d(r),i?(t.synchronousResult=i,n.isFromCache=!0,n.isAsyncCopy=!1,n.clientSideCopyTime=n.commandParameters.stopwatch.b(),n.commandParameters.commandType===1&&this.d.B(2045211913,n.commandParameters.ribbonCommandInfo.c,n.commandParameters.ribbonCommandInfo.b,null)):(n.isFromCache=!1,n.isAsyncCopy=!0,i=this.h.a(),t.synchronousResult=this.s(i),t.asynchronousResult=this.u(n,r,i)),n.syncClipboardItemsKeys=_Ewa.hL.a(t.synchronousResult),t):(Diag.a.a(36824456,0,50,"ArtCopyPasteHandler.Serialize: Unsupported floating object type. This will clear the clipboard"),t):(Diag.a.a(36227299,0,10,"ArtCopyPasteHandler.Serialize: artSourceItem should not be null"),t)},s:function(n){var t,i;return Diag.a.b(39977874,0,!!this.f.b().a(),"Expecting a floating object to be currently selected for copy"),n||(n=this.h.a()),t=this.f.b().a().cf(),!t||!t.length||(i=String.format("<img src='{0}'>",t),n.setItem("text/html",i)),n},x:function(){var n=this.f.b().a();this.g.b(_Ewa.O.f(n.a(),null),_Ewa.O.x(n.K()))},shouldWaitForCopyToComplete:function(){return Diag.a.a(41562515,0,50,"ArtCopyPasteHandler.ShouldWaitForCopyToComplete: returning true"),!0},onDeferredPasteStarted:function(n){this.k.d(n)},onDeferredPasteCompleted:function(n){this.k.c(n)},deserialize:function(n){var r,i,u,f,t,c,e,o,s,h;if(_Ewa.cD.b(n))return this.l(n);if(r=n.copyContextSnapshot,i=r.sourceItem,!i)return Promise.reject(new _Ewa.cy(10,null,null,""));if(u=i.c(this.d),!u&&!_Ewa.tj.a(i))return f=String.format("User attempted to paste art of type [{0}] between sessions.",i.b),Diag.a.a(36229120,0,50,f),Promise.reject(new _Ewa.cy(11,null,null,f));if(r.isAsyncSerializeFailed)return Promise.reject(new _Ewa.cy(16,null,null,"Last async serialize failed, therefore no current shadow workbook payload to paste"));try{c=n.clipboardItems.getItem("data/shadow-workbook");t=JSON.parse(c)}catch(l){return Diag.a.a(38102659,0,10,"ArtCopyPasteHandler.Deserialize: Failed to parse shadow workbook JSON with exception: {0}",copyPasteInfra.getStringifiedError(l)),Promise.reject(new _Ewa.cy(12,null,l,""))}if(t.floatingObjectId!==i.a?Diag.a.a(40134681,0,10,"ArtCopyPasteHandler.Deserialize: FloatingObjectId mismatch! Deserializing with artSourceItem.ActiveFloatingObjectControlId=[{0}], shadowWorkbookPayload.FloatingObjectId=[{1}]",i.a,t.floatingObjectId):Diag.a.a(39682268,0,50,"ArtCopyPasteHandler.Deserialize: Deserializing with artSourceItem.ActiveFloatingObjectControlId=[{0}], shadowWorkbookPayload.FloatingObjectId=[{1}]",i.a,t.floatingObjectId),!t||_Ewa.e.a(t.shadowWorkbookBase64))return Promise.reject(new _Ewa.cy(13,null,null,String.format("shadowWorkbookPayload is null = {0}",!t)));if(n.isShadowWorkbookParsedSuccessfully=!0,n.shadowWorkbookPayloadSize=_Ewa.gs.b(t),n.shadowWorkbookSizeExceedsLimit=_Ewa.gs.a(t),n.payloadOrigin=u?"SameSession":"CrossSession",n.payloadType="GVML",_Ewa.gs.a(t))return e=String.format("Shadow workbook size [{0}] is over the limit [{1}]. ShadowWorkbookSizeExceedsLimit: {2}",n.shadowWorkbookPayloadSize,4194304,t.shadowWorkbookSizeExceedsLimit),Diag.a.a(36304156,0,15,"ArtCopyPasteHandler.Deserialize: {0}",e),Promise.reject(new _Ewa.cy(1,null,null,e));if(o=null,s=null,_Ewa.b.a(this.d).a().c()&326?s=_Ewa.b.a(this.d).a().b().e():o=this.d.j()&&this.d.j().p()?_Ewa.g.a(this.d.j().p(),this.d):_Ewa.g.a(_Ewa.g.g(n.commandParameters.originalDestinations),this.d),h=null,this.g.c(i))try{h=this.g.a()}catch(a){Diag.a.a(37857494,0,10,"ArtCopyPasteHandler.Deserialize: Exception encountered while performing client-side estimation. Exception: {0}",copyPasteInfra.getStringifiedError(a))}return this.m.j(new _Ewa.xJ(n.commandParameters.ribbonCommandInfo,o,s,n.commandParameters.commandType,[n.commandParameters.stopwatch],t,i,n,h))},l:function(n){var t,i,r;return(n.isExternalPaste=!0,n.clipboardItems.getItem("image/png"))?(t=n.commandParameters.stopwatch.b(),this.c.isChangeGateEnabled("OfficeVSO:3782723_EnablePastingImageFromExternalOnFloatingObject")&&(n.payloadType="Bitmap"),i=this,r=this,$$sc.h.toPromise$t(Boolean,this.d.B(1403967063,n.commandParameters.ribbonCommandInfo.c,n.commandParameters.ribbonCommandInfo.b,{dataUrl:n.clipboardItems.getItem("image/png")})).then(function(i){return(n.serverRequestTimeInMs=n.commandParameters.stopwatch.b()-t,i)?Promise.resolve(null):Promise.reject(new _Ewa.cy(15,null,null,""))},function(){return n.serverRequestTimeInMs=n.commandParameters.stopwatch.b()-t,Promise.reject(new _Ewa.cy(15,null,null,""))})):(Diag.a.b(39965841,0,!1,"Should not paste external content that is not image via ArtCopyPasteHandler"),_Ewa.ZH.prototype.l.call(this,n))},v:function(){var n=_Ewa.b.a(this.d).a(),t;return!n.b().e()||!n.b().a()||!n.b().a().a()?!1:(t=n.b().a().a(),t.X())},u:function(n,t,i){var r=this;return new Promise(function(u,f){var e=n.commandParameters.stopwatch.b(),o=function(o){var c,s,l,h;if(n.requestTelemetryData=o.RequestTelemetryData,n.serverRequestTimeInMs=n.commandParameters.stopwatch.b()-e,_Ewa.h.d(o.Errors))_Ewa.h.h(o.Errors)?(n.encounteredDeploymentErrors=!0,Diag.a.a(36538327,0,15,"ArtCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}",_Ewa.h.a(o.Errors,","))):(Diag.a.a(36229122,0,10,"ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}",_Ewa.h.a(o.Errors,",")),f(new _Ewa.jX(4,o.Errors)));else{if(Diag.a.a(36229121,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeeded for FloatingObjectId=[{0}].",t.a),n.markForCancellation){f(new _Ewa.jX(3,o.Errors));return}if(_Ewa.h.e(o.Errors)&&Diag.a.a(39688195,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: Server messages present. Errors: {0}",_Ewa.h.a(o.Errors,",")),c=o.Result,c){s=null;s=r.r(c);s.floatingObjectId=t.a;n.shadowWorkbookPayloadSize=_Ewa.gs.b(s);n.shadowWorkbookSizeExceedsLimit=_Ewa.gs.a(s);try{l=JSON.stringify(s)}catch(a){f(new _Ewa.cy(14,null,a,String.format("Failed to stringify shadow workbook: copyContext.ShadowWorkbookPayloadSize: [{0}], shadowWorkbookPayload.FloatingObjectId: [{1}]",n.shadowWorkbookPayloadSize,s.floatingObjectId)));return}Diag.a.b(41537862,0,!!i,"Expecting syncClipboardItems to be defined");h=i;h.setItem("data/shadow-workbook",l);n.commandParameters.commandType===1&&(r.w(t.b,t.a,o.StateId),r.t(t.a,t.b));r.i.e(t,h);n.asyncClipboardItemsKeys=_Ewa.hL.a(h);u(h)}else Diag.a.a(36508684,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: Result form server returned null, copied item id: {0}",t.a),u(r.i.d(t))}},s=function(i){n.serverRequestTimeInMs=n.commandParameters.stopwatch.b()-e;var u=_Ewa.X.a(i.b);n.commandParameters.commandType===1&&r.j.d(t.b,t.a);Diag.a.a(36229123,0,10,"ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}",_Ewa.h.a(u,","));f(new _Ewa.jX(4,u))};Diag.a.a(41562516,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data...");r.j.b(new _Ewa.Fn(t.a,n.commandParameters,o,n.commandParameters.commandType,t.b,s,[n.commandParameters.stopwatch]))})},t:function(n,t){var u=t+"_"+n,i=_Ewa.K.a(this.d).b(u,null),r;i?(r=14,_Ewa.K.a(this.d).c(i,r,!0),_Ewa.b.a(this.d).a().b().p(null)):Diag.a.a(37839768,0,100,"ArtCopyPasteHandler.DeleteFloatingObject: tried to delete a non existing floating object")},w:function(n,t,i){var f=this.d.b().a(_Ewa.jp,277,!1,null);if(f){var u=null,e=n+"_"+t,r=_Ewa.K.a(this.d).b(e,null);if(r&&r.i()&&(u=r.i().a),!u)return;var o=r.a().h(),h=this,s=function(){return!u.v().d(o)};f.a(s,i,"CutArt")}}};_Ewa.mH=function(n,t){this.e=n;this.f=t};_Ewa.mH.a=function(n){return String.format("{0}.{{{1}}}",n.length+2,n.toUpperCase())};_Ewa.mH.prototype={e:null,f:null,h:function(n,t,i,r,u,f,e){var a=this.e.d().a().b(!1),h=null,c,o={},l,v,s;o.CopyPasteTargetType=2;o.FloatingObjectId=n;o.CopyOperationId=i.id;l=0;u===2?(c=505,l=16,v=this,h=function(n,t){return _Ewa.kZ.a(v.e.d().a(),o,_Ewa.n.a(n,r),f?_Ewa.n.b(t,f):t,i.ribbonCommandInfo,a,e)}):(c=179,s=this,h=function(u,h){return s.g(t,n),s.e.M(),_Ewa.kZ.c(s.e.d().a(),o,_Ewa.n.a(u,r),f?_Ewa.n.b(h,f):h,i.ribbonCommandInfo,a,e)});this.e.g().a(new _Ewa.bh(c,0,h,l,null),i.ribbonCommandInfo)},g:function(n,t){var r=n+"_"+t,i=_Ewa.K.a(this.e).b(r,null);i?(_Ewa.b.a(this.e).a().b().c(i,!0),i.p(!1)):Diag.a.a(37790621,0,50,"ArtCopyPasteUtils.DoCutClientEstimation: floatingObjectcontrol is null. FloatingObjectType : {0}, FloatingObjectId: {1}",n,t)},d:function(n,t){var r=n+"_"+t,i=_Ewa.K.a(this.e).b(r,null);i&&i.p(!0)},b:function(n){var t=n;this.h(t.e,t.b,t.a,t.f,t.c,t.d,t.g)},i:function(n,t,i,r,u,f,e,o,s){var h=this;return new Promise(function(c,l){var a=f.commandParameters.stopwatch.b(),v=function(n){if(f.requestTelemetryData=n.RequestTelemetryData,f.serverRequestTimeInMs=f.commandParameters.stopwatch.b()-a,_Ewa.h.h(n.Errors))f&&(f.encounteredDeploymentErrors=!0),Diag.a.a(36538328,0,15,"ArtCopyPasteUtils.PasteArt: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}",_Ewa.h.a(n.Errors,","));else if(_Ewa.h.d(n.Errors))Diag.a.a(36459652,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: {0}",_Ewa.h.a(n.Errors,",")),l(new _Ewa.cy(9,n.Errors,null,""));else if(n.Result){var t=n.Result;Diag.a.a(36229124,0,50,"ArtCopyPasteUtils.PasteArt: PasteArt succeeded.");h.j(e,t.FloatingObjectId,n.StateId);c(_Ewa.mH.a(t.FloatingObjectId))}else Diag.a.a(36229125,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed, result returned from server is null."),l(new _Ewa.cy(9,n.Errors,null,""))},y=function(n){f.serverRequestTimeInMs=f.commandParameters.stopwatch.b()-a;var t=_Ewa.X.a(n.b);Diag.a.a(36229126,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: {0}",_Ewa.h.a(t,","));l(new _Ewa.cy(9,t,null,""))};h.k(n,u,t,i,v,y,r,o,s)})},j:function(n,t,i){var r=this.e.b().a(_Ewa.jp,277,!1,null);if(r){var u=n+"_"+_Ewa.mH.a(t),f=this,e=function(){return!!_Ewa.K.a(f.e).b(u,null)};r.a(e,i,"PasteArt")}},l:function(n,t){!t||!t.length||this.f.d(n,n.b+"_"+t)},a:function(n){var t=n,r=this,i=this;return this.i(t.i,t.c,t.e,t.k,t.j,t.h,t.b.b,t.d,t.b.c(this.e)).then(function(n){return n},function(n){return i.l(t.b,t.d),Promise.reject(n)})},c:function(n,t,i){if(n||(n=_Ewa.g.a(_Ewa.b.a(this.e).a().a().a(),this.e)),_Ewa.b.a(this.e).bS(_Ewa.g.b(n),1))_Ewa.K.a(this.e).d(i,t,!0);else{var r=_Ewa.b.a(this.e).a().b().j(n,t,i),u=this;r.CW(function(n){var i=n.a();i?Diag.a.a(36459653,5,50,"ArtCopyPasteUtils.SelectPastedObject: Selection succeeded in async manner for object ID [{0}]",t):Diag.a.a(36459654,5,10,"ArtCopyPasteUtils.SelectPastedObject: Selection failed in async manner for object ID [{0}]",t)})}},k:function(n,t,i,r,u,f,e,o,s){var a=this.e.d().a().b(!1),h={};h.ShadowWorkbookBase64=t.shadowWorkbookBase64;h.FloatingObjectId=r;h.DestinationRanges=i?_Ewa.g.j(i):null;h.CopyPasteTargetType=2;h.ClientEstimationFloatingObjectId=o;var c=this,v=function(n,t){return o||c.e.M(),_Ewa.kZ.b(c.e.d().a(),h,_Ewa.n.a(n,u),_Ewa.n.b(t,f),null,a,e)},y=this,p=function(){if(s){var n={};return n=_Ewa.H.b(_Ewa.H.a(h)),n.FloatingObjectId=t.floatingObjectId,h.DestinationRanges||(n.DestinationRanges=_Ewa.g.x(y.e.f().a().c(),"",0,0,0,0)),new _Ewa.wM(n,s,0,0)}return new _Ewa.wM(h,s,0,0)},l=new _Ewa.bh(503,0,v,0,p);l.v=1;this.e.g().a(l,n)}};_Ewa.Ea=function(n){this.e=n};_Ewa.Ea.prototype={e:null,f:null,h:null,g:15,b:function(n,t){this.f=n;this.h=t},a:function(){var n,i,r,u,t,f;return!this.f||!this.h?(Diag.a.a(37857495,0,15,"ArtPasteClientEstimation.DoPasteClientEstimation: copiedFloatingObjectControl and/or copiedEffectsExtents is null, aborting client side estimation."),""):(n=_Ewa.O.f(new _Ewa.gu(this.f),null),n.Id=_Ewa.mH.a(Common.z.a().a),n.Version=-1,this.e.isChangeGateEnabled("OfficeVSO:4099342_FloatingObjectsNaming")&&(n.Name=""),n.IsClientEstimation=!0,i=this.i(n),!i)?null:(r=new _Ewa.gu(n),i.a.v().b(r),r.f=-1,u=_Ewa.K.a(this.e),u.k(r,i),t=u.b(n.Type+"_"+n.Id,null),f=this.e.isChangeGateEnabled("OfficeVSO:4361326_AvoidSetEffectExtentsForSVGChartsDuringPaste")&&t.a().c===3,!t||t.a().c===5||f||t.bU(this.h),u.d(n.Type,n.Id,!0),n.Id)},c:function(n){return this.e.a(274)&&n.c(this.e)&&!_Ewa.b.a(this.e).d()&&!_Ewa.b.a(this.e).h().d()},d:function(n,t){if(this.c(n)){var i=_Ewa.K.a(this.e).b(t,null);i&&(Diag.a.a(38012936,5,50,"ArtPasteClientEstimation.UndoPasteClientEstimation: undoing client-side estimation. Removing floating object with ID: [{0}] of type [{1}]",t,i.a().a),_Ewa.K.a(this.e).c(i,15,!0),i.i()&&i.Y(i.i(),!1))}},i:function(n){var u,f,t,r,i;return n?_Ewa.b.a(this.e).a().b().e()?(u=_Ewa.b.a(this.e).a().b().f().a(),n.OriginDeltaX=u.s+this.g,n.OriginDeltaY=u.t+this.g,n.AbsoluteLeft=n.AbsoluteLeft+this.g,n.AbsoluteTop=n.AbsoluteTop+this.g,n.AbsoluteRight=n.AbsoluteRight+this.g,n.AbsoluteBottom=n.AbsoluteBottom+this.g,n.ZOrder=u.p+1,_Ewa.b.a(this.e).a().b().f().i()):!this.e.j()||!this.e.j().p()?(Diag.a.a(37857497,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: ActiveItem/ActiveCell is null - cannot perform estimation for grid paste."),null):(f=this.e.j().p(),t=_Ewa.b.a(this.e).bf(f),!t)?(Diag.a.a(37857498,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: gridViewBlock for range {0} is null.",f.toString()),null):(r=_Ewa.i.m(t.d(),t.f().j(),this.e.isChangeGateEnabled("OfficeVSO:4071894_IeAndEdgeMisplacedEditorInRtlEnabled")),i=t.c().x(f,2,!1,!1),!r||!i)?(Diag.a.a(37857499,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: blockPositionRelativeToGridOrigin is null: {0}. cellPositionRelativeToGridOrigin is null: {1} .",!r,!i),null):(n.OriginDeltaX=i.a.a-r.x,n.OriginDeltaY=i.a.b-r.y,n.AbsoluteLeft=i.a.a,n.AbsoluteTop=i.a.b,n.AbsoluteRight=n.AbsoluteLeft+Math.abs(this.f.AbsoluteRight-this.f.AbsoluteLeft),n.AbsoluteBottom=n.AbsoluteTop+Math.abs(this.f.AbsoluteBottom-this.f.AbsoluteTop),n.ZOrder=this.f.ZOrder+100,new _Ewa.fn(t.c().b().a(t.a()),t.a())):(Diag.a.a(37857496,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: Called with null FloatingObjectData."),null)}};_Ewa.ZH=function(n,t){this.b=this.a;this.n=t;this.c=n;this.o=_Ewa.ClientStringManager.a();this.e=new _Ewa.fF(n,_Ewa.b.a(n))};_Ewa.ZH.prototype={c:null,o:null,e:null,n:null,a:function(){return this.n},p:function(){return this.o.b(5)},shouldWaitForCopyToComplete:function(){return!1},onDeferredPasteStarted:function(){},onDeferredPasteCompleted:function(){},beforePaste:function(){},l:function(n){var r,t,u,i;return(n.isExternalPaste=!0,r=this.c.j().c(),this.e.c(null,null,r,n.commandParameters.originalDestinations,n.commandParameters.expandDestinations,!1,!1,!1,!1,!1,!1,!0))?Promise.reject(new _Ewa.cy(18,null,null,"")):n.commandParameters.commandType!==516&&n.commandParameters.commandType!==36?this.c.a(197)&&n.commandParameters.commandType!==20?(t=n.clipboardItems.getItem("text/html"),u=!isNullOrUndefined(t)&&!(!t||!t.length)&&t.trim()!==this.p()&&t.startsWith("<"),u?(i=n.clipboardItems.getItem("copyId"),this.y(n,t,isUndefined(i)?null:i)):this.q(n)):this.q(n):Promise.reject(new _Ewa.cy(6,null,null,""))},q:function(n){var t=n.clipboardItems.getItem("text/plain"),r=!isNullOrUndefined(t)&&t.trim()===this.p(),i;return r?Promise.reject(new _Ewa.cy(7,null,null,"")):(isNullOrUndefined(t)||(n.plainTextPayloadSize=t.length),n.isPlainTextPaste=!0,n.pasteResult="SystemClipboardPaste",n.payloadOrigin=_Ewa.cD.c(n)?"LegacyCrossSession":"External",n.payloadType="PlainText",Diag.a.a(39186568,0,50,"BaseRangeCopyPasteHandler.PasteByPlainText: trigger ProcessPasteText request. pasteContext.Id={0}",n.id),i=this.e.l(_Ewa.g.g(n.commandParameters.originalDestinations),t,n.commandParameters.ribbonCommandInfo,[n.commandParameters.stopwatch],n),Diag.a.a(51668559,0,50,"BaseRangeCopyPasteHandler.PasteByPlainText: returned from ProcessPasteText. pasteContext.Id={0}",n.id),i)},y:function(n,t,i){return n.htmlPayloadSize=t.length,n.isHtmlPaste=!0,n.pasteResult="SystemClipboardHtmlPaste",n.payloadType="Html",n.payloadOrigin=_Ewa.cD.c(n)?"LegacyCrossSession":"External",Diag.a.a(42071711,0,50,"BaseRangeCopyPasteHandler.PasteByHtml: trigger ProcessPasteHtml request..."),this.e.k(_Ewa.g.g(n.commandParameters.originalDestinations),t,i,n.commandParameters.id,n.commandParameters.ribbonCommandInfo,[n.commandParameters.stopwatch],n)},r:function(n){var t={};return n&&(t.shadowWorkbookBase64=n.ShadowWorkbookBase64,t.shadowWorkbookSizeExceedsLimit=n.ShadowWorkbookSizeExceedsLimit,t.shadowWorkbookBlockedSize=n.ShadowWorkbookBlockedSize),t}};_Ewa.ZI=function(n,t,i,r,u){_Ewa.ZI.initializeBase(this,[n,r]);this.j=t;this.f=i;this.g=u||new _Ewa.tl(this.f);this.d=_Ewa.b.a(n);this.k=this.d.a();this.i=n.b().a(_Ewa.tq,169,!1,null)};_Ewa.ZI.prototype={d:null,k:null,i:null,j:null,g:null,f:null,getSourceItem:function(){var n=Common.P.c(this.d.a().a().c());return new _Ewa.jd(this.c,n,this.c.c().q().c(),this.c.c().d(),this.c.e().UserSessionId)},beforeSerialize:function(n){n.isSellectionAllowed=!1;n.isAsyncCopy=!1;n.isFromCache=!1;n.encounteredDeploymentErrors=!1;n.plainTextPayloadSize=0;n.shadowWorkbookPayloadSize=0;n.htmlPayloadSize=0;n.clientSideCopyTime=0;var i=new _Ewa.bX(this.c.f()),t=n.sourceItem,r=this;n.isSellectionAllowed=Common.P.b(t.a,function(n){return r.x(i,n)});n.isSellectionAllowed&&this.e.d(t.a,n.commandParameters.commandType)},w:function(n){return this.d.b().l()&&_Ewa.b.i(this.d,n)},A:function(n,t,i,r){var u=!1;return n.commandParameters.ribbonCommandInfo.a===1804571062&&i.a.length===1&&r.length===1&&(u=this.j.f(n,_Ewa.g.g(i.a),i.b,_Ewa.g.g(n.commandParameters.expandDestinations),this.c.c().q().c(),t.commandParameters.commandType===1),u&&this.c.isChangeGateEnabled("OfficeVSO:4313497_PasteOptionPerfTelemetry")&&_Ewa.b.a(this.c).v().e(n.commandParameters.stopwatch.c(),_Ewa.bk.c,!0)),this.z(n,i,_Ewa.g.n(this.c.j().c(),null,r),t.commandParameters.commandType,u)},x:function(n,t){return n.e(t,this.d)},z:function(n,t,i,r,u){var f=_Ewa.g.n(t.b,null,t.a);return n.pasteResult="SameSessionPaste",n.payloadOrigin="SameSession",n.payloadType="ActiveSelection",Diag.a.a(37003422,0,50,"BaseRangeCopyPasteHandler.PasteSameSession: trigger PasteRange request..."),this.e.e(n.commandParameters.ribbonCommandInfo,f,i,r,n.commandParameters.commandType,[n.commandParameters.stopwatch],n,u)}};_Ewa.tk=function(){};_Ewa.tk.prototype={a:function(){var n=window.clipboardPlatform;return n?n.createClipboardItems():null}};_Ewa.oR=function(){};_Ewa.oR.b=function(n,t,i,r,u,f,e,o,s){var h=n.a(9,o);return h.sourceRanges=t,h.destinationRanges=i,h.flags=r,_Ewa.j.a(n,"PasteRange",h,u,f,e,64,s)};_Ewa.oR.a=function(n,t,i,r,u,f,e){var o=n.a(1,f);return o.pasteHtmlParameters=t,_Ewa.j.a(n,"PasteHtmlContent",o,i,r,u,64,e)};_Ewa.oR.c=function(n,t,i,r,u,f,e,o){var s=n.a(9,e);return s.destinationRange=t,s.source=i,_Ewa.j.a(n,"PasteString",s,r,u,f,64,o)};_Ewa.Eb=function(){};_Ewa.Eb.a=function(n){if(!n){Diag.a.a(36701969,0,10,"CommonCopyPasteUtils.InitializeCopyContext: copyContext is null.");return}n.isAsyncCopy=!1;n.isSellectionAllowed=!1;n.isFromCache=!1;n.plainTextPayloadSize=0;n.shadowWorkbookPayloadSize=0;n.htmlPayloadSize=0;n.htmlSizeExceedsLimit=!1;n.clientSideCopyTime=0;n.encounteredDeploymentErrors=!1;n.shadowWorkbookSizeExceedsLimit=!1;n.copyTotalSizeExceedsLimit=!1};_Ewa.tl=function(n){this.b=n};_Ewa.tl.prototype={a:null,c:null,b:null,d:function(n){return this.a&&this.a.g(n)?this.f(this.c):null},e:function(n,t){this.a=n;this.c=this.f(t)},f:function(n){var t=this.b.a(),u=n.getItem("text/plain"),i,r;return u&&t.setItem("text/plain",u),i=n.getItem("data/shadow-workbook"),i&&t.setItem("data/shadow-workbook",i),r=n.getItem("text/html"),r&&t.setItem("text/html",r),t}};_Ewa.cj=function(n,t,i,r,u,f,e,o){this.I=Function.createDelegate(this,this.bh);this.D=Function.createDelegate(this,this.bp);this.K=Function.createDelegate(this,this.bq);this.C=Function.createDelegate(this,this.bo);this.B=Function.createDelegate(this,this.bk);this.A=Function.createDelegate(this,this.bi);this.J=Function.createDelegate(this,this.bl);_Ewa.cj.initializeBase(this,[!1]);this.p=n;this.w=i;this.q=_Ewa.b.a(n);this.s=u;this.F=f;this.r=t;this.t=r;this.z=o===1;this.bu();this.v=this.p.b().a(_Ewa.tr,85,!1,null);Diag.a.b(24388233,0,!!this.v,"CopyPasteInfrastructure.ctor: this.copyPasteShortcutDialogFactory shouldn't be null.");e||(Diag.a.a(37033877,0,50,"CopyPasteInfrastructure.ctor: userId is null, using default userId."),e="cpiDID");this.u=Common.d.e(e);this.G="CultureTag: "+_Ewa.ClientStringManager.a().d()+" HASH: ";this.r.addMetadataChangeListener("EwaJsMetadataChangeListenerId",this.J)};_Ewa.cj.k=function(n){var t=n.innerError;return t&&t.pasteErrorName?n.innerError:null};_Ewa.cj.i=function(n){var t=n.innerError;return t&&t.copyErrorName?n.innerError:null};_Ewa.cj.a=function(n){var t="",i,r;return n?(i=n,_Ewa.e.a(i.errorName)||(t=i.errorName,i.innerError&&(t+="_"+_Ewa.cj.a(i.innerError))),t&&t.length||(r=n,t=r&&!_Ewa.e.a(r.name)?r.name:"UnknownError"),t):"UnknownError"};_Ewa.cj.c=function(n){return _Ewa.cj.b||(_Ewa.cj.b=n.a(198)?"Slice6":_Ewa.o.q(n)?"Slice5":"Slice4"),_Ewa.cj.b};_Ewa.cj.l=function(n){switch(n){case 7:case 1:return 1862;case 5:return 1860;case 6:return 1859;case 8:case 3:case 2:case 4:case 9:case 10:return 1857;default:return Diag.a.b(593850376,0,!1,"CopyPasteInfrastructure.ConvertPasteValidationOptionToJsStringId: no case for validationOptions = {0}",n),1862}};_Ewa.cj.j=function(n){switch(n){case 3:case 1:return 1858;case 2:case 4:return 1857;default:return Diag.a.b(593850375,0,!1,"CopyPasteInfrastructure.ConvertCopySourceValidationOptionToJsStringId: no case for validationOptions = {0}",n),1862}};_Ewa.cj.prototype={p:null,q:null,r:null,w:null,v:null,t:null,s:null,F:null,u:0,G:null,z:!1,x:function(){return this.p.b().a(_Ewa.oT,373,!1,null)},g:function(n){this.dK("cpiOSC",n)},o:function(n){this.dL("cpiOSC",n)},i:function(n){var u,s,f,e,t,o,r,i;return(n.stopwatch=this.p.p().a("UserAction",_Ewa.A.a().b(n.ribbonCommandInfo.a)+"ClientSide"),u=!!_Ewa.cD.a(this.r),s=this,this.d("Copy/before/"+Common.j.b.toString(n.ribbonCommandInfo.c),!1,!1,!0,n.copyPasteTargetType).catch(function(){}),f=this.q.bY()===1,e=n.ribbonCommandInfo.a===-1985798686,f&&(t=this.s.h(this.q.a().a().c(),e),t))?(o=_Ewa.cj.j(t),this.y(o,_Ewa.tT.toString(t)),Promise.reject(!1)):(n.userHash=this.u,n.id=Common.z.a().a,r=this,i=this,this.t.onCopy(n).then(function(t){return t.isAsyncCopy||n.stopwatch.a(),r.x().b(0),Diag.a.a(24150883,0,50,"CopyPasteInfrastructure.OnCopy: Copy operation finished successfully. {0}",_Ewa.gr.a(n)),r.bc(t,u),Promise.resolve(!0)},function(t){var r=t,f=!1,s="none",o="Unknown",e=!0,h=-1,c="CopyError_",l=!1,a=null,u;return r&&(a=r.copyContext,h=r.reason,c+=_Ewa.cj.a(r),_Ewa.e.a(r.message)||(o=r.message),u=_Ewa.cj.i(r),u&&(u.copyErrorName===3?(f=!0,o=s="Async Copy canceled by the user.",e=!1):_Ewa.h.e(u.ewaErrors)&&(o=i.E(u.ewaErrors),_Ewa.h.c(u.ewaErrors,_Ewa.cj.d)?(f=!0,l=!0):(_Ewa.h.c(u.ewaErrors,_Ewa.cj.g)||_Ewa.h.c(u.ewaErrors,_Ewa.cj.e))&&(f=!0))),r.reason===13?(f=!0,e=!1):r.reason===11&&(e=!1)),f?Diag.a.a(36304157,0,15,"CopyPasteInfrastructure.OnCopy: Copy operation failed with an expected error. clearStateNeeded: {0}, Friendly message: {1}, Error Message: {2}, CommandParameters: {3}",e,s,r?copyPasteInfra.getStringifiedError(r):"null",_Ewa.gr.a(n)):Diag.a.a(24150912,0,10,"CopyPasteInfrastructure.OnCopy: Copy operation failed with an unexpected error. clearStateNeeded: {0}, Error Message: {1}, CommandParameters: {2}",e,r?copyPasteInfra.getStringifiedError(r):"null",_Ewa.gr.a(n)),e&&i.d("Copy/fail/"+Common.j.b.toString(n.ribbonCommandInfo.c),!0,!1,!1,n.copyPasteTargetType).catch(function(){}),i.bb(n,f,o,c,h,l,a),Promise.reject(t)}))},n:function(n){var f,t,u,v,y,p,w;n.stopwatch=this.p.p().a("UserAction",_Ewa.A.a().b(n.ribbonCommandInfo.a)+"ClientSide");_Ewa.b.a(this.p).v()&&_Ewa.b.a(this.p).v().f(this.Y(n.ribbonCommandInfo.a),n.stopwatch.c(),"");f=Common.P.c(this.q.a().a().c());n.originalDestinations=f;n.expandDestinations=this.L(n.originalDestinations,n.commandType);var e=this.h(n.commandType,n.expandDestinations),r=this.r.getCachedMetadata().lastCopy,o=null,s=null,h=!1,c=!1,l=!1,a=!0;r&&(a=!1,c=r.commandParameters.ribbonCommandInfo.a===-1985798686,t=$$as(_Ewa.zD,r.sourceItem),t&&(h=!t.c(this.p),_Ewa.fX.a(t)?(u=$$as(_Ewa.jd,t),o=u.a,s=u.b):_Ewa.fX.b(t)&&(l=!0)));var b=this.p.j().c(),k=(n.commandType&64)==64,d=(n.commandType&32)==32,g=(n.commandType&1024)==1024,i=this.s.c(s,o,b,n.originalDestinations,n.expandDestinations,h,k,d,g,c,l,a);return i?(v=_Ewa.cj.l(i),this.y(v,_Ewa.xK.toString(i)),y=i===6,e&&y&&this.H(n.expandDestinations),Promise.reject(!1)):e||this.U()?(n.userHash=this.u,n.id=Common.z.a().a,p=this,w=this,this.t.onPaste(n).then(function(t){return p.bn(t,n)},function(t){return w.bm(n,t)})):(Diag.a.a(24150913,0,15,'CopyPasteInfrastructure.OnPaste: paste was triggered but the estimated destination range is not editable, do nothing. ExpandDestinations: {0}, CommandType: {1}, copyPasteTargetType="{2}"',_Ewa.g.k(n.expandDestinations,",",this.p,!1,!1,!1),n.commandType,n.copyPasteTargetType),Promise.resolve(!0))},Y:function(n){if(this.p.isChangeGateEnabled("OfficeVSO:4313497_PasteOptionPerfTelemetry"))switch(n){case 1804571062:return 6;case-185374993:return 7;case 1766348718:return 8;default:return 3}return 3},U:function(){if(!this.p.isChangeGateEnabled("OfficeVSO:3782723_EnablePastingImageFromExternalOnFloatingObject")){var n=_Ewa.cD.a(this.r);if(!n||!n.sourceItem||Object.getType(n.sourceItem)!==_Ewa.hy)return!1}return!!_Ewa.b.a(this.p).a().b().e()&&this.p.Z(null,470)},a:function(){var n=_Ewa.cD.a(this.r);return!n||!n.commandParameters?0:n.commandParameters.copyPasteTargetType},l:function(){return!!_Ewa.cD.a(this.r)&&_Ewa.lp.a(_Ewa.cD.a(this.r),this.p)},d:function(n,t,i,r,u){var e,o,f,s,h,c;try{return(e=u,o=this.ba(),!r&&o===2)?(Diag.a.a(36304158,0,50,"CopyPasteInfrastructure.ClearState clipboard won't be cleared as there's art in the clipboard. clearClipboardContent = '{0}', isExplicit = '{1}', isForce = '{2}', Current CCP operation copyPasteTargetType = '{3}', LastCopyPasteTargetType = '{4}'",t,i,r,u,o),Promise.reject(null)):(e||(e=o),f=this.p.p().a("UserAction","ClearCopyState"),s=f.c(),Diag.a.a(24150914,0,50,"CopyPasteInfrastructure.ClearState clear clipboard state. clearClipboardContent = '{0}', isExplicit = '{1}', isForce = '{2}', Current CCP operation copyPasteTargetType = '{3}', LastCopyPasteTargetType = '{4}'",t,i,r,u,o),this.s.b(),this.bt(),h=this,c=this,this.t.onCancelCopy(t).then(function(){return f.a(),h.T(n,s,!0,i,t,"","",f.b(),e),Promise.resolve(!0)},function(r){Diag.a.a(24150915,0,15,"CopyPasteInfrastructure.ClearState: error during call to copyPasteFlowManager.OnClear(). error: {0}",r?copyPasteInfra.getStringifiedError(r):"null");f.a();var o="CancelError_",h="Unknown",u=r;return u&&(o+=_Ewa.cj.a(u),_Ewa.e.a(u.message)||(h=u.message)),c.T(n,s,!1,i,t,h,o,f.b(),e),Promise.reject(r)}))}catch(l){return Promise.reject(null)}},ba:function(){var n=_Ewa.cD.a(this.r);return!n||!n.sourceItem?0:Object.getType(n.sourceItem)===_Ewa.hy?2:1},j:function(n,t,i,r){var s,e,u,f,o;return n.stopwatch=this.p.p().a("UserAction","DragDropClientSide"),s=this,this.d("DragDrop/before/"+Common.j.b.toString(n.ribbonCommandInfo.c),!1,!1,!1,n.copyPasteTargetType).catch(function(){}),e=r?256:128,u={},u.encounteredDeploymentErrors=!1,u.commandParameters=n,n.userHash=this.u,n.id=Common.z.a().a,f=this,o=this,this.s.e(n.ribbonCommandInfo,_Ewa.g.e(t,this.p),_Ewa.g.e(i,this.p),1,e,[n.stopwatch],u,!1).then(function(){return Diag.a.a(36975680,0,50,'CopyPasteInfrastructure.DragDropCells: success. copyPasteTargetType="{0}"',n.copyPasteTargetType),f.q.a().s(-1),f.be(n,t,i,u),Promise.resolve(!0)},function(r){return Diag.a.a(36975681,0,10,'CopyPasteInfrastructure.DragDropCells: {0}, copyPasteTargetType="{1}"',r?copyPasteInfra.getStringifiedError(r):"null",n.copyPasteTargetType),o.bj(r,n,t,i,u)})},k:function(n,t){var r=_Ewa.cD.a(this.r),i,e,c,l,o;if(!r)return Diag.a.a(25518403,0,50,"InsertCopiedCutCells: CopyContext must not be null or undefined"),$$sc.a.a(Boolean,!1);if(!_Ewa.fX.a(r.sourceItem))return Diag.a.a(36824457,0,50,"InsertCopiedCutCells: CopyContext must be a Range"),$$sc.a.a(Boolean,!1);if(i=r.sourceItem,!i)return Diag.a.b(25518404,0,!!i,"InsertCopiedCutCells: rangeSourceItem must not be null or undefined"),$$sc.a.a(Boolean,!1);if(!i.c(this.p))return Diag.a.a(34981187,0,50,"InsertCopiedCutCells: rangeSourceItem is from a different session"),$$sc.a.a(Boolean,!1);if(i.a.length>1)return Diag.a.a(595185888,0,50,"InsertCopiedCutCells: multiple source ranges are not supported"),this.y(1857,"InsertCopiedCutCells"),$$sc.a.a(Boolean,!1);var u=_Ewa.g.g(i.a),a=this.q.a().a().b(),f=_Ewa.g.g(this.L([a],n)),s=this.m(),v=i.b,y=this.p.c().q().c(),h=_Ewa.g.a(u,this.p);return h.SheetName=v,e=_Ewa.g.a(f,this.p),e.SheetName=y,c=f.m()||u.m()?$$sc.a.a(_Ewa.oB,0):f.j()||u.j()?$$sc.a.a(_Ewa.oB,1):this.F.a(this.p,_Ewa.b.a(this.p).d()),l=this,o=this,c.CWR($$sc.a,function(n){return l.W(h,e,s,n.a(),t)}).CW(function(){s?o.s.b():o.d("InsertCopiedCutCells/success/"+Common.j.b.toString(t.c),!0,!1,!1,0)})},c:function(){var n=_Ewa.cD.a(this.r),t=this.q.a().a().d();return!!n&&_Ewa.fX.a(n.sourceItem)&&t&&n.sourceItem.a.length===1},m:function(){return this.S(-911352779)},b:function(){return this.S(-1985798686)},h:function(n,t){var i=new _Ewa.bX(this.p.f()),r=n===36,u=i.a(4),f=this.a()===2&&i.a(1),e=r&&u;return e||f||this.p.Z(t,1)},e:function(n,t){return this.s.i(n,t)},dispose:function(){_Ewa.ci.prototype.dispose.call(this);this.bx();this.r.removeMetadataChangeListener("EwaJsMetadataChangeListenerId")},f:function(n,t,i,r,u,f){var h=!1,s,c,l,e,o,a;if(n.commandParameters.commandType!==516){if(i===u&&(s=t.l(this.q.p()),c=r.l(this.q.p()),s&&c)){l=_Ewa.g.a(s,this.p);l.SheetName=i;e=!0;o=!1;switch(n.commandParameters.ribbonCommandInfo.a){case 1804571062:e=!0;o=!1;break;case 237279923:case 808159687:e=!0;o=!0;break;case 1766348718:case-185374993:e=!1;o=!0}a=this.w.f(this.q,l,_Ewa.g.a(c,this.p),n.commandParameters.stopwatch,e,o);h=a;f&&(this.w.e(s,!1),h=!0);a&&(this.x().a(n.commandParameters.id),this.H(n.commandParameters.expandDestinations),this.M("DoPasteClientEstimation/"+Common.j.b.toString(n.commandParameters.ribbonCommandInfo.c),n))}}else Diag.a.a(24417763,0,50,"RangeCopyPasteHandler.DoPasteClientEstimation: client estimation support only paste formatting.");return h},S:function(n){var t=_Ewa.cD.a(this.r),i;return t?(i=t.sourceItem,i&&!i.c(this.p))?(Diag.a.a(34981188,0,50,"CopyPasteInfrastructure.LastOperationWasCopyCut: Last copy operation was from a different session."),!1):t.commandParameters.ribbonCommandInfo.a===n:!1},W:function(n,t,i,r,u){var f={};f.InsertDirection=r;f.SourceRange=n;f.DestRange=t;f.CopyCutOperation=i?0:1;var e=this.p.d().a(),h=this,o=function(n,t){return _Ewa.Ju.a(e,f,n,t,null,null)},c=this,s=function(){return new _Ewa.Nh(f)},l=this;return _Ewa.M.a(this.p.g(),o,function(n){return new _Ewa.F(104,0,n,0,s)},u)},bl:function(n){this.bw(n)&&(this.s.b(),Diag.a.a(38922268,0,50,"CopyPasteInfrastructure.OnMetadataChanged: found that cut/copy operation was preformed in another session therefore removed the highlight in this session."))},bw:function(n){var t=!n||!n.lastCopy;return t?!0:_Ewa.lp.a(n.lastCopy,this.p)},P:function(n,t,i,r){var u={};return u.a=this.p.e().UserSessionId,u.e=n.stopwatch.c(),u.c=_Ewa.A.a().b(n.ribbonCommandInfo.a),u.b=Common.j.b.toString(n.ribbonCommandInfo.c),u.d=n.id,u.f=t.toString(),u.g=i.toString(),u.l=n.stopwatch.b(),u.n=!1,u.o=n.copyPasteTargetType.toString(),u.p=r.encounteredDeploymentErrors,u},be:function(n,t,i,r){var u=this.P(n,t,i,r);u.h=!0;_Ewa.A.a().a(45,u,!0)},bd:function(n,t,i,r,u,f,e,o){var s=this.P(n,t,i,o);s.h=!1;s.i=r;s.k=u;s.m=f;s.n=e;_Ewa.A.a().a(45,s,!0)},T:function(n,t,i,r,u,f,e,o,s){var h={};h.a=this.p.e().UserSessionId;h.b=t;h.c=n;h.f=i;h.e=r;h.d=u;h.g=f;h.h=e;h.i=o;h.j=s.toString();_Ewa.A.a().a(46,h,!0)},bc:function(n,t){var i=this.O(n.commandParameters,n);i.l=!0;i.j=t;_Ewa.A.a().a(43,i,!0)},bb:function(n,t,i,r,u,f,e){var o=this.O(n,e);o.l=!1;o.m=t;o.o=i;o.y=r;o.x=u;o.z=f;_Ewa.A.a().a(43,o,!0);Diag.a.a(42768481,0,15,"CopyPasteInfrastructure.LogCopyFailedTelemetry: ErrorName={0},ErrorReason={1},IsExpectedError={2},IsSucceededWithAlert={3},ErrorMessage={4}",o.y,o.x,o.m,o.z,o.o)},O:function(n,t){var i={},u,e;if(i.a=this.p.e().UserSessionId,i.f=n.stopwatch.c(),i.g=n.id,i.c=_Ewa.A.a().b(n.ribbonCommandInfo.a),i.b=Common.j.b.toString(n.ribbonCommandInfo.c),i.q=n.stopwatch.b(),i.bd=_Ewa.cj.c(this.p),i.bg=n.copyPasteHandlerName,i.bj=isNullOrUndefined(n.ribbonCommandInfo.b)?null:Common.K.toString(n.ribbonCommandInfo.b),i.s=n.copyPasteTargetType.toString(),i.bc=_Ewa.hL.b(n.copyPasteTargetType),i.z=!1,i.bk=this.p.a(61),t){if(i.bl=t.id,i.bm=t.serverRequestTimeInMs,t.requestTelemetryData&&(i.bn=t.requestTelemetryData.EcsOperationDuration,i.bo=t.requestTelemetryData.EcsRequestDuration,i.bp=t.requestTelemetryData.WfeRequestDuration),i.d=t.sourceItem?t.sourceItem.toString():null,i.e=-1,_Ewa.fX.a(t.sourceItem)){i.e=0;u=t.sourceItem.a;for(var f=u,o=f.length,r=0;r<o;++r)e=f[r],i.e+=e.A()}i.h=t.isAsyncCopy;i.i=t.isFromCache;i.k=t.isSellectionAllowed;i.r=t.plainTextPayloadSize;i.u=t.htmlPayloadSize;i.v=t.htmlSizeExceedsLimit;i.w=t.copyTotalSizeExceedsLimit;i.t=t.shadowWorkbookPayloadSize;i.p=t.clientSideCopyTime;i.ba=t.encounteredDeploymentErrors;i.bb=t.shadowWorkbookSizeExceedsLimit;i.be=t.syncClipboardItemsKeys;i.bf=t.asyncClipboardItemsKeys;i.bh=this.N(t.succeededPopulatingSystemClipboardSync);i.bi=this.N(t.succeededPopulatingSystemClipboardAsync)}return i},H:function(n){var t=n.length===1&&this.q.a().a().i()&&this.q.a().a().c()[0].cb(n[0])?this.q.a().a().a():n[0].e();this.q.a().O(n,0,t,0,!0,"",!1,!0,!0)},Q:function(n,t){var i={},r,f,o;if(i.a=this.p.e().UserSessionId,i.g=n.stopwatch.c(),i.p=n.stopwatch.b(),t&&(i.bs=t.id,i.bt=t.serverRequestTimeInMs,t.requestTelemetryData&&(i.bw=t.requestTelemetryData.EcsOperationDuration,i.bx=t.requestTelemetryData.EcsRequestDuration,i.by=t.requestTelemetryData.WfeRequestDuration)),i.t=n.copyPasteTargetType.toString(),i.bh=_Ewa.hL.b(n.copyPasteTargetType),i.bn=n.copyPasteHandlerName,i.i=_Ewa.g.k(n.expandDestinations,",",this.p,!1,!1,!1),i.h=_Ewa.g.k(n.originalDestinations,",",this.p,!1,!1,!1),i.e=n.id,i.d=n.commandType,i.c=_Ewa.A.a().b(n.ribbonCommandInfo.a),i.b=Common.j.b.toString(n.ribbonCommandInfo.c),i.bb=!1,i.bc=!1,i.bl=_Ewa.cj.c(this.p),i.bp=isNullOrUndefined(n.ribbonCommandInfo.b)?null:Common.K.toString(n.ribbonCommandInfo.b),i.br=this.p.a(61),t)if(r=t.copyContextSnapshot,r&&!t.isExternalPaste){if(i.f=r.commandParameters.id,i.j=r.sourceItem.toString(),i.k=-1,_Ewa.fX.a(r.sourceItem)){i.k=0;f=r.sourceItem.a;for(var e=f,s=e.length,u=0;u<s;++u)o=e[u],i.k+=o.A()}i.bc=r.commandParameters.commandType===1}else t.clipboardItems?i.f=t.clipboardItems.getItem("copyId"):Diag.a.a(50647260,0,50,"CopyPasteInfrastructure.GetPasteUsageData: pasteContext.ClipboardItems is null");else Diag.a.a(50647261,0,50,"CopyPasteInfrastructure.GetPasteUsageData: pasteContext is null");return i},bf:function(n,t,i,r,u,f,e,o,s){var h=this.Q(n,o);h.l=!1;h.m=t;h.o=i;h.y=r;h.ba=u;h.z=f;h.bb=e;o?(h.u=_Ewa.cD.b(o)||!o.copyContextSnapshot,h.be=!h.u&&_Ewa.lp.a(o.copyContextSnapshot,this.p),h.bf=o.shadowWorkbookSizeExceedsLimit,h.r=o.shadowWorkbookPayloadSize,h.s=o.htmlPayloadSize,h.bm=_Ewa.hL.a(o.clipboardItems),h.x=o.activeSelectionType,h.bo=o.isSameSession,h.bj=o.payloadOrigin,h.bk=o.payloadType,h.bq=o.externalAppSource,h.bu=o.indicationDisplayed,h.bv=o.pasteIndicationDisplayStatus):h.be=_Ewa.lp.a(s,this.p);_Ewa.A.a().a(44,h,!0);Diag.a.a(42768482,0,15,"CopyPasteInfrastructure.LogPasteFailedTelemetry: ErrorName={0},ErrorReason={1},IsExpectedError={2},IsSucceededWithAlert={3},ErrorMessage={4}",h.ba,h.z,h.m,h.bb,h.o)},bg:function(n){var t=this.Q(n.commandParameters,n);t.u=n.isExternalPaste;t.l=!0;t.q=n.plainTextPayloadSize;t.r=n.shadowWorkbookPayloadSize;t.s=n.htmlPayloadSize;t.v=n.isClipboardDataContainShadowWorkbook;t.w=n.isShadowWorkbookParsedSuccessfully;t.x=n.activeSelectionType;t.y=n.pasteResult;t.bd=n.encounteredDeploymentErrors;t.bf=n.shadowWorkbookSizeExceedsLimit;t.bg=_Ewa.cD.c(n);t.bm=_Ewa.hL.a(n.clipboardItems);t.bo=n.isSameSession;t.bj=n.payloadOrigin;t.bk=n.payloadType;t.bq=n.externalAppSource;t.bu=n.indicationDisplayed;t.bv=n.pasteIndicationDisplayStatus;this.p.isChangeGateEnabled("OfficeVSO:4310335_LoggingChromeExtensionIdInPasteUsageDate")&&(t.bi=_Ewa.cD.e(n));t.be=!n.isSameSession&&!n.isExternalPaste;_Ewa.A.a().a(44,t,!0)},bu:function(){this.p.f().c(this.A);this.p.f().K(this.B);this.p.g().c(this.C);this.p.E(this.K);_Ewa.b.a(this.p).g().c(this.D)},bx:function(){this.p&&this.p.f()&&(this.p.f().e(this.A),this.p.f().Q(this.B));this.p&&this.p.g()&&this.p.g().e(this.C);this.q&&this.q.g()&&this.q.g().d(this.D)},bm:function(n,t){var i=null,o=t,r=!1,f=null,e="UnknownFailure",c=-1,u="Unknown",s="PasteError_",l=!1,a,y,v,h;return this.x().a(n.id),a=_Ewa.cD.a(this.r),(n.clearStateOnFinish||n.clearSystemClipboard)&&(y=this,this.d("Paste/fail/"+Common.j.b.toString(n.ribbonCommandInfo.c),!0,!1,!1,n.copyPasteTargetType).catch(function(){})),o&&(c=o.reason,s+=_Ewa.cj.a(o),_Ewa.e.a(o.message)||(u=o.message),i=_Ewa.cj.k(o),i&&(i.pasteErrorName===1?(r=!0,e="CopyPasteLengthTooLongPopup",u=f="The pasted content is too long. Popup a dialog to the user.",Diag.a.a(25216992,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',f,n.copyPasteTargetType),v=_Ewa.h.b(1,0,23,612,0,1306609195,"CopyPasteOversizeError"),h=new _Ewa.dc(this.p,v),h.E(),h.x(!1)):i.pasteErrorName===7?(r=!0,e="No-Op",u=f="The shadow workbook is not ready yet and an async copy failed to populate the clipboard. Do nothing (by the spec)",Diag.a.a(33948251,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',f,n.copyPasteTargetType)):i.pasteErrorName===8?(r=!0,e="UseShortcutsPopup",u=f="Unable to paste content from the system clipboard. Popup dialog to the user.",Diag.a.a(25216994,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',f,n.copyPasteTargetType),this.bs()):i.pasteErrorName===18?(r=!0,e="PasteExternalNotSupportMultipleSelectionPopup",u="Paste external not support multiple selection. Popup dialog to the user.",this.y(1857,"PasteFromExternal")):i.pasteErrorName===6?(r=!0,e="No-Op",u=f="Paste Formatting/Transpose is not yet a supported operation on System Clipboard based content",Diag.a.a(36263241,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',f,n.copyPasteTargetType)):i.pasteErrorName===17?(r=!0,e="No-Op",u=f="Paste text on Art is not yet a supported operation",Diag.a.a(0,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',f,n.copyPasteTargetType)):i.pasteErrorName===16?(r=!0,e="No-Op",u=f="Paste has failed because the previous copy has failed",Diag.a.a(40147082,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}", error={2}',f,n.copyPasteTargetType,copyPasteInfra.getStringifiedError(i))):_Ewa.h.e(i.ewaErrors)?(_Ewa.h.i(i.ewaErrors)||_Ewa.h.c(i.ewaErrors,_Ewa.h.o())?(r=!0,e="CommunicationError",f=_Ewa.h.a(i.ewaErrors,","),Diag.a.a(36304159,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0} copyPasteTargetType="{1}"',u,n.copyPasteTargetType)):_Ewa.h.c(i.ewaErrors,_Ewa.cj.h)?(r=!0,e="SavingWorkbookError",f=_Ewa.h.a(i.ewaErrors,","),Diag.a.a(36304160,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0} copyPasteTargetType="{1}"',u,n.copyPasteTargetType)):_Ewa.h.c(i.ewaErrors,_Ewa.cj.d)&&(r=!0,l=!0,e="OperationSucceededWithAlert",f=_Ewa.h.a(i.ewaErrors,","),Diag.a.a(36304161,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0} copyPasteTargetType="{1}"',u,n.copyPasteTargetType)),r||(u=this.E(i.ewaErrors),r=this.R(o))):i.pasteErrorName===11&&(r=!0,e="No-Op",u="Paste has failed because user try copy cross-session oart object")),o.reason===15&&(r=!0,e="No-Op",u="Rejecting deferred paste there is metadata update without copy context. Usually it means that copy canceled before finished."),_Ewa.e.b(s,"PasteError_FailedToReadFromClipboard_UserHashMismatchError",!1)&&(r=!0,e="No-Op",u="User hash of the copy is different then the user hash of the paste during cross-session copy-paste. Do nothing.")),r||Diag.a.a(24150916,0,10,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',o?copyPasteInfra.getStringifiedError(o):"null",n.copyPasteTargetType),this.bf(n,r,u,e,s,c,l,o.pasteContext,a),Promise.reject(t)},bn:function(n,t){if(Diag.a.a(24150917,0,50,'CopyPasteInfrastructure.OnPasteSuccess: paste succeed. copyPasteTargetType="{0}"',t.copyPasteTargetType),this.x().a(t.id),this.br(t.copyPasteTargetType,n)){var i=null;n.PastedRange&&n.PastedRange.Ranges&&n.PastedRange.Ranges.length>0?i=_Ewa.g.s(n.PastedRange.Ranges):n.isExternalPaste||(i=t.expandDestinations);this.bv(n,i)}return this.M("Paste/success/"+Common.j.b.toString(t.ribbonCommandInfo.c),n),this.bg(n),this.z&&(!t.isKeyboardEvent||_Ewa.cD.c(n))&&this.p.c().e().a(66)&&(Diag.a.a(42824788,0,15,"CopyPasteInfrastructure.OnPasteSuccess: show localStorage disable notification"),this.z=!1,this.V()),Promise.resolve(!0)},br:function(n,t){return n===1||t.payloadType==="PlainText"||this.p.a(197)&&t.payloadType==="Html"},M:function(n,t){var i,r,u,f;(u=this.Z(t,r={val:i}),i=r.val,u)&&(f=this,this.d(n,i,!1,!1,t.commandParameters.copyPasteTargetType).catch(function(){}))},bh:function(n,t){Diag.a.a(37364764,0,50,"CopyPasteInfrastructure.LogShortcutDialogAndRestoreFocus: Got shortcut dialog, user pressed [{0}]. userPressedExtensionLink={1}",n,t);this.q.o()},bs:function(){var n=this.v.a(this.p);n.a(!0,!1,!1,this.I)},y:function(n,t){Diag.a.a(590705172,0,50,"CopyPasteInfrastructure.PopupDiscontinuousSelectionErrorDialog: Blocked CCP due to discontinuous selection, reason: {0}",t);var r=_Ewa.h.b(1,1,662,n,0,371863010,"DiscontinuousSelectionBlocking"),i=new _Ewa.dc(this.p,r);i.E();i.x(!1)},bj:function(n,t,i,r,u){Diag.a.a(24150918,0,10,"CopyPasteInfrastructure.OnDragAndDropCellsFailed: {0}",n?copyPasteInfra.getStringifiedError(n):"null");var o=!1,s=!1,f=!1,e="Unknown",h="DragAndDropError_";return n&&(h+=_Ewa.cj.a(n),_Ewa.h.e(n.ewaErrors)?(e=this.E(n.ewaErrors),_Ewa.h.c(n.ewaErrors,_Ewa.cj.d)&&(o=!0),_Ewa.h.c(n.ewaErrors,_Ewa.cj.f)&&(s=f=!0)):n.message&&(e=n.message)),f||(f=this.R(n)),s?this.q.a().s(-1):this.s.m(r),this.bd(t,i,r,f,e,h,o,u),Promise.reject(n)},L:function(n,t){var r=n,i=this.X();return i&&i.a&&(r=this.s.f(t,i.a,n)),r},X:function(){var n=_Ewa.cD.a(this.r);return n&&_Ewa.fX.a(n.sourceItem)?n.sourceItem:null},bt:function(){this.dJ("cpiOSC",null,null)},bv:function(n,t){var i=n.commandParameters.originalDestinations,r;t&&(r=_Ewa.g.m(this.q.a().a().c(),i),r?(this.H(t),Diag.a.a.apply(null,[24150919,0,50,"CopyPasteInfrastructure.SelectPastedRangeIfNeeded: select paste range, range: {0}"].concat(t))):Diag.a.a.apply(null,[24150920,0,50,"CopyPasteInfrastructure.SelectPastedRangeIfNeeded: user change his selection during paste operation. don't change selection. originalPasteDestinations: {0}"].concat(i)))},Z:function(n,t){var i,r,u,f;if((t.val=!0,n.isPlainTextPaste||n.isHtmlPaste)||_Ewa.cD.d(n))return t.val=!1,!0;if(i=n.copyContextSnapshot,n.commandParameters.clearStateOnFinish)return!0;if(i&&_Ewa.fX.a(i.sourceItem)){if(r=i.sourceItem,!r.c(this.p))return!1;if(u=i.commandParameters.ribbonCommandInfo.a===-1985798686,f=r.a.length>1||n.commandParameters.expandDestinations.length>1,!f){var e=_Ewa.g.g(r.a),o=_Ewa.g.g(n.commandParameters.expandDestinations),s=this.p.c().q().c(),h=r.b,c=h===s&&!!o.l(e);if(c)return!0}return u}return!1},bq:function(n,t){if(!t.b&&!t.c){var i=this;this.d("OnWorkbookOpened",!1,!1,!1,0).catch(function(){})}},bi:function(n,t){var r=_Ewa.cD.a(this.r),i=this.s.a(r);i&&(t.a&&t.a.c()===i.b&&i.c(this.p)?this.s.d(i.a,r.commandParameters.commandType):this.s.b())},bk:function(n,t){var r=_Ewa.cD.a(this.r),i=this.s.a(r),u;i&&t.a&&t.a.c()===i.b&&i.c(this.p)&&(u=this,this.d("OnItemDeleting",!1,!1,!1,0).catch(function(){}))},bp:function(){var t=_Ewa.cD.a(this.r),n=this.s.a(t),i;n&&n.c(this.p)&&(i=this,this.d("OnStartEdit",!1,!1,!1,0).catch(function(){}))},bo:function(n,t){if(t.b===1&&t.a.a.c()&2){var i=this;this.d("OnQueueItemChanged/ItemRemoved",!1,!1,!1,0).catch(function(){})}},E:function(n){var t=_Ewa.h.V(n,"_");return this.G+Common.d.e(t).toString()},R:function(n){var t=_Ewa.cj.a(n);return!(!t||!t.length)&&_Ewa.e.m(t,"MergedCellOverlap")},V:function(){var t=Common.c.f()?289:Common.c.m()?290:291;var i=_Ewa.h.b(1,2,287,288,t,530046625,"ActivateLocalStorage"),n=_Ewa.l.b(_Ewa.cQ,this.p.b(),5,4,0,null),r=this;_Ewa.f.cw(n,function(){n.a().a(34,i,null)},this.dM(),3)},N:function(n){return isNullOrUndefined(n)?"NotCalled":n?"Success":"Failed"}};_Ewa.tm=function(n){_Ewa.tm.initializeBase(this);this.a=n;this.g=_Ewa.ClientStringManager.a();this.e()};_Ewa.tm.a=function(n){n.b().b(_Ewa.oT,373,new _Ewa.jD(n));n.b().b(_Ewa.wC.$$(_Ewa.dg),255,new _Ewa.tm(n))};_Ewa.tm.prototype={a:null,g:null,p:function(){var i=_Ewa.r.d([49,50],4,!1,!1,!0,255,this.c),t=_Ewa.l.a(_Ewa.fQ,this.a.b(),18,this.a.i(),this.c,null),n=this;_Ewa.f.cw(_Ewa.f.ws([t,i],this.b(),3),function(){var r=new _Ewa.om,i=null;n.j(r).then(function(u){var f,e;i=u.b;f=copyPasteInfra.createCopyPasteInfra(i,new _Ewa.Ed(n.a),r,n.a);Diag.a.b(24970909,0,!!n.a.e(),"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext should not be null");Diag.a.b(24970910,0,!!n.a.e()&&!!n.a.e().DocumentHostInfo,"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext.DocumentHostInfo should not be null");e=i.getMetadataManager();n.d(new _Ewa.cj(n.a,e,t.a(),f,new _Ewa.fF(n.a,_Ewa.b.a(n.a)),new _Ewa.Ee,n.a.e().DocumentHostInfo.UserId,i.getInitializationError()));u.a?Diag.a.a(41731933,0,50,"CopyPasteInfrastructureFactory.Create: Initialize CCP infra succeed. SliceName={0}, StrategyType={1}, StrategyCapabilities={2}, IsBestStrategyTypeInitialized={3}, InfraLoadTimeMS={4}, IncreasingCipboardLimitEnabled = {5}",_Ewa.cj.c(n.a),u.a.dataClipboardStrategyType,JSON.stringify(u.a.dataClipboardCapabilities),u.a.clipboardStrategiesToInitialize[0].clipboardStrategyType===u.a.dataClipboardStrategyType,isNullOrUndefined(window.bsqmXLSPageLoadStartTime)?"-1":(Date.now()-window.bsqmXLSPageLoadStartTime.getTime()).toString(),n.a.a(61)):Diag.a.b(41731932,0,!1,"CopyPasteInfrastructureFactory.Create: initResult.ClipboardPlatformEnvironmentInitializationInfo should not be null")},function(t){Diag.a.b(38847436,0,!1,"CopyPasteInfrastructureFactory.Create: error during call to clipboardPlatformEnvironment.Init(). Copy Paste operations will not be available in this session. SliceName: {0} error: {1}",_Ewa.cj.c(n.a),t?copyPasteInfra.getStringifiedError(t):"null")})},this.b(),3)},dispose:function(){_Ewa.qV.prototype.dispose.call(this)},j:function(n){var i=null,u=window.clipboardPlatform,o,s,a,v;if(u&&(i=u.getClipboardPlatformEnvironment()),!i)return Diag.a.b(24970911,0,!1,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: getClipboardPlatformEnvironment should have returned a valid object"),Promise.reject(null);var t=this.a.e(),h=[t.OfficeOnlineChromeExtensionId,t.ChromeClipboardAccessExtensionId],c=this.g.b(5),f=this.a.z().a(56),e=!f&&this.a.z().a(5),r=this.a.A().c(),l=!!r&&(r.b()||r.q()||r.e());return l&&(e=!1),o=!f,s=this.m(e,o),Diag.a.b(40380624,0,!!t.DocumentHostInfo,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: bootstrapContext.DocumentHostInfo should not be null"),a=this,v=this,i.init(this.a,n,h,t.SharedClipboardHostingApp,t.SharedClipboardHostingApps,t.SharedClipboardHostingEnvironments,t.SharedClipboardOverrideOrigin,t.SharedClipboardSchemaVersion,t.SharedClipboardExpirationInMinutes,t.ClipboardPromiseTimeoutInMinutes,c,t.MachineCluster,new _Ewa.Ec(this.a),s,t.DocumentHostInfo.UserId,t.ClipboardTtlInMS,this.a.a(399),t.UserSessionId).then(function(n){var t;return t=new _Ewa.tm.b,t.b=i,t.a=n,t},function(n){return Promise.reject(n)})},m:function(n,t){var i=[];return n&&t&&Array.add(i,this.l(6)),t&&(Array.add(i,this.f(7)),Array.add(i,this.f(0))),n&&Array.add(i,this.i(5)),Array.add(i,this.k(4)),Diag.a.a(39978242,0,50,"CopyPasteInfrastructureFactory.GetClipboardStrategiesInitList: create clipboard stratgy initialization list: isBrowserStorageAllowed={0}, isSystemClipboardAllowed={1}, result = {2}",n,t,i?i.join(","):"[]"),i},i:function(n){var i=this.a.e(),t={};return t.clipboardStrategyType=n,t.sessionId=i.UserSessionId,t.useSharedClipboardIframe=!0,t.sharedClipboardHostingApp=i.SharedClipboardHostingApp,t.sharedClipboardHostingApps=i.SharedClipboardHostingApps,t.sharedClipboardHostingEnvironments=i.SharedClipboardHostingEnvironments,t.sharedClipboardOverrideOrigin=i.SharedClipboardOverrideOrigin,t.sharedClipboardSchemaVersion=i.SharedClipboardSchemaVersion,t.sharedClipboardExpirationInMinutes=i.SharedClipboardExpirationInMinutes,t.wacCluster=i.MachineCluster,t},l:function(n){var t={};return t.clipboardStrategyType=n,t.localStorageStrategyParameters=this.i(5),t.systemClipboardStrategyParameters=this.f(0),t},f:function(n){var t={};return t.clipboardStrategyType=n,t.skipFilesIfPlainTextExists=!0,t},k:function(n){var t={};return t.clipboardStrategyType=n,t}};_Ewa.tm.b=function(){};_Ewa.tm.b.prototype={b:null,a:null};_Ewa.fF=function(n,t){this.n=n;this.o=t};_Ewa.fF.d=function(n,t,i,r,u,f,e,o,s,h){var c=n.d().a().b(h),l=function(t,h){return n.M(),_Ewa.oR.b(n.d().a(),i,r,u,_Ewa.n.a(t,e),_Ewa.n.b(h,o),f,c,s)},a=function(){return new _Ewa.MX(i,r,u)},v=new _Ewa.bh(506,0,l,1,a);n.g().a(v,t)};_Ewa.fF.a=function(n,t,i,r,u,f,e){var o,s;Diag.a.a(51668566,0,50,"CopyPasteInfrastructure.HandlePasteResult profiling trace: on HandlePasteResult start. pasteContext.Id={0}",t.id);t.requestTelemetryData=n.RequestTelemetryData;t.serverRequestTimeInMs=t.commandParameters.stopwatch.b()-u;_Ewa.h.d(n.Errors)?_Ewa.h.h(n.Errors)?(t&&(t.encounteredDeploymentErrors=!0),Diag.a.a(36538329,0,15,"CopyPasteUtils.HandlePasteServerResponse: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}",_Ewa.h.a(n.Errors,","))):r(new _Ewa.cy(5,n.Errors,null,"")):n.Result?(o=!!n&&!!n.RequestTelemetryData,_Ewa.b.a(f).v().g(t.commandParameters.stopwatch.c(),n.StateId,o?n.RequestTelemetryData.EcsOperationDuration:0,o?n.RequestTelemetryData.EcsRequestDuration:0,o?n.RequestTelemetryData.WfeRequestDuration:0),s=n.Result,t.PastedRange=s.SheetMultiRange,Diag.a.a(51668568,0,50,"CopyPasteInfrastructure.HandlePasteResult profiling trace: resolving promise ewaResult.Result is not null. pasteContext.Id={0}",t.id),i(!0)):(Diag.a.a(51668567,0,50,"CopyPasteInfrastructure.HandlePasteResult profiling trace: resolving promise when ewaResult.Result is null. pasteContext.Id={0}",t.id),i(e?e:!0))};_Ewa.fF.e=function(n,t,i,r,u,f,e,o,s,h,c){var a=n.d().a().b(!1),l=_Ewa.fF.c(i,r,s,h,c),v=function(t,i){return n.M(),_Ewa.kZ.b(n.d().a(),l,_Ewa.n.a(t,f),_Ewa.n.b(i,e),u,a,o)},y=function(){return new _Ewa.MW(l)},p=new _Ewa.bh(503,0,v,1,y);n.g().a(p,t)};_Ewa.fF.c=function(n,t,i,r,u){var f={};return f.ShadowWorkbookBase64=n.shadowWorkbookBase64,f.SourceRanges={},f.SourceRanges.Ranges=new Array(1),f.SourceRanges.Ranges[0]={},f.SourceRanges.Ranges[0].FirstRow=n.rangeRowStart,f.SourceRanges.Ranges[0].LastRow=n.rangeRowEnd,f.SourceRanges.Ranges[0].FirstColumn=n.rangeColumnStart,f.SourceRanges.Ranges[0].LastColumn=n.rangeColumnEnd,f.DestinationRanges=t?_Ewa.g.j(t):null,f.CopyPasteTargetType=1,f.PasteType=i,f.CopyOperationId=r,f.PasteId=u,f.SourceClientPath=n.sourceClientPath,f.SourceSheetName=n.sourceSheetName,f.SourceWorkbookName=n.sourceWorkbookName,f};_Ewa.fF.b=function(n,t,i){var r=i.g();return r.k()<t&&(r.c=Math.min(1048576,r.a+t-1)),r.n()<n&&(r.d=Math.min(16384,r.b+n-1)),r};_Ewa.fF.prototype={n:null,o:null,q:function(){return Diag.a.a(51505284,0,50,"CopyPasteUtils.MaxCopyPasteLength returning BootstrapContext.MaxCopyPasteLength. MaxCopyPasteLength={0}",this.n.e().MaxCopyPasteLength),this.n.e().MaxCopyPasteLength},g:function(n,t,i,r,u){var f=this.n.d().a().b(!1),e=this,o=function(o,s){var h={};return h.CopyPasteTargetType=1,h.SourceRanges=n,h.CopyOperationId=t.id,_Ewa.kZ.a(e.n.d().a(),h,_Ewa.n.a(o,i),r?_Ewa.n.b(s,r):s,t.ribbonCommandInfo,f,u)};this.n.g().a(new _Ewa.bh(505,0,o,16,null),t.ribbonCommandInfo)},j:function(n,t,i,r,u){var f=this;return new Promise(function(e,o){var c=u.commandParameters.stopwatch.b(),l=function(n){_Ewa.fF.a(n,u,e,o,c,f.n,null)},a=function(n){u.serverRequestTimeInMs=u.commandParameters.stopwatch.b()-c;var t=_Ewa.X.a(n.b);o(new _Ewa.cy(5,t,null,""))},s=2,h;u.commandParameters.commandType===20&&(s=16);u.commandParameters.commandType===36&&(s=32);_Ewa.o.q(f.n)&&u.commandParameters.commandType===68&&(s=64);_Ewa.o.o(f.n)&&u.commandParameters.commandType===1028&&(s=1024);h=null;u.copyContextSnapshot&&u.copyContextSnapshot.commandParameters&&(h=u.copyContextSnapshot.commandParameters.id);_Ewa.fF.e(f.n,n,i,t,null,l,a,r,s,h,u.commandParameters.id)})},e:function(n,t,i,r,u,f,e,o){var s=this;return new Promise(function(h,c){var l=e.commandParameters.stopwatch.b(),a=function(n){_Ewa.fF.a(n,e,h,c,l,s.n,null)},v=function(n){e.serverRequestTimeInMs=e.commandParameters.stopwatch.b()-l;var t=_Ewa.X.a(n.b);c(new _Ewa.cy(5,t,null,""))},y=r,p=-5&u,w=y|p;_Ewa.fF.d(s.n,n,t,i,w,null,a,v,f,o)})},k:function(n,t,i,r,u,f,e){var o=this;return new Promise(function(s,h){if(!t||!t.length)s("");else if(t.length>4194304)Diag.a.a(42071712,0,15,"CopyPasteInfrastructure.ProcessPasteHtml copy paste length too long. clipboardHtml.Length: {0}, MaxHtmlImportLength: {1}",t.length,4194304),h(new _Ewa.cy(1,null,null,""));else{var c=function(u,c){o.n.M();var a=e.commandParameters.stopwatch.b(),y=_Ewa.n.a(u,function(n){_Ewa.fF.a(n,e,s,h,a,o.n,t)}),p=_Ewa.n.b(c,function(n){e.serverRequestTimeInMs=e.commandParameters.stopwatch.b()-a;var t=_Ewa.X.a(n.b);h(new _Ewa.cy(3,t,null,""))}),w=o.n.d().a().b(!1),v=_Ewa.g.a(n,o.n),l={};return l.SourceHtml=t,l.DestinationRanges=v?_Ewa.g.j(v):null,l.CopyOperationId=i,l.PasteId=r,_Ewa.oR.a(o.n.d().a(),l,y,p,null,w,f)},l=new _Ewa.bh(204,0,c,1,null);o.n.g().a(l,u)}})},l:function(n,t,i,r,u){var f=this;return new Promise(function(e,o){var c,l,a,v,h,s,y,p,w,b;Diag.a.a(51505037,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: method start. pasteContext.Id={0}",u.id);!t||!t.length||(t=_Ewa.e.p(t,"\n","\r"));Diag.a.a(51505038,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: after clipboardText.TrimEnd. pasteContext.Id={0}",u.id);!t||!t.length?e(""):(c=f.q(),t.length>c?(Diag.a.a(24150921,0,15,"CopyPasteInfrastructure.ProcessPasteText copy paste length too long. clipboardText.Length: {0}, MaxCopyPasteLength: {1}",t.length,c),o(new _Ewa.cy(1,null,null,""))):(h=_Ewa.g.a(n,f.n),Diag.a.a(51505039,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before treatAsLink calculation. pasteContext.Id={0}",u.id),s=!f.n.c().b()&&t.indexOf("\n")===-1&&t.indexOf("\t")===-1,Diag.a.a(51505040,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before isLink check. pasteContext.Id={0}. treatAsLink={1}",u.id,s),s=s&&_Ewa.e.t(t),Diag.a.a(51505041,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: after treatAsLink calculation. pasteContext.Id={0}. treatAsLink={1}",u.id,s),y=f.n.d().a().b(!1),s?(v=526,Diag.a.a(51505042,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before FixUpUrl. pasteContext.Id={0}",u.id),p=_Ewa.bf.d(t,!0),Diag.a.a(51505043,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: after FixUpUrl. pasteContext.Id={0}",u.id),w=_Ewa.g.j(h),l=function(i,s){var h=u.commandParameters.stopwatch.b(),c=_Ewa.n.a(i,function(n){Diag.a.a(51668560,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: on ApplyHyperlink successCallback. pasteContext.Id={0}",u.id);u.requestTelemetryData=n.RequestTelemetryData;u.serverRequestTimeInMs=u.commandParameters.stopwatch.b()-h;n.Errors&&n.Errors.length>0?o(new _Ewa.cy(2,n.Errors,null,"")):e(t)}),l=_Ewa.n.b(s,function(n){u.serverRequestTimeInMs=u.commandParameters.stopwatch.b()-h;var t=_Ewa.X.a(n.b);o(new _Ewa.cy(2,t,null,""))});return f.n.M(),Diag.a.a(51668561,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before ApplyHyperlink. pasteContext.Id={0}",u.id),_Ewa.j.g(f.n.d().a(),w,t,p,!1,!1,63,c,l,n,y,r)},a=function(){return new _Ewa.nC(w,t,p)}):(v=180,l=function(n,i){f.n.M();var s=u.commandParameters.stopwatch.b(),c=_Ewa.n.a(n,function(n){Diag.a.a(51668562,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: on PasteString successCallback. pasteContext.Id={0}",u.id);_Ewa.fF.a(n,u,e,o,s,f.n,t)}),l=_Ewa.n.b(i,function(n){u.serverRequestTimeInMs=u.commandParameters.stopwatch.b()-s;var t=_Ewa.X.a(n.b);o(new _Ewa.cy(4,t,null,""))});return Diag.a.a(51668563,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before PasteString. pasteContext.Id={0}",u.id),_Ewa.oR.c(f.n.d().a(),h,t,c,l,null,y,r)},a=function(){return new _Ewa.MY(h,t)}),Diag.a.a(51668564,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before UserNonBlockingWebMethodOperation. pasteContext.Id={0}",u.id),b=new _Ewa.bh(v,0,l,1,a),Diag.a.a(51668565,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: returning. pasteContext.Id={0}",u.id),f.n.g().a(b,i)))})},d:function(n,t){if(this.n.isChangeGateEnabled("OfficeVSO:3799648_EnableRunningAntsInViewMode")||this.o.c().r()&16){var i=[t===1?4:5];this.o.k().d(_Ewa.cX.a(_Ewa.z.b(this.n.j()),n),i,!0,null,!0);this.o.k().c(i,null,null);this.o.k().f(!0,!0)}},b:function(){var n=[4,5];this.o.k().a(n);this.o.k().b(null,n,!0);this.o.a().c()===1&&this.o.dr(!1)},f:function(n,t,i){for(var e,u=[],f=i,o=f.length,r=0;r<o;++r)e=f[r],Array.add(u,this.p(n,t,e));return u},p:function(n,t,i){var f,v;Diag.a.b(595185887,0,!!t,"CopyPasteUtils.CalculateSingleImpactedRange: sourceArray shouldn't be null");Diag.a.b(595185886,0,t.length>0,"CopyPasteUtils.CalculateSingleImpactedRange: sourceArray length shouldn't be zero");for(var r=0,u=0,s=new($$sc.m.$$(String))($$sc.e.b()),h=new($$sc.m.$$(String))($$sc.e.b()),c=t,y=c.length,o=0;o<y;++o){var e=c[o],l=String.format("{0}_{1}",e.b,e.d),a=String.format("{0}_{1}",e.a,e.c);h.b(l)||(h.a(l),u+=e.n());s.b(a)||(s.a(a),r+=e.k())}if(36===n)return i.p()?_Ewa.fF.b(u,r,i):i.g();n===516&&(v=r,r=u,u=v);var p=!(i.n()%u)&&!(i.k()%r),w=i.H()&&!(i.n()%u),b=i.E()&&!(i.k()%r);return w||b?f=_Ewa.fF.b(u,r,i):p?f=i.g():(f=i.g(),f.c=Math.min(1048576,f.a+r-1),f.d=Math.min(16384,f.b+u-1)),f},c:function(n,t,i,r,u,f,e,o,s,h,c,l){var a,g,y,w,b;if(!r||!r.length)return 1;if(this.n.isChangeGateEnabled("OfficeVSO:4248574_DisableCCPMultipleRanges")&&(t&&t.length>1||r.length>1))return 10;if(r.length>1){if(f)return 3;if(c)return 0;if(s)return 9;if(h)return 8;if(l)return 2;if(t.length>1)return 4;if(a=t[0],g=this,!o&&!Common.P.b(r,function(n){return n.p()||!(n.n()%a.n())&&!(n.k()%a.k())}))return 5;if(_Ewa.e.b(n,i,!0))for(var k=u,nt=k.length,v=0;v<nt;++v)if(y=k[v],y.h(a)&&!y.f(a))return 6}else if(t&&t.length>0){if(o&&this.n.isChangeGateEnabled("OfficeVSO:4166482_DisablePasteFormattingMultipleRanges")&&t.length>1||e&&this.n.isChangeGateEnabled("OfficeVSO:4251353_DisablePasteFormulasMultipleRanges")&&t.length>1)return 10;if(this.h(t,h))return 7;if(t.length>1){if(f)return 3;if(_Ewa.e.b(n,i,!0))for(var d=t,tt=d.length,p=0;p<tt;++p)if(w=d[p],b=u[0],w.h(b)&&!w.f(b))return 6}}return 0},h:function(n,t){var u,i,f;if(!n||n.length<=1)return 0;if(this.n.isChangeGateEnabled("OfficeVSO:4248574_DisableCCPMultipleRanges")&&n.length>1)return 4;if(t)return 2;if(!_Ewa.g.D(n))return 1;u=new($$sc.m.$$(String))($$sc.e.a());for(var h=n,a=h.length,e=0;e<a;++e){i=h[e];for(var c=n,v=c.length,o=0;o<v;++o){var r=c[o],y=i.a===r.a&&i.c===r.c,p=i.b===r.b&&i.d===r.d,w=Math.max(i.a,r.a)<Math.min(i.c,r.c),b=Math.max(i.b,r.b)<Math.min(i.d,r.d);if(w&&!y||b&&!p)return 3;u.a(String.format("{0}-{1}-{2}-{3}",i.a,i.c,r.b,r.d));u.a(String.format("{0}-{1}-{2}-{3}",r.a,r.c,i.b,i.d))}}for(var l=n,k=l.length,s=0;s<k;++s)f=l[s],u.f(String.format("{0}-{1}-{2}-{3}",f.a,f.c,f.b,f.d));return u.e>0?3:0},m:function(n){var t=this.o.a();t.d(n,n.e(),0,0,!0,"",!1,!0,!0);t.s(-1)},a:function(n){if(n&&n.sourceItem){if(!_Ewa.fX.a(n.sourceItem))return null;var t=n.sourceItem;if(t&&_Ewa.g.u(t.a,!0))return t}return null},i:function(n,t){return(Diag.a.b(33863620,0,!!n,"CopyPasteUtils.IsFromKeyboardShortcut: commandInfo shouldn't be null"),t&&"SourceControlId"in t)?!1:n.d?!1:n.c===1}};_Ewa.tn=function(n){this.a=new _Ewa.v(!0);this.b=n};_Ewa.tn.prototype={b:null,d:function(n){if(this.a.d(n.id)||this.a.c(n.id,!0),this.a.a.length>0){var t=_Ewa.l.b(_Ewa.cQ,this.b.b(),5,4,0,null),i=this;_Ewa.f.cw(t,function(){t.a().a(27,null,null)},this.b.i(),3)}},c:function(n){var i=this.a.a.length>0,t,r;this.a.d(n.id)&&this.a.e(n.id);i&&!this.a.a.length&&(t=_Ewa.l.b(_Ewa.cQ,this.b.b(),5,4,0,null),r=this,_Ewa.f.cw(t,function(){t.a().b(27)},this.b.i(),3))}};_Ewa.Ec=function(n){this.l={"SourceItemType.Range":0,"SourceItemType.Art":1};this.d={};this.h={"FloatingObjectType.Unknown":99,"FloatingObjectType.CardView":6,"FloatingObjectType.Chart":0,"FloatingObjectType.Group":7,"FloatingObjectType.Image":1,"FloatingObjectType.Ink":8,"FloatingObjectType.InteractiveReport":4,"FloatingObjectType.ModernOfficeExtension":3,"FloatingObjectType.Shape":5,"FloatingObjectType.Slicer":2,"FloatingObjectType.Unsupported":100};this.e={"99":"FloatingObjectType.Unknown","6":"FloatingObjectType.CardView","0":"FloatingObjectType.Chart","7":"FloatingObjectType.Group","1":"FloatingObjectType.Image","8":"FloatingObjectType.Ink","4":"FloatingObjectType.InteractiveReport","3":"FloatingObjectType.ModernOfficeExtension","5":"FloatingObjectType.Shape","2":"FloatingObjectType.Slicer","100":"FloatingObjectType.Unsupported"};this.k={"RibbonCommand.Copy":-911352779,"RibbonCommand.Cut":-1985798686};this.f={"-911352779":"RibbonCommand.Copy","-1985798686":"RibbonCommand.Cut"};this.j={"InputManager.InputMethod.NotDefined":-1,"InputManager.InputMethod.Unknown":0,"InputManager.InputMethod.Keyboard":1,"InputManager.InputMethod.Mouse":2,"InputManager.InputMethod.Touch":3,"InputManager.InputMethod.CrossSlide":9};this.b={};this.i={"FrameMode.None":0,"FrameMode.Reading":1,"FrameMode.Edit":2};this.c={};this.m={"UILocation.Unknown":0,"UILocation.UpperRibbon":1,"UILocation.Ribbon":2,"UILocation.QAT":3,"UILocation.Jewel":4,"UILocation.NavigationPane":5,"UILocation.KeyboardShortcut":6,"UILocation.StatusBar":7,"UILocation.Dialog":8,"UILocation.Floatie":9,"UILocation.NotificationBar":10,"UILocation.StandaloneCuiRoot":11,"UILocation.TaskPane":12,"UILocation.HeroDock":13,"UILocation.ContextMenu":19,"UILocation.DialogMenu":20,"UILocation.Toolbar":26,"UILocation.Canvas":30};this.a={};this.g=n;this.b[Common.j.b.toString(-1)]="InputManager.InputMethod.NotDefined";this.b[Common.j.b.toString(0)]="InputManager.InputMethod.Unknown";this.b[Common.j.b.toString(1)]="InputManager.InputMethod.Keyboard";this.b[Common.j.b.toString(2)]="InputManager.InputMethod.Mouse";this.b[Common.j.b.toString(3)]="InputManager.InputMethod.Touch";this.b[Common.j.b.toString(9)]="InputManager.InputMethod.CrossSlide";this.c[Common.bu.toString(0)]="FrameMode.None";this.c[Common.bu.toString(1)]="FrameMode.Reading";this.c[Common.bu.toString(2)]="FrameMode.Edit";this.a[Common.K.toString(0)]="UILocation.Unknown";this.a[Common.K.toString(1)]="UILocation.UpperRibbon";this.a[Common.K.toString(2)]="UILocation.Ribbon";this.a[Common.K.toString(3)]="UILocation.QAT";this.a[Common.K.toString(4)]="UILocation.Jewel";this.a[Common.K.toString(5)]="UILocation.NavigationPane";this.a[Common.K.toString(6)]="UILocation.KeyboardShortcut";this.a[Common.K.toString(7)]="UILocation.StatusBar";this.a[Common.K.toString(8)]="UILocation.Dialog";this.a[Common.K.toString(9)]="UILocation.Floatie";this.a[Common.K.toString(10)]="UILocation.NotificationBar";this.a[Common.K.toString(11)]="UILocation.StandaloneCuiRoot";this.a[Common.K.toString(12)]="UILocation.TaskPane";this.a[Common.K.toString(13)]="UILocation.HeroDock";this.a[Common.K.toString(19)]="UILocation.ContextMenu";this.a[Common.K.toString(20)]="UILocation.DialogMenu";this.a[Common.K.toString(26)]="UILocation.Toolbar";this.a[Common.K.toString(30)]="UILocation.Canvas";this.d[_Ewa.gf.toString(0)]="SourceItemType.Range";this.d[_Ewa.gf.toString(1)]="SourceItemType.Art"};_Ewa.Ec.prototype={g:null,serializeSourceItem:function(n){var t={},i,u,f,e,o,r;if(n&&Object.getType(n)===_Ewa.jd)i=n,t.sheetName=i.b,u=this,t.topArray=_Ewa.bw.d(i.a,function(n){return n.a}),f=this,t.leftArray=_Ewa.bw.d(i.a,function(n){return n.b}),e=this,t.bottomArray=_Ewa.bw.d(i.a,function(n){return n.c}),o=this,t.rightArray=_Ewa.bw.d(i.a,function(n){return n.d}),t.sessionStateId=i.e,t.sessionId=i.d,t.sourceItemType=this.n(0);else if(n&&Object.getType(n)===_Ewa.hy)r=n,t.activeFloatingObjectControlId=r.a,t.sheetName=r.f,t.sessionStateId=r.e,t.sessionId=r.d,t.floatingObjectType=this.w(r.b),t.sourceItemType=this.n(1);else return Diag.a.b(25217025,0,!1,"EnvironmentSerializationHelper.SerializeSourceItem: sourceItem shouldn't be null."),null;return JSON.stringify(t)},serializeCommandParameters:function(n){if(!n)return Diag.a.b(25217024,0,!1,"EnvironmentSerializationHelper.Serialize: commandParameters shouldn't be null."),null;var t={};return t.id=n.id,t.commandType=n.commandType,t.copyPasteTargetType=n.copyPasteTargetType,n.ribbonCommandInfo&&(t.ribbonCommandName=this.z(n.ribbonCommandInfo.a),t.inputMethodName=this.y(n.ribbonCommandInfo.c),t.frameModeName=this.x(n.ribbonCommandInfo.e),t.uiLocationName=this.A(n.ribbonCommandInfo.b),t.tabName=n.ribbonCommandInfo.d),JSON.stringify(t)},deserializeSourceItem:function(n){var t,i;if(!n||!n.length)return null;try{if(t=JSON.parse(n),!t)return Diag.a.b(38847437,0,!1,"EnvironmentSerializationHelper.Deserialize: Json.Parse return null result."),null;i=null;switch(this.u(t.sourceItemType)){case 0:i=new _Ewa.jd(this.g,this.r(t),t.sheetName,t.sessionStateId,t.sessionId);break;case 1:i=new _Ewa.hy(t.activeFloatingObjectControlId,t.sheetName,t.sessionStateId,t.sessionId,this.o(t.floatingObjectType))}return i}catch(r){return Diag.a.a(38847438,0,10,"EnvironmentSerializationHelper.DeserializeSourceItem: got exception while try to JSON.Parse string length: {0}, errror: {1}",n?n.length:0,r),null}},deserializeCommandParameters:function(n){var t,i;if(!n||!n.length)return null;try{return(t=JSON.parse(n),!t)?(Diag.a.b(38847439,0,!1,"EnvironmentSerializationHelper.DeserializeCommandParameters: Json.Parse return null result."),null):(i=_Ewa.gr.b(),i.id=t.id,i.ribbonCommandInfo=this.t(t),i.commandType=t.commandType,i.copyPasteTargetType=t.copyPasteTargetType,i)}catch(r){return Diag.a.a(38847440,0,10,"EnvironmentSerializationHelper.DeserializeCommandParameters: got exception while try to JSON.Parse string length: {0}, errror: {1}",n?n.length:0,r),null}},r:function(n){var i=[],r,t;if(Diag.a.b(595185885,0,!!n.topArray&&n.topArray.length>0,"EnvironmentSerializationHelper.DeserializeRanges: TopArray shouldn't be {0}.",n.topArray?"empty":"null"),Diag.a.b(595185884,0,!!n.leftArray&&n.leftArray.length>0,"EnvironmentSerializationHelper.DeserializeRanges: LeftArray shouldn't be {0}.",n.leftArray?"empty":"null"),Diag.a.b(595185883,0,!!n.bottomArray&&n.bottomArray.length>0,"EnvironmentSerializationHelper.DeserializeRanges: BottomArray shouldn't be {0}.",n.bottomArray?"empty":"null"),Diag.a.b(595185882,0,!!n.rightArray&&n.rightArray.length>0,"EnvironmentSerializationHelper.DeserializeRanges: RightArray shouldn't be {0}.",n.rightArray?"empty":"null"),!n.topArray||!n.leftArray||!n.bottomArray||!n.rightArray)return i;for(Diag.a.b(595185881,0,n.topArray.length===n.bottomArray.length&&n.topArray.length===n.leftArray.length&&n.topArray.length===n.rightArray.length,"EnvironmentSerializationHelper.DeserializeRanges: The length of TopArray({0}), BottomArray({1}), LeftArray({2}), RightArray({3}) should be the same.",n.topArray.length,n.bottomArray.length,n.leftArray.length,n.rightArray.length),r=Math.min(n.topArray.length,n.bottomArray.length,n.leftArray.length,n.rightArray.length),t=0;t<r;t++)Array.add(i,new _Ewa.p(n.topArray[t],n.leftArray[t],n.bottomArray[t],n.rightArray[t],!1,!1));return i},t:function(n){return new _Ewa.R(this.s(n.ribbonCommandName),this.q(n.inputMethodName),this.p(n.frameModeName),this.v(n.uiLocationName),n.tabName)},z:function(n){return isNullOrUndefined(n)||!(n.toString()in this.f)?(Diag.a.b(25217028,0,!1,"EnvironmentSerializationHelper.SerializeRibbonCommand expected to get RibbonCommand.Copy({0}) or RibbonCommand.Cut({1}) but got {2}",-911352779,-1985798686,n),this.f["-911352779"]):this.f[n.toString()]},s:function(n){return!n||!n.length||!(n in this.k)?(Diag.a.b(25217029,0,!1,"EnvironmentSerializationHelper.DeserializeRibbonCommand: expected to get RibbonCommand.Copy({0}) or RibbonCommand.Cut({1}) but got {2}",-911352779,-1985798686,n),-911352779):this.k[n]},y:function(n){return isNullOrUndefined(n)||!(Common.j.b.toString(n)in this.b)?(Diag.a.b(25217030,0,!1,"EnvironmentSerializationHelper.SerializeInputMethod: got unexpected value {0}",n),this.b[Common.j.b.toString(0)]):this.b[Common.j.b.toString(n)]},q:function(n){return!n||!n.length||!(n in this.j)?(Diag.a.b(25217031,0,!1,"EnvironmentSerializationHelper.DeserializeInputMethod: got unexpected value {0}",n),0):this.j[n]},x:function(n){return isNullOrUndefined(n)||!(Common.bu.toString(n)in this.c)?(Diag.a.b(25217032,0,!1,"EnvironmentSerializationHelper.SerializeFrameMode: got unexpected value {0}",n),this.c[Common.bu.toString(2)]):this.c[Common.bu.toString(n)]},p:function(n){return!n||!n.length||!(n in this.i)?(Diag.a.b(25217033,0,!1,"EnvironmentSerializationHelper.DeserializeFrameMode: got unexpected value {0}",n),2):this.i[n]},n:function(n){return isNullOrUndefined(n)||!(_Ewa.gf.toString(n)in this.d)?(Diag.a.b(25217034,0,!1,"EnvironmentSerializationHelper.SerializeSourceItemType: got unexpected value {0}",n),this.d[_Ewa.gf.toString(0)]):this.d[_Ewa.gf.toString(n)]},u:function(n){return!n||!n.length||!(n in this.l)?(Diag.a.b(25217035,0,!1,"EnvironmentSerializationHelper.DeserializeSourceItemType: got unexpected value {0}",n),0):this.l[n]},w:function(n){return isNullOrUndefined(n)||!(n.toString()in this.e)?(Diag.a.b(36229127,0,!1,"EnvironmentSerializationHelper.SerializeArtSourceItemType: got unexpected value {0}",n),this.e["99"]):this.e[n.toString()]},o:function(n){return!n||!n.length||!(n in this.h)?(Diag.a.b(36229128,0,!1,"EnvironmentSerializationHelper.DeserializeArtSourceItemType: got unexpected value {0}",n),99):this.h[n]},A:function(n){return isNullOrUndefined(n)||!(Common.K.toString(n)in this.a)?(Diag.a.b(36229129,0,!1,"EnvironmentSerializationHelper.SerializeUILocation: got unexpected value {0}",n),this.a[Common.K.toString(2)]):this.a[Common.K.toString(n)]},v:function(n){return!n||!n.length||!(n in this.m)?(Diag.a.b(36229130,0,!1,"EnvironmentSerializationHelper.DeserializeUILocation: got unexpected value {0}",n),2):this.m[n]}};_Ewa.Ed=function(n){this.a=n};_Ewa.Ed.prototype={a:null,c:null,b:null,e:function(){var n,t;return this.c||(n=this.a.b().a(_Ewa.dg,254,!0,null),n&&(t=n,this.c=new _Ewa.DZ(this.a,t,new _Ewa.tk,null))),this.c},d:function(){var t,n;return this.b||(t=this.a.b().a(_Ewa.dg,254,!0,null),t&&(n=new _Ewa.Ea(this.a),this.b=new _Ewa.tj(this.a,new _Ewa.tk,new _Ewa.mH(this.a,n),n,null))),this.b},getCopyFlowHandler:function(n){var t=this.g(_Ewa.b.a(this.a).bY());return n.commandParameters.copyPasteHandlerName=t.a(),t},getPasteFlowHandler:function(n){var t=n.copyContextSnapshot,i=null;return i=_Ewa.cD.d(n)?this.d():_Ewa.cD.b(n)?this.e():t&&t.sourceItem&&Object.getType(t.sourceItem)===_Ewa.hy?this.d():this.e(),n.commandParameters.copyPasteHandlerName=i.b(),i},initializePasteContext:function(n){var r,e,o;if(n&&(n.isSameSession=!1,n.isShadowWorkbookParsedSuccessfully=!1,n.pasteResult="Undefined",n.payloadOrigin="Undefined",n.payloadType="Undefined",n.encounteredDeploymentErrors=!1,n.shadowWorkbookSizeExceedsLimit=!1,n.activeSelectionType=this.f(),n.indicationDisplayed=!1,n.pasteIndicationDisplayStatus="DisplayNotInvoked",n.copyContextSnapshot)){var t=n.copyContextSnapshot,u=_Ewa.fX.a(t.sourceItem),s=_Ewa.fX.b(t.sourceItem),i=0,f=!1;u?(r=t.sourceItem,n.isSameSession=r.c(this.a),i=1,f=this.h(r,n)):s&&(e=t.sourceItem,n.isSameSession=e.c(this.a),i=2);n.copyContextSnapshot.commandParameters&&(o=t.commandParameters.ribbonCommandInfo.a===-1985798686,n.commandParameters.clearSystemClipboard=_Ewa.lp.b(t,this.a)&&o&&u&&!f,n.commandParameters.copyPasteTargetType=i)}},getSessionId:function(){return this.a.e().UserSessionId},h:function(n,t){var u=this,f=this,i=_Ewa.bw.b(n.a,function(n){return n.m()})&&_Ewa.bw.b(t.commandParameters.originalDestinations,function(n){return n.a!==1}),e=this,o=this,r=_Ewa.bw.b(n.a,function(n){return n.j()})&&_Ewa.bw.b(t.commandParameters.originalDestinations,function(n){return n.b!==1});return r||i},g:function(n){switch(n){case 1:return this.e();case 64:case 4:case 2:case 256:return this.d();default:throw Error.invalidOperation("Unsupported selection");}},f:function(){return _Ewa.b.a(this.a).a().c()&470?"FloatingObject":_Ewa.b.a(this.a).a().c()===1?"Cells":"Unknown"}};_Ewa.to=function(n){this.d=Function.createDelegate(this,this.bc);_Ewa.to.initializeBase(this,[n,null,!1,!1,!1,!1])};_Ewa.to.a=function(){return{ShiftCellsRight:!1,ShiftCellsDown:!0}};_Ewa.to.prototype={b:null,e:null,R:null,Y:function(n){this.p=_Ewa.oS.b(n);this.b=new($$sc.D.$$(_Ewa.oB));var t=_Ewa.ClientStringManager.a().a(15),i=_Ewa.to.a();return this.j(t,this.d,i),this.Z(),this.b.a},bc:function(n,t){if(n===1){var i=1;t.ShiftCellsRight&&(i=0);Diag.a.a(25518408,0,50,"InsertCopiedCutDialog OK button pressed with valid input, shift direction = {0}",i?"Vertical":"Horizontal");this.b.b(i)}else Diag.a.a(25518409,0,50,"InsertCopiedCutDialog cancel button pressed"),this.i(),this.b.e()},Z:function(){this.e=document.getElementById("ShiftCellsDown");this.R=document.getElementById("ShiftCellsRight")}};_Ewa.Ee=function(){};_Ewa.Ee.prototype={a:function(n,t){var i=new _Ewa.to(n);return i.Y(t)}};_Ewa.jD=function(n){this.e=Function.createDelegate(this,this.j);this.d=_Ewa.b.a(n);this.d.c().a(948)?this.d.a().m(this.e):this.d.a().e(this.e);this.d.a().C(this.e)};_Ewa.jD.prototype={d:null,h:"",f:null,i:null,g:!1,b:function(n){if(!this.g){Diag.a.a(592528332,0,50,"PasteIndicationManager.DownloadPrerequisitesIfNeeded: Trying to get appChrome");var t=this;this.d.c().X(function(i){i.a(n).then(function(){t.g=!0})})}},c:function(n){var t=n.commandParameters.id,i,r;Diag.a.a(593781649,0,50,"PasteIndicationManager.ScheduleDisplay: pasteCommandId = {0}, cancelCtx is null = {1}, PrerequisitesDownloaded = {2}",t,!this.f,this.g);this.b(0);this.h=t;i=!_Ewa.g.m(this.d.a().a().c(),this.i);(!this.f||i)&&(this.k(),r=this,this.f=_Ewa.x.a().a(function(){r.m(n)},100,_Ewa.m.bK,!0,!1));this.i=n.commandParameters.originalDestinations},m:function(n){this.g?(this.l(n.commandParameters.originalDestinations),n.pasteIndicationDisplayStatus="Displayed"):(Diag.a.a(592528331,0,50,"PasteIndicationManager.DisplayIfPossible: Prerequisites were not ready, skipping display"),this.j(null,null),n.pasteIndicationDisplayStatus="PrerequisitesNotReady")},l:function(n){Diag.a.a(593781648,0,50,"PasteIndicationManager.Display: started");this.d.k().d(_Ewa.cX.a(_Ewa.z.b(this.d.c().j()),n),_Ewa.jD.a,!0,null,!0);this.d.k().c(_Ewa.jD.a,null,null)},a:function(n){Diag.a.a(593781647,0,50,"PasteIndicationManager.HideForPasteId: pasteCommandId = {0}, currentPasteCommandId = {1}",n,this.h);n&&_Ewa.e.b(n,this.h,!1)&&this.j(null,null)},j:function(){this.h="";this.k();this.i=null;this.d.k().a(_Ewa.jD.a);this.d.k().b(null,_Ewa.jD.a,!0)},k:function(){this.f&&(System.a.a(this.f),this.f=null)},dispose:function(){this.j(null,null);this.d.c().a(948)?this.d.a().n(this.e):this.d.a().f(this.e);this.d.a().F(this.e)}};_Ewa.kZ=function(){};_Ewa.kZ.a=function(n,t,i,r,u,f,e){var o=n.a(1,f);return o.copyParameters=t,_Ewa.j.a(n,"Copy",o,i,r,u,0,e)};_Ewa.kZ.c=function(n,t,i,r,u,f,e){var o=n.a(1,f);return o.copyParameters=t,_Ewa.j.a(n,"Cut",o,i,r,u,0,e)};_Ewa.kZ.b=function(n,t,i,r,u,f,e){var o=n.a(1,f);return o.pasteParameters=t,_Ewa.j.a(n,"Paste",o,i,r,u,64,e)};_Ewa.Ju=function(){};_Ewa.Ju.a=function(n,t,i,r,u,f){var e=n.a(41,f);return e.insertCopiedCutCellsParameters=t,_Ewa.j.a(n,"InsertCopiedCutCells",e,i,r,u,4,null)};_Ewa.MX.registerClass("_Ewa.MX");_Ewa.MY.registerClass("_Ewa.MY");_Ewa.Nh.registerClass("_Ewa.Nh");_Ewa.ZH.registerClass("_Ewa.ZH");_Ewa.ZI.registerClass("_Ewa.ZI",_Ewa.ZH);_Ewa.DZ.registerClass("_Ewa.DZ",_Ewa.ZI);_Ewa.tj.registerClass("_Ewa.tj",_Ewa.ZH);_Ewa.cj.registerClass("_Ewa.cj",_Ewa.ci,_Ewa.dg,_Ewa.bdA,Sys.IDisposable);_Ewa.tm.registerClass("_Ewa.tm",_Ewa.qV.$$(_Ewa.dg));_Ewa.to.registerClass("_Ewa.to",_Ewa.FD);_Ewa.oS.a="<div class='WACDialogRow' id='labelRow'> <label id='labelId' class='WACDialogLabel' >{0}<\/label> <\/div> <div class='WACDialogRowNoBreak' id='RightRow'> <input type='radio' id='ShiftCellsRight' name='ShiftOptions' class='WACDialogRadio' alt='{1}' title='{1}'><\/input> <label id='ShiftRight' class='WACDialogLabel' for='ShiftCellsRight' >{1}<\/label> <\/div> <div class='WACDialogRowNoBreak' id='DownRow'> <input type='radio' id='ShiftCellsDown' name='ShiftOptions' class='WACDialogRadio' alt='{2}' title='{2}'><\/input> <label id='ShiftDown' class='WACDialogLabel' for='ShiftCellsDown' >{2}<\/label> <\/div>";_Ewa.cj.h=[1352631530,1679665408];_Ewa.cj.d=[-103190598];_Ewa.cj.g=[1306609195];_Ewa.cj.e=[-386183710];_Ewa.cj.f=[563945982];_Ewa.cj.b=null;_Ewa.jD.a=[30];Type.registerNamespace("_Ewa");_Ewa.ZJ=function(){};_Ewa.ZJ.a=function(){_Ewa.k.a(function(n){_Ewa.tm.a(n)})};_Ewa.ZJ.a();