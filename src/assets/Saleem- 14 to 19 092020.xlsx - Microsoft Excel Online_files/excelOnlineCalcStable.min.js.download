var excelOnlineCalc=function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=7)}([function(e,t,r){"use strict";r.d(t,"c",(function(){return a})),r.d(t,"a",(function(){return i})),r.d(t,"e",(function(){return o})),r.d(t,"b",(function(){return u})),r.d(t,"d",(function(){return c})),r.d(t,"f",(function(){return s}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function a(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function o(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r}function u(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function u(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,u)}c((n=n.apply(e,t||[])).next())}))}function c(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}}function s(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),a=0;for(t=0;t<r;t++)for(var i=arguments[t],o=0,u=i.length;o<u;o++,a++)n[a]=i[o];return n}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(9);t.utils=n;var a=r(10);t.ULS=a.ULS,t.TraceLevel=a.TraceLevel,t.LogCategory=a.LogCategory,t.NulLogger=a.NulLogger,t.ConsoleLogger=a.ConsoleLogger;var i=r(11);t.browserSupport=i;var o=r(12);t.perfWatch=o;var u=r(13);t.initEwaUtils=u.initEwaUtils,t.ewaUtils=u.ewaUtils;var c=r(14);t.initStopwatchFactory=c.initStopwatchFactory;var s=r(15);t.getNewGuid=s.getNewGuid;var l=r(16);t.TextAreaVirtualKeyboardPolicy=l.TextAreaVirtualKeyboardPolicy,t.TextAreaInputMode=l.TextAreaInputMode},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5);t.mathpack=n;var a=r(20);t.dtr=a,r(4)._start()},function(e,t,r){"use strict";r.r(t);var n=r(0);function a(e){return o(e)&&"WorkerError"===e.name&&"object"==typeof e.info}var i=function(e){function t(t,r){var n=this.constructor,a=e.call(this,t)||this;a.info=r,a.name="WorkerError";var i=n.prototype;return Object.getPrototypeOf(a)!==i&&(null!=Object.setPrototypeOf?Object.setPrototypeOf(a,i):a.__proto__=i),a}return Object(n.c)(t,e),t.isWorkerError=a,t}(Error);function o(e){if(null==e)return!1;if(e instanceof Error)return!0;var t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}function u(e){return o(e)?e:new Error("(non-Error object) "+e)}var c={Error:Error,EvalError:EvalError,RangeError:RangeError,ReferenceError:ReferenceError,SyntaxError:SyntaxError,TypeError:TypeError,URIError:URIError};function s(e){return{name:e.name,message:e.message,stack:e.stack,info:a(e)?(t=e.info,Object(n.a)(Object(n.a)({},t),{error:t.error?s(t.error):void 0})):void 0};var t}function l(e){return o(e)?{isError:!0,value:s(e)}:{isError:!1,value:e}}function f(e){var t;if("WorkerError"===e.name)t=new i(e.message,function(e){return Object(n.a)(Object(n.a)({},e),{error:e.error?f(e.error):void 0})}(e.info));else{var r=c[e.name];r?t=new r(e.message):(t=new Error(e.message)).name=e.name}return null!=e.stack&&(t.stack=e.stack),t}function d(e){return e.isError?f(e.value):e.value}function h(e,t){return e.then((function(e){return t(),e}),(function(e){return t(),Promise.reject(e)}))}function v(e,t,r){if(e>1<<30)return r;var n=setTimeout(t,Math.max(0,e));return{resolve:function(e){clearTimeout(n),r.resolve(e)},reject:function(e){clearTimeout(n),r.reject(e)}}}function p(){var e=Object.create(null);return e.key=void 0,delete e.key,e}function m(e,t){var r=p(),n=function(t,r){var n;return null!=(n=t[r])?n:t[r]=e(r)};return t?(t.forEach((function(e){return n(r,e)})),r):new Proxy(r,{get:n})}function g(){return"undefined"!=typeof self&&"__typed_workers_thread"in self?self:void 0}var C;function S(){return"undefined"!=typeof Blob&&"undefined"!=typeof URL&&void 0!==URL.createObjectURL&&void 0!==URL.revokeObjectURL&&"undefined"!=typeof Worker}function y(e){if(C)throw new TypeError("setConfig has already been called");C=e}function E(){var e=null!=C?C:{};return{createTimeout:e.createTimeout,createMode:e.createMode,importScriptUrls:e.importScriptUrls?Object(n.f)(e.importScriptUrls):void 0,typedWorkersUrl:e.typedWorkersUrl,typedWorkersName:e.typedWorkersName}}function O(e,t){var r,n=null!=(r=t.stack)?r:t.message;console.warn(e+": "+n),a(t)&&console.warn("WorkerError info:",t.info)}function k(e){if(g()){var t={kind:1,error:l(e)};self.postMessage(t)}else O("defaultOnWorkerError",e)}function A(e){var t,r;try{(null!=(r=null===(t=C)||void 0===t?void 0:t.onWorkerError)?r:k)(e)}catch(t){O("dispatchWorkerError",u(t)),O("dispatchWorkerError (original)",e)}}function b(e){if(g()){var t={kind:2,stats:e};self.postMessage(t)}}function R(e){var t,r;try{(null!=(r=null===(t=C)||void 0===t?void 0:t.onCreateWorker)?r:b)(e)}catch(e){O("dispatchCreateWorker",u(e))}}var I=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return I.transfer.apply(I,Object(n.f)([e,void 0],t))};I.transfer=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return{def:e,args:r,transferables:null!=t?t:[]}};var T=-1,N=function(){function e(e,t){var r,n,a=this;this.idInfo=e,this.port=t,this.isClosed=!1,this.exports={},this.unresolvedCalls=p();var i=function(){var e,t;return null===(t=(e=a).onClose)||void 0===t?void 0:t.call(e)},o=((r={})[0]=this.onInvoke.bind(this),r[1]=this.onResult.bind(this),r[2]=function(e){var t,r,n=e.funcNames;null===(r=(t=a).onImports)||void 0===r||r.call(t,m(a.createPostProxy.bind(a),n),m(a.createCallProxy.bind(a),n))},r[3]=i,r),u=((n={})[0]=this.onSendInvokeFailed.bind(this),n[1]=this.onSendResultFailed.bind(this),n[2]=i,n[3]=i,n);this.port.onmessage=function(e){var t=e.data;return o[t.kind](t)},this.port.onmessageerror=function(e){var t=e.data;return u[t.kind](t)}}return e.prototype.setExports=function(e){this.exports=e;var t={kind:2,funcNames:"function"==typeof Proxy?void 0:function(e){for(var t=p();null!=e;){for(var r=0,n=Object.getOwnPropertyNames(e);r<n.length;r++){var a=n[r];try{"function"==typeof e[a]&&(t[a]=!0)}catch(e){}}e=Object.getPrototypeOf(e)}return Object.getOwnPropertyNames(t)}(e)};this.port.postMessage(t)},e.prototype.close=function(){if(!this.isClosed){this.isClosed=!0;for(var e in this.port.postMessage({kind:3}),this.port.close(),this.unresolvedCalls){var t=this.unresolvedCalls[e],r=t.reject,n=t.funcName,a={cause:"Connection",idInfo:this.idInfo,funcName:n};r(new i("Importing Endpoint closed while waiting for "+n+" result",a))}}},e.prototype.onInvoke=function(e){var t=this,r=e.callId,n=e.funcName,a=e.args,o=Promise.resolve().then((function(){var e=t.exports[n];if(e)return e.apply(t.exports,a);var o=r>=0?"call":"post",u={cause:"Connection",idInfo:t.idInfo,callId:r,funcName:n};throw new i("Exporting Endpoint received a "+o+" to unknown function "+n,u)}));r>=0?o.then((function(e){return t.sendResult(r,n,!0,e)}),(function(e){return t.sendResult(r,n,!1,e)})):o.catch((function(e){return t.sendResult(r,n,!1,e)}))},e.prototype.sendResult=function(e,t,r,n){var a={kind:1,callId:e,funcName:t,isFulfilled:r,resultValue:l(n)};try{this.port.postMessage(a,void 0)}catch(e){this.onSendResultFailed(a,u(e))}},e.prototype.onSendResultFailed=function(e,t){var r=e.callId,n=e.funcName,a=e.resultValue,o=t?"Exporting Endpoint failed to send "+n+" result":"Importing Endpoint failed to deserialize "+n+" result",u={cause:"MessageError",idInfo:this.idInfo,error:t,callId:r,funcName:n},c=new i(o,u);a.isError?A(c):this.sendResult(r,n,!1,c)},e.prototype.takeCallbacks=function(e){var t=this.unresolvedCalls[e];return t&&delete this.unresolvedCalls[e],t},e.prototype.setCallTimeout=function(e,t,r,n){var a=this;if(r>1<<30)return n;return v(r,(function(){var n=a.takeCallbacks(e);if(n){var o={cause:"Timeout",idInfo:a.idInfo,timeout:r,callId:e,funcName:t};n.reject(new i("Importing Endpoint's call to "+t+" timed out",o))}}),n)},e.prototype.sendCall=function(e,t,r,a){var o=this;return new Promise((function(c,s){var l=T+=1,f={kind:0,callId:l,funcName:e,args:t};o.unresolvedCalls[l]=Object(n.a)(Object(n.a)({},o.setCallTimeout(l,e,r,{resolve:c,reject:s})),{funcName:e});try{o.port.postMessage(f,a)}catch(t){var d=o.takeCallbacks(l);if(d){var h=u(t),v={cause:"MessageError",idInfo:o.idInfo,error:h,callId:l,funcName:e};d.reject(new i("Importing Endpoint failed to send call to "+e,v))}}}))},e.prototype.sendPost=function(e,t,r){var n={kind:0,callId:-1,funcName:e,args:t};try{this.port.postMessage(n,r)}catch(t){var a=u(t),o={cause:"MessageError",idInfo:this.idInfo,error:a,callId:-1,funcName:e};throw new i("Importing Endpoint failed to post to "+e,o)}},e.prototype.onSendInvokeFailed=function(e){var t,r,n=e.callId,a=e.funcName,o=n>=0?"call":"post",u={cause:"MessageError",idInfo:this.idInfo,callId:n,funcName:a},c=new i("Exporting Endpoint failed to deserialize "+o+" to "+a,u);(null!=(r=null===(t=n>=0?this.takeCallbacks(n):void 0)||void 0===t?void 0:t.reject)?r:A)(c)},e.prototype.onResult=function(e){var t=e.callId,r=e.funcName,n=e.isFulfilled,a=e.resultValue;if(t>=0){var o=this.takeCallbacks(t);if(o)(n?o.resolve:o.reject)(d(a))}else if(!n){var u=a.isError?f(a.value):void 0,c={cause:"UnhandledError",idInfo:this.idInfo,error:u,callId:t,funcName:r};A(new i("Exporting Endpoint's "+r+" implementation threw or rejected",c))}},e.prototype.createPostProxy=function(e){var t=this,r=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.transfer.apply(r,Object(n.f)([void 0],e))};return r.transfer=function(r){for(var n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];t.isClosed||t.sendPost(e,n,r)},r},e.prototype.createCallProxy=function(e){var t=this,r=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.transfer.apply(r,Object(n.f)([void 0],e))};return r.transfer=function(n){for(var a,o,u,c,s=[],l=1;l<arguments.length;l++)s[l-1]=arguments[l];if(t.isClosed){var f={cause:"Connection",idInfo:t.idInfo,funcName:e};return Promise.reject(new i(t.idInfo.side+" Endpoint's call."+e+" called after close",f))}var d=null!=(c=null!=(a=r.timeout)?a:null===(u=(o=t).getCallTimeout)||void 0===u?void 0:u.call(o))?c:1/0;return t.sendCall(e,s,d,n)},r.timeout=void 0,r},e}();var F,_=function(){function e(e,t,r){this.callTimeout=1/0,this._idInfo=e,this._state=t,this.createMode=r;var n=function(t){return function(){var r="Outside"===e.side?"inside":"outside",n={cause:"Connection",idInfo:e};throw new i(e.side+" Endpoint's "+t+" referenced before the "+r+" Endpoint started",n)}};Object.defineProperties(this,{post:{configurable:!0,enumerable:!1,get:n("post")},call:{configurable:!0,enumerable:!1,get:n("call")}})}return e._create=function(t,r,n){var a,o,u,c=r.port,s=r.options,l=r.createMode,f={type:"Endpoint",side:t,id:null===(a=s)||void 0===a?void 0:a.id};try{o=new N(f,c),u=new e(f,o,l)}catch(e){return Promise.reject(e)}return new Promise((function(e,r){var a;o.getCallTimeout=function(){return u.callTimeout},o.onImports=function(e,t){Object.defineProperties(u,{post:{configurable:!0,enumerable:!1,writable:!1,value:e},call:{configurable:!0,enumerable:!1,writable:!1,value:t}}),d.resolve()},o.onClose=function(){return u.close("Force")};var c,l=function(e){var t,r,n,a;return null!=(a=null!=(r=null===(t=e)||void 0===t?void 0:t.createTimeout)?r:null===(n=C)||void 0===n?void 0:n.createTimeout)?a:3e5}(s),d=v(l,(function(){var e=new i(t+" Endpoint timed out waiting for the "+("Outside"===t?"inside":"outside")+" to start",{cause:"Timeout",idInfo:f,timeout:l});d.reject(e)}),{resolve:e,reject:r});u._closedDuringCreate=function(){d.resolve()};try{c=n(u)}catch(e){return d.reject(e)}null===(a=u._state)||void 0===a||a.setExports(c)})).then((function(){return u._closedDuringCreate=void 0,u}),(function(e){return u._closedDuringCreate=void 0,u.close(),Promise.reject(e)}))},e.prototype.hasBeenClosed=function(){return void 0===this._state},e.prototype.close=function(e){var t,r;if(this._state){if(this._closedDuringCreate){if("Force"!==e){var n={cause:"Connection",idInfo:this._idInfo};throw new i(this._idInfo.side+" Endpoint's close called during creation",n)}this._closedDuringCreate()}var a=this._state;this._state=void 0;try{a.close(),null===(t=this._onClose)||void 0===t||t.call(this),null===(r=this.onClose)||void 0===r||r.call(this)}catch(e){n={cause:"Connection",idInfo:this._idInfo,error:u(e)};A(new i(this._idInfo.side+" Endpoint's close threw an error",n))}}},e.createOutside=function(t,r){return void 0===r&&(r=function(){}),e._create("Outside",t,r)},e.createInside=function(t,r){return e._create("Inside",t,r).then((function(){}))},e}(),M=function(){!function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){r.r(t);
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};var a=function(){return(a=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function i(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),a=0;for(t=0;t<r;t++)for(var i=arguments[t],o=0,u=i.length;o<u;o++,a++)n[a]=i[o];return n}function o(e){return u(e)&&"WorkerError"===e.name&&"object"==typeof e.info}!function(e){function t(t,r){var n=this.constructor,a=e.call(this,t)||this;a.info=r,a.name="WorkerError";var i=n.prototype;return Object.getPrototypeOf(a)!==i&&(null!=Object.setPrototypeOf?Object.setPrototypeOf(a,i):a.__proto__=i),a}(function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(t,e),t.isWorkerError=o}(Error);function u(e){if(null==e)return!1;if(e instanceof Error)return!0;var t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}Error,EvalError,RangeError,ReferenceError,SyntaxError,TypeError,URIError;function c(e){return{name:e.name,message:e.message,stack:e.stack,info:o(e)?(t=e.info,a(a({},t),{error:t.error?c(t.error):void 0})):void 0};var t}function s(e){throw new ReferenceError(e+" is not defined")}function l(e,t,r){void 0===r&&(r=s);try{for(var n=t.split("."),a=0,i=n;a<i.length;a++){e=e[i[a]]}return null!=e?e:r(t)}catch(e){return r(t)}}var f=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return f.transfer.apply(f,i([e,void 0],t))};f.transfer=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return{def:e,args:r,transferables:null!=t?t:[]}};var d="undefined"!=typeof performance&&void 0!==performance.timeOrigin?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};function h(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,null!=r?r:d()))}self.onmessage=function(e){var t,r=e.data,n=r.config,a=r.port,s=r.options,f=r.script,v=r.args;function p(){var e;if(t)return t;if(void 0===n.typedWorkersUrl)throw new TypeError("importTypedWorkers: typedWorkersUrl is not defined");return importScripts(n.typedWorkersUrl),(t=l(self,null!=(e=n.typedWorkersName)?e:"typedWorkers")).setConfig(n),t}self.onmessage=null,self.__typed_workers_thread=!0;var m={status:"Pending",start:d()};function g(e,t){var r,n={kind:0,error:e?void 0:(r=function(e){return u(e)?e:new Error("(non-Error object) "+e)}(t),u(r)?{isError:!0,value:c(r)}:{isError:!1,value:r}),stopwatch:m};self.postMessage(n),e||setTimeout(self.close.bind(self),6e4)}try{(function(e,t){function r(t){throw h(e,o(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((function(t){var r;return null!=(r=h(e,"Success"))?r:t}),r)}catch(e){r(e)}})(m,(function(){var e,t,r;return importScripts.apply(void 0,i(null!=(r=null!=(t=null===(e=s)||void 0===e?void 0:e.importScriptUrls)?t:n.importScriptUrls)?r:[],void 0!==f.scriptUrl?[f.scriptUrl]:[])),l(self,f.insideInitName).apply(void 0,i([{config:n,importTypedWorkers:p,connection:{port:a,options:s,createMode:"Thread"}}],v))})).then((function(){return g(!0)}),(function(e){return g(!1,e)}))}catch(e){g(!1,e)}}}])},D=-1;function w(){return void 0===F&&(F="("+M.toString()+")();"),F}var L=function(){function e(e){var t,r;try{var n;t=function(e){var t="def"in e?e:I(e),r=t.def,n=t.args,a=t.transferables;if("function"!=typeof r)return[r,n,a,void 0];var i="__generatedInsideInit"+(D+=1);return[{scriptUrl:void 0,insideInitName:i},n,a,"var "+i+" = "+r.toString()+";"]}(e),this.script=t[0],this.args=t[1],this.transferables=t[2];var a=void 0===(n=t[3])?[w()]:[n,"\n\n",w()];this.blobUrl=URL.createObjectURL(new Blob(a,{type:"application/javascript"})),this.worker=new Worker(this.blobUrl)}catch(e){throw null===(r=this.worker)||void 0===r||r.terminate(),this.revokeBlobUrl(),e}}return e.prototype.revokeBlobUrl=function(){void 0!==this.blobUrl&&(URL.revokeObjectURL(this.blobUrl),this.blobUrl=void 0)},e.prototype.createInside=function(e,t){var r=this,u=e.port,c=e.options,s={type:"Thread",side:"Outside",id:c.id},l=this.worker;return h(new Promise((function(e,f){r.createCallbacks={resolve:e,reject:f};var h={config:E(),port:u,options:c,script:r.script,args:r.args};l.postMessage(h,Object(n.f)([u],r.transferables)),l.onerror=function(e){e.preventDefault();var t=function(e,t,r){if(o(r.error)){if(a(r.error))return r.error;var n={cause:"UnhandledError",idInfo:e,error:r.error};return new i(t+" received an unhandled error",n)}if(null==r.message)return new i(t+" received a non-error (worker script fetch probably failed)",{cause:"UnhandledError",idInfo:e});var u={cause:"UnhandledError",idInfo:e},c=r.message+" at "+r.filename+":"+r.lineno+":"+r.colno;return new i(t+" received an unhandled error: "+c,u)}(s,"worker.onerror",e);r.createCallbacks?r.createCallbacks.reject(t):A(t)},l.onmessage=function(e){var n,a,i=e.data;switch(i.kind){case 0:return t.insideInit=i.stopwatch,void 0===i.error?null===(n=r.createCallbacks)||void 0===n?void 0:n.resolve():null===(a=r.createCallbacks)||void 0===a?void 0:a.reject(d(i.error));case 1:return A(d(i.error));case 2:return R(i.stats)}}})),(function(){r.createCallbacks=void 0}))},e.prototype.terminate=function(){var e;if(this.worker){var t=this.worker;this.worker=void 0,null===(e=this.createCallbacks)||void 0===e||e.resolve(),t.terminate(),this.revokeBlobUrl()}},e}(),U="undefined"!=typeof performance&&void 0!==performance.timeOrigin?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};function x(){return{status:"Pending",start:U()}}function P(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,null!=r?r:U()))}function G(e,t){function r(t){throw P(e,a(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((function(t){var r;return null!=(r=P(e,"Success"))?r:t}),r)}catch(e){r(e)}}function V(e){return Math.round(1e3*e)/1e3}function B(e,t,r){return e<t?t:e>r?r:e}function W(e,t,r){var n,a,i,o,u,c,s=B(null!=(a=null===(n=e)||void 0===n?void 0:n.start)?a:1/0,t,r),l=B(null!=(o=null===(i=e)||void 0===i?void 0:i.end)?o:1/0,t,r);return{status:(c=null===(u=e)||void 0===u?void 0:u.status,null!=c?c:"Pending"),start:V(s-t),end:V(l-t),duration:V(l-s)}}var j=function(){return r(3)};function H(e,t,r,n,a){var i,o=new MessageChannel,u=o.port1,c=o.port2;return Promise.all([n({port:u,options:e,createMode:t}),G(r.createOutside=x(),(function(){return _.createOutside({port:c,options:e,createMode:t},(function(e){return a(i=e)}))}))]).then((function(){return i}),(function(e){return i?i.close("Force"):c.close(),Promise.reject(e)}))}function K(e,t,r,a){return H(e,"Local",t,(function(e){return function(e,t,r){var a="def"in r?r:I(r),o=a.def,u=a.args;if("function"!=typeof o){var c={cause:"InternalError",idInfo:{type:"Endpoint",side:"Inside",id:e.options.id}};return Promise.reject(new i("Loading an InsideScript to create a local worker is unimplemented",c))}return Promise.resolve().then((function(){return G(t.insideInit=x(),(function(){return o.apply(void 0,Object(n.f)([{config:E(),importTypedWorkers:j,connection:e}],u))}))}))}(e,t,r)}),a)}function q(e,t,r,n){var a;t.createThread=x();try{a=new L(r)}catch(e){return P(t.createThread,"Error"),Promise.reject(e)}return P(t.createThread,"Success"),H(e,"Thread",t,(function(e){return a.createInside(e,t)}),n).then((function(e){return e.hasBeenClosed()?a.terminate():e._onClose=a.terminate.bind(a),e}),(function(e){return a.terminate(),Promise.reject(e)}))}function Y(e,t,r){void 0===r&&(r=function(){});var n=function(e){var t,r,n,a,i=null!=(a=null!=(r=null===(t=e)||void 0===t?void 0:t.createMode)?r:null===(n=C)||void 0===n?void 0:n.createMode)?a:"Thread";return"ThreadOrLocal"===i?S()?"Thread":"Local":i}(e),a="local"in t?"Local"===n?t.local:t.thread:t,i="Local"===n?K:q,o={id:e.id,createMode:n,createWorker:x()};return h(G(o.createWorker,(function(){return i(function(e){return{id:e.id,createTimeout:e.createTimeout,createMode:e.createMode,importScriptUrls:e.importScriptUrls}}(e),o,a,r)})),(function(){var e=function(e){var t=e.id,r=e.createMode,n=e.createWorker,a=e.insideInit,i=e.createOutside,o=e.createThread,u=n.status,c=n.start,s=n.end;if("Pending"!==u&&void 0!==s)return{id:t,createMode:r,createWorker:{status:u,absStart:c,duration:V(s-c)},createThread:"Thread"===r?W(o,c,s):void 0,createOutside:W(i,c,s),insideInit:W(a,c,s)}}(o);e&&R(e)}))}r.d(t,"WorkerError",(function(){return i})),r.d(t,"isThreadingSupported",(function(){return S})),r.d(t,"setConfig",(function(){return y})),r.d(t,"paramInsideDef",(function(){return I})),r.d(t,"Endpoint",(function(){return _})),r.d(t,"createWorker",(function(){return Y}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.__growWasmMemory=t.stackRestore=t.stackAlloc=t.stackSave=t.setThrew=t.__errno_location=t._start=t.Mathpack_Pack=t.Mathpack_FormatGeneral=t.Mathpack_Atan2=t.Mathpack_Atan=t.Mathpack_Acos=t.Mathpack_Asin=t.Mathpack_Tan=t.Mathpack_Cos=t.Mathpack_Sin=t.Mathpack_Log=t.Mathpack_Ln=t.Mathpack_Exp=t.Mathpack_Sqrt=t.Mathpack_ViewRound=t.Mathpack_Equal=t.Mathpack_GetExp32=t.Mathpack_Compare=t.Mathpack_RoundDown=t.Mathpack_RoundUp=t.Mathpack_Round=t.Mathpack_SFix=t.Mathpack_LFix=t.Mathpack_Fix=t.Mathpack_SFloat=t.Mathpack_Float=t.Mathpack_Neg=t.Mathpack_Abs=t.Mathpack_Floor=t.Mathpack_Ceil=t.Mathpack_Trunc=t.Mathpack_TakeMathError=t.Mathpack_Cond2=t.Mathpack_Cond=t.Mathpack_Power=t.Mathpack_Add=t.Mathpack_Sub=t.Mathpack_Mul=t.Mathpack_Div=t.Mathpack_Pi=t.Mathpack_One=t.Mathpack_Zero=t.Dtr_ToDays=t.Dtr_Days=t.Dtr_ToNum=t.Dtr_Rounding=t.Dtr_FracSec=t.Dtr_Wdy=t.Dtr_Sec=t.Dtr_Min=t.Dtr_Hour=t.Dtr_DOM=t.Dtr_Mon=t.Dtr_Yr=t.Dtr_FromNum=t.Dtr_DaysPerMonth=t.Base_StrBufSize=t.Base_StrBuf=t.memory=void 0;var n=r(17),a=r(18),i=r(19),o=new ArrayBuffer(8),u=new Int32Array(o),c=(new Float32Array(o),new Float64Array(o));function s(e){return u[e]}function l(e,t){u[e]=t}function f(){return c[0]}function d(e){c[0]=e}var h,v=new ArrayBuffer(65536),p=(h=new Uint8Array(v),function(e,t){var r,n;if("undefined"==typeof Buffer)for(r=atob(t),n=0;n<r.length;n++)h[e+n]=r.charCodeAt(n);else for(r=Buffer.from(t,"base64"),n=0;n<r.length;n++)h[e+n]=r[n]});p(1024,"+AgAAAEAAAACAAAAAwAAAAAAAAAE"),p(1056,"yAgAANAIAADYCAAA4AgAAB8dHx4fHh8fHh8eHx8cHx4fHh8fHh8eHx8cHx4fHh8fHh8eHx8cHx4fHh8fHh8eHx8cHx4fHh8fHh8eHx8dHx4fHh8fHh8eHw=="),p(1152,"kAgAAKgIAACgCAAAsAg="),p(1175,"oAQ="),p(1191,"yAc="),p(1207,"+go="),p(1222,"QJwO"),p(1238,"UMMR"),p(1254,"JPQU"),p(1269,"gJaYGA=="),p(1285,"ILy+Gw=="),p(1301,"KGvuHg=="),p(1317,"+QKVIg=="),p(1332,"QLdDuiU="),p(1348,"EKXU6Cg="),p(1364,"KueEkSw="),p(1379,"gPQg5rUv"),p(1395,"oDGpX+My"),p(1411,"BL/JG442AAAAAAAAAJ61cCuorcWdawAAAAAAAADXlUMOBY0pr6AAAAAAAAAA1abP/0kfeMLVAAAAAAAAAPz32oePeufXCgEAAAAAAACjFJvFFquz7z8BAAAAAAAAnjIjmcCtD4V1AQAAAAAAAOCM6YDJR7qTqgEAAAAAAADnptOoxbkCpN8BAAAAAAAAqhfmfyuhFrYUAgAAAAAAAJO/m4WRoijKSQIAAAAAAABrVSc5jfdw4H4CAAAAAAAARmGCNzUMLvmzAgAAAAAAADDJPOP/llKK6QIAAAAAAABmF7/W86aRmR4DAAAAAAAAjt75nfvrfqpTAwAAAAAAAM3MzMzMzMzM/f///wAAAAAK16NwPQrXo/r///8AAAAAO99PjZduEoP3////AAAAACxlGeJYF7fR8////wAAAAAjhEcbR6zFp/D///8AAAAAtmlsrwW9N4bt////AAAAALxCeuXVlL/W6f///wAAAAD9zmGEEXfMq+b///8AAAAAl6W0NkFfcInj////AAAAAL/V7b3O/ubb3////wAAAAD/qiTLC//rr9z///8AAAAAzIhQbwnMvIzZ////AAAAABMOtEtCEy7h1f///wAAAAAP2FwJNdwktNL///8AAAAA2aywOvd8HZDP////AAAAAFvhTcS+lJXmy////wAAAAC6lDlFrR6xz5b///8AAAAAWcF+sVN8Erth////AAAAAKXpOaUn6n+oLP///wAAAACmGQlrumDFl/f+//8AAAAAm1N1/fcCtIjC/v//AAAAAH3TZfC8NUP2jP7//wAAAACh5LxkfEbQ3Vf+//8AAAAAyYJTfG66ysci/v//AAAAAJOgc9uT4PSz7f3//wAAAAAwAMs42ycXorj9//8AAAAABswjVHeD/5GD/f//AAAAAGC8pD2p3oCDTv3//wAAAAC+TjFK7Dzl7Bj9//8AAAAA1+Eyz81fYNXj/P//AAAAADoZemMlQzHArvz//wAAAAAYLURU+yEJQAAAAAAAAOA/AAAAAAAAAEAYLURU+yH5PwAAAAAAAPA/"),p(2214,"WUAAAAAAAAAkQAAAAAAAQI9AAAAAAAAAOEAAAAAAAABOQClRzqDIRdg+IXQL5wZroz41IN+kpBFvPvZNfx3q2jg+AADA////30EAAAAAAADgwQQEAAAQBA=="),p(2416,"EEo=");var m=function(e,t,r){var n=new e.Int8Array(r),a=new e.Int16Array(r),i=new e.Int32Array(r),o=new e.Uint8Array(r),u=new e.Uint16Array(r),c=new e.Uint32Array(r),h=(new e.Float32Array(r),new e.Float64Array(r)),v=e.Math.imul,p=(e.Math.fround,e.Math.abs),m=(e.Math.clz32,e.Math.min),g=(e.Math.max,e.Math.floor),C=e.Math.ceil,S=e.Math.sqrt,y=t.abort,E=(e.NaN,e.Infinity,t.Base_LocaleIsNumeral),O=t.Base_LocaleGetOrdinal,k=t.Base_LocaleDecimalSeparator,A=t.Math_log10,b=t.Math_log,R=(S=t.Math_sqrt,t.Math_sin),I=t.Math_cos,T=t.Math_tan,N=t.Math_atan,F=t.Math_exp,_=t.proc_exit,M=18800;function D(){}function w(e,t,r){e:if(e>>>0<=t>>>0){if(!r)break e;for(;n[0|e]=o[0|t],e=e+1|0,t=t+1|0,r=r+-1|0;);}else if(r)for(e=e+r|0,t=t+r|0;t=t+-1|0,n[0|(e=e+-1|0)]=o[0|t],r=r+-1|0;);}function L(e,t){var r,c,l=0,f=0,v=0,p=0;if(f=2376,M=r=M-48|0,i[r+40>>2]=0,a[r+30>>1]=0,a[r+32>>1]=0,h[297]=e,c=V(e),h[297]=c,fe(c,r+40|0,r),u[r+42>>1]){l=(0|(l=ne(t)<<16))<0?100:l>>16,d(+t),v=0|s(1),s(0),(p=-65536&v)&&(2146435072!=(2146435072&v)?l=(0|p)<1?0-l|0:l:i[596]=1);e:{if(!((0|(l=a[r+40>>1]+l|0))>=a[r+42>>1])){if((0|l)<1){f=2200;break e}(255&l)>>>0>=o[r+30|0]||(n[r+30|0]=l)}le(2300,2376,r)}e=h[f>>3]}return M=r+48|0,e}function U(e,t){var r,n=0,a=0,o=0;if(h[297]=e,d(+e),a=0|s(1),s(0),o=a,a=0,(n=-65536&o)&&(2146435072!=(2146435072&o)?a=(0|n)<1:(i[596]=1,a=0)),i[595]=2147483647&o,J(h[274]),n=-65536&(o=i[595]))if(2146435072!=(2146435072&o)){if(!((0|n)<1))return B(8),0}else i[596]=1;r=Q(h[274],e),h[297]=Q(h[272],r),X(r),oe();e:{t:{if((n=i[595])>>>0>=65536){if(2146435072!=(2146435072&n))break t;i[596]=1}if(t){if(i[594]=0,i[595]=0,!a)break e;return t=i[541],i[594]=i[540],i[595]=t,h[297]}if(n=i[547],i[594]=i[546],i[595]=n,t=n,1^a|n>>>0<65536)break e;return i[595]=-2147483648^t,h[297]}ve(e),ue(),t&&(h[297]=Q(h[273],h[297]))}return h[297]}function x(e,t,r){var n,c=0,s=0,l=0,f=0,d=0,h=0,p=0,m=0;if(s=i[588],d=-2146827284,!((0|(n=(c=(0|(l=a[1175]))>=1?(l+-1|0)/12|0:(0|l)/-12^-1)+u[1174]<<16>>16))>9999|((t?1900:-9999)+(e?4:0)|0)>(0|n)||((l=l+v(c,-12)<<16>>16)+-1&65535)>>>0>11|(!s|1900==(0|n)&2==(0|l)&29==(0|s)?!t:0))){if(p=(0|(f=(c=(0|(h=n+1e4|0))/4|0)<<2))%100|0,m=(0|f)%400|0,c=(((s=v(c,1461)+s|0)+((0|(c=f+-1|0))/-100|0)|0)+((0|c)/400|0)|0)-1|0,f=(v(h-f|0,12)+l|0)-1|0)for(f=f+(s=m?p?0:12:0)|0;c=o[s+1072|0]+c|0,(0|f)!=(0|(s=s+1|0)););e:if(t||e){if(e=c+-4346385|0,!((0|n)>1900|(0|l)>=3))break e;e=c+-4346384|0}else e=c+-4346384|0;e>>>0>2958465||(i[r>>2]=e,d=0)}return d}function P(e,t,r){var n,o=0,c=0,s=0,l=0,f=0;if(M=n=M-16|0,r&&(s=r>>31,s^=s+r))for(r=(0|r)>0?1152:1648;(o=15&s)&&(c=a[(o=(o<<4)+r|0)+8>>1],f=G(h[e>>3],h[o>>3],n),t=t+c|0,a[n+14>>1]<=0?(o=u[n+6>>1],c=u[n+8>>1]):(c=i[n+4>>2],o=u[n+6>>1]<<1,a[n+6>>1]=o,l=i[n+8>>2],i[n+12>>2]=i[n+12>>2]<<1|l>>>31,c=l<<1|c>>>31,i[n+8>>2]=c,t=t+-1|0),(65535&o|1&c|0!=(0|f))>>>0<32769||(c=(o=i[n+8>>2])+1|0,i[n+8>>2]=c,c>>>0>=o>>>0||(c=(o=i[n+12>>2])+1|0,i[n+12>>2]=c,c>>>0>=o>>>0||(i[n+12>>2]=-2147483648,t=t+1|0))),o=i[n+12>>2],i[e>>2]=i[n+8>>2],i[e+4>>2]=o),r=r+240|0,s>>=4;);return M=n+16|0,t}function G(e,t,r){var n,i,o,u=0,c=0,l=0,f=0,h=0,p=0,m=0,g=0,C=0,S=0,y=0,E=0;return d(+t),f=0|s(1),h=65535&(c=0|s(0)),d(+e),S=0|s(1),u=0|s(0),l=S,i=v(g=65535&u,h),a[r>>1]=i,o=((65535&(y=v(C=u>>>16,h)))+(i>>>16)|0)+(65535&(m=v(c>>>=16,g)))|0,a[r+2>>1]=o,y=(((p=((65535&(u=v(n=65535&l,h)))+(y>>>16)|0)+(m>>>16)|0)+(65535&(m=v(c,C)))|0)+(65535&(E=v(S=65535&f,g)))|0)+(o>>>16)|0,a[r+4>>1]=y,m=(((((((65535&(p=v(f>>>=16,g)))+(u>>>16)|0)+(65535&(l=v(u=l>>>16,h)))|0)+(m>>>16)|0)+(E>>>16)|0)+(65535&(h=v(S,C)))|0)+(65535&(g=v(c,n)))|0)+(y>>>16)|0,a[r+6>>1]=m,C=((((((E=(l>>>16)+(p>>>16)|0)+(65535&(l=v(f,C)))|0)+(h>>>16)|0)+(g>>>16)|0)+(65535&(p=v(u,c)))|0)+(65535&(c=v(S,n)))|0)+(m>>>16)|0,a[r+8>>1]=C,p=((c=(((65535&(h=v(f,n)))+(l>>>16)|0)+(p>>>16)|0)+(c>>>16)|0)+(65535&(l=v(u,S)))|0)+(C>>>16)|0,a[r+10>>1]=p,u=(((65535&(f=v(u,f)))+(h>>>16)|0)+(l>>>16)|0)+(p>>>16)|0,a[r+12>>1]=u,a[r+14>>1]=(u>>>16)+(f>>>16),65535&(i|o|y)}function V(e){var t,r,n=0,a=0,o=0,u=0,l=0,f=0;return M=t=M-16|0,h[t+8>>3]=e,d(+e),n=0|s(1),a=0|s(0),r=n,(n&=2146435072)&&(i[t+8>>2]=a<<11,i[t+12>>2]=r<<11|a>>>21|-2147483648,u=(n=v(a=(n>>>20)-1022|0,39457)>>17)+-14|0,o=P(t+8|0,a,14-n|0),a=i[t+8>>2],(0|o)>=(0|(c[t+12>>2]<(a>>>0<2147477094?-1243209483:-1243209484)>>>0?48:47))||(o=P(t+8|0,o,1),a=i[t+8>>2],u=n+-15|0),n=u,u=(u=a)+(a=-2147483648>>>(31&o))|0,i[t+8>>2]=u,u>>>0>=a>>>0||(f=(l=i[t+12>>2])+1|0,i[t+12>>2]=f,f>>>0>=l>>>0||(i[t+12>>2]=-2147483648,o=o+1|0)),i[t+8>>2]=u&0-(a<<1),o=P(t+8|0,o,n),3071&(n=i[t+8>>2])?(a=n+1024|0,i[t+8>>2]=a,n>>>0<4294966272||(u=(n=i[t+12>>2])+1|0,i[t+12>>2]=u,o=(u>>>0<n>>>0)+o|0)):a=n,(0|o)<=-1023?(i[t+8>>2]=0,i[t+12>>2]=0):(0|(n=1071644672+(o<<20)|0))<=-1||(o=i[t+12>>2],i[t+8>>2]=o<<21|a>>>11,i[t+12>>2]=o>>>11&1048575|n|-2147483648&r),e=h[t+8>>3]),M=t+16|0,e}function B(e){var t;return t=i[596],i[596]=e,t}function W(){var e,t,r;return e=i[594],t=i[595],q(1048576),q(2146435072),a[1191]<0?(i[594]=e,i[595]=t,-2147483648):(r=re(),i[594]=e,i[595]=t,-2147483648^r)}function j(e){var t,r=0,n=0,a=0,i=0;if(d(+e),r=0|s(1),t=0|s(0),i=r,a=0,!((r=2047&(n=r>>>20))>>>0<1023||(a=e,r>>>0>1075))){if(n=-1<<(19-n&31),r>>>0>=1044)return l(0,n&t),l(1,0|i),+f();i&=n,l(0,0),l(1,0|i),a=+f()}return a}function H(e){var t=0,r=0,n=0;if(e+307>>>0<=615)return i[594]=0,i[595]=-2147483648,n=P(2376,1,e),r=i[594],e=i[595],3071&r&&(t=i[595],(e=i[594]+1024|0)>>>0<1024&&(t=t+1|0),i[594]=e,i[595]=t,r=e,e=t),i[594]=e<<21|r>>>11,void(i[595]=1071644672+(e>>>11&1048575|n<<20));(0|e)>=309&&(i[596]=1),i[594]=0,i[595]=0}function K(){var e=0,t=0,r=0;e:{if(r=i[594],t=-65536&(e=i[595])){if(2146435072==(2146435072&e))return i[596]=1,void ce();if((0|t)<1)break e}return void ce()}ce(),(0|r)==i[594]&&i[595]==(0|e)||J(1)}function q(e){h[297]=Y(h[297],e)}function Y(e,t){var r;return d(+(e+=t)),r=0|s(1),s(0),2146435072==(2146435072&r)&&(i[596]=1,e=h[275]),e}function J(e){h[297]=Q(h[297],e)}function Q(e,t){var r;return d(+(e-=t)),r=0|s(1),s(0),2146435072==(2146435072&r)&&(i[596]=1,e=h[275]),e}function X(e){h[297]=z(h[297],e)}function z(e,t){var r,n=0,a=0,o=0;return d(+e*t),n=0|s(1),r=0|s(0),0|2146435072!=(0|(a=2146435072&n))?(o=(a=!(a|o))?i[550]:r,n=a?i[551]:n,l(0,0|o),l(1,0|n),+f()):(i[596]=1,n=i[551],l(0,i[550]),l(1,0|n),+f())}function Z(e,t){var r=0,n=0,a=0,o=0;if(d(+t),r=0|s(1),s(0),2146435072&r){if(n=1,d(+e/t),r=0|s(1),a=0|s(0),!(!0&2146435072==(0|(o=2146435072&r))))return a=(n=!(0|o))?i[550]:a,r=n?i[551]:r,l(0,0|a),l(1,0|r),+f()}else n=4;return i[596]=n,r=i[551],l(0,i[550]),l(1,0|r),+f()}function $(e){h[297]=e>>>0}function ee(e){h[297]=0|e}function te(){var e,t;e=+b(+h[297]),h[297]=e,d(+e),t=0|s(1),s(0),2146435072==(2146435072&t)&&(i[596]=8)}function re(){return ne(h[297])}function ne(e){var t,r=0,n=0,a=0,i=0;return d(+e),i=1106247680==(0|(a=2146435072&(r=0|s(1))))&i>>>0<0|a>>>0<1106247680,t=r&=2147483647,l(0,0|(n=0|s(0))),l(1,0|r),(e=+f())<0x10000000000000000&e>=0?(a=p(e)>=1?e>0?~~m(g(e/4294967296),4294967295)>>>0:~~C((e-+(~~e>>>0>>>0))/4294967296)>>>0:0,r=~~e>>>0):(a=0,r=0),n=i?r:n,!(r=i?a:t)&n>>>0<4294967295|r>>>0<0?n:-1}function ae(){return ie(h[297])}function ie(e){var t=0,r=0;return d(+e),t=0|s(1),s(0),r=1105199104==(0|(t&=2145386496))&r>>>0<0|t>>>0<1105199104,t=p(e)<2147483648?~~e:-2147483648,r?t:-2147483648}function oe(){var e,t;e=+S(+h[297]),h[297]=e,d(+e),t=0|s(1),s(0),2146435072==(2146435072&t)&&(i[596]=8)}function ue(){var e,t;e=+N(+h[297]),h[297]=e,d(+e),t=0|s(1),s(0),2146435072==(2146435072&t)&&(i[596]=8)}function ce(){h[297]=j(h[297])}function se(){var e,t;e=+F(+h[297]),h[297]=e,d(+e),t=0|s(1),s(0),2146435072==(2146435072&t)&&(i[596]=1)}function le(e,t,r){return function(e,t,r){var n=0,c=0,l=0,f=0;if(n=o[r+30|0]){for(c=r;f=10*f+ +(0|me[i[i[e>>2]+4>>2]](e,u[c>>1])),c=c+2|0,l=(0|n)>1,n=n+-1|0,l;);if(d(+f),n=0|s(1),e=0|s(0),i[t>>2]=e<<11,i[t+4>>2]=2147481600&((2097151&n)<<11|e>>>21)|e>>>21|-2147483648,n=P(t,(n>>>20&2047)-1022|0,((32767&u[r+32>>1])-o[r+30|0]|0)-16384|0),3071&(c=i[t>>2])?(e=c+1024|0,i[t>>2]=e,c>>>0<4294966272||(l=(c=i[t+4>>2])+1|0,i[t+4>>2]=l,n=(l>>>0<c>>>0)+n|0)):e=c,!((0|n)<=-1022))return(0|(c=1071644672+(n<<20)|0))<0?1:(n=i[t+4>>2],i[t>>2]=n<<21|e>>>11,i[t+4>>2]=-2147483648&a[r+32>>1]|c|n>>>11&1048575,0)}return i[t>>2]=0,i[t+4>>2]=0,0}(e,t,r)}function fe(e,t,r){!function(e,t,r){var o,c,l=0,f=0,p=0,m=0,g=0,C=0,S=0,y=0,E=0;if(g=15,M=o=M-16|0,h[o+8>>3]=e,c=t,d(+e),f=0|s(1),p=0|s(0),m=f,C=f,f&=2146435072){if(f=v(l=(f>>>20)-1022|0,39457)>>17,a[r+32>>1]=f+16385|m>>>16&32768,i[o+8>>2]=p<<11,i[o+12>>2]=C<<11|p>>>21|-2147483648,(0|(l=P(o+8|0,l,-1^f)))>=1)for(p=r+32|0;m=u[p>>1],a[p>>1]=m+1&32767|32768&m,(0|(l=P(o+8|0,l,-1)))>0;);for(l?(f=(p=i[o+12>>2])>>>(m=0-l|0),i[o+12>>2]=f,l=p<<l+32|i[o+8>>2]>>>m,i[o+8>>2]=l):(l=i[o+8>>2],f=i[o+12>>2]),l=(m=f>>>0<(l>>>0<2576980377?429496730:429496729)>>>0?922:9223)+l|0,i[o+8>>2]=l,l>>>0<m>>>0&&(f=f+1|0,i[o+12>>2]=f),S=l>>>16,C=u[o+14>>1],y=r+32|0,p=r,E=1;;){for(m=g;g=(g=v(C,10))+((C=v(S,10)+(v(65535&l,10)>>>16)>>>16)+v(65535&f,10)>>>16)>>>16|48,a[p>>1]=g,C=(f=C+v(f,10)|0)>>>16,S=(l=v(l,10))>>>16,!(1&(-1^E|48!=(0|g)));)g=u[y>>1],a[y>>1]=g+-1&32767|32768&g;if(p=p+2|0,E=0,g=m+-1|0,!((0|m)>1))break}i[o+12>>2]=f,i[o+8>>2]=l,l=(m=p-r|0)>>1;e:{if((0|m)<=29){if((0|f)<=-1){a[p>>1]=57,f=l+1|0;break e}a[p>>1]=48}for(;;){if(f=l,(0|l)<1)break e;if(l=f+-1|0,48!=u[(p=p+-2|0)>>1])break}}n[r+30|0]=f,a[t+2>>1]=f,t=(32767&u[r+32>>1])-16384|0}else n[r+30|0]=0,a[r+32>>1]=0,a[t+2>>1]=0,t=0;a[c>>1]=t,M=o+16|0}(e,t,r)}function de(e){return Q(h[297],e)}function he(e){return Z(h[297],e)}function ve(e){h[297]=Z(e,h[297])}function pe(e,t){h[297]=Z(e,t)}var me=[null,function(e,t){return 0,0!=(0|E(0|(t|=0)))|0},function(e,t){return 0,0|O(0|(t|=0))},function(e){return 0,0|k()},function(e,t){return 0,(t|=0)+-48|0},D];return{memory:Object.create(Object.prototype,{grow:{},buffer:{get:function(){return r}}}),Base_StrBuf:function(){return 2304},Base_StrBufSize:function(){return 22},Dtr_DaysPerMonth:function(e,t,r){return 0|function(e,t,r){var n=0;n=3&t;e:if(r){if(n|(0|t)<2100)break e;n=!((t>>>0)%100)&0!=((t>>>0)%400|0)}else n||(n=!((0|t)%100)&0!=((0|t)%400|0));return o[1072+(((v(n,12)+e|0)-1|0)%48|0)|0]}(e|=0,t|=0,0!=(0|(r|=0)))},Dtr_FromNum:function(e,t,r,n){return e=+e,t|=0,r|=0,n|=0,a[1174]=0,t=function(e,t,r,n){var c=0,p=0,m=0,g=0,C=0,S=0,y=0,E=0,O=0;e:if(!u[1174]){if(h[297]=e,d(+e),c=0|s(1),m=0|s(0),S=c,O=-65536&c)if(2146435072!=(2146435072&c)){if(!((0|O)>=1))return-2147467259}else i[596]=1;C=i[570],y=i[571],g=-1;t:{if(!((0|c)<(0|(p=y))||(g=1,(0|c)>(0|p)))){if((0|C)==(0|(p=m)))break t;g=p>>>0<C>>>0?-1:1}if(p=-2147467259,1==(0|((S&y)>-1?g:0-g|0)))break e}t:{if(C=i[572],p=i[573],y=p,g=-1,!((0|c)<(0|p)||(g=1,(0|c)>(0|y)))){if((0|m)==(0|C))break t;g=m>>>0<C>>>0?-1:1}if(C=g,-1==(0|((p&S)>-1?C:0-C|0)))return-2147467259}t:{r:{if(!(n|!O))if(2146435072!=(2146435072&c)){if((0|O)<1)break r}else i[596]=1;q(h[i[1056+(t<<2)>>2]>>3]),E=h[297];break t}K(),J(e),S=i[595],m=S,l(0,0|(c=i[594])),l(1,0|m),E=+f(),i[550]==(0|c)&&i[551]==(0|m)||(p=i[595])>>>0<65536||(i[595]=-2147483648^p,d(+(E=h[297])),m=0|s(1),c=0|s(0)),S=m,C=m,m=i[1056+(t<<2)>>2],y=i[m+4>>2],p=i[m>>2],g=-1;r:{if(!((0|C)<(0|(m=y))||(g=1,(0|C)>(0|m)))){if((0|c)==(0|p)){h[297]=e;break r}g=c>>>0<p>>>0?-1:1}if(C=g,h[297]=e,-1==(0|((S&y)>-1?C:0-C|0)))break t}J(h[274])}if(a[1183]=t,c=ae(),p=-2147467259,!B(0)){if(r){if((0|c)>2957003)break e;c=c+1462|0}else if(c+4346018>>>0>7304483)break e;if(a[1181]=1+((c+6|0)%7|0),!n|c)if(c){if((0|c)<=-1?(m=-4-((r=(-1^c)/1461|0)<<2)|0,p=1461+(v(r,1461)+c|0)|0):(m=(r=(c+-1|0)/1461|0)<<2,p=v(r,-1461)+c|0),!(n&&(0|m)<=199))if((0|(p=(((0|(r=m+-101|0))/100|0)-((0|r)/400|0)|0)+p|0))>=1462){c=3&(r=m+1900|0);t:if(n){if(c|(0|m)<200)break t;c=!((r>>>0)%100)&0!=((r>>>0)%400|0)}else c||(c=!((0|r)%100)&0!=((0|r)%400|0));m=m+4|0,p=(12==(0|v(c,12))?-1460:-1461)+p|0}else(0|p)>0||(m=m+-4|0,p=p+1461|0);c=3&(r=m+1900|0);t:if(n){if(c|(0|m)<200)break t;c=!((r>>>0)%100)&0!=((r>>>0)%400|0)}else c||(c=!((0|r)%100)&0!=((0|r)%400|0));for(S=v(c,12),c=S;n=c,c=c+1|0,(0|(p=(r=p)-o[n+1072|0]|0))>0;);n=((p=n)-((0|S)<(0|(n=n+-11|0))?S:n)>>>0)/12|0,a[1174]=1900+(n+m|0),a[1175]=(v(n,-12)+c|0)-S}else i[587]=788331,r=30;else i[587]=67436;if(i[588]=r,h[297]=E,ce(),(r=i[595])>>>0>=65536&&(i[595]=-2147483648^r),q(E),X(h[279]),e=h[297],r=re(),a[1178]=r,$(r<<16>>16),(r=i[595])>>>0>=65536&&(i[595]=-2147483648^r),q(e),X(h[280]),e=h[297],r=re(),a[1179]=r,$(r<<16>>16),(r=i[595])>>>0>=65536&&(i[595]=-2147483648^r),q(e),X(h[280]),!t)return t=re(),a[1182]=0,a[1180]=t,0;e=h[297],r=re(),a[1180]=r,$(r<<16>>16),(r=i[595])>>>0>=65536&&(i[595]=-2147483648^r),q(e),X(h[i[1152+(t<<2)>>2]>>3]),h[297]=V(h[297]),a[1182]=re(),p=0}}return p}(e,t,0!=(0|r),0!=(0|n)),i[596]=0,0|t},Dtr_Yr:function(){return a[1174]},Dtr_Mon:function(){return a[1175]},Dtr_DOM:function(){return i[588]},Dtr_Hour:function(){return a[1178]},Dtr_Min:function(){return a[1179]},Dtr_Sec:function(){return a[1180]},Dtr_Wdy:function(){return a[1181]},Dtr_FracSec:function(){return a[1182]},Dtr_Rounding:function(){return a[1183]},Dtr_ToNum:function(e,t,r,n,o,c,s,l,f,d){return e|=0,t|=0,r|=0,n|=0,o|=0,c|=0,s|=0,l|=0,f|=0,d|=0,a[1182]=s,a[1180]=c,a[1179]=o,a[1178]=n,i[588]=r,a[1175]=t,a[1174]=e,a[1183]=l,i[594]=0,i[595]=0,a[1181]=0,function(e,t){var r,n=0;M=r=M-16|0;e:{t:{r:{if((u[1175]+-32767&65535)>>>0>1){if(a[1183]>=1?(ee(a[1182]),n=he(h[i[1152+(a[1183]<<2)>>2]>>3]),ee(a[1180]),q(n)):ee(a[1180]),n=he(h[280]),ee(a[1179]),q(n),n=he(h[280]),ee(a[1178]),q(n),n=he(h[279]),!((0|x(e,t,r+12|0))<0)){if(t=i[r+12>>2],!e)break r;if(ee(t+-1462|0),!((0|t)<1462)){if(e=i[595],!(t=-65536&e))break t;if(2146435072==(2146435072&e)){i[596]=1;break t}if((0|t)>=1)break t}}i[594]=0,i[595]=0}i[594]=0,i[595]=0,B(8);break e}$(t)}q(n)}M=r+16|0}(0!=(0|f),0!=(0|d)),+h[297]},Dtr_Days:function(){return i[592]},Dtr_ToDays:function(e,t,r,n,o){return e|=0,t|=0,r|=0,n|=0,o|=0,i[589]=0,i[590]=0,i[588]=r,a[1175]=t,a[1174]=e,i[591]=0,0|x(0!=(0|n),0!=(0|o),2368)},Mathpack_Zero:function(){return+h[275]},Mathpack_One:function(){return+h[274]},Mathpack_Pi:function(){return+h[270]},Mathpack_Div:function(e,t){return+Z(e=+e,t=+t)},Mathpack_Mul:function(e,t){return+z(e=+e,t=+t)},Mathpack_Sub:function(e,t){return+Q(e=+e,t=+t)},Mathpack_Add:function(e,t){return+Y(e=+e,t=+t)},Mathpack_Power:function(e,t){return+function(e,t){var r=0,n=0,o=0,c=0;h[297]=t,d(+t),r=0|s(1),s(0),o=r,i[595]=2147483647&r,t=h[297];e:{if(d(+de(h[271])),r=0|s(1),n=0|s(0),65535==(0|r)&n>>>0<=4294967295|r>>>0<65535)h[297]=e,oe();else if(ce(),d(+de(t)),r=0|s(1),n=0|s(0),65535==(0|r)&n>>>0>4294967295|r>>>0>65535||-1==(0|(r=re()))){if(h[297]=e,d(+e),n=0|s(1),s(0),(0|(n=(r=n)>>>16<<16))>=1)te(),X(t),se();else if(!((0|n)>-1)){if(pe(h[274],t),c=V(h[297]),h[297]=c,ce(),d(+de(c)),65535==(0|(n=0|s(1)))&s(0)>>>0>4294967295|n>>>0>65535)break e;if(2147483647==(0|(n=ae()))|!(1&n))break e;h[297]=e,i[595]=2147483647&r,te(),X(t),se(),(r=i[595])>>>0<65536||(i[595]=-2147483648^r)}}else h[297]=e,function(e){var t,r=0;if(!((t=a[1191])|e))return void(i[596]=4&i[596]?4:64);if(!((0|t)<1)&&10==(0|re())){if(r=h[297],ce(),J(r),!u[1191])return void H(e);h[297]=r}r=1;for(;1&e&&(r=z(h[297],r)),e>>>=1;)X(h[297]);h[297]=r}(r);if(o>>>16<<16>>16<=-1){if(1&(o=i[596]))return i[594]=0,i[595]=0,i[596]=-2&o,h[297];ve(h[274])}return h[297]}return i[596]=8,h[297]}(e=+e,t=+t)},Mathpack_Cond:function(e){var t,r;return d(+(e=+e)),t=0|s(1),s(0),(r=-65536&t)?2146435072==(2146435072&t)?(i[596]=1,0):0|((0|r)<1?-1:1):0},Mathpack_Cond2:function(e,t){t=+t;var r,n,a,i,o=0,u=0,c=0;d(+(e=+e)),o=0|s(1),r=0|s(0),n=o,i=o,d(+t),a=0|s(1),o=0|s(0),c=-1;e:{if(!((0|n)<(0|(u=a))||(c=1,(0|i)>(0|u)))){if(u=0,(0|o)==(0|r))break e;c=r>>>0<o>>>0?-1:1}o=c,u=(a&n)>-1?o:0-o|0}return 0|u},Mathpack_TakeMathError:function(){var e;return e=i[596],i[596]=0,0|e},Mathpack_Trunc:function(e){return+j(e=+e)},Mathpack_Ceil:function(e){return e=+e,h[297]=e,function(){var e=0,t=0,r=0;e:{if(r=i[594],e=i[595],t=-65536&e){if(2146435072==(2146435072&e))return i[596]=1,void ce();if((0|t)>0)break e}return void ce()}ce(),(0|r)==i[594]&&i[595]==(0|e)||q(1)}(),+h[297]},Mathpack_Floor:function(e){return e=+e,h[297]=e,K(),+h[297]},Mathpack_Abs:function(e){var t=0;return d(+(e=+e)),t=0|s(1),t&=2147483647,l(0,0|(0|s(0))),l(1,0|t),+f()},Mathpack_Neg:function(e){var t,r,n,a;return d(+(e=+e)),n=-2147483648^(t=0|s(1)),l(0,0|(r=0|s(0))),l(1,0|n),a=+f(),+(65535==(0|t)&r>>>0>4294967295|t>>>0>65535?a:e)},Mathpack_Float:function(e){return+((e|=0)>>>0)},Mathpack_SFloat:function(e){return+(0|(e|=0))},Mathpack_Fix:function(e){return 0|ne(e=+e)},Mathpack_LFix:function(e){return 0|ie(e=+e)},Mathpack_SFix:function(e){return e=+e,h[297]=e,0|W()},Mathpack_Round:function(e,t){return+function(e,t){var r,o=0,c=0,l=0,f=0;M=r=M+-64|0,i[r+56>>2]=0,a[r+46>>1]=0,a[r+48>>1]=0,h[297]=e,d(+e),o=0|s(1),s(0);e:if(c=-65536&o)if(2146435072!=(2146435072&o)){(0|c)>0||(f=32768,o>>>0<65536||(i[595]=-2147483648^o,e=h[297])),fe(e,r+56|0,r+16|0),u[r+58>>1]||(a[r+56>>1]=1),h[297]=t,o=(0|(o=W()))<0?100:o;t:{if(c=i[595],l=-65536&c)if(2146435072!=(2146435072&c)){if(!((0|l)>0)){if((o=i[595])>>>0>=65536&&(i[595]=-2147483648^o),(0|(o=W()))<=-1)break t;o=0-o|0}}else i[596]=1;c=a[r+56>>1],l=o+c|0,o=a[r+58>>1],(0|l)<(0|o)&&(i[r+12>>2]=o,i[r+8>>2]=c,function(e,t,r,n){var o=0,c=0,s=0;r:{n:{a:{i:{if(!n){if(u[e>>1]<=52)break i;break n}if(!((0|n)<1)&&(0|n)<15)break a}return i[t>>2]=1,void(i[r>>2]=0)}if(u[(n<<1)+e>>1]<=52)break r;for(;;){if(s=u[(c=((o=n+-1|0)<<1)+e|0)>>1]+1|0,a[c>>1]=s,58!=(65535&s))break r;if(!(n=o))break}}return a[e>>1]=49,i[t>>2]=i[t>>2]+1,void(i[r>>2]=1)}for(;t=n,(0|n)>=2&&48==u[((n=t+-1|0)<<1)+e>>1];);i[r>>2]=t}(r+16|0,r+8|0,r+12|0,l),o=i[r+12>>2],a[r+58>>1]=o,c=i[r+8>>2],a[r+56>>1]=c),n[r+46|0]=o,a[r+48>>1]=c+16384&32767|f,le(2300,2376,r+16|0),e=h[297];break e}e=h[275]}else i[596]=1;return M=r- -64|0,e}(e=+e,t=+t)},Mathpack_RoundUp:function(e,t){return+function(e,t){var r=0,n=0,a=0,o=0,u=0;d(+e),r=0|s(1),s(0);(n=-65536&r)&&(2146435072!=(2146435072&r)?u=(0|n)<1?-1:1:i[596]=1);if(a=L(e,t),h[297]=e,h[297]=V(e),J(a),(r=i[595])>>>0>=65536){if(2146435072==(2146435072&r))return i[596]=1,a;if(r=(0|(r=ne(t)<<16))<0?309:r>>16,d(+t),n=0|s(1),s(0),(o=-65536&n)&&(2146435072!=(2146435072&n)?r=(0|o)<1?0-r|0:r:i[596]=1),(0|r)<=-309)return B(8),0;H(0-r|0),(0|u)>-1||(r=i[595])>>>0<65536||(i[595]=-2147483648^r),q(a),a=h[297]}return a}(e=+e,t=+t)},Mathpack_RoundDown:function(e,t){var r;return d(+(e=L(e=+e,t=+t))),r=0|s(1),s(0),2146435072==(2146435072&r)&&(i[596]=1,e=-1),+e},Mathpack_Compare:function(e,t){return+(0|function(e,t){var r,n=0,a=0,o=0,u=0,c=0;M=r=M-16|0,h[r+8>>3]=e,h[r>>3]=t,d(+e),n=0|s(1),a=0|s(0),o=n,d(+t),n=0|s(1),u=0|s(0),c=n;e:{if((0|a)!=(0|u)||(0|o)!=(0|n)){if((c+2097152&2146435072)-(2146435072&o)>>>0<=5242879&&(e=V(e),h[r+8>>3]=e,d(+e),n=0|s(1),s(0),o=n,e=V(t),h[r>>3]=e,d(+e),n=0|s(1),s(0),c=n),n=1,o=i[(u=(a=(c&o)>-1)?r+8|0:r)+4>>2],c=i[(a=a?r:r+8|0)+4>>2],(0|o)>(0|c))break e;if((0|o)<(0|c)){n=-1;break e}if(u=i[u>>2],a=i[a>>2],u>>>0>a>>>0)break e;if(n=-1,u>>>0<a>>>0)break e}n=0}return M=r+16|0,n}(e=+e,t=+t))},Mathpack_GetExp32:function(e){var t;return d(+(e=+e)),t=0|s(1),s(0),2146435072&t},Mathpack_Equal:function(e,t){t=+t;var r,n,a=0;return d(+(e=+e)),a=0|s(1),r=0|s(0),d(+t),n=0|s(1),0|(a=(0|r)==(0|s(0))?(0|a)==(0|n):0)},Mathpack_ViewRound:function(e){var t;return d(+(e=+e)),t=0|s(1),s(0),2146435072==(2146435072&t)?(i[596]=1,-1):+V(e)},Mathpack_Sqrt:function(e){return e=+e,h[297]=e,oe(),+h[297]},Mathpack_Exp:function(e){return e=+e,h[297]=e,se(),+h[297]},Mathpack_Ln:function(e){return e=+e,h[297]=e,te(),+h[297]},Mathpack_Log:function(e){return e=+e,h[297]=e,function(){var e,t;e=+A(+h[297]),h[297]=e,d(+e),t=0|s(1),s(0),2146435072==(2146435072&t)&&(i[596]=8)}(),+h[297]},Mathpack_Sin:function(e){return e=+e,h[297]=e,function(){var e=0,t=0;d(+(t=h[297])),e=0|s(1),s(0),1101004799==(0|(e&=2145386496))&!0|e>>>0<1101004799&&(t=+R(+t),h[297]=t,d(+t),e=0|s(1),s(0),2146435072!=(2146435072&e))||(i[596]=8)}(),+h[297]},Mathpack_Cos:function(e){return e=+e,h[297]=e,function(){var e=0,t=0;d(+(t=h[297])),e=0|s(1),s(0),1101004799==(0|(e&=2145386496))&!0|e>>>0<1101004799&&(t=+I(+t),h[297]=t,d(+t),e=0|s(1),s(0),2146435072!=(2146435072&e))||(i[596]=8)}(),+h[297]},Mathpack_Tan:function(e){return e=+e,h[297]=e,function(){var e=0,t=0,r=0;r=8,d(+(t=h[297])),e=0|s(1),s(0);1101004799==(0|(e&=2145386496))&!0|e>>>0<1101004799&&(t=+T(+t),h[297]=t,r=4,d(+t),e=0|s(1),s(0),2146435072!=(2146435072&e))||(i[596]=r)}(),+h[297]},Mathpack_Asin:function(e){return+U(e=+e,0)},Mathpack_Acos:function(e){return+U(e=+e,1)},Mathpack_Atan:function(e){return e=+e,h[297]=e,ue(),+h[297]},Mathpack_Atan2:function(e,t){return+function(e,t){var r=0,n=0,a=0,o=0,u=0,c=0;h[297]=e;e:{if(d(+e),r=0|s(1),s(0),r>>>0>=65536){if(2146435072!=(2146435072&r))break e;i[596]=1}h[297]=t;t:{if(d(+t),r=0|s(1),s(0),n=-65536&r){if(2146435072!=(2146435072&r))break t;i[596]=1}return B(4),0}return ee((0|n)<1?-1:1),X(h[270]),h[297]=Z(h[297],h[272]),h[297]}e:if((0|r)<=-1){d(+t),r=0|s(1),s(0);t:{if(n=-65536&r)if(2146435072!=(2146435072&r)){if((0|n)<1)break t}else i[596]=1;a=h[270];break e}d(+(a=h[270])),r=0|s(1),n=0|s(0),o=-2147483648^r,l(0,0|n),l(1,0|o),u=+f(),c=a,a=65535==(0|r)&n>>>0>4294967295|r>>>0>65535?u:c}else a=h[275];return pe(t,e),ue(),q(a),h[297]}(e=+e,t=+t)},Mathpack_FormatGeneral:function(e,t){t|=0;var r,n,o,c=0,l=0;return d(+(e=+e)),r=0|s(1),o=0|s(0),2146435072==(2146435072&r)?(i[596]=1,-1):(h[297]=e,c=2304,(n=-65536&(l=r))&&(2146435072!=(2146435072&l)?(c=2304,(0|n)>0||(l>>>0>=65536&&(i[595]=-2147483648^l),c=2304,!o&-2147483648==(0|r)||(a[1152]=45,c=2306))):(i[596]=1,c=2304)),l=c,t=(0|t)<21?t:21,t=function(e,t,r,n){var o;M=o=M-16|0,e=0|me[i[i[e>>2]+8>>2]](e),i[o+8>>2]=0;e:if(r<<1>>>0<=33){if((0|r)<1)break e;a[t>>1]=0}else fe(h[297],o+8|0,t),t=function(e,t,r,n,o,c){var s,l,f,d=0,h=0,p=0,m=0,g=0;M=l=M-16|0,s=(t<<1)+e|0,f=l+12|0;t:{r:{n:{a:if(!(p=(0|r)<5&(h=o?n:1)+3>>>0<8)){i:if(!((0|h)>(0|r))){if((0|(n=r+h|0))>=3){if((0|r)<5|(0|h)>-4)break a;if((n+-2|0)<(0|o))break i;break a}if((0|r)<5)break a}if(m=1,n=1,(0|r)<7)break n;n=r-(h+97>>>0>196?6:5)|0;break n}(1!=(0|r)||(n=0,h))&&(n=r-((0|h)<(0|r)?(0|h)<1?2-h|0:1:0)|0)}n:{if((0|n)<(0|o)){d=1,o=0;a:if(!((0|t)<1)){i:{o:{if(!n){if(u[e>>1]>52)break o;break a}if((0|n)<1|(0|n)>=(0|t))break a;if(u[(n<<1)+e>>1]<=52)break i;for(;;){if(g=u[(d=((o=n+-1|0)<<1)+e|0)>>1]+1|0,a[d>>1]=g,58!=(65535&g))break i;if(n=o,!o)break}}a[e>>1]=49,o=1,d=h+1|0;break a}for(;(0|(o=n))>=2&&48==u[((n=o+-1|0)<<1)+e>>1];);d=h}if((-1^p)&(0|d)>(0|r)|m)break n;break r}if(d=h,!m)break r}if(i[f>>2]=32768,r=e+2|0,(0|o)<2||(n=r+(o<<1)|0)>>>0>=s>>>0?n=r:(o=o+-1|0,i[f>>2]=32768|o,e=e+4|0,(t<<1)-4>>1>>>0<o>>>0&&(_(1),y()),w(e,r,o<<1),a[r>>1]=c),n>>>0<s>>>0&&(a[n>>1]=69,n=n+2|0),n>>>0>=s>>>0?o=n:(o=n+2|0,(0|d)<=0?(a[n>>1]=45,d=1-d|0):(a[n>>1]=43,d=d+-1|0)),(0|d)<100|o>>>0>=s>>>0||(e=(d>>>0)/100|0,a[o>>1]=e+48,d=d-v(e,100)|0,o=o+2|0),o>>>0<s>>>0&&(a[o>>1]=48+((0|d)/10|0),o=o+2|0),o>>>0>=s>>>0)break t;a[o>>1]=48+((0|d)%10|0),o=o+2|0;break t}if((0|o)<0|(0|o)>(0|d))if(r=o-d|0,i[f>>2]=r,(0|d)>=1){if(!((r=(n=((p=(r=(h=(0|d)>(0|t)?t:d)<<1)+e|0)+(o<<1)|0)-r|0)+-2|0)>>>0<e>>>0|n>>>0>=s>>>0))for(;a[n>>1]=u[r>>1],n=n+-2|0,(r=r+-2|0)>>>0>=p>>>0;);(0|d)<(0|t)&&(a[p>>1]=c),o=p+(((0|(e=s-p>>1))>(0|(t=o-h|0))?t+1|0:e)<<1)|0}else{if(!((n=2+((e-(d<<1)|0)+(o<<1)|0)|0)>>>0>=s>>>0||(o=((o<<1)+e|0)-2|0)>>>0<e>>>0))for(;a[n>>1]=u[o>>1],n=n+-2|0,(o=o+-2|0)>>>0>=e>>>0;);if((0|t)>=1&&(a[e>>1]=48,e=e+2|0),e>>>0<s>>>0&&(a[e>>1]=c,e=e+2|0),n=s-e>>1,d&&(t=(0|n)<(0|(t=0-d|0))?n:t))for(o=0;a[(o<<1)+e>>1]=48,(0|t)!=(0|(o=o+1|0)););o=(((0|n)<(0|r)?n:r)<<1)+e|0}else{if(r=(n=(0|d)>(0|t)?t:d)-o|0)for(t=(o<<1)+e|0,o=0;a[t+(o<<1)>>1]=48,(0|r)!=(0|(o=o+1|0)););o=(n<<1)+e|0}}return M=l+16|0,o}(t,r,n,a[o+8>>1],a[o+10>>1],e);return M=o+16|0,t}(i[256],l,2348-l>>1,(0|t)>0?t:0),i[594]=0,i[595]=0,t-2304>>1)},Mathpack_Pack:function(e,t,r){var o;return e|=0,t|=0,r|=0,M=o=M-48|0,n[o+39|0]=0,w(o+8|0,2304,(r=(0|r)<15?r:15)<<1),a[o+40>>1]=t+16384&32767|!e<<15,n[o+38|0]=r,i[o>>2]=0,i[o+4>>2]=0,le(i[256],o,o+8|0)&&(i[596]=1),M=o+48|0,+h[o>>3]},_start:D,__errno_location:function(){return 2400},setThrew:function(e,t){e|=0,t|=0,i[598]||(i[599]=t,i[598]=e)},stackSave:function(){return 0|M},stackAlloc:function(e){return M=e=M-(e|=0)&-16,0|e},stackRestore:function(e){M=e|=0},__growWasmMemory:function(e){return 0,0|y()}}}({Math:n.Math,Int8Array:Int8Array,Uint8Array:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array,NaN:NaN,Infinity:1/0},{abort:function(){throw new Error("abort")},Base_LocaleIsNumeral:a.Base_LocaleIsNumeral,Base_LocaleGetOrdinal:a.Base_LocaleGetOrdinal,Base_LocaleDecimalSeparator:a.Base_LocaleDecimalSeparator,Math_log10:a.Math_log10,Math_log:a.Math_log,Math_sqrt:a.Math_sqrt,Math_sin:a.Math_sin,Math_cos:a.Math_cos,Math_tan:a.Math_tan,Math_atan:a.Math_atan,Math_exp:a.Math_exp,proc_exit:i.proc_exit},v),g=m.memory;t.memory=g;var C=m.Base_StrBuf;t.Base_StrBuf=C;var S=m.Base_StrBufSize;t.Base_StrBufSize=S;var y=m.Dtr_DaysPerMonth;t.Dtr_DaysPerMonth=y;var E=m.Dtr_FromNum;t.Dtr_FromNum=E;var O=m.Dtr_Yr;t.Dtr_Yr=O;var k=m.Dtr_Mon;t.Dtr_Mon=k;var A=m.Dtr_DOM;t.Dtr_DOM=A;var b=m.Dtr_Hour;t.Dtr_Hour=b;var R=m.Dtr_Min;t.Dtr_Min=R;var I=m.Dtr_Sec;t.Dtr_Sec=I;var T=m.Dtr_Wdy;t.Dtr_Wdy=T;var N=m.Dtr_FracSec;t.Dtr_FracSec=N;var F=m.Dtr_Rounding;t.Dtr_Rounding=F;var _=m.Dtr_ToNum;t.Dtr_ToNum=_;var M=m.Dtr_Days;t.Dtr_Days=M;var D=m.Dtr_ToDays;t.Dtr_ToDays=D;var w=m.Mathpack_Zero;t.Mathpack_Zero=w;var L=m.Mathpack_One;t.Mathpack_One=L;var U=m.Mathpack_Pi;t.Mathpack_Pi=U;var x=m.Mathpack_Div;t.Mathpack_Div=x;var P=m.Mathpack_Mul;t.Mathpack_Mul=P;var G=m.Mathpack_Sub;t.Mathpack_Sub=G;var V=m.Mathpack_Add;t.Mathpack_Add=V;var B=m.Mathpack_Power;t.Mathpack_Power=B;var W=m.Mathpack_Cond;t.Mathpack_Cond=W;var j=m.Mathpack_Cond2;t.Mathpack_Cond2=j;var H=m.Mathpack_TakeMathError;t.Mathpack_TakeMathError=H;var K=m.Mathpack_Trunc;t.Mathpack_Trunc=K;var q=m.Mathpack_Ceil;t.Mathpack_Ceil=q;var Y=m.Mathpack_Floor;t.Mathpack_Floor=Y;var J=m.Mathpack_Abs;t.Mathpack_Abs=J;var Q=m.Mathpack_Neg;t.Mathpack_Neg=Q;var X=m.Mathpack_Float;t.Mathpack_Float=X;var z=m.Mathpack_SFloat;t.Mathpack_SFloat=z;var Z=m.Mathpack_Fix;t.Mathpack_Fix=Z;var $=m.Mathpack_LFix;t.Mathpack_LFix=$;var ee=m.Mathpack_SFix;t.Mathpack_SFix=ee;var te=m.Mathpack_Round;t.Mathpack_Round=te;var re=m.Mathpack_RoundUp;t.Mathpack_RoundUp=re;var ne=m.Mathpack_RoundDown;t.Mathpack_RoundDown=ne;var ae=m.Mathpack_Compare;t.Mathpack_Compare=ae;var ie=m.Mathpack_GetExp32;t.Mathpack_GetExp32=ie;var oe=m.Mathpack_Equal;t.Mathpack_Equal=oe;var ue=m.Mathpack_ViewRound;t.Mathpack_ViewRound=ue;var ce=m.Mathpack_Sqrt;t.Mathpack_Sqrt=ce;var se=m.Mathpack_Exp;t.Mathpack_Exp=se;var le=m.Mathpack_Ln;t.Mathpack_Ln=le;var fe=m.Mathpack_Log;t.Mathpack_Log=fe;var de=m.Mathpack_Sin;t.Mathpack_Sin=de;var he=m.Mathpack_Cos;t.Mathpack_Cos=he;var ve=m.Mathpack_Tan;t.Mathpack_Tan=ve;var pe=m.Mathpack_Asin;t.Mathpack_Asin=pe;var me=m.Mathpack_Acos;t.Mathpack_Acos=me;var ge=m.Mathpack_Atan;t.Mathpack_Atan=ge;var Ce=m.Mathpack_Atan2;t.Mathpack_Atan2=Ce;var Se=m.Mathpack_FormatGeneral;t.Mathpack_FormatGeneral=Se;var ye=m.Mathpack_Pack;t.Mathpack_Pack=ye;var Ee=m._start;t._start=Ee;var Oe=m.__errno_location;t.__errno_location=Oe;var ke=m.setThrew;t.setThrew=ke;var Ae=m.stackSave;t.stackSave=Ae;var be=m.stackAlloc;t.stackAlloc=be;var Re=m.stackRestore;t.stackRestore=Re;var Ie=m.__growWasmMemory;t.__growWasmMemory=Ie},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0});var a,i=r(4),o=r(6);function u(e){return{num:e}}!function(e){e[e.None=0]="None",e[e.Over=1]="Over",e[e.Under=2]="Under",e[e.DivBy0=4]="DivBy0",e[e.Trans=8]="Trans",e[e._NA=16]="_NA",e[e._Val=32]="_Val",e[e._Num=64]="_Num"}(a=t.MathErrorNum||(t.MathErrorNum={}));var c=((n={})[a.Over]=u(a.Over),n[a.Under]=u(a.Under),n[a.DivBy0]=u(a.DivBy0),n[a.Trans]=u(a.Trans),n);function s(e){var t;return null!=(t=c[e])?t:u(e)}function l(e){return function(t){var r=e(t),n=i.Mathpack_TakeMathError();return n===a.None?r:s(n)}}function f(e){return function(t,r){var n=e(t,r),o=i.Mathpack_TakeMathError();return o===a.None?n:s(o)}}t.mathError=s,t.zero=i.Mathpack_Zero,t.one=i.Mathpack_One,t.pi=i.Mathpack_Pi,t.exp32=i.Mathpack_GetExp32,t.equal=function(e,t){return 0!==i.Mathpack_Equal(e,t)},t.trunc=i.Mathpack_Trunc,t.ceil=l(i.Mathpack_Ceil),t.floor=l(i.Mathpack_Floor),t.abs=i.Mathpack_Abs,t.neg=i.Mathpack_Neg,t.float=function(e){return e<0?i.Mathpack_SFloat(e):i.Mathpack_Float(e)},t.fix=function(e){return i.Mathpack_Fix(e)>>>0},t.lfix=i.Mathpack_LFix,t.sfix=l(i.Mathpack_SFix),t.round=f(i.Mathpack_Round),t.roundUp=f(i.Mathpack_RoundUp),t.roundDown=f(i.Mathpack_RoundDown),t.compare=i.Mathpack_Compare,t.div=f(i.Mathpack_Div),t.mul=f(i.Mathpack_Mul),t.sub=f(i.Mathpack_Sub),t.add=f(i.Mathpack_Add),t.power=f(i.Mathpack_Power),t.cond=function(e){var t=i.Mathpack_Cond(e),r=i.Mathpack_TakeMathError();return r===a.None?t:s(r)},t.cond2=i.Mathpack_Cond2,t.viewRound=l(i.Mathpack_ViewRound),t.sqrt=l(i.Mathpack_Sqrt),t.exp=l(i.Mathpack_Exp),t.ln=l(i.Mathpack_Ln),t.log=l(i.Mathpack_Log),t.sin=l(i.Mathpack_Sin),t.cos=l(i.Mathpack_Cos),t.tan=l(i.Mathpack_Tan),t.asin=l(i.Mathpack_Asin),t.acos=l(i.Mathpack_Acos),t.atan=l(i.Mathpack_Atan),t.atan2=f(i.Mathpack_Atan2),t.formatGeneral=function(e,t,r){try{o.setLocale(e);var n=i.Mathpack_FormatGeneral(t,r);return n<0?s(i.Mathpack_TakeMathError()):o.pxcharToStr(i.Base_StrBuf(),n)}finally{o.setLocale(void 0)}},t.pack=function(e,t,r,n){try{o.setLocale(e);var u=o.fastMin(n.length,i.Base_StrBufSize());o.strToPxchar(i.Base_StrBuf(),n.substring(0,u));var c=i.Mathpack_Pack(!!t,r,u),l=i.Mathpack_TakeMathError();return l!==a.None?s(l):isNaN(c)?s(a.Over):c}finally{o.setLocale(void 0)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(4),a=void 0;t.setLocale=function(e){a=e};t.Base_LocaleIsNumeral=function(e){return a.isNumeral(e)?1:0},t.Base_LocaleGetOrdinal=function(e){return a.getOrdinal(e)},t.Base_LocaleDecimalSeparator=function(){var e=a.decimalSeparator;return 0===e.length?46:e.charCodeAt(0)},t.fastMin=function(e,t){return e<t?e:t},t.pxcharToStr=function(e,t){for(var r=new Uint16Array(n.memory.buffer),a="",i=0;i<t;i+=1)a+=String.fromCharCode(r[e+(i<<1)>>1]);return a},t.strToPxchar=function(e,t){for(var r=new Uint16Array(n.memory.buffer),a=0;a<t.length;a+=1)r[e+(a<<1)>>1]=t.charCodeAt(a)}},function(e,t,r){r(8),e.exports=r(21)},function(e,t,r){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */var n;n=function(){"use strict";function e(e){return"function"==typeof e}var t=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},r=0,n=void 0,a=void 0,i=function(e,t){d[r]=e,d[r+1]=t,2===(r+=2)&&(a?a(h):C())},o="undefined"!=typeof window?window:void 0,u=o||{},c=u.MutationObserver||u.WebKitMutationObserver,s="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),l="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function f(){var e=setTimeout;return function(){return e(h,1)}}var d=new Array(1e3);function h(){for(var e=0;e<r;e+=2)(0,d[e])(d[e+1]),d[e]=void 0,d[e+1]=void 0;r=0}var v,p,m,g,C=void 0;function S(e,t){var r=this,n=new this.constructor(O);void 0===n[E]&&M(n);var a=r._state;if(a){var o=arguments[a-1];i((function(){return F(a,n,o,r._result)}))}else T(r,n,e,t);return n}function y(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(O);return A(t,e),t}s?C=function(){return process.nextTick(h)}:c?(p=0,m=new c(h),g=document.createTextNode(""),m.observe(g,{characterData:!0}),C=function(){g.data=p=++p%2}):l?((v=new MessageChannel).port1.onmessage=h,C=function(){return v.port2.postMessage(0)}):C=void 0===o?function(){try{var e=Function("return this")().require("vertx");return void 0!==(n=e.runOnLoop||e.runOnContext)?function(){n(h)}:f()}catch(e){return f()}}():f();var E=Math.random().toString(36).substring(2);function O(){}function k(t,r,n){r.constructor===t.constructor&&n===S&&r.constructor.resolve===y?function(e,t){1===t._state?R(e,t._result):2===t._state?I(e,t._result):T(t,void 0,(function(t){return A(e,t)}),(function(t){return I(e,t)}))}(t,r):void 0===n?R(t,r):e(n)?function(e,t,r){i((function(e){var n=!1,a=function(e,t,r,n){try{e.call(t,r,n)}catch(e){return e}}(r,t,(function(r){n||(n=!0,t!==r?A(e,r):R(e,r))}),(function(t){n||(n=!0,I(e,t))}),e._label);!n&&a&&(n=!0,I(e,a))}),e)}(t,r,n):R(t,r)}function A(e,t){if(e===t)I(e,new TypeError("You cannot resolve a promise with itself"));else if(a=typeof(n=t),null===n||"object"!==a&&"function"!==a)R(e,t);else{var r=void 0;try{r=t.then}catch(t){return void I(e,t)}k(e,t,r)}var n,a}function b(e){e._onerror&&e._onerror(e._result),N(e)}function R(e,t){void 0===e._state&&(e._result=t,e._state=1,0!==e._subscribers.length&&i(N,e))}function I(e,t){void 0===e._state&&(e._state=2,e._result=t,i(b,e))}function T(e,t,r,n){var a=e._subscribers,o=a.length;e._onerror=null,a[o]=t,a[o+1]=r,a[o+2]=n,0===o&&e._state&&i(N,e)}function N(e){var t=e._subscribers,r=e._state;if(0!==t.length){for(var n=void 0,a=void 0,i=e._result,o=0;o<t.length;o+=3)n=t[o],a=t[o+r],n?F(r,n,a,i):a(i);e._subscribers.length=0}}function F(t,r,n,a){var i=e(n),o=void 0,u=void 0,c=!0;if(i){try{o=n(a)}catch(e){c=!1,u=e}if(r===o)return void I(r,new TypeError("A promises callback cannot return that same promise."))}else o=a;void 0!==r._state||(i&&c?A(r,o):!1===c?I(r,u):1===t?R(r,o):2===t&&I(r,o))}var _=0;function M(e){e[E]=_++,e._state=void 0,e._result=void 0,e._subscribers=[]}var D=function(){function e(e,r){this._instanceConstructor=e,this.promise=new e(O),this.promise[E]||M(this.promise),t(r)?(this.length=r.length,this._remaining=r.length,this._result=new Array(this.length),0===this.length?R(this.promise,this._result):(this.length=this.length||0,this._enumerate(r),0===this._remaining&&R(this.promise,this._result))):I(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var t=0;void 0===this._state&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var r=this._instanceConstructor,n=r.resolve;if(n===y){var a=void 0,i=void 0,o=!1;try{a=e.then}catch(e){o=!0,i=e}if(a===S&&void 0!==e._state)this._settledAt(e._state,t,e._result);else if("function"!=typeof a)this._remaining--,this._result[t]=e;else if(r===w){var u=new r(O);o?I(u,i):k(u,e,a),this._willSettleAt(u,t)}else this._willSettleAt(new r((function(t){return t(e)})),t)}else this._willSettleAt(n(e),t)},e.prototype._settledAt=function(e,t,r){var n=this.promise;void 0===n._state&&(this._remaining--,2===e?I(n,r):this._result[t]=r),0===this._remaining&&R(n,this._result)},e.prototype._willSettleAt=function(e,t){var r=this;T(e,void 0,(function(e){return r._settledAt(1,t,e)}),(function(e){return r._settledAt(2,t,e)}))},e}(),w=function(){function t(e){this[E]=_++,this._result=this._state=void 0,this._subscribers=[],O!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof t?function(e,t){try{t((function(t){A(e,t)}),(function(t){I(e,t)}))}catch(t){I(e,t)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return t.prototype.catch=function(e){return this.then(null,e)},t.prototype.finally=function(t){var r=this.constructor;return e(t)?this.then((function(e){return r.resolve(t()).then((function(){return e}))}),(function(e){return r.resolve(t()).then((function(){throw e}))})):this.then(t,t)},t}();return w.prototype.then=S,w.all=function(e){return new D(this,e).promise},w.race=function(e){var r=this;return t(e)?new r((function(t,n){for(var a=e.length,i=0;i<a;i++)r.resolve(e[i]).then(t,n)})):new r((function(e,t){return t(new TypeError("You must pass an array to race."))}))},w.resolve=y,w.reject=function(e){var t=new this(O);return I(t,e),t},w._setScheduler=function(e){a=e},w._setAsap=function(e){i=e},w._asap=i,w.polyfill=function(){var e=void 0;if("undefined"!=typeof global)e=global;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var r=null;try{r=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===r&&!t.cast)return}e.Promise=w},w.Promise=w,w.polyfill(),w},e.exports=n()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.forEachPromise=function(e,t,r){return e.reduce((function(e,n){return e.then((function(){return r&&r.stop?Promise.resolve(void 0):t(n,r)}))}),Promise.resolve(void 0))},t.defaultToJSONResultWhenStringifyFails="...",t.getStringifiedError=function(e){if(0===e)return"0";if(!e)return"";try{return JSON.stringify(function e(t,r){void 0===r&&(r=0);if(r<0||r>5)return t;if(null==t||"object"!=typeof t)return t;var n={};Object.getOwnPropertyNames(t).forEach((function(e){"stack"!==e&&e.toUpperCase()!==e&&(n[e]=t[e])}));var a=Object.getPrototypeOf(t);a&&"object"==typeof a&&Object.keys(a).forEach((function(e){"stack"!==e&&e.toUpperCase()!==e&&(n[e]=t[e])}));var i={};return Object.keys(n).forEach((function(t){i[t]=e(n[t],r+1)})),i}(e))}catch(e){return t.defaultToJSONResultWhenStringifyFails}};var n=new RegExp("\\W+","g");t.getPerfWatchMarkName=function(e){if(!e)return"";var t=e.trim().substring(0,200).trim().replace(n,"_").substring(0,80);return t&&t.length>0&&"_"===t.substr(t.length-1,1)&&(t=t.substr(0,t.length-1)),t&&t.length>0&&"_"===t.substr(0,1)&&(t=t.substr(1)),t},t.retry=function(e,t){if(!e)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(t<1)return Promise.reject(new Error("utils.retry: attempts expected to be greater than 0 but got "+t));for(var r=Promise.reject(),n=function(t){r=r.catch((function(r){return e(t,r)}))},a=1;a<=t;a+=1)n(a);return r},t.chainFallbackPromises=function(e,t){if(!e||0===e.length)return Promise.reject();for(var r=t(e[0]),n=function(n){var a=e[n];r=r.catch((function(){return t(a)}))},a=1;a<e.length;a+=1)n(a);return r},t.getQueryParameterByName=function(e,t){var r=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(e);if(r)return r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):""},t.decodeHtml=function(e){return"string"==typeof e?(new DOMParser).parseFromString(e,"text/html").documentElement.textContent:e},t.calcHashCode=function(e){if(!e)return 0;for(var t=5381,r=t,n=e.length,a=0;a<n&&(t=4294967295&((t<<5)+t^e.charCodeAt(a)),a!==n-1);a+=2)r=4294967295&((r<<5)+r^e.charCodeAt(a+1));var i=t+35685*r+(23896*r<<16)&4294967295;return i<0&&(i+=4294967296),i},t.getCharIndexInTextFromPoint=function(e,t){var r=-1,n=null;if(void 0!==document.caretPositionFromPoint)null!==(a=document.caretPositionFromPoint(e,t))&&(r=a.offset,n=null!=a.offsetNode&&null!=a.offsetNode.parentElement&&"SPAN"===a.offsetNode.parentElement.nodeName?a.offsetNode.parentElement:a.offsetNode);else if(void 0!==document.caretRangeFromPoint){null!==(a=document.caretRangeFromPoint(e,t))&&(r=a.startOffset,n=null!=a.startContainer&&null!=a.startContainer.parentElement&&"SPAN"===a.startContainer.parentElement.nodeName?a.startContainer.parentElement:a.startContainer)}else try{var a;n=document.elementFromPoint(e,t),(a=document.body.createTextRange()).moveToPoint(e,t);var i=document.body.createTextRange();i.moveToElementText(n),i.setEndPoint("EndToStart",a),r=i.text.length}catch(e){return r}for(;null!=n;)null!=(n=n.previousSibling)&&null!=n.textContent&&(r+=n.textContent.length);return r},t.getBoundingRectForText=function(e,t,r){function n(e,t,r){if(!e||!e.textContent)return t;if(t<0||t>e.textContent.length)return t-e.textContent.length;if(!e.hasChildNodes())return r(e,t),t-e.textContent.length;for(var a=e.childNodes,i=0;i<a.length&&t>=0;i+=1)t=n(a[i],t,r);return t}var a=document.createRange();return n(e,t,(function(e,t){return a.setStart(e,t)})),n(e,r,(function(e,t){return a.setEnd(e,t)})),a.getBoundingClientRect()}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(t.TraceLevel||(t.TraceLevel={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS"}(t.LogCategory||(t.LogCategory={})),t.ULS={getFromExternalLogger:function(e){var t=e;return{ULS:{trace:function(e,r,n){return t.traceTag(0,e,r,n)},traceTag:function(e,r,n,a){return t.traceTag(e,r,n,a)},debugTrace:function(e,r,n){return t.debugTraceTag(0,e,r,n)},debugTraceTag:function(e,r,n,a){return t.debugTraceTag(e,r,n,a)},assert:function(e,r,n){return t.assertTag(0,e,r,n)},assertTag:function(e,r,n,a){return t.assertTag(e,r,n,a)},shipAssert:function(e,r,n){return t.shipAssertTag(0,e,r,n)},shipAssertTag:function(e,r,n,a){return t.shipAssertTag(e,r,n,a)}}}}};var n=function(){function e(){}return e.prototype.shipAssertTag=function(e,t,r,n){console.assert(r,"shipAssertTag:",e,t,n)},e.prototype.assertTag=function(e,t,r,n){console.assert(r,"assertTag",e,t,n)},e.prototype.traceTag=function(e,t,r,n){console.log("traceTag",e,n,t,r)},e.prototype.debugTraceTag=function(e,t,r,n){console.log("debugTraceTag",e,n,t,r)},e}();t.ConsoleLogger=n;var a=function(){function e(){}return e.prototype.shipAssertTag=function(){},e.prototype.assertTag=function(){},e.prototype.traceTag=function(){},e.prototype.debugTraceTag=function(){},e}();t.NulLogger=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={};t.promises=function(){return void 0===n.promises&&(n.promises="undefined"!=typeof Promise&&"function"==typeof Promise.resolve&&Promise.resolve(0)&&"function"==typeof Promise.resolve(0).then),n.promises}},function(e,t,r){"use strict";function n(){return window.performance&&window.performance.now?window.performance.now():Date.now()}function a(e,t,r){e[t]=n()-r}Object.defineProperty(t,"__esModule",{value:!0}),t.start=function(e){var t=n(),r=e,i=t,o={},u=function(e,t,n){return function(e,t,r,n,i,o){a(e,"end",r);var u={sessionName:t,result:n?"success":"failure",message:o,marks:e},c=JSON.stringify(u);i(c)}(o,r,i,e,t,n)};return o.start=0,{mark:function(e){return function(e){return a(o,e,i)}(e)},end:function(e){return u(!0,e)},success:function(e,t){return u(!0,e,t)},failure:function(e,t){return u(!1,e,t)}}},t.mark=function(e,t){void 0!==e&&e.mark(t)},t.end=function(e,t){void 0!==e&&e.end(t)},t.success=function(e,t,r){void 0!==e&&e.success(t,r)},t.failure=function(e,t,r){void 0!==e&&e.failure(t,r)},t.timeStamp=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={isChangeGateEnabled:function(e){return!1}};t.ewaUtils=function(){return n},t.initEwaUtils=function(e){if(!e)throw new Error("the 'ewaUtils' argument is missing");n=e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){return Date.now()};t.initStopwatchFactory=function(e,t){return void 0===t&&(t=1),"undefined"!=typeof self&&self.performance&&self.performance.now&&(n=function(){return self.performance.now()}),function(r){var a=n(),i=r;return{reset:function(e){null!=e&&(i=e),a=n()},stop:function(r){var o=n()-a,u=JSON.stringify({Target:i,Duration:o.toFixed(t),StopInfo:r});e(u)}}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNewGuid=function(){var e=new Uint8Array(31),t=function(e){var t={crypto:!1,perfNow:!1,exceptions:[]},r=window.crypto||window.msCrypto;if(r){t.crypto=!0;try{return r.getRandomValues(e),t}catch(e){t.exceptions.push("crypto: "+JSON.stringify(e))}}var n=!1,a=window.performance;try{a&&a.now&&a.now()!==1/0&&(n=!0)}catch(e){t.exceptions.push("perfNow: "+JSON.stringify(e))}for(var i=0;i<e.length;i+=1){try{if(n){t.perfNow=!0;var o=Math.floor(100*a.now())%10;(o<0||o>9)&&(o=0);for(var u=0;u<o;u+=1)Math.random()}}catch(e){t.exceptions.push("Math.random: "+JSON.stringify(e))}e[i]=Math.floor(16*Math.random())}return t}(e),r=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=15&e[r];return r+=1,("x"===t?n:3&n|8).toString(16)})),t]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Auto="auto",e.Manual="manual"}(t.TextAreaVirtualKeyboardPolicy||(t.TextAreaVirtualKeyboardPolicy={})),function(e){e.None="none",e.Text="text",e.Tel="tel",e.Url="url",e.Email="email",e.Numeric="numeric",e.Decimal="decimal",e.Search="search"}(t.TextAreaInputMode||(t.TextAreaInputMode={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Math=void 0;const n=function(e){if(e.imul&&e.fround&&e.clz32)return e;const t=new Float32Array(1);return Object.create(e,{imul:{value:function(e,t){var r=(4194303&e)*(t|=0);return 4290772992
/*!== 0*/&e&&(r+=(4290772992&e)*t|0),0|r}},fround:{value:function(e){return t[0]=e,t[0]}},clz32:{value:function(t){var r=t>>>0;return 0===r?32:31-(e.log(r)/e.LN2|0)|0}}})}(Math);t.Math=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Base_LocaleIsNumeral",{enumerable:!0,get:function(){return n.Base_LocaleIsNumeral}}),Object.defineProperty(t,"Base_LocaleGetOrdinal",{enumerable:!0,get:function(){return n.Base_LocaleGetOrdinal}}),Object.defineProperty(t,"Base_LocaleDecimalSeparator",{enumerable:!0,get:function(){return n.Base_LocaleDecimalSeparator}}),t.Math_atan=t.Math_tan=t.Math_cos=t.Math_sin=t.Math_exp=t.Math_log=t.Math_log10=t.Math_sqrt=void 0;var n=r(6);const a=Math.sqrt;t.Math_sqrt=a;const i=Math.log10||function(e){return Math.log(e)*Math.LOG10E};t.Math_log10=i;const o=Math.log;t.Math_log=o;const u=Math.exp;t.Math_exp=u;const c=Math.sin;t.Math_sin=c;const s=Math.cos;t.Math_cos=s;const l=Math.tan;t.Math_tan=l;const f=Math.atan;t.Math_atan=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.proc_exit=function(e){throw new Error("unexpected process termination: "+e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(4),a=r(5);function i(e,t,r,n,a,i,o,u,c){return{yr:e,mon:t,dom:r,hour:n,min:a,sec:i,wdy:o,fracSec:u,rounding:c}}t.daysPerMonth=function(e,t,r){return n.Dtr_DaysPerMonth(e,t,r?1:0)},function(e){e[e.RoundSec=0]="RoundSec",e[e.Round10ths=1]="Round10ths",e[e.Round100ths=2]="Round100ths",e[e.Round1000ths=3]="Round1000ths"}(t.Rounding||(t.Rounding={})),t.dtr=i,t.fromNum=function(e,t,r,a){var o=t;return 0===n.Dtr_FromNum(e,o,r?1:0,a?1:0)&&i(n.Dtr_Yr(),n.Dtr_Mon(),n.Dtr_DOM(),n.Dtr_Hour(),n.Dtr_Min(),n.Dtr_Sec(),n.Dtr_Wdy(),n.Dtr_FracSec(),n.Dtr_Rounding())},t.toNum=function(e,t,r){var i=n.Dtr_ToNum(e.yr,e.mon,e.dom,e.hour,e.min,e.sec,e.fracSec,e.rounding,t?1:0,r?1:0),o=n.Mathpack_TakeMathError();return o===a.MathErrorNum.None?i:a.mathError(o)},t.toDays=function(e,t,r){return 0===n.Dtr_ToDays(e.yr,e.mon,e.dom,t?1:0,r?1:0)&&n.Dtr_Days()}},function(e,t,r){"use strict";r.r(t);var n={};r.r(n),r.d(n,"createParseGlobals",(function(){return Ti})),r.d(n,"ReasonKind",(function(){return Fi})),r.d(n,"parseLocals",(function(){return Ni})),r.d(n,"formatLocalsGrid",(function(){return _i})),r.d(n,"formatLocalsName",(function(){return Mi})),r.d(n,"notImplemented",(function(){return Ii})),r.d(n,"notFormulaString",(function(){return Di})),r.d(n,"createParser",(function(){return ks})),r.d(n,"parseResultHelper",(function(){return ws}));var a={};r.r(a),r.d(a,"SyntaxError",(function(){return Ms})),r.d(a,"TypeError",(function(){return Ds})),r.d(a,"baseErrors",(function(){return Ls})),r.d(a,"formatDiagnostic",(function(){return Us}));var i={};r.r(i),r.d(i,"MachineCallKind",(function(){return rf})),r.d(i,"machineCall",(function(){return uf})),r.d(i,"isMachineCall",(function(){return cf})),r.d(i,"ArrayMachine",(function(){return sf})),r.d(i,"TransitionKind",(function(){return jl})),r.d(i,"nextTransition",(function(){return Zl})),r.d(i,"callMachineTransition",(function(){return $l})),r.d(i,"nextOnSuccessReceiver",(function(){return tf})),r.d(i,"MachineCycle",(function(){return nf})),r.d(i,"MachineRuntime",(function(){return af})),r.d(i,"AllMachine",(function(){return of}));var o={};r.r(o),r.d(o,"analyzeLocalsGrid",(function(){return Ys})),r.d(o,"analyzeLocalsName",(function(){return Js})),r.d(o,"analyzeFormatLocalsGrid",(function(){return Qs})),r.d(o,"diagnostics",(function(){return a})),r.d(o,"summarizeFormulaDiagnostics",(function(){return Ks})),r.d(o,"createAnalyzeGlobals",(function(){return qs})),r.d(o,"createAnalyzer",(function(){return Sh}));var u={};r.r(u),r.d(u,"createCompiler",(function(){return iv})),r.d(u,"createEvaluator",(function(){return Pp})),r.d(u,"ReasonKind",(function(){return Nl})),r.d(u,"interval",(function(){return Ll})),r.d(u,"CellKind",(function(){return Ml})),r.d(u,"Interrupt",(function(){return Dl})),r.d(u,"notImplemented",(function(){return Il})),r.d(u,"finalValue",(function(){return xl})),r.d(u,"pendingValue",(function(){return Pl})),r.d(u,"cellFormula",(function(){return Gl})),r.d(u,"userDefinedFunc",(function(){return Bl})),r.d(u,"unavailable",(function(){return Tl})),r.d(u,"stopped",(function(){return Vl})),r.d(u,"nameCycle",(function(){return Kl})),r.d(u,"cellCycle",(function(){return ql})),r.d(u,"paused",(function(){return Ql})),r.d(u,"previousFailure",(function(){return Yl})),r.d(u,"evalGlobals",(function(){return Wl})),r.d(u,"evalLocals",(function(){return Hl})),r.d(u,"compileLocals",(function(){return _l})),r.d(u,"getEvalFailureReason",(function(){return Xl})),r.d(u,"illFormedFormula",(function(){return Ul})),r.d(u,"createCompileGlobals",(function(){return Fl})),r.d(u,"limitExceeded",(function(){return Jl})),r.d(u,"LimitKind",(function(){return wl})),r.d(u,"extractResultValue",(function(){return Af})),r.d(u,"evalToCellValue",(function(){return bf})),r.d(u,"extension",(function(){return Mp}));var c={};r.r(c),r.d(c,"WorkerKind",(function(){return Om})),r.d(c,"ErrorKind",(function(){return km})),r.d(c,"isWorkerSupported",(function(){return cg})),r.d(c,"createWorker",(function(){return lg})),r.d(c,"tryCreateWorker",(function(){return fg})),r.d(c,"dedicatedWorkerInsideInit",(function(){return hg})),r.d(c,"runSmokeTest",(function(){return Og})),r.d(c,"cancelSmokeTest",(function(){return yg})),r.d(c,"smokeTestInsideInit",(function(){return gg})),r.d(c,"smokeTestInsideDef",(function(){return kg}));var s={};r.r(s),r.d(s,"getWorksheetFunc",(function(){return OR}));var l={};r.r(l),r.d(l,"worksheetFunctionName",(function(){return Gp})),r.d(l,"errorTypeName",(function(){return Vp})),r.d(l,"localeData",(function(){return Bp})),r.d(l,"numberFormat",(function(){return Wp})),r.d(l,"sheetName",(function(){return jp})),r.d(l,"blankValue",(function(){return Hp})),r.d(l,"errorValue",(function(){return Kp})),r.d(l,"richValue",(function(){return qp})),r.d(l,"getCellValueKind",(function(){return Yp})),r.d(l,"cellLocation",(function(){return Jp})),r.d(l,"rangeLocation",(function(){return Qp})),r.d(l,"sheetRangeLocation",(function(){return Xp})),r.d(l,"cellData",(function(){return zp})),r.d(l,"cellFormulaCellData",(function(){return Zp})),r.d(l,"arrayFormulaCellData",(function(){return $p})),r.d(l,"valueCellData",(function(){return em})),r.d(l,"rangeUpdate",(function(){return tm})),r.d(l,"rangeWrite",(function(){return rm})),r.d(l,"rangePromote",(function(){return nm})),r.d(l,"arrayData",(function(){return am})),r.d(l,"arrayUpdate",(function(){return im})),r.d(l,"arrayWrite",(function(){return om})),r.d(l,"arrayPromote",(function(){return um})),r.d(l,"unusedCellsUpdate",(function(){return cm})),r.d(l,"namedValueData",(function(){return sm})),r.d(l,"namedFormulaData",(function(){return lm})),r.d(l,"namedRangeData",(function(){return fm})),r.d(l,"namedFailureData",(function(){return dm})),r.d(l,"namedObject",(function(){return hm})),r.d(l,"namedObjectsUpdate",(function(){return vm})),r.d(l,"namedObjectsWrite",(function(){return pm})),r.d(l,"undefinedNamesWrite",(function(){return mm})),r.d(l,"namedObjectsPromote",(function(){return gm})),r.d(l,"rangeFormulaEdit",(function(){return Cm})),r.d(l,"cellFormulaRangeFormulaEdit",(function(){return Sm})),r.d(l,"valueRangeFormulaEdit",(function(){return ym})),r.d(l,"inferredRangeFormulaEdit",(function(){return Em})),r.d(l,"arrayFormulaEdit",(function(){return Rm})),r.d(l,"inferredFormat",(function(){return Im})),r.d(l,"cellDataDelta",(function(){return Tm})),r.d(l,"rangeDelta",(function(){return Nm})),r.d(l,"arrayDelta",(function(){return Fm})),r.d(l,"rangeFailure",(function(){return _m})),r.d(l,"recalcResults",(function(){return Mm})),r.d(l,"updateRequest",(function(){return Dm})),r.d(l,"runExperiment",(function(){return wm})),r.d(l,"recalcServiceConfig",(function(){return Lm})),r.d(l,"workbookProps",(function(){return Um})),r.d(l,"createRecalcService",(function(){return aI})),r.d(l,"RecalcServiceCreateMode",(function(){return nI})),r.d(l,"recalcServiceInsideDef",(function(){return rI}));var f=r(1);function d(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}function h(e,t,r){return void 0===r&&(r=0),r+t.length<=e.length&&e.substring(r,r+t.length)===t}function v(e){var t=[];return Object.keys(e).map(Number).forEach((function(r){return t[r]=e[r]})),t}function p(e){if(null==e||"object"!=typeof e)return"<not object>";var t=e,r=String(t.message);if(null!=t.stack){var n=String(t.stack);return n.indexOf(r)>=0?n:"Error: "+r+"\n"+n}return r}function m(e){return e}function g(e,t){if("string"==typeof t&&null!=S[t])return e;var r=function(e){if("object"==typeof e&&null!==e){var t=e.kind;if("string"==typeof t)return t}}(e),n=void 0!==r?E[r]:void 0;return void 0===n&&(n=y[function(e){var t=typeof e;if("object"===t){if(null===e)return"null";if(e instanceof Array)return"Array"}return t}(e)]),void 0!==n?n(e,t):"<unexpected>"}function C(e){try{return JSON.stringify(g(e,void 0))}catch(e){return e instanceof Error?"<error "+e.name+": "+JSON.stringify(e.message)+">":"<error: "+JSON.stringify(e)+">"}}var S={kind:!0,type:!0,index:!0,length:!0,row:!0,col:!0,rows:!0,cols:!0},y={boolean:m,symbol:m,undefined:m,null:m,number:function(e){return"number"!=typeof e?"<unexpected>":isFinite(e)?"<number>":e},bigint:function(e){return"bigint"!=typeof e?"<unexpected>":"<bigint>"},string:function(e){return"string"!=typeof e?"<unexpected>":e.length>0?"<string>":e},function:function(e){if("function"!=typeof e)return"<unexpected>";var t=e.name;return"string"==typeof t&&t.length>0?"<function "+t+">":"<function>"},object:function(e){if("object"!=typeof e)return"<unexpected>";var t={};for(var r in e)e.hasOwnProperty(r)&&(t[r]=g(e[r],r));return t},Array:function(e){return"object"==typeof e&&e instanceof Array?e.map(g):"<unexpected>"}},E=Object.create(null),O={ULS:new(function(){function e(){}return e.prototype.shipAssertTag=function(e,t,r,n){if(!r)throw new Error("shipAssertTag "+e+" "+t+" "+n)},e.prototype.assertTag=function(e,t,r,n){if(!r)throw new Error("assertTag "+e+" "+t+" "+n)},e.prototype.traceTag=function(){},e.prototype.debugTraceTag=function(){},e}())};function k(e,t){var r=e+": code should be unreachable because a value has type 'never'; given "+C(t);return O.ULS.assertTag(595980872,f.LogCategory.msoulscat_ES_EWAJS,!1,r)}function A(e){return O.ULS.assertTag(595980873,f.LogCategory.msoulscat_ES_EWAJS,!1,e)}function b(e,t){t||A(e+": expected condition to be true")}function R(e,t){(!d(t)||t<0)&&A(e+": expected natural number; given "+C(t))}function I(e,t){(!d(t)||t<=0)&&A(e+": expected positive integer; given "+C(t))}function T(e,t,r){(!d(t)||t<0||t>=r)&&A(e+": expected natural number less than "+C(r)+"; given "+C(t))}function N(e,t,r){(!d(t)||t<=0||t>r)&&A(e+": expected positive integer at most "+C(r)+"; given "+C(t))}var F,_,M,D,w,L,U,x,P,G,V,B,W,j=r(0);function H(e){return void 0===e&&(e=0),{kind:_.Error,isQuoted:!1,label:e}}function K(e){return void 0===e&&(e=0),{kind:_.Relative,isQuoted:!1,label:e}}function q(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=0),{kind:_.Document,isQuoted:r,label:n,document:e,path:t}}function Y(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=0),{kind:_.Sheet,isQuoted:r,label:n,sheet:e,document:t}}function J(e,t,r){return void 0===t&&(t=!1),void 0===r&&(r=0),{kind:_.Ident,isQuoted:t,label:r,name:e}}function Q(e,t,r,n,a){return void 0===n&&(n=!1),void 0===a&&(a=0),{kind:_.SheetRange,isQuoted:n,label:a,sheet1:e,sheet2:t,document:r}}function X(e,t){return{kind:e,index:t}}function z(e){return void 0===e&&(e=0),{kind:M.Error,label:e}}function Z(e,t,r){return void 0===r&&(r=0),{kind:M.Single,label:r,row:e,col:t}}function $(e,t,r){return void 0===r&&(r=0),{kind:M.Range,label:r,ref1:e,ref2:t}}function ee(e,t,r){return void 0===r&&(r=0),{kind:M.Row,label:r,row1:e,row2:t}}function te(e,t,r){return void 0===r&&(r=0),{kind:M.Col,label:r,col1:e,col2:t}}function re(e,t,r){return{node:e,spans:t,annotations:r}}function ne(e,t,r,n){var a,i;return R("calc.lang.formulaSpan",e),a="calc.lang.formulaSpan",d(i=t)||A(a+": expected integer; given "+C(i)),t<e&&A("calc.lang.formulaSpan: expected end >= "+e+"; given "+t),{start:e,end:t,pre:r,post:n}}function ae(e){return{kind:w.WorksheetFuncName,id:e}}function ie(e){return{kind:w.LocalName,name:e}}function oe(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=0),{kind:L.Literal,label:r,oper:e,isClosed:t}}function ue(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=0),{kind:L.Array,label:r,nodes:e,isClosed:t}}function ce(e,t,r,n){return void 0===r&&(r=!0),void 0===n&&(n=0),{kind:L.App,label:n,head:e,args:t,isClosed:r}}function se(e,t){return void 0===t&&(t=0),{kind:L.Operator,label:t,id:e}}function le(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=0),{kind:L.Paren,label:r,node:e,isClosed:t}}function fe(e,t,r){return void 0===r&&(r=0),{kind:L.Name,label:r,whole:e,qualifier:t}}function de(e,t,r){return void 0===r&&(r=0),{kind:L.CellRef,label:r,ref:e,qualifier:t}}function he(e,t,r){return void 0===r&&(r=0),{kind:L.Bad,label:r,type:e,contents:t}}function ve(e,t,r,n,a,i,o){(R("calc.lang.functionType",e),0===r.length?0!==n.length:n.length>=r.length)&&A("calc.lang.functionType: expected tailTypes.length < restTypes.length; given "+JSON.stringify(n));0===r.length&&t.length+n.length<e&&A("calc.lang.functionType: expected headTypes.length + tailTypes.length >= "+e+"; given "+JSON.stringify(t));return{minArgs:e,headTypes:t,restTypes:r,tailTypes:n,returnType:a,staticPrecs:i,flags:o}}!function(e){e[e.R1C1=1]="R1C1",e[e.A1=2]="A1"}(F||(F={})),function(e){e.Error="QualError",e.Relative="Relative",e.Document="Document",e.Sheet="Sheet",e.Ident="Ident",e.SheetRange="SheetRange"}(_||(_={})),function(e){e.Error="RefError",e.Single="Single",e.Range="Range",e.Row="Row",e.Col="Col"}(M||(M={})),function(e){e.Abs="Abs",e.Rel="Rel"}(D||(D={})),function(e){e.WorksheetFuncName="WorksheetFuncName",e.LocalName="LocalName"}(w||(w={})),function(e){e.Literal="Literal",e.Array="Array",e.App="App",e.Paren="Paren",e.Name="Name",e.CellRef="CellRef",e.Bad="Bad",e.Operator="Operator"}(L||(L={})),function(e){e.Unexpected="Unexpected",e.CellRef="CellRef",e.Qualifier="Qualifier",e.Sequence="Sequence"}(U||(U={})),function(e){e[e.Number=1]="Number",e[e.String=2]="String",e[e.Boolean=4]="Boolean",e[e.Error=8]="Error",e[e.Range=16]="Range",e[e.Array=32]="Array",e[e.Missing=64]="Missing",e[e.Blank=128]="Blank",e[e.Rich=256]="Rich"}(x||(x={})),function(e){e[e.None=0]="None",e[e.Goto=512]="Goto",e[e.Ref3D=1024]="Ref3D",e[e.All=2047]="All"}(P||(P={})),function(e){e[e.None=0]="None",e[e.OwnDoc=1]="OwnDoc",e[e.OwnSheet=2]="OwnSheet",e[e.OwnRow=4]="OwnRow",e[e.OwnCol=8]="OwnCol",e[e.OwnRowCopy=16]="OwnRowCopy",e[e.OwnColCopy=32]="OwnColCopy",e[e.OwnDocSheets=64]="OwnDocSheets",e[e.CellProps=128]="CellProps",e[e.AllCells=256]="AllCells",e[e.AllNames=512]="AllNames",e[e.Time=1024]="Time",e[e.Calc=2048]="Calc",e[e.InFilterMode=4096]="InFilterMode",e[e.RefStyle=8192]="RefStyle",e[e.All=16383]="All"}(G||(G={})),function(e){e[e.None=0]="None",e[e.Dark=1]="Dark",e[e.Macro=2]="Macro",e[e.OnlyParsedDuringLoad=4]="OnlyParsedDuringLoad",e[e.Internal=8]="Internal",e[e.Allow3dRef=16]="Allow3dRef"}(V||(V={})),function(e){e[e.Lower=-1]="Lower",e[e.Exact=0]="Exact",e[e.Upper=1]="Upper"}(W||(W={}));var pe,me;function ge(e,t,r,n){return{cells:e,names:t,special:r,bound:n}}function Ce(e){var t=Ne[e];return void 0!==t?t:Te(e)}!function(e){e[e.NULL=1]="NULL",e[e.DIV0=2]="DIV0",e[e.VALUE=3]="VALUE",e[e.REF=4]="REF",e[e.NAME=5]="NAME",e[e.NUM=6]="NUM",e[e.NA=7]="NA",e[e.GETTING_DATA=8]="GETTING_DATA",e[e.FIELD=13]="FIELD"}(pe||(pe={})),function(e){e[e.First=1]="First",e[e.Last=13]="Last"}(me||(me={}));var Se=Te(pe.NULL),ye=Te(pe.DIV0),Ee=Te(pe.VALUE),Oe=Te(pe.REF),ke=Te(pe.NAME),Ae=Te(pe.NUM),be=Te(pe.NA),Re=Te(pe.GETTING_DATA),Ie=Te(pe.FIELD);function Te(e){return{kind:x.Error,type:e}}var Ne=v(((B={})[pe.NULL]=Se,B[pe.DIV0]=ye,B[pe.VALUE]=Ee,B[pe.REF]=Oe,B[pe.NAME]=ke,B[pe.NUM]=Ae,B[pe.NA]=be,B[pe.GETTING_DATA]=Re,B[pe.FIELD]=Ie,B));function Fe(e,t,r){return R("calc.lang.arrayOper",e),R("calc.lang.arrayOper",t),r.length!==e?A("calc.lang.arrayOper: Inconsistent row number"):{kind:x.Array,rows:e,cols:t,opers:r}}function _e(e,t){return I("calc.lang.rangeSeqOper",t.length),{kind:x.Range,sheets:e,ranges:t}}function Me(e,t){return{kind:x.Range,sheets:e,ranges:[t]}}var De,we={kind:x.Missing},Le={kind:x.Blank};!function(e){e[e.COUNT=0]="COUNT",e[e.IF=1]="IF",e[e.ISNA=2]="ISNA",e[e.ISERROR=3]="ISERROR",e[e.SUM=4]="SUM",e[e.AVERAGE=5]="AVERAGE",e[e.MIN=6]="MIN",e[e.MAX=7]="MAX",e[e.ROW=8]="ROW",e[e.COLUMN=9]="COLUMN",e[e.NA=10]="NA",e[e.NPV=11]="NPV",e[e.STDEV=12]="STDEV",e[e.DOLLAR=13]="DOLLAR",e[e.FIXED=14]="FIXED",e[e.SIN=15]="SIN",e[e.COS=16]="COS",e[e.TAN=17]="TAN",e[e.ATAN=18]="ATAN",e[e.PI=19]="PI",e[e.SQRT=20]="SQRT",e[e.EXP=21]="EXP",e[e.LN=22]="LN",e[e.LOG10=23]="LOG10",e[e.ABS=24]="ABS",e[e.INT=25]="INT",e[e.SIGN=26]="SIGN",e[e.ROUND=27]="ROUND",e[e.LOOKUP=28]="LOOKUP",e[e.INDEX=29]="INDEX",e[e.REPT=30]="REPT",e[e.MID=31]="MID",e[e.LEN=32]="LEN",e[e.VALUE=33]="VALUE",e[e.TRUE=34]="TRUE",e[e.FALSE=35]="FALSE",e[e.AND=36]="AND",e[e.OR=37]="OR",e[e.NOT=38]="NOT",e[e.MOD=39]="MOD",e[e.DCOUNT=40]="DCOUNT",e[e.DSUM=41]="DSUM",e[e.DAVERAGE=42]="DAVERAGE",e[e.DMIN=43]="DMIN",e[e.DMAX=44]="DMAX",e[e.DSTDEV=45]="DSTDEV",e[e.VAR=46]="VAR",e[e.DVAR=47]="DVAR",e[e.TEXT=48]="TEXT",e[e.LINEST=49]="LINEST",e[e.TREND=50]="TREND",e[e.LOGEST=51]="LOGEST",e[e.GROWTH=52]="GROWTH",e[e.GOTO=53]="GOTO",e[e.HALT=54]="HALT",e[e.RETURN=55]="RETURN",e[e.PV=56]="PV",e[e.FV=57]="FV",e[e.NPER=58]="NPER",e[e.PMT=59]="PMT",e[e.RATE=60]="RATE",e[e.MIRR=61]="MIRR",e[e.IRR=62]="IRR",e[e.RAND=63]="RAND",e[e.MATCH=64]="MATCH",e[e.DATE=65]="DATE",e[e.TIME=66]="TIME",e[e.DAY=67]="DAY",e[e.MONTH=68]="MONTH",e[e.YEAR=69]="YEAR",e[e.WEEKDAY=70]="WEEKDAY",e[e.HOUR=71]="HOUR",e[e.MINUTE=72]="MINUTE",e[e.SECOND=73]="SECOND",e[e.NOW=74]="NOW",e[e.AREAS=75]="AREAS",e[e.ROWS=76]="ROWS",e[e.COLUMNS=77]="COLUMNS",e[e.OFFSET=78]="OFFSET",e[e.ABSREF=79]="ABSREF",e[e.RELREF=80]="RELREF",e[e.ARGUMENT=81]="ARGUMENT",e[e.SEARCH=82]="SEARCH",e[e.TRANSPOSE=83]="TRANSPOSE",e[e.ERROR=84]="ERROR",e[e.STEP=85]="STEP",e[e.TYPE=86]="TYPE",e[e.ECHO=87]="ECHO",e[e.SET_NAME=88]="SET_NAME",e[e.CALLER=89]="CALLER",e[e.DEREF=90]="DEREF",e[e.WINDOWS=91]="WINDOWS",e[e.SERIES=92]="SERIES",e[e.DOCUMENTS=93]="DOCUMENTS",e[e.ACTIVE_CELL=94]="ACTIVE_CELL",e[e.SELECTION=95]="SELECTION",e[e.RESULT=96]="RESULT",e[e.ATAN2=97]="ATAN2",e[e.ASIN=98]="ASIN",e[e.ACOS=99]="ACOS",e[e.CHOOSE=100]="CHOOSE",e[e.HLOOKUP=101]="HLOOKUP",e[e.VLOOKUP=102]="VLOOKUP",e[e.LINKS=103]="LINKS",e[e.INPUT=104]="INPUT",e[e.ISREF=105]="ISREF",e[e.GET_FORMULA=106]="GET_FORMULA",e[e.GET_NAME=107]="GET_NAME",e[e.SET_VALUE=108]="SET_VALUE",e[e.LOG=109]="LOG",e[e.EXEC=110]="EXEC",e[e.CHAR=111]="CHAR",e[e.LOWER=112]="LOWER",e[e.UPPER=113]="UPPER",e[e.PROPER=114]="PROPER",e[e.LEFT=115]="LEFT",e[e.RIGHT=116]="RIGHT",e[e.EXACT=117]="EXACT",e[e.TRIM=118]="TRIM",e[e.REPLACE=119]="REPLACE",e[e.SUBSTITUTE=120]="SUBSTITUTE",e[e.CODE=121]="CODE",e[e.NAMES=122]="NAMES",e[e.DIRECTORY=123]="DIRECTORY",e[e.FIND=124]="FIND",e[e.CELL=125]="CELL",e[e.ISERR=126]="ISERR",e[e.ISTEXT=127]="ISTEXT",e[e.ISNUMBER=128]="ISNUMBER",e[e.ISBLANK=129]="ISBLANK",e[e.T=130]="T",e[e.N=131]="N",e[e.FOPEN=132]="FOPEN",e[e.FCLOSE=133]="FCLOSE",e[e.FSIZE=134]="FSIZE",e[e.FREADLN=135]="FREADLN",e[e.FREAD=136]="FREAD",e[e.FWRITELN=137]="FWRITELN",e[e.FWRITE=138]="FWRITE",e[e.FPOS=139]="FPOS",e[e.DATEVALUE=140]="DATEVALUE",e[e.TIMEVALUE=141]="TIMEVALUE",e[e.SLN=142]="SLN",e[e.SYD=143]="SYD",e[e.DDB=144]="DDB",e[e.GET_DEF=145]="GET_DEF",e[e.REFTEXT=146]="REFTEXT",e[e.TEXTREF=147]="TEXTREF",e[e.INDIRECT=148]="INDIRECT",e[e.REGISTER=149]="REGISTER",e[e.CALL=150]="CALL",e[e.ADD_BAR=151]="ADD_BAR",e[e.ADD_MENU=152]="ADD_MENU",e[e.ADD_COMMAND=153]="ADD_COMMAND",e[e.ENABLE_COMMAND=154]="ENABLE_COMMAND",e[e.CHECK_COMMAND=155]="CHECK_COMMAND",e[e.RENAME_COMMAND=156]="RENAME_COMMAND",e[e.SHOW_BAR=157]="SHOW_BAR",e[e.DELETE_MENU=158]="DELETE_MENU",e[e.DELETE_COMMAND=159]="DELETE_COMMAND",e[e.GET_CHART_ITEM=160]="GET_CHART_ITEM",e[e.DIALOG_BOX=161]="DIALOG_BOX",e[e.CLEAN=162]="CLEAN",e[e.MDETERM=163]="MDETERM",e[e.MINVERSE=164]="MINVERSE",e[e.MMULT=165]="MMULT",e[e.FILES=166]="FILES",e[e.IPMT=167]="IPMT",e[e.PPMT=168]="PPMT",e[e.COUNTA=169]="COUNTA",e[e.CANCEL_KEY=170]="CANCEL_KEY",e[e.FOR=171]="FOR",e[e.WHILE=172]="WHILE",e[e.BREAK=173]="BREAK",e[e.NEXT=174]="NEXT",e[e.INITIATE=175]="INITIATE",e[e.REQUEST=176]="REQUEST",e[e.POKE=177]="POKE",e[e.EXECUTE=178]="EXECUTE",e[e.TERMINATE=179]="TERMINATE",e[e.RESTART=180]="RESTART",e[e.HELP=181]="HELP",e[e.GET_BAR=182]="GET_BAR",e[e.PRODUCT=183]="PRODUCT",e[e.FACT=184]="FACT",e[e.GET_CELL=185]="GET_CELL",e[e.GET_WORKSPACE=186]="GET_WORKSPACE",e[e.GET_WINDOW=187]="GET_WINDOW",e[e.GET_DOCUMENT=188]="GET_DOCUMENT",e[e.DPRODUCT=189]="DPRODUCT",e[e.ISNONTEXT=190]="ISNONTEXT",e[e.GET_NOTE=191]="GET_NOTE",e[e.NOTE=192]="NOTE",e[e.STDEVP=193]="STDEVP",e[e.VARP=194]="VARP",e[e.DSTDEVP=195]="DSTDEVP",e[e.DVARP=196]="DVARP",e[e.TRUNC=197]="TRUNC",e[e.ISLOGICAL=198]="ISLOGICAL",e[e.DCOUNTA=199]="DCOUNTA",e[e.DELETE_BAR=200]="DELETE_BAR",e[e.UNREGISTER=201]="UNREGISTER",e[e.USDOLLAR=204]="USDOLLAR",e[e.FINDB=205]="FINDB",e[e.SEARCHB=206]="SEARCHB",e[e.REPLACEB=207]="REPLACEB",e[e.LEFTB=208]="LEFTB",e[e.RIGHTB=209]="RIGHTB",e[e.MIDB=210]="MIDB",e[e.LENB=211]="LENB",e[e.ROUNDUP=212]="ROUNDUP",e[e.ROUNDDOWN=213]="ROUNDDOWN",e[e.ASC=214]="ASC",e[e.DBCS=215]="DBCS",e[e.RANK=216]="RANK",e[e.ADDRESS=219]="ADDRESS",e[e.DAYS360=220]="DAYS360",e[e.TODAY=221]="TODAY",e[e.VDB=222]="VDB",e[e.ELSE=223]="ELSE",e[e.ELSE_IF=224]="ELSE_IF",e[e.END_IF=225]="END_IF",e[e.FOR_CELL=226]="FOR_CELL",e[e.MEDIAN=227]="MEDIAN",e[e.SUMPRODUCT=228]="SUMPRODUCT",e[e.SINH=229]="SINH",e[e.COSH=230]="COSH",e[e.TANH=231]="TANH",e[e.ASINH=232]="ASINH",e[e.ACOSH=233]="ACOSH",e[e.ATANH=234]="ATANH",e[e.DGET=235]="DGET",e[e.CREATE_OBJECT=236]="CREATE_OBJECT",e[e.VOLATILE=237]="VOLATILE",e[e.LAST_ERROR=238]="LAST_ERROR",e[e.CUSTOM_UNDO=239]="CUSTOM_UNDO",e[e.CUSTOM_REPEAT=240]="CUSTOM_REPEAT",e[e.FORMULA_CONVERT=241]="FORMULA_CONVERT",e[e.GET_LINK_INFO=242]="GET_LINK_INFO",e[e.TEXT_BOX=243]="TEXT_BOX",e[e.INFO=244]="INFO",e[e.GROUP=245]="GROUP",e[e.GET_OBJECT=246]="GET_OBJECT",e[e.DB=247]="DB",e[e.PAUSE=248]="PAUSE",e[e.RESUME=251]="RESUME",e[e.FREQUENCY=252]="FREQUENCY",e[e.ADD_TOOLBAR=253]="ADD_TOOLBAR",e[e.DELETE_TOOLBAR=254]="DELETE_TOOLBAR",e[e._UDF=255]="_UDF",e[e.RESET_TOOLBAR=256]="RESET_TOOLBAR",e[e.EVALUATE=257]="EVALUATE",e[e.GET_TOOLBAR=258]="GET_TOOLBAR",e[e.GET_TOOL=259]="GET_TOOL",e[e.SPELLING_CHECK=260]="SPELLING_CHECK",e[e.ERROR_TYPE=261]="ERROR_TYPE",e[e.APP_TITLE=262]="APP_TITLE",e[e.WINDOW_TITLE=263]="WINDOW_TITLE",e[e.SAVE_TOOLBAR=264]="SAVE_TOOLBAR",e[e.ENABLE_TOOL=265]="ENABLE_TOOL",e[e.PRESS_TOOL=266]="PRESS_TOOL",e[e.REGISTER_ID=267]="REGISTER_ID",e[e.GET_PROJECT=268]="GET_PROJECT",e[e.AVEDEV=269]="AVEDEV",e[e.BETADIST=270]="BETADIST",e[e.GAMMALN=271]="GAMMALN",e[e.BETAINV=272]="BETAINV",e[e.BINOMDIST=273]="BINOMDIST",e[e.CHIDIST=274]="CHIDIST",e[e.CHIINV=275]="CHIINV",e[e.COMBIN=276]="COMBIN",e[e.CONFIDENCE=277]="CONFIDENCE",e[e.CRITBINOM=278]="CRITBINOM",e[e.EVEN=279]="EVEN",e[e.EXPONDIST=280]="EXPONDIST",e[e.FDIST=281]="FDIST",e[e.FINV=282]="FINV",e[e.FISHER=283]="FISHER",e[e.FISHERINV=284]="FISHERINV",e[e.FLOOR=285]="FLOOR",e[e.GAMMADIST=286]="GAMMADIST",e[e.GAMMAINV=287]="GAMMAINV",e[e.CEILING=288]="CEILING",e[e.HYPGEOMDIST=289]="HYPGEOMDIST",e[e.LOGNORMDIST=290]="LOGNORMDIST",e[e.LOGINV=291]="LOGINV",e[e.NEGBINOMDIST=292]="NEGBINOMDIST",e[e.NORMDIST=293]="NORMDIST",e[e.NORMSDIST=294]="NORMSDIST",e[e.NORMINV=295]="NORMINV",e[e.NORMSINV=296]="NORMSINV",e[e.STANDARDIZE=297]="STANDARDIZE",e[e.ODD=298]="ODD",e[e.PERMUT=299]="PERMUT",e[e.POISSON=300]="POISSON",e[e.TDIST=301]="TDIST",e[e.WEIBULL=302]="WEIBULL",e[e.SUMXMY2=303]="SUMXMY2",e[e.SUMX2MY2=304]="SUMX2MY2",e[e.SUMX2PY2=305]="SUMX2PY2",e[e.CHITEST=306]="CHITEST",e[e.CORREL=307]="CORREL",e[e.COVAR=308]="COVAR",e[e.FORECAST=309]="FORECAST",e[e.FTEST=310]="FTEST",e[e.INTERCEPT=311]="INTERCEPT",e[e.PEARSON=312]="PEARSON",e[e.RSQ=313]="RSQ",e[e.STEYX=314]="STEYX",e[e.SLOPE=315]="SLOPE",e[e.TTEST=316]="TTEST",e[e.PROB=317]="PROB",e[e.DEVSQ=318]="DEVSQ",e[e.GEOMEAN=319]="GEOMEAN",e[e.HARMEAN=320]="HARMEAN",e[e.SUMSQ=321]="SUMSQ",e[e.KURT=322]="KURT",e[e.SKEW=323]="SKEW",e[e.ZTEST=324]="ZTEST",e[e.LARGE=325]="LARGE",e[e.SMALL=326]="SMALL",e[e.QUARTILE=327]="QUARTILE",e[e.PERCENTILE=328]="PERCENTILE",e[e.PERCENTRANK=329]="PERCENTRANK",e[e.MODE=330]="MODE",e[e.TRIMMEAN=331]="TRIMMEAN",e[e.TINV=332]="TINV",e[e.MOVIE_COMMAND=334]="MOVIE_COMMAND",e[e.GET_MOVIE=335]="GET_MOVIE",e[e.CONCATENATE=336]="CONCATENATE",e[e.POWER=337]="POWER",e[e.SPREADBASE_DATA_FIELD=338]="SPREADBASE_DATA_FIELD",e[e.GET_VIEW=339]="GET_VIEW",e[e.GET_FIELD=340]="GET_FIELD",e[e.GET_ITEM=341]="GET_ITEM",e[e.RADIANS=342]="RADIANS",e[e.DEGREES=343]="DEGREES",e[e.SUBTOTAL=344]="SUBTOTAL",e[e.SUMIF=345]="SUMIF",e[e.COUNTIF=346]="COUNTIF",e[e.COUNTBLANK=347]="COUNTBLANK",e[e.SCENARIO_GET=348]="SCENARIO_GET",e[e.OPTIONS_LISTS=349]="OPTIONS_LISTS",e[e.ISPMT=350]="ISPMT",e[e.DATEDIF=351]="DATEDIF",e[e.DATESTRING=352]="DATESTRING",e[e.NUMBERSTRING=353]="NUMBERSTRING",e[e.ROMAN=354]="ROMAN",e[e.OPENDIALOG=355]="OPENDIALOG",e[e.SAVEDIALOG=356]="SAVEDIALOG",e[e.VIEW_GET=357]="VIEW_GET",e[e.GETPIVOTDATA=358]="GETPIVOTDATA",e[e.HYPERLINK=359]="HYPERLINK",e[e.FURIGANA=360]="FURIGANA",e[e.AVERAGEA=361]="AVERAGEA",e[e.MAXA=362]="MAXA",e[e.MINA=363]="MINA",e[e.STDEVPA=364]="STDEVPA",e[e.VARPA=365]="VARPA",e[e.STDEVA=366]="STDEVA",e[e.VARA=367]="VARA",e[e.BAHTTEXT=368]="BAHTTEXT",e[e.THAIDOW=369]="THAIDOW",e[e.THAIDIGIT=370]="THAIDIGIT",e[e.THAIMOY=371]="THAIMOY",e[e.THAINUMSOUND=372]="THAINUMSOUND",e[e.THAINUMSTRING=373]="THAINUMSTRING",e[e.THAISTRINGLENGTH=374]="THAISTRINGLENGTH",e[e.ISTHAIDIGIT=375]="ISTHAIDIGIT",e[e.ROUNDBAHTDOWN=376]="ROUNDBAHTDOWN",e[e.ROUNDBAHTUP=377]="ROUNDBAHTUP",e[e.THAIYEAR=378]="THAIYEAR",e[e.RTD=379]="RTD",e[e.CUBEVALUE=380]="CUBEVALUE",e[e.CUBEMEMBER=381]="CUBEMEMBER",e[e.CUBEMEMBERPROPERTY=382]="CUBEMEMBERPROPERTY",e[e.CUBERANKEDMEMBER=383]="CUBERANKEDMEMBER",e[e.HEX2BIN=384]="HEX2BIN",e[e.HEX2DEC=385]="HEX2DEC",e[e.HEX2OCT=386]="HEX2OCT",e[e.DEC2BIN=387]="DEC2BIN",e[e.DEC2HEX=388]="DEC2HEX",e[e.DEC2OCT=389]="DEC2OCT",e[e.OCT2BIN=390]="OCT2BIN",e[e.OCT2HEX=391]="OCT2HEX",e[e.OCT2DEC=392]="OCT2DEC",e[e.BIN2DEC=393]="BIN2DEC",e[e.BIN2OCT=394]="BIN2OCT",e[e.BIN2HEX=395]="BIN2HEX",e[e.IMSUB=396]="IMSUB",e[e.IMDIV=397]="IMDIV",e[e.IMPOWER=398]="IMPOWER",e[e.IMABS=399]="IMABS",e[e.IMSQRT=400]="IMSQRT",e[e.IMLN=401]="IMLN",e[e.IMLOG2=402]="IMLOG2",e[e.IMLOG10=403]="IMLOG10",e[e.IMSIN=404]="IMSIN",e[e.IMCOS=405]="IMCOS",e[e.IMEXP=406]="IMEXP",e[e.IMARGUMENT=407]="IMARGUMENT",e[e.IMCONJUGATE=408]="IMCONJUGATE",e[e.IMAGINARY=409]="IMAGINARY",e[e.IMREAL=410]="IMREAL",e[e.COMPLEX=411]="COMPLEX",e[e.IMSUM=412]="IMSUM",e[e.IMPRODUCT=413]="IMPRODUCT",e[e.SERIESSUM=414]="SERIESSUM",e[e.FACTDOUBLE=415]="FACTDOUBLE",e[e.SQRTPI=416]="SQRTPI",e[e.QUOTIENT=417]="QUOTIENT",e[e.DELTA=418]="DELTA",e[e.GESTEP=419]="GESTEP",e[e.ISEVEN=420]="ISEVEN",e[e.ISODD=421]="ISODD",e[e.MROUND=422]="MROUND",e[e.ERF=423]="ERF",e[e.ERFC=424]="ERFC",e[e.BESSELJ=425]="BESSELJ",e[e.BESSELK=426]="BESSELK",e[e.BESSELY=427]="BESSELY",e[e.BESSELI=428]="BESSELI",e[e.XIRR=429]="XIRR",e[e.XNPV=430]="XNPV",e[e.PRICEMAT=431]="PRICEMAT",e[e.YIELDMAT=432]="YIELDMAT",e[e.INTRATE=433]="INTRATE",e[e.RECEIVED=434]="RECEIVED",e[e.DISC=435]="DISC",e[e.PRICEDISC=436]="PRICEDISC",e[e.YIELDDISC=437]="YIELDDISC",e[e.TBILLEQ=438]="TBILLEQ",e[e.TBILLPRICE=439]="TBILLPRICE",e[e.TBILLYIELD=440]="TBILLYIELD",e[e.PRICE=441]="PRICE",e[e.YIELD=442]="YIELD",e[e.DOLLARDE=443]="DOLLARDE",e[e.DOLLARFR=444]="DOLLARFR",e[e.NOMINAL=445]="NOMINAL",e[e.EFFECT=446]="EFFECT",e[e.CUMPRINC=447]="CUMPRINC",e[e.CUMIPMT=448]="CUMIPMT",e[e.EDATE=449]="EDATE",e[e.EOMONTH=450]="EOMONTH",e[e.YEARFRAC=451]="YEARFRAC",e[e.COUPDAYBS=452]="COUPDAYBS",e[e.COUPDAYS=453]="COUPDAYS",e[e.COUPDAYSNC=454]="COUPDAYSNC",e[e.COUPNCD=455]="COUPNCD",e[e.COUPNUM=456]="COUPNUM",e[e.COUPPCD=457]="COUPPCD",e[e.DURATION=458]="DURATION",e[e.MDURATION=459]="MDURATION",e[e.ODDLPRICE=460]="ODDLPRICE",e[e.ODDLYIELD=461]="ODDLYIELD",e[e.ODDFPRICE=462]="ODDFPRICE",e[e.ODDFYIELD=463]="ODDFYIELD",e[e.RANDBETWEEN=464]="RANDBETWEEN",e[e.WEEKNUM=465]="WEEKNUM",e[e.AMORDEGRC=466]="AMORDEGRC",e[e.AMORLINC=467]="AMORLINC",e[e.CONVERT=468]="CONVERT",e[e.ACCRINT=469]="ACCRINT",e[e.ACCRINTM=470]="ACCRINTM",e[e.WORKDAY=471]="WORKDAY",e[e.NETWORKDAYS=472]="NETWORKDAYS",e[e.GCD=473]="GCD",e[e.MULTINOMIAL=474]="MULTINOMIAL",e[e.LCM=475]="LCM",e[e.FVSCHEDULE=476]="FVSCHEDULE",e[e.CUBEKPIMEMBER=477]="CUBEKPIMEMBER",e[e.CUBESET=478]="CUBESET",e[e.CUBESETCOUNT=479]="CUBESETCOUNT",e[e.IFERROR=480]="IFERROR",e[e.COUNTIFS=481]="COUNTIFS",e[e.SUMIFS=482]="SUMIFS",e[e.AVERAGEIF=483]="AVERAGEIF",e[e.AVERAGEIFS=484]="AVERAGEIFS",e[e.AGGREGATE=485]="AGGREGATE",e[e.BINOM_DIST=486]="BINOM_DIST",e[e.BINOM_INV=487]="BINOM_INV",e[e.CONFIDENCE_NORM=488]="CONFIDENCE_NORM",e[e.CONFIDENCE_T=489]="CONFIDENCE_T",e[e.CHISQ_TEST=490]="CHISQ_TEST",e[e.F_TEST=491]="F_TEST",e[e.COVARIANCE_P=492]="COVARIANCE_P",e[e.COVARIANCE_S=493]="COVARIANCE_S",e[e.EXPON_DIST=494]="EXPON_DIST",e[e.GAMMA_DIST=495]="GAMMA_DIST",e[e.GAMMA_INV=496]="GAMMA_INV",e[e.MODE_MULT=497]="MODE_MULT",e[e.MODE_SNGL=498]="MODE_SNGL",e[e.NORM_DIST=499]="NORM_DIST",e[e.NORM_INV=500]="NORM_INV",e[e.PERCENTILE_EXC=501]="PERCENTILE_EXC",e[e.PERCENTILE_INC=502]="PERCENTILE_INC",e[e.PERCENTRANK_EXC=503]="PERCENTRANK_EXC",e[e.PERCENTRANK_INC=504]="PERCENTRANK_INC",e[e.POISSON_DIST=505]="POISSON_DIST",e[e.QUARTILE_EXC=506]="QUARTILE_EXC",e[e.QUARTILE_INC=507]="QUARTILE_INC",e[e.RANK_AVG=508]="RANK_AVG",e[e.RANK_EQ=509]="RANK_EQ",e[e.STDEV_S=510]="STDEV_S",e[e.STDEV_P=511]="STDEV_P",e[e.T_DIST=512]="T_DIST",e[e.T_DIST_2T=513]="T_DIST_2T",e[e.T_DIST_RT=514]="T_DIST_RT",e[e.T_INV=515]="T_INV",e[e.T_INV_2T=516]="T_INV_2T",e[e.VAR_S=517]="VAR_S",e[e.VAR_P=518]="VAR_P",e[e.WEIBULL_DIST=519]="WEIBULL_DIST",e[e.NETWORKDAYS_INTL=520]="NETWORKDAYS_INTL",e[e.WORKDAY_INTL=521]="WORKDAY_INTL",e[e.ECMA_CEILING=522]="ECMA_CEILING",e[e.ISO_CEILING=523]="ISO_CEILING",e[e.BETA_DIST=525]="BETA_DIST",e[e.BETA_INV=526]="BETA_INV",e[e.CHISQ_DIST=527]="CHISQ_DIST",e[e.CHISQ_DIST_RT=528]="CHISQ_DIST_RT",e[e.CHISQ_INV=529]="CHISQ_INV",e[e.CHISQ_INV_RT=530]="CHISQ_INV_RT",e[e.F_DIST=531]="F_DIST",e[e.F_DIST_RT=532]="F_DIST_RT",e[e.F_INV=533]="F_INV",e[e.F_INV_RT=534]="F_INV_RT",e[e.HYPGEOM_DIST=535]="HYPGEOM_DIST",e[e.LOGNORM_DIST=536]="LOGNORM_DIST",e[e.LOGNORM_INV=537]="LOGNORM_INV",e[e.NEGBINOM_DIST=538]="NEGBINOM_DIST",e[e.NORM_S_DIST=539]="NORM_S_DIST",e[e.NORM_S_INV=540]="NORM_S_INV",e[e.T_TEST=541]="T_TEST",e[e.Z_TEST=542]="Z_TEST",e[e.ERF_PRECISE=543]="ERF_PRECISE",e[e.ERFC_PRECISE=544]="ERFC_PRECISE",e[e.GAMMALN_PRECISE=545]="GAMMALN_PRECISE",e[e.CEILING_PRECISE=546]="CEILING_PRECISE",e[e.FLOOR_PRECISE=547]="FLOOR_PRECISE",e[e.ACOT=548]="ACOT",e[e.ACOTH=549]="ACOTH",e[e.COT=550]="COT",e[e.COTH=551]="COTH",e[e.CSC=552]="CSC",e[e.CSCH=553]="CSCH",e[e.SEC=554]="SEC",e[e.SECH=555]="SECH",e[e.IMTAN=556]="IMTAN",e[e.IMCOT=557]="IMCOT",e[e.IMCSC=558]="IMCSC",e[e.IMCSCH=559]="IMCSCH",e[e.IMSEC=560]="IMSEC",e[e.IMSECH=561]="IMSECH",e[e.BITAND=562]="BITAND",e[e.BITOR=563]="BITOR",e[e.BITXOR=564]="BITXOR",e[e.BITLSHIFT=565]="BITLSHIFT",e[e.BITRSHIFT=566]="BITRSHIFT",e[e.PERMUTATIONA=567]="PERMUTATIONA",e[e.COMBINA=568]="COMBINA",e[e.XOR=569]="XOR",e[e.PDURATION=570]="PDURATION",e[e.BASE=571]="BASE",e[e.DECIMAL=572]="DECIMAL",e[e.DAYS=573]="DAYS",e[e.BINOM_DIST_RANGE=574]="BINOM_DIST_RANGE",e[e.GAMMA=575]="GAMMA",e[e.SKEW_P=576]="SKEW_P",e[e.GAUSS=577]="GAUSS",e[e.PHI=578]="PHI",e[e.RRI=579]="RRI",e[e.UNICHAR=580]="UNICHAR",e[e.UNICODE=581]="UNICODE",e[e.MUNIT=582]="MUNIT",e[e.ARABIC=583]="ARABIC",e[e.ISOWEEKNUM=584]="ISOWEEKNUM",e[e.NUMBERVALUE=585]="NUMBERVALUE",e[e.SHEET=586]="SHEET",e[e.SHEETS=587]="SHEETS",e[e.FORMULATEXT=588]="FORMULATEXT",e[e.ISFORMULA=589]="ISFORMULA",e[e.IFNA=590]="IFNA",e[e.CEILING_MATH=591]="CEILING_MATH",e[e.FLOOR_MATH=592]="FLOOR_MATH",e[e.IMSINH=593]="IMSINH",e[e.IMCOSH=594]="IMCOSH",e[e.FILTERXML=595]="FILTERXML",e[e.WEBSERVICE=596]="WEBSERVICE",e[e.ENCODEURL=597]="ENCODEURL",e[e.FORECAST_ETS=598]="FORECAST_ETS",e[e.FORECAST_ETS_CONFINT=599]="FORECAST_ETS_CONFINT",e[e.FORECAST_ETS_SEASONALITY=600]="FORECAST_ETS_SEASONALITY",e[e.FORECAST_LINEAR=601]="FORECAST_LINEAR",e[e.FORECAST_ETS_STAT=602]="FORECAST_ETS_STAT",e[e.MAXIFS=603]="MAXIFS",e[e.MINIFS=604]="MINIFS",e[e.TEXTJOIN=605]="TEXTJOIN",e[e.CONCAT=606]="CONCAT",e[e.IFS=607]="IFS",e[e.SWITCH=608]="SWITCH",e[e.SINGLE=609]="SINGLE",e[e.AVERAGE_WEIGHTED=610]="AVERAGE_WEIGHTED",e[e.ANCHORARRAY=611]="ANCHORARRAY",e[e._FV=612]="_FV",e[e.FIELDVALUE=613]="FIELDVALUE",e[e.FILTER=614]="FILTER",e[e.SORT=615]="SORT",e[e.UNIQUE=616]="UNIQUE",e[e.RICHSEARCH=617]="RICHSEARCH",e[e.LARGEPROPERTY=618]="LARGEPROPERTY",e[e.SMALLPROPERTY=619]="SMALLPROPERTY",e[e.AVERAGEPROPERTY=620]="AVERAGEPROPERTY",e[e.FINDN=621]="FINDN",e[e.TEXTSLICE=622]="TEXTSLICE",e[e.TEXTBEFORE=623]="TEXTBEFORE",e[e.TEXTAFTER=624]="TEXTAFTER",e[e.TEXTSPLIT=625]="TEXTSPLIT",e[e._SORT=626]="_SORT",e[e._ONEDARRAY=627]="_ONEDARRAY",e[e.XMATCH=628]="XMATCH",e[e.XLOOKUP=629]="XLOOKUP",e[e.SORTBY=630]="SORTBY",e[e.RANDARRAY=631]="RANDARRAY",e[e.SEQUENCE=632]="SEQUENCE",e[e.STOCKHISTORY=633]="STOCKHISTORY",e[e.SUBARRAY=634]="SUBARRAY",e[e.APPENDROWS=635]="APPENDROWS",e[e.APPENDCOLUMNS=636]="APPENDCOLUMNS",e[e.SELECTROW=637]="SELECTROW",e[e.SELECTCOLUMN=638]="SELECTCOLUMN",e[e.LET=639]="LET",e[e.FUN=640]="FUN",e[e.ARRAYMAKE=641]="ARRAYMAKE",e[e.APPLY=642]="APPLY",e[e.ISFUN=643]="ISFUN",e[e.ARITY=644]="ARITY",e[e.RECURSE=645]="RECURSE",e[e.RECORD=646]="RECORD",e[e.VALUETOTEXT=647]="VALUETOTEXT",e[e.ARRAYTOTEXT=648]="ARRAYTOTEXT",e[e.TESTFUNCTIONBEGIN=649]="TESTFUNCTIONBEGIN",e[e.IMAGE=650]="IMAGE",e[e.GRF=651]="GRF",e[e.UNIT=652]="UNIT",e[e.RICHERROR=653]="RICHERROR",e[e.COUNTER=654]="COUNTER",e[e.BROKENRECORD=655]="BROKENRECORD",e[e.FORMULABYTES=656]="FORMULABYTES",e[e.FORMULACODE=657]="FORMULACODE",e[e.FORMULAHTML=658]="FORMULAHTML",e[e.STREAM=659]="STREAM",e[e.FORMATTEDNUMBER=660]="FORMATTEDNUMBER",e[e.LETREC=680]="LETREC"}(De||(De={}));var Ue,xe=[[255,"255"],[268,"GET.WORKBOOK"],[349,"OPTIONS.LISTS.GET"],[355,"OPEN.DIALOG"],[356,"SAVE.DIALOG"],[360,"PHONETIC"],[369,"THAIDAYOFWEEK"],[371,"THAIMONTHOFYEAR"],[612,"_FV"],[626,"_SORT"],[627,"_ONEDARRAY"],[637,"SelectRow"],[638,"SelectColumn"],[641,"ARRAY.MAKE"]].reduce((function(e,t){return e[t[0]]=t[1],e}),[]),Pe=[],Ge=[[1,Pe,[57],Pe,1,0,16],[1,[36,831,831],Pe,Pe,823,0,0],[1,[15],Pe,Pe,4,0,0],[1,[15],Pe,Pe,4,0,0],[1,Pe,[305],Pe,1,0,16],[1,Pe,[49],Pe,1,0,16],[1,Pe,[49],Pe,1,0,16],[1,Pe,[49],Pe,1,0,16],[0,[16],Pe,Pe,33,0,0],[0,[16],Pe,Pe,33,0,0],[0,Pe,Pe,Pe,3,0,16],[2,[1],[49],Pe,1,0,16],[1,Pe,[49],Pe,1,0,16],[1,[1,1],Pe,Pe,2,0,0],[1,[1,65,4],Pe,Pe,2,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[0,Pe,Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[2,[1,1],Pe,Pe,1,0,0],[2,[263,48,48],Pe,Pe,263,0,0],[2,[48,1,1,1],Pe,Pe,311,0,0],[2,[2,1],Pe,Pe,2,0,0],[3,[2,1,1],Pe,Pe,2,0,0],[1,[2],Pe,Pe,1,0,0],[1,[7],Pe,Pe,1,0,0],[0,Pe,Pe,Pe,4,0,16],[0,Pe,Pe,Pe,4,0,16],[1,Pe,[52],Pe,4,0,16],[1,Pe,[52],Pe,4,0,16],[1,[4],Pe,Pe,4,0,16],[2,[1,1],Pe,Pe,1,0,0],[3,[16,83,18],Pe,Pe,1,0,0],[3,[16,19,18],Pe,Pe,1,0,0],[3,[16,19,18],Pe,Pe,1,0,0],[3,[16,19,18],Pe,Pe,1,0,0],[3,[16,19,18],Pe,Pe,1,0,0],[3,[16,19,18],Pe,Pe,1,0,0],[1,Pe,[49],Pe,1,0,16],[3,[16,19,18],Pe,Pe,1,0,0],[2,[7,2],Pe,Pe,2,0,0],[1,[48,112,84,84],Pe,Pe,32,0,0],[1,[48,112,112,84],Pe,Pe,32,0,0],[1,[48,112,84,84],Pe,Pe,32,0,0],[1,[48,112,112,84],Pe,Pe,32,0,0],[1,[16],Pe,Pe,512,0,2],[0,[4],Pe,Pe,512,0,2],[0,[575],Pe,Pe,512,0,2],[3,[1,1,1,1,1],Pe,Pe,1,0,0],[3,[1,1,1,1,1],Pe,Pe,1,0,0],[3,[1,1,1,1,1],Pe,Pe,1,0,0],[3,[1,1,1,1,1],Pe,Pe,1,0,0],[3,[1,1,1,1,1,1],Pe,Pe,1,0,0],[3,[48,1,1],Pe,Pe,1,0,16],[1,[48,1],Pe,Pe,1,0,0],[0,Pe,Pe,Pe,1,16383,0],[2,[263,305,17],Pe,Pe,1,0,0],[3,[1,1,1],Pe,Pe,1,0,0],[3,[1,1,1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1,1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[0,Pe,Pe,Pe,1,16383,0],[1,[16],Pe,Pe,1,0,0],[1,[48],Pe,Pe,1,0,0],[1,[48],Pe,Pe,1,0,0],[3,[16,65,65,65,65],Pe,Pe,16,16383,0],[2,[2,16],Pe,Pe,16,0,2],[2,[16,16],Pe,Pe,2,0,2],[0,[66,81,16],Pe,Pe,4,0,2],[2,[2,2,1],Pe,Pe,1,0,0],[1,[39],Pe,Pe,32,0,0],[0,[1,24],Pe,Pe,4,0,2],[0,Pe,Pe,Pe,4,0,2],[1,[303],Pe,Pe,1,0,0],[0,[4],Pe,Pe,4,0,2],[1,[2,63],Pe,Pe,4,0,2],[0,Pe,Pe,Pe,50,0,2],[1,[16],Pe,Pe,47,0,2],[0,[65,66],Pe,Pe,32,0,2],[4,[87,117,117,1,117],Pe,Pe,4,0,0],[0,[1,66],Pe,Pe,32,0,2],[0,Pe,Pe,Pe,16,0,2],[0,Pe,Pe,Pe,16,0,2],[0,[1],Pe,Pe,4,0,2],[2,[1,1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[2,[33],[831],Pe,823,0,0],[3,[263,49,49,4],Pe,Pe,295,0,0],[3,[263,49,49,4],Pe,Pe,295,0,0],[0,[66,65],Pe,Pe,32,0,2],[1,[2,65,66,67,65,65,2],Pe,Pe,575,0,2],[1,[63],Pe,Pe,4,0,0],[1,[18],Pe,Pe,2,0,2],[1,[2,4],Pe,Pe,6,0,2],[2,[16,47],Pe,Pe,4,0,2],[1,[1,1],Pe,Pe,1,0,0],[1,[2,1,4,4],Pe,Pe,7,0,2],[1,[1],Pe,Pe,2,0,0],[1,[2],Pe,Pe,2,0,0],[1,[2],Pe,Pe,2,0,0],[1,[2],Pe,Pe,2,0,0],[1,[2,9],Pe,Pe,2,0,0],[1,[2,9],Pe,Pe,2,0,0],[2,[2,2],Pe,Pe,4,0,0],[1,[2],Pe,Pe,2,0,0],[4,[2,1,1,2],Pe,Pe,2,0,0],[3,[2,2,2,2],Pe,Pe,2,0,0],[1,[2],Pe,Pe,1,0,0],[0,[66,65,66],Pe,Pe,32,0,2],[0,[2],Pe,Pe,2,0,2],[2,[2,2,1],Pe,Pe,1,0,0],[1,[2,16],Pe,Pe,303,16383,0],[1,[15],Pe,Pe,4,0,0],[1,[143],Pe,Pe,4,0,0],[1,[143],Pe,Pe,4,0,0],[1,[143],Pe,Pe,4,0,0],[1,[23],Pe,Pe,2,0,0],[1,[23],Pe,Pe,1,0,0],[1,[2,1],Pe,Pe,1,0,2],[1,[1],Pe,Pe,1,0,2],[1,[1],Pe,Pe,1,0,2],[1,[1],Pe,Pe,2,0,2],[2,[1,1],Pe,Pe,2,0,2],[2,[1,2],Pe,Pe,1,0,2],[2,[1,2],Pe,Pe,1,0,2],[1,[1,1],Pe,Pe,1,0,2],[1,[3],Pe,Pe,1,0,0],[1,[3],Pe,Pe,1,0,0],[3,[1,1,1],Pe,Pe,1,0,0],[4,[1,1,1,1],Pe,Pe,1,0,0],[4,[1,1,1,1,1],Pe,Pe,1,0,0],[1,[2,66,65],Pe,Pe,2,0,2],[1,[16,4],Pe,Pe,2,0,2],[1,[2,4],Pe,Pe,16,0,2],[1,[2,4],Pe,Pe,16,16383,0],[1,[2,3,66,66,66,65,67,66,67],[66],Pe,3,0,2],[1,[3],[127],Pe,575,0,2],[0,[3],Pe,Pe,1,0,2],[2,[3,115,83,3],Pe,Pe,1,0,2],[3,[3,83,115,83,3],Pe,Pe,1,0,2],[4,[3,3,3,4,3],Pe,Pe,4,0,2],[4,[3,3,3,4,3],Pe,Pe,4,0,2],[4,[3,3,3,3,3],Pe,Pe,4,0,2],[0,[3],Pe,Pe,4,0,2],[2,[3,3,3],Pe,Pe,4,0,2],[3,[3,3,3,3],Pe,Pe,4,0,2],[1,[1,67,66],Pe,Pe,1,0,2],[1,[52],Pe,Pe,36,0,2],[1,[2],Pe,Pe,2,0,0],[1,[32],Pe,Pe,1,0,0],[1,[32],Pe,Pe,32,0,0],[2,[32,32],Pe,Pe,32,0,0],[0,[2,2],Pe,Pe,32,0,2],[4,[1,1,1,1,1,1],Pe,Pe,1,0,0],[4,[1,1,1,1,1,1],Pe,Pe,1,0,0],[1,Pe,[121],Pe,1,0,16],[0,[1,16],Pe,Pe,4,0,2],[3,[2,1,1,1],Pe,Pe,512,0,2],[1,[4],Pe,Pe,512,0,2],[0,Pe,Pe,Pe,512,0,2],[0,Pe,Pe,Pe,512,0,2],[2,[2,2],Pe,Pe,1,0,2],[2,[1,2],Pe,Pe,32,0,2],[3,[1,18,18],Pe,Pe,4,0,2],[2,[1,2],Pe,Pe,4,0,2],[1,[1],Pe,Pe,4,0,2],[0,[1],Pe,Pe,512,0,2],[0,[2],Pe,Pe,4,0,2],[0,[3,3,3,3],Pe,Pe,3,0,2],[1,Pe,[113],Pe,1,0,16],[1,[1],Pe,Pe,1,0,0],[1,[1,16],Pe,Pe,47,0,2],[1,[1],Pe,Pe,47,0,2],[1,[1,2],Pe,Pe,47,0,2],[1,[1,2],Pe,Pe,63,0,2],[3,[16,19,18],Pe,Pe,1,0,0],[1,[143],Pe,Pe,4,0,0],[0,[82,65,65],Pe,Pe,2,0,2],[0,[66,82,17,17],Pe,Pe,1,0,2],[1,Pe,[49],Pe,1,0,16],[1,Pe,[49],Pe,1,0,16],[3,[16,19,18],Pe,Pe,1,0,0],[3,[16,19,18],Pe,Pe,1,0,0],[1,[1,1],Pe,Pe,1,0,0],[1,[143],Pe,Pe,4,0,0],[3,[16,83,18],Pe,Pe,1,0,0],[1,[3],Pe,Pe,4,0,2],[1,[3],Pe,Pe,4,0,2],void 0,void 0,[1,[1,1],Pe,Pe,2,0,0],[2,[2,2,1],Pe,Pe,1,0,0],[2,[2,2,1],Pe,Pe,1,0,0],[4,[2,1,1,2],Pe,Pe,2,0,0],[1,[2,9],Pe,Pe,2,0,0],[1,[2,9],Pe,Pe,2,0,0],[3,[2,1,1],Pe,Pe,2,0,0],[1,[2],Pe,Pe,1,0,0],[2,[1,1],Pe,Pe,1,0,0],[2,[1,1],Pe,Pe,1,0,0],[1,[2],Pe,Pe,2,0,0],[1,[2],Pe,Pe,2,0,0],[2,[1,16,4],Pe,Pe,1,0,16],void 0,void 0,[2,[1,65,65,68,66],Pe,Pe,2,0,0],[2,[1,1,4],Pe,Pe,1,0,0],[0,Pe,Pe,Pe,1,16383,0],[5,[1,1,1,1,1,1,4],Pe,Pe,1,0,0],[0,Pe,Pe,Pe,512,0,2],[1,[12],Pe,Pe,512,0,2],[0,Pe,Pe,Pe,512,0,2],[1,[2,82,84],Pe,Pe,512,0,2],[1,Pe,[49],Pe,1,0,16],[1,Pe,[32],Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[3,[16,19,18],Pe,Pe,263,0,0],[2,[1,18,17,17,18,17,17,115,84,21,17],Pe,Pe,2,0,2],[0,[4],Pe,Pe,4,0,2],[0,Pe,Pe,Pe,16,0,2],[0,[2,2],Pe,Pe,4,0,2],[0,[2,2,2],Pe,Pe,4,0,2],[2,[2,23,23,23,23],Pe,Pe,2,0,2],[2,[2,1,1,2],Pe,Pe,1,0,2],[1,[2,66,65,65],Pe,Pe,1,0,2],[1,[2],Pe,Pe,3,16383,0],[0,Pe,Pe,Pe,2,0,2],[1,[1,2,1,1,1],Pe,Pe,47,0,2],[4,[1,1,1,1,1],Pe,Pe,1,0,0],[0,[4],Pe,Pe,512,0,2],void 0,void 0,[0,[1],Pe,Pe,512,0,2],[2,[48,48],Pe,Pe,32,0,16],[0,[66,96],Pe,Pe,2,0,2],[1,[2],Pe,Pe,4,0,2],[1,[17],[127],Pe,575,0,0],[1,[3],Pe,Pe,4,0,2],[1,[2],Pe,Pe,63,0,2],[1,[1,3],Pe,Pe,47,0,2],[1,[1,3,1],Pe,Pe,47,0,2],[1,[2,66,4],Pe,Pe,4,0,2],[1,[15],Pe,Pe,1,0,0],[0,[2],Pe,Pe,4,0,2],[0,[2],Pe,Pe,4,0,2],[0,[99,66],Pe,Pe,4,0,2],[3,[3,1,4],Pe,Pe,4,0,2],[3,[3,1,4],Pe,Pe,4,0,2],[2,[2,3,66],Pe,Pe,1,0,2],[1,[1,2],Pe,Pe,35,0,2],[1,Pe,[49],Pe,1,0,16],[3,[1,1,1,65,65],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[3,[1,1,1,65,65],Pe,Pe,1,0,0],[4,[1,1,1,4],Pe,Pe,1,0,0],[2,[1,1],Pe,Pe,1,0,0],[2,[1,1],Pe,Pe,1,0,0],[2,[1,1],Pe,Pe,1,0,0],[3,[1,1,1],Pe,Pe,1,0,0],[3,[1,1,1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[3,[1,1,4],Pe,Pe,1,0,0],[3,[1,1,1],Pe,Pe,1,0,0],[3,[1,1,1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[2,[1,1],Pe,Pe,1,0,0],[4,[1,1,1,4],Pe,Pe,1,0,0],[3,[1,1,1],Pe,Pe,1,0,0],[2,[1,1],Pe,Pe,1,0,0],[4,[1,1,1,1],Pe,Pe,1,0,0],[3,[1,1,1],Pe,Pe,1,0,0],[3,[1,1,1],Pe,Pe,1,0,0],[3,[1,1,1],Pe,Pe,1,0,0],[4,[1,1,1,4],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[3,[1,1,1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[3,[1,1,1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[2,[1,1],Pe,Pe,1,0,0],[3,[1,1,4],Pe,Pe,1,0,0],[3,[1,1,1],Pe,Pe,1,0,0],[4,[1,1,1,4],Pe,Pe,1,0,0],[2,[32,32],Pe,Pe,1,0,0],[2,[32,32],Pe,Pe,1,0,0],[2,[32,32],Pe,Pe,1,0,0],[2,[32,32],Pe,Pe,1,0,0],[2,[32,32],Pe,Pe,1,0,0],[2,[32,32],Pe,Pe,1,0,0],[3,[1,32,32],Pe,Pe,1,0,0],[2,[32,32],Pe,Pe,1,0,0],[2,[32,32],Pe,Pe,1,0,0],[2,[32,32],Pe,Pe,1,0,0],[2,[32,32],Pe,Pe,1,0,0],[2,[32,32],Pe,Pe,1,0,0],[2,[32,32],Pe,Pe,1,0,0],[4,[32,32,1,1],Pe,Pe,1,0,0],[3,[32,32,1,65],Pe,Pe,1,0,0],[1,Pe,[49],Pe,1,0,16],[1,Pe,[49],Pe,1,0,16],[1,Pe,[49],Pe,1,0,16],[1,Pe,[49],Pe,1,0,16],[1,Pe,[49],Pe,1,0,16],[1,Pe,[49],Pe,1,0,16],[2,[49,1,1],Pe,Pe,1,0,16],[2,[49,1],Pe,Pe,1,0,16],[2,[49,1],Pe,Pe,1,0,16],[2,[49,1],Pe,Pe,1,0,16],[2,[49,1],Pe,Pe,1,0,16],[2,[49,1,65],Pe,Pe,1,0,16],[1,Pe,[32],Pe,1,0,16],[2,[49,1],Pe,Pe,1,0,16],[2,[1,1],Pe,Pe,1,0,0],void 0,[3,[2,1,1,1],Pe,Pe,1,0,2],[2,[2,1,1],Pe,Pe,1,0,2],[1,Pe,[2],Pe,2,0,0],[2,[1,1],Pe,Pe,1,0,0],[2,[66,2,66,65,65,65,66,66,66],Pe,Pe,2,0,2],[1,[1,2],Pe,Pe,35,0,2],[1,[1,66,2],Pe,Pe,35,0,2],[1,[1,66,66,2],Pe,Pe,7,0,2],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[2,[1],[16],Pe,1,0,0],[2,[16,15,16],Pe,Pe,1,0,0],[2,[16,15],Pe,Pe,1,0,0],[1,[16],Pe,Pe,1,0,0],[1,[1,2],Pe,Pe,19,0,2],[1,[33],Pe,Pe,33,0,2],[4,[1,1,1,1],Pe,Pe,1,0,0],[3,[1,1,2],Pe,Pe,1,0,0],[1,[1],Pe,Pe,2,0,0],[2,[1,1],Pe,Pe,2,0,0],[1,[1,5],Pe,Pe,2,0,0],[0,[66,66,66,65],Pe,Pe,6,0,2],[0,[66,66,66,66,65],Pe,Pe,6,0,2],[1,[1,2],Pe,Pe,19,0,2],[2,[18,18],[2,79],Pe,15,0,0],[1,[2,39],Pe,Pe,39,0,0],[1,[16],Pe,Pe,2,0,0],[1,Pe,[49],Pe,1,0,16],[1,Pe,[49],Pe,1,0,16],[1,Pe,[49],Pe,1,0,16],[1,Pe,[49],Pe,1,0,16],[1,Pe,[49],Pe,1,0,16],[1,Pe,[49],Pe,1,0,16],[1,Pe,[49],Pe,1,0,16],[1,[1],Pe,Pe,2,0,0],[1,[1],Pe,Pe,2,0,0],[1,[3],Pe,Pe,2,0,0],[1,[1],Pe,Pe,2,0,0],[1,[1],Pe,Pe,2,0,0],[1,[1],Pe,Pe,2,0,0],[1,[2],Pe,Pe,1,0,0],[1,[2],Pe,Pe,4,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[3,Pe,[2],Pe,2,0,0],[1,[2],[50],Pe,15,0,0],[2,[2,50,2],Pe,Pe,10,0,0],[3,[2,2,2],Pe,Pe,15,0,0],[3,[2,2,1,2],Pe,Pe,10,0,0],[1,[95,95],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[1,[95,95],Pe,Pe,9,0,0],[1,[95,95],Pe,Pe,9,0,0],[1,[95,95],Pe,Pe,9,0,0],[1,[95,95],Pe,Pe,9,0,0],[1,[95,95],Pe,Pe,9,0,0],[1,[95,95],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[1,[95,95],Pe,Pe,9,0,0],[1,[95,95],Pe,Pe,9,0,0],[2,[95,95],Pe,Pe,9,0,0],[2,[95,95],Pe,Pe,9,0,0],[2,[95,95],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[2,[95,95,95],Pe,Pe,9,0,0],[1,Pe,[127],Pe,9,0,0],[1,Pe,[127],Pe,9,0,0],[4,[95,95,95,127],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[2,[95,95],Pe,Pe,9,0,0],[1,[95,95],Pe,Pe,9,0,0],[1,[95,95],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[2,[95,95],Pe,Pe,9,0,0],[1,[95,95],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[2,[95,95],Pe,Pe,9,0,0],[2,[95,95],Pe,Pe,9,0,0],[2,[95,95],Pe,Pe,9,0,0],[2,[95,95],Pe,Pe,9,0,0],[2,[127,127,95],Pe,Pe,9,0,0],[3,[95,127,127],Pe,Pe,9,0,0],[5,[95,95,95,95,95,95],Pe,Pe,9,0,0],[5,[95,95,95,95,95,95],Pe,Pe,9,0,0],[4,[95,95,95,95,95],Pe,Pe,9,0,0],[4,[95,95,95,95,95],Pe,Pe,9,0,0],[4,[95,95,95,95,95],Pe,Pe,9,0,0],[4,[95,95,95,95,95],Pe,Pe,9,0,0],[4,[95,95,95,95,95],Pe,Pe,9,0,0],[3,[95,95,95],Pe,Pe,9,0,0],[3,[95,95,95],Pe,Pe,9,0,0],[3,[95,95,95],Pe,Pe,9,0,0],[6,[95,95,95,95,95,95,95],Pe,Pe,9,0,0],[6,[95,95,95,95,95,95,95],Pe,Pe,9,0,0],[2,[95,95],Pe,Pe,9,0,0],[2,[95,95],Pe,Pe,9,0,0],[2,[95,95],Pe,Pe,9,0,0],[2,[95,95],Pe,Pe,9,0,0],[6,[95,95,95,95,95,95],Pe,Pe,9,0,0],[6,[95,95,95,95,95,95],Pe,Pe,9,0,0],[2,[95,95],Pe,Pe,9,0,0],[2,[95,95],Pe,Pe,9,0,0],[2,[95,95,95],Pe,Pe,9,0,0],[3,[95,95,95,95],Pe,Pe,9,0,0],[3,[95,95,95,95],Pe,Pe,9,0,0],[3,[95,95,95,95],Pe,Pe,9,0,0],[3,[95,95,95,95],Pe,Pe,9,0,0],[3,[95,95,95,95],Pe,Pe,9,0,0],[3,[95,95,95,95],Pe,Pe,9,0,0],[5,[95,95,95,95,95,95],Pe,Pe,9,0,0],[5,[95,95,95,95,95,95],Pe,Pe,9,0,0],[7,[95,95,95,95,95,95,95,95],Pe,Pe,9,0,0],[7,[95,95,95,95,95,95,95,95],Pe,Pe,9,0,0],[8,[95,95,95,95,95,95,95,95,95],Pe,Pe,9,0,0],[8,[95,95,95,95,95,95,95,95,95],Pe,Pe,9,0,0],[2,[95,95],Pe,Pe,9,16383,0],[1,[95,95],Pe,Pe,9,0,0],[6,[95,95,95,95,95,95,95],Pe,Pe,9,0,0],[6,[95,95,95,95,95,95,95],Pe,Pe,9,0,0],[3,[95,95,95],Pe,Pe,9,0,0],[6,[95,95,95,95,95,95,95,95],Pe,Pe,9,0,0],[4,[95,95,95,95,95],Pe,Pe,9,0,0],[2,[95,95,127],Pe,Pe,9,0,0],[2,[95,95,127],Pe,Pe,9,0,0],[1,Pe,[127],Pe,9,0,0],[1,Pe,[127],Pe,9,0,0],[1,Pe,[127],Pe,9,0,0],[2,[95,127],Pe,Pe,9,0,0],[3,[2,2,1,2],Pe,Pe,10,0,0],[2,[2,50,2,1,2],Pe,Pe,10,0,0],[1,[2],Pe,Pe,9,0,0],[2,[47,575],Pe,Pe,303,0,0],[2,Pe,[16,15],Pe,1,0,0],[3,[16],[16,15],Pe,1,0,0],[2,[16,15,16],Pe,Pe,1,0,0],[3,[16],[16,15],Pe,1,0,0],[3,[1,1,48,17],[16],Pe,1,0,0],[4,[1,1,1,4],Pe,Pe,1,0,0],[3,[1,1,1],Pe,Pe,1,0,0],[3,[1,1,1],Pe,Pe,1,0,0],[3,[1,1,1],Pe,Pe,1,0,0],[2,[32,32],Pe,Pe,1,0,0],[2,[32,32],Pe,Pe,1,0,0],[2,[32,32],Pe,Pe,1,0,0],[2,[32,32],Pe,Pe,1,0,0],[3,[1,1,4],Pe,Pe,1,0,0],[4,[1,1,1,4],Pe,Pe,1,0,0],[3,[1,1,1],Pe,Pe,1,0,0],[1,Pe,[32],Pe,32,0,16],[1,Pe,[32],Pe,1,0,16],[4,[1,1,1,4],Pe,Pe,1,0,0],[3,[1,1,1],Pe,Pe,1,0,0],[2,[49,1],Pe,Pe,1,0,16],[2,[49,1],Pe,Pe,1,0,16],[2,[49,1,65],Pe,Pe,1,0,16],[2,[49,1,65],Pe,Pe,1,0,16],[3,[1,1,4],Pe,Pe,1,0,0],[2,[49,1],Pe,Pe,1,0,16],[2,[49,1],Pe,Pe,1,0,16],[2,[1,16,4],Pe,Pe,1,0,16],[2,[1,16,4],Pe,Pe,1,0,16],[1,Pe,[49],Pe,1,0,16],[1,Pe,[49],Pe,1,0,16],[3,[1,1,4],Pe,Pe,1,0,0],[2,[1,1],Pe,Pe,1,0,0],[2,[1,1],Pe,Pe,1,0,0],[2,[1,1],Pe,Pe,1,0,0],[2,[1,1],Pe,Pe,1,0,0],[1,Pe,[49],Pe,1,0,16],[1,Pe,[49],Pe,1,0,16],[4,[1,1,1,4],Pe,Pe,1,0,0],[2,[95,95,75,127],Pe,Pe,9,0,0],[2,[95,95,75,127],Pe,Pe,9,0,0],[2,[1,1],Pe,Pe,1,0,0],[1,[1,65],Pe,Pe,1,0,0],void 0,[4,[1,1,1,4,65,65],Pe,Pe,1,0,0],[3,[1,1,1,65,65],Pe,Pe,1,0,0],[3,[1,1,4],Pe,Pe,1,0,0],[2,[1,1],Pe,Pe,1,0,0],[2,[1,1],Pe,Pe,1,0,0],[2,[1,1],Pe,Pe,1,0,0],[4,[1,1,1,4],Pe,Pe,1,0,0],[3,[1,1,1],Pe,Pe,1,0,0],[3,[1,1,1],Pe,Pe,1,0,0],[3,[1,1,1],Pe,Pe,1,0,0],[5,[1,1,1,1,4],Pe,Pe,1,0,0],[4,[1,1,1,4],Pe,Pe,1,0,0],[3,[1,1,1],Pe,Pe,1,0,0],[4,[1,1,1,4],Pe,Pe,1,0,0],[2,[1,4],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[4,[32,32,1,1],Pe,Pe,1,0,0],[2,[49,1,1],Pe,Pe,1,0,16],[1,[95],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1,65],Pe,Pe,1,0,0],[1,[1,65],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[95],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[2,[1,1],Pe,Pe,1,0,0],[2,[1,1],Pe,Pe,1,0,0],[2,[1,1],Pe,Pe,1,0,0],[2,[1,1],Pe,Pe,1,0,0],[2,[1,1],Pe,Pe,1,0,0],[2,[1,1],Pe,Pe,1,0,0],[2,[1,1],Pe,Pe,1,0,0],[1,Pe,[52],Pe,4,0,16],[3,[1,1,1],Pe,Pe,1,0,0],[2,[1,1,65],Pe,Pe,2,0,0],[2,[2,1],Pe,Pe,1,0,0],[2,[3,3],Pe,Pe,1,0,0],[3,[1,1,1,65],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,Pe,[49],Pe,1,0,16],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[3,[1,1,1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,2,0,0],[1,[2],Pe,Pe,1,0,0],[1,[1],Pe,Pe,32,0,0],[1,[2],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[2,66,66],Pe,Pe,1,0,0],[0,[50],Pe,Pe,1,16383,16],[0,[48],Pe,Pe,1,16383,16],[1,[16],Pe,Pe,2,16383,0],[1,[16],Pe,Pe,4,0,0],[2,[47,575],Pe,Pe,303,0,0],[1,[1,65,65],Pe,Pe,1,0,0],[1,[1,65,65],Pe,Pe,1,0,0],[1,[95],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[2,[2,2],Pe,Pe,47,0,0],[1,[2],Pe,Pe,10,0,0],[1,[2],Pe,Pe,10,0,0],[3,[1,48,48,65,65,65],Pe,Pe,1,0,0],[3,[1,48,48,65,65,65,65],Pe,Pe,1,0,0],[2,[48,48,65,65],Pe,Pe,1,0,0],[3,[1,32,32],Pe,Pe,1,0,0],[3,[48,48,1,65,65,65],Pe,Pe,1,0,0],[3,[16],[16,15],Pe,1,0,0],[3,[16],[16,15],Pe,1,0,0],[3,[114,68],[114],Pe,2,0,16],[1,Pe,[114],Pe,2,0,16],[2,Pe,[44,575],Pe,831,0,0],[3,[47],[575,575],[575],831,0,0],[1,[1399],Pe,Pe,1375,0,17],[2,Pe,[113,113],Pe,1,0,17],[1,[16],Pe,Pe,48,0,21],[2,[271,2,4],Pe,Pe,303,0,21],[2,[271,2],Pe,Pe,303,0,17],[2,[48,48,111],Pe,Pe,303,0,1],[1,[160,96,96,4],Pe,Pe,32,0,1],[1,[160,4,4],Pe,Pe,32,0,1],[2,[2,256],Pe,Pe,1,0,8],[3,[2,49,1],Pe,Pe,1,0,25],[3,[2,49,1],Pe,Pe,1,0,25],[2,[2],[49],Pe,1,0,25],[2,[2,2,65,68,68],Pe,Pe,1,0,1],[1,[2,65,65],Pe,Pe,2,0,1],[2,[2,2,65,68],Pe,Pe,2,0,1],[2,[2,2,65,68],Pe,Pe,2,0,1],[2,[2,98,98,68],Pe,Pe,32,0,1],[1,[32,96,96,4],Pe,Pe,32,0,9],[2,[4,16],Pe,Pe,32,0,25],[2,[391,48,65,65],Pe,Pe,1,0,1],[3,[391,48,48,511,65,65],Pe,Pe,319,0,1],[2,[160],[160,65],Pe,32,0,1],[0,[65,65,65,65,68],Pe,Pe,32,16383,1],[1,[65,65,65,65],Pe,Pe,32,0,1],[2,[258,1,65,65,68],[65],Pe,32,0,17],[1,[48,65,65,65,65],Pe,Pe,48,0,1],[1,[48],[48],Pe,32,0,1],[1,[48],[48],Pe,32,0,1],[1,[48,33],[33],Pe,32,0,1],[1,[48,33],[33],Pe,32,0,1],[3,Pe,[319,319],[319],319,0,1],[1,Pe,[319],Pe,319,0,1],[3,[1,1,319],Pe,Pe,32,0,1],[1,Pe,[319],Pe,319,0,1],[1,[319],Pe,Pe,4,0,1],[1,[319],Pe,Pe,9,0,1],[0,Pe,Pe,Pe,319,0,1],[3,[15],[2,47],Pe,303,0,17],[1,[399,1],Pe,Pe,2,0,1],[1,[32,1],Pe,Pe,2,0,1],[0,Pe,Pe,Pe,1,0,1],[1,[2],Pe,Pe,258,0,1],[1,[287,2],Pe,Pe,288,0,17],[2,[15,2],Pe,Pe,271,0,17],[1,[1],Pe,Pe,10,0,17],[0,Pe,Pe,Pe,1,0,1],[3,[47],[2,47],Pe,47,0,17],[1,[16],Pe,Pe,2,16383,1],[1,[16],Pe,Pe,2,16383,1],[1,[16],Pe,Pe,2,16383,1],[0,[1],Pe,Pe,1,0,1],[2,[1,1],Pe,Pe,265,0,17],void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,[3,Pe,[319,319],[319],319,0,1]].map((function(e){return void 0===e?void 0:ve.apply(void 0,e)})),Ve=ve(0,[],[P.All],[],P.All,G.All,V.None);!function(e){e[e.Add=1]="Add",e[e.Sub=2]="Sub",e[e.Mul=3]="Mul",e[e.Div=4]="Div",e[e.Pow=5]="Pow",e[e.Percent=6]="Percent",e[e.Neg=7]="Neg",e[e.Pos=8]="Pos",e[e.Concat=9]="Concat",e[e.Eq=10]="Eq",e[e.Ne=11]="Ne",e[e.Lt=12]="Lt",e[e.Le=13]="Le",e[e.Gt=14]="Gt",e[e.Ge=15]="Ge",e[e.Range=16]="Range",e[e.Isect=17]="Isect",e[e.Union=18]="Union",e[e.And=19]="And",e[e.Or=20]="Or",e[e.Xor=21]="Xor",e[e.Min=22]="Min",e[e.Max=23]="Max",e[e.Dot=24]="Dot",e[e.At=25]="At",e[e.Pound=26]="Pound"}(Ue||(Ue={}));var Be,We,je=[void 0,"+","-","*","/","^","%","-","+","&","=","<>","<","<=",">",">=",":",void 0,void 0,"&&","||","^^",void 0,void 0,".","@","#"],He=x.Number|x.String|x.Boolean|x.Blank,Ke=x.Number|x.String|x.Boolean|x.Blank,qe=ve(2,[x.Number,x.Number],[],[],x.Number,G.None,V.None),Ye=ve(1,[x.Number],[],[],x.Number,G.None,V.None),Je=ve(1,[He],[],[],He,G.None,V.None),Qe=ve(2,[x.String,x.String],[],[],x.String,G.None,V.None),Xe=ve(2,[Ke,Ke],[],[],x.Boolean,G.None,V.None),ze=ve(2,[x.Range,x.Range],[],[],x.Range,G.AllCells,V.None),Ze=ve(2,[x.Range,x.Range],[],[],x.Range,G.None,V.None),$e=ve(2,[x.Boolean,x.Boolean],[],[],x.Boolean,G.None,V.None),et=[];function tt(e){var t=et[e];return null!=t?t:Ve}function rt(e){var t=Ge[e];return null!=t?t:Ve}function nt(e,t){var r=Ge[e];null!=r&&(r.staticPrecs=t)}function at(e){return{kind:Be.Success,value:e}}function it(e){return{kind:Be.Failure,reason:e}}function ot(e){return e.kind===Be.Success}function ut(e){return{kind:We.JavaScriptError,error:e}}function ct(e){return e.index===e.index2}function st(e){return e.isWellFormed}function lt(e){return 1===e.rows&&1===e.cols}function ft(e){return ct(e.sheet)}function dt(e){return lt(e.range)}function ht(e,t){if(lt(e))return t(e,0,0);for(var r=e.row,n=e.rows,a=e.col,i=e.cols,o=0;o<n;o+=1)for(var u=0;u<i;u+=1)if(!t(Zt(r+o,a+u),o,u))return!1;return!0}function vt(e,t){return e===t||e.name===t.name&&e.path===t.path}function pt(e,t){return vt(e.document,t.document)&&e.index===t.index}function mt(e,t){return e.row===t.row&&e.col===t.col}function gt(e,t){return pt(e.sheet,t.sheet)&&mt(e.range,t.range)}function Ct(e){return lt(e)?e:Xt(e.row,e.col,1,1)}function St(e){return dt(e)?e:rr(e.sheet,Ct(e.range))}function yt(e,t){var r=e.row,n=e.col,a=t.row,i=t.col;return Xt(Math.min(r,a),Math.min(n,i),Math.abs(a-r)+1,Math.abs(i-n)+1)}function Et(e,t){function r(r){var n=e.spans[r.label];return void 0!==n&&n.start<=t&&t<n.end}for(var n=e.node,a=!0;a;)switch(a=!1,n.kind){case L.Array:for(var i=n.nodes,o=i.length-1;!a&&o>=0;o-=1)for(var u=i[o],c=u.length-1;!a&&c>=0;c-=1){r(l=u[c])&&(n=l,a=!0)}break;case L.App:var s=n.args;for(c=s.length-1;!a&&c>=0;c-=1){r(l=s[c])&&(n=l,a=!0)}break;case L.Paren:var l;r(l=n.node)&&(n=l,a=!0);break;case L.Bad:case L.Name:case L.CellRef:case L.Literal:break;default:k("getSubExpressionFromPosition",n)}return n}et[Ue.Add]=qe,et[Ue.Sub]=qe,et[Ue.Mul]=qe,et[Ue.Div]=qe,et[Ue.Pow]=qe,et[Ue.Percent]=Ye,et[Ue.Neg]=Ye,et[Ue.At]=Ge[De.SINGLE],et[Ue.Pound]=Ge[De.ANCHORARRAY],et[Ue.Pos]=Je,et[Ue.Concat]=Qe,et[Ue.Eq]=Xe,et[Ue.Ne]=Xe,et[Ue.Lt]=Xe,et[Ue.Le]=Xe,et[Ue.Gt]=Xe,et[Ue.Ge]=Xe,et[Ue.Range]=ze,et[Ue.Isect]=Ze,et[Ue.Union]=Ze,et[Ue.And]=$e,et[Ue.Or]=$e,et[Ue.Xor]=$e,et[Ue.Min]=qe,et[Ue.Max]=qe,et[Ue.Dot]=Ge[De._FV],nt(De.ROW,G.OwnRow),nt(De.COLUMN,G.OwnCol),nt(De.SHEET,G.OwnDocSheets),nt(De.SHEETS,G.OwnDocSheets),nt(De.OFFSET,G.AllCells),nt(De.INDIRECT,G.AllCells),nt(De.SUMIF,G.AllCells),nt(De.AVERAGEIF,G.AllCells),nt(De.LOOKUP,G.AllCells),nt(De.ADDRESS,G.RefStyle),nt(De.FORMULATEXT,G.RefStyle),nt(De.NOW,G.Time),nt(De.TODAY,G.Time),nt(De.RAND,G.Calc),nt(De.RANDBETWEEN,G.Calc),nt(De.RANDARRAY,G.Calc),nt(De.SUBTOTAL,G.CellProps),nt(De.CELL,G.CellProps|G.AllCells),nt(De.INFO,G.None),function(e){e.Success="Success",e.Failure="Failure",e.Paused="Paused"}(Be||(Be={})),function(e){e.JavaScriptError="JavaScriptError"}(We||(We={}));var Ot,kt=[];function At(e){return 0===function(e){if(1===e.args.length){var t=e.args[0];if(t.kind===L.Literal&&Nt(t.oper)===x.Missing)return 0}return e.args.length}(e)?kt:e.args}function bt(e){return e.kind===L.Operator}function Rt(e){return e.kind===L.Name&&void 0===e.qualifier}function It(e,t,r){var n=e.headTypes,a=e.restTypes,i=e.tailTypes;if(I("calc.runtime.getArgType: n",r),T("calc.runtime.getArgType: i",t,r),t<n.length)return n[t];if(0===a.length)return P.None;var o=(r-n.length)%a.length;return o>i.length?P.None:t>=r-o?i[t-(r-o)]:a[(t-n.length)%a.length]}function Tt(e,t){var r=e.minArgs,n=e.headTypes,a=e.restTypes,i=e.tailTypes;return!(t<r)&&(t<=n.length||0!==a.length&&(t-n.length)%a.length<=i.length)}function Nt(e){switch(typeof e){case"number":return x.Number;case"string":return x.String;case"boolean":return x.Boolean;default:return e.kind}}function Ft(e){return"number"==typeof e&&isFinite(e)}function _t(e,t,r){if(typeof t!=typeof e)return!1;if("object"!=typeof t||"object"!=typeof e)return t===e;if(t.kind!==e.kind)return!1;switch(t.kind){case x.Error:return t.type===e.type;case x.Rich:return r;case x.Array:var n=e;if(t.cols!==n.cols||t.rows!==n.rows)return!1;for(var a=0;a<t.rows;a+=1)for(var i=t.opers[a],o=n.opers[a],u=0;u<t.cols;u+=1)if(!_t(o[u],i[u],r))return!1;return!0;case x.Blank:return!0;default:return k("calc.lang.readOperEq",t)}}!function(e){e.NotImplemented="NotImplemented",e.Unavailable="Unavailable",e.Internal="Internal"}(Ot||(Ot={}));var Mt=Object(j.a)(Object(j.a)({},We),Ot);function Dt(e){return{kind:Mt.NotImplemented,features:e}}function wt(e){return 0===e.length&&A("calc.lang.unavailable: expected nonempty array"),{kind:Mt.Unavailable,objects:e}}function Lt(e){return{kind:Mt.Internal,message:e}}var Ut=function(e){this.reason=e,this.name="EvaluationError",this.stack="EvaluationError",this.message=e.kind};(Ut.prototype=Object.create(Error.prototype)).constructor=Ut;var xt="_xlfn.",Pt="_xlws.";function Gt(e,t){var r=t;return r.length>xt.length&&0===e.stringCompareCI(r.substr(0,xt.length),xt)&&(r=r.substr(xt.length)).length>Pt.length&&0===e.stringCompareCI(r.substr(0,Pt.length),Pt)&&(r=r.substr(Pt.length)),e.getWorksheetFuncId(r)}var Vt;function Bt(e){return{kind:Vt.Cell,range:e}}function Wt(e){return{kind:Vt.Range,range:e}}function jt(e,t){switch(e){case Vt.Cell:return dt(t)?Bt(t):A("calc.lang.lexicalSourceGrid: expected cell");case Vt.Range:return Wt(t)}}function Ht(e){return{kind:Vt.NameManager,name:e}}!function(e){e[e.Cell=1]="Cell",e[e.Range=2]="Range",e[e.NameManager=3]="NameManager",e[e.CondFormatting=4]="CondFormatting",e[e.DataValidation=5]="DataValidation",e[e.Indirect=6]="Indirect",e[e.Other=7]="Other"}(Vt||(Vt={}));function Kt(e,t){return{path:e,name:t}}function qt(e,t,r){return{document:e,index:t,index2:r}}function Yt(e,t){return qt(e,t,t)}function Jt(e){return{document:e,index:void 0,index2:void 0}}function Qt(e,t){return{sheets:e,position:t}}function Xt(e,t,r,n){return{row:e,col:t,rows:r,cols:n}}function zt(e,t,r,n){return T("calc.lang.gridRange",e,1<<20),T("calc.lang.gridRange",t,16384),N("calc.lang.gridRange",r,(1<<20)-e),N("calc.lang.gridRange",n,16384-t),Xt(e,t,r,n)}function Zt(e,t){return T("calc.lang.gridCell",e,1<<20),T("calc.lang.gridCell",t,16384),Xt(e,t,1,1)}function $t(e,t){return{sheet:e,range:t}}var er=$t,tr=$t,rr=$t,nr=$t;function ar(e){return{document:e,index:void 0}}function ir(e,t){return void 0===t?ar(e):Yt(e,t)}function or(e,t){return{scope:e,name:t}}function ur(e,t){return{document:e,id:t}}function cr(e,t){return{wrap:e,unwrap:t}}function sr(e){return e}function lr(e){return null!=e}function fr(e){return null==e}function dr(e,t){return lr(e)?e:t}function hr(e,t){return[e,t]}function vr(e,t){return e<t?e:t}function pr(e,t){return e<t?t:e}function mr(e){return e<0?-e:e}function gr(e){try{var t=new Intl.Collator(function(e){var t=[e],r=e.indexOf("-");return r>0&&t.push(e.substring(0,r)),"en"!==t[t.length-1]&&t.push("en"),t}(e),{sensitivity:"accent"});return t.compare.bind(t)}catch(e){return function(e,t){return e===t?0:e.toLocaleUpperCase().localeCompare(t.toLocaleUpperCase())}}}var Cr="undefined"!=typeof self&&null!=self.performance&&null!=self.performance.now?function(){return self.performance.now()}:function(){return Date.now()};function Sr(e){return 32===e||10===e}function yr(e,t,r,n){T("calc.parse.parseUint",t,16);for(var a=0,i=n,o=r.length;i<o;i+=1){var u=r.charCodeAt(i);if(!e.isNumeral(u))break;var c=e.getOrdinal(u);0===a&&0!==c&&(o=vr(o,i+t)),a=10*a+c}return i===o&&i<r.length&&e.isNumeral(r.charCodeAt(i))?[0,n]:[a,i]}var Er=43,Or=45;function kr(e,t,r,n){var a=n,i=0,o="";if(h(r,e.decimalSeparator,n)||r.length>n&&e.isNumeral(r.charCodeAt(n))){for(;a<r.length;a+=1){var u=r.charCodeAt(a);if(!e.isNumeral(u))break;if(0!==e.getOrdinal(u))break}for(var c=a;a<r.length;a+=1){u=r.charCodeAt(a);if(!e.isNumeral(u))break;i+=1}o+=r.substring(c,a);var s=!1;if(h(r,e.decimalSeparator,a)&&(s=a===n,a+=e.decimalSeparator.length),0===i)for(;a<r.length;a+=1){u=r.charCodeAt(a);if(!e.isNumeral(u))break;if(0!==e.getOrdinal(u))break;i-=1}for(c=a;a<r.length;a+=1){u=r.charCodeAt(a);if(!e.isNumeral(u))break}if(o+=r.substring(c,a),!(s&&a<=n+e.decimalSeparator.length)){var l=function(e,t,r){var n=r;if(n<t.length&&0===e.stringCompareCI("E",t.substring(n,n+1)))n+=1;else{if(!(n+1<t.length&&"**"===t.substring(n,n+2)))return[0,r];n+=2}var a=!1;if(n<t.length){var i=t.charCodeAt(n);((a=i===Or)||i===Er)&&(n+=1)}if(n>=t.length||!e.isNumeral(t.charCodeAt(n)))return!1;var o=yr(e,10,t,n),u=o[0],c=o[1];return c!==n&&(!(u>2147483647)&&[a?-u:u,c])}(e,r,a);if(!1!==l)i+=l[0],a=l[1];return!1===l||mr(i)>=309?{value:void 0,i:a}:{value:t.parse(e,!0,i,o),i:a}}}}var Ar=1<<20,br=Ar.toString(10).length,Rr=16384,Ir=Rr.toString(26).length,Tr=Rr.toString(10).length;function Nr(e){return e>=97&&e<=122||e>=65&&e<=90}function Fr(e){return 1+(e>=97?e-97:e-65)}function _r(e,t,r){return function(n,a,i,o){var u=function(e,t){return"$"===e[t]?[D.Abs,t+1]:[D.Rel,t]}(i,o),c=u[0],s=u[1],l=e(n,r,i,s),f=l[0],d=l[1];if(d>s){if(f<1||f>t)return;return[X(c,(c===D.Rel?f-a:f)-1),!1,d]}return[void 0,!1,o]}}function Mr(e,t,r){return Yr(e,t,r)-e}function Dr(e,t,r,n){return function(a,i,o,u){var c=t?e?"R":a.rowLetter:e?"C":a.columnLetter;if(u>=o.length||0!==a.stringCompareCI(c,o[u]))return[void 0,!1,u];var s=u+1,l=yr(a,n,o,s),f=l[0],d=l[1];if(d>s){if(f<1||f>r)return;return[X(D.Abs,f-1),!1,d]}if(o[s]===a.leftBracket){if(o[s+=1]===a.rightBracket)return[X(D.Rel,Mr(i,0,r)),!0,s+1];var h=1;"+"===o[s]?s+=1:"-"===o[s]&&(h=-1,s+=1);var v=yr(a,n,o,s),p=v[0],m=v[1];if(m>s&&p<r&&o[m]===a.rightBracket)return[X(D.Rel,Mr(i,p*h,r)),!0,m+1]}return[!1,!1,d]}}function wr(e,t,r,n,a,i,o){var u=n(e,t,i,o);if(null==u)return[void 0,void 0,o];var c=u[0],s=u[1],l=u[2];if(l>o){var f=a(e,r,i,l);if(null==f)return s?[c,void 0,l]:[void 0,void 0,o];var d=f[0],h=f[2];return h>l?[c,d,h]:[c,void 0,l]}var v=a(e,r,i,o);if(null==v)return[void 0,void 0,o];var p=v[0],m=v[2];return m>o?[void 0,p,m]:[void 0,void 0,o]}var Lr=_r(yr,Ar,br),Ur=_r((function(e,t,r,n){return function(e,t,r){for(var n=0,a=r,i=Math.min(t.length,r+e);a<i;a+=1){var o=t.charCodeAt(a);if(!Nr(o))break;n=26*n+Fr(o)}return a===i&&Nr(t.charCodeAt(a))?[0,r]:[n,a]}(t,r,n)}),Rr,Ir),xr=Dr(!1,!0,Ar,br),Pr=Dr(!1,!1,Rr,Tr),Gr=Dr(!0,!0,Ar,br),Vr=Dr(!0,!1,Rr,Tr);function Br(e,t,r,n,a){var i,o=r.col,u=r.row;if(t===F.A1){var c=wr(e,o,u,Ur,Lr,n,a),s=c[0],l=c[1],f=c[2];if(null!=l&&null!=s||null!=l&&l.kind===D.Abs||null!=s&&s.kind===D.Abs||(null!=l||null!=s)&&(":"===n[a-1]||":"===n[f])){if(f>=n.length||!e.isIdentContinue(n.charCodeAt(f)))return{refStyle:F.A1,row:l,col:s,i:f};if("."===n[f])return}}var d=!1,h=wr(e,u,o,xr,Pr,n,a),v=h[0],p=h[1],m=h[2];if(null!=v||null!=p||"R"===e.rowLetter&&"C"===e.columnLetter||(d=!0,v=(i=wr(e,u,o,Gr,Vr,n,a))[0],p=i[1],m=i[2]),null!=v||null!=p){var g=null!=v&&!1!==v||null!=p&&!1!==p;if(m>=n.length||g||!e.isIdentContinue(n.charCodeAt(m)))return{refStyle:F.R1C1,row:v,col:p,i:m,enLocale:d}}}function Wr(e,t){var r=wr(e,0,0,Ur,Lr,t,0),n=r[0],a=r[1],i=r[2];return void 0!==n&&void 0!==a&&i===t.length?Zt(a.index,n.index):void 0}function jr(e,t){var r=wr(e,0,0,Ur,Lr,t,0),n=r[0],a=r[1],i=r[2];if(void 0!==n&&void 0!==a){if(i===t.length)return Zt(a.index,n.index);if(":"===t[i]){var o=wr(e,0,0,Ur,Lr,t,i+1),u=o[0],c=o[1],s=o[2];if(void 0!==u&&void 0!==c&&s===t.length){var l=vr(a.index,c.index),f=vr(n.index,u.index);return zt(l,f,pr(a.index,c.index)+1-l,pr(n.index,u.index)+1-f)}}}}var Hr=X(D.Abs,0),Kr=X(D.Abs,1048575);function qr(e){for(var t=e+1,r="";t>0;){var n=(t-1)%26;r=String.fromCharCode(65+n)+r,t=Math.floor((t-n)/26)}return r}function Yr(e,t,r){return e+t&r-1}function Jr(e,t,r,n){if(t.kind===D.Abs)return t.index;if(n)return Yr(e,t.index,r);var a=e+t.index;return 0<=a&&a<r?a:void 0}function Qr(e,t,r,n,a,i){var o=Jr(r,n,a,i);if(void 0!==o){if(n.kind===D.Abs)return t+(o+1).toFixed();var u=o-r;return 0===u?t:t+e.leftBracket+u.toFixed()+e.rightBracket}}function Xr(e,t,r,n,a){return t===F.A1?function(e,t,r){var n=Jr(e,t,1<<20,r);if(void 0!==n){var a=(n+1).toFixed();return t.kind===D.Abs?"$"+a:a}}(r,n,a):Qr(e,e.rowLetter,r,n,1<<20,a)}function zr(e,t,r,n,a){return t===F.A1?function(e,t,r){var n=Jr(e,t,16384,r);if(void 0!==n){var a=qr(n);return t.kind===D.Abs?"$"+a:a}}(r,n,a):Qr(e,e.columnLetter,r,n,16384,a)}function Zr(e,t,r,n){if(r.kind===D.Abs)return r;var a=Jr(t,r,e,n);if(void 0!==a){var i=a-t;return i===r.index?r:X(D.Rel,i)}}Zr.bind(void 0,1<<20),Zr.bind(void 0,16384);function $r(e,t,r,n,a){var i=Jr(e,t,n,a),o=Jr(e,r,n,a);if(void 0!==i&&void 0!==o)return i<=o?[t,r,i,o]:[r,t,o,i]}function en(e,t,r,n,a,i,o,u,c){var s=$r(i,o,u,r,c);if(void 0!==s){var l=s[0],f=s[1],d=s[2],h=s[3];if(void 0!==t&&0===d&&h===r-1&&o.kind===u.kind)return t(n,a,c);var v=e(n,a,i,l,c);if(void 0!==v){if(a===F.R1C1&&l.kind===f.kind&&l.index===f.index)return v;var p=e(n,a,i,f,c);if(void 0!==p)return v+":"+p}}}var tn=en.bind(void 0,Xr,void 0,1<<20),rn=en.bind(void 0,zr,(function(e,t,r){return tn(e,t,0,Hr,Kr,r)}),16384);function nn(e,t,r,n,a,i){var o=$r(r,n,a,t,i);if(void 0!==o){var u=o[0],c=o[1],s=o[2],l=o[3];if(void 0!==e&&0===s&&l===t-1&&n.kind===a.kind)return e;var f=Zr(t,r,u,i),d=Zr(t,r,c,i);if(void 0!==f&&void 0!==d)return[!1,f,d]}}nn.bind(void 0,void 0,1<<20),nn.bind(void 0,[!0,Hr,Kr],16384);function an(e,t,r,n,a,i){var o=Xr(e,t,r.row,n,i),u=zr(e,t,r.col,a,i);if(void 0!==o&&void 0!==u)return t===F.A1?u+o:o+u}function on(e,t,r,n,a,i,o,u){var c=$r(r.row,n,i,1<<20,u),s=$r(r.col,a,o,16384,u);if(void 0!==c&&void 0!==s){var l=c[0],f=c[1],d=c[2],h=c[3],v=s[0],p=s[1],m=s[2],g=s[3];if(0===m&&16383===g&&a.kind===o.kind)return tn(e,t,r.row,l,f,u);if(0===d&&1048575===h&&n.kind===i.kind)return rn(e,t,r.col,v,p,u);var C=an(e,t,r,l,v,u),S=an(e,t,r,f,p,u);if(void 0!==C&&void 0!==S)return C+":"+S}}var un=/'/g;function cn(e,t){if(0===t.length)return!1;if(!e.isIdentStart(t.charCodeAt(0)))return!1;for(var r=1;r<t.length;r+=1)if(!e.isIdentContinue(t.charCodeAt(r)))return!1;return!0}var sn=Zt(0,0);function ln(e,t,r){if(0===e.stringCompareCI(r,e.trueName))return!0;if(0===e.stringCompareCI(r,e.falseName))return!0;var n=Br(e,t,sn,r,0);if(void 0!==n){var a=n.refStyle,i=n.i;if(a!==F.A1)return!0;if(void 0===e.getWorksheetFuncId(r.substring(0,i)))return!0}return!cn(e,r)&&(!function(e,t){var r=0;if(t.substring(r,r+e.leftBracket.length)!==e.leftBracket)return!1;if((r+=e.leftBracket.length)===t.length||!e.isIdentContinue(t.charCodeAt(r)))return!1;for(r+=1;;){if(t.substring(r,r+e.rightBracket.length)===e.rightBracket){r+=e.rightBracket.length;break}if(r===t.length||!e.isIdentContinue(t.charCodeAt(r)))return!1;r+=1}var n=t.indexOf(":",r);return n<0?cn(e,t.substring(r)):cn(e,t.substring(r,n))&&cn(e,t.substring(n+1))}(e,r)&&!function(e,t){var r=e.leftBracket.length,n=e.rightBracket.length;return!(t.length<r+n)&&(t.substring(0,r)===e.leftBracket&&(t.substring(t.length-n)===e.rightBracket&&cn(e,t.substring(r,t.length-n))))}(e,r))}function fn(e,t,r){return ln(e,t,r)?"'"+r.replace(un,"''")+"'":r}function dn(e,t,r){var n=1===t.cols&&1===t.rows?an(e,F.A1,Zt(0,0),X(D.Rel,t.row),X(D.Rel,t.col),!1):on(e,F.A1,Zt(0,0),X(D.Rel,t.row),X(D.Rel,t.col),X(D.Rel,t.row+t.rows-1),X(D.Rel,t.col+t.cols-1),!1);return b("calc.lang.formatGridRangeA1",void 0!==n),void 0===r?n:fn(e,F.A1,r)+"!"+n}var hn,vn=r(3),pn={ULS:new f.NulLogger},mn=Object(f.initStopwatchFactory)((function(e){return pn.ULS.traceTag(595948114,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,e)}));function gn(e,t){return Object(j.b)(this,void 0,void 0,(function(){var r;return Object(j.d)(this,(function(n){switch(n.label){case 0:r=mn(e),n.label=1;case 1:return n.trys.push([1,,3,4]),[4,t()];case 2:return[2,n.sent()];case 3:return r.stop(),[7];case 4:return[2]}}))}))}!function(e){e.FeatureCheckingEnabled="FeatureCheckingEnabled",e.CalcPreventSpillingHack="CalcPreventSpillingHack",e.CalcSupportDynamicArrays="CalcSupportDynamicArrays",e.CalcStrictFormulaChecking="CalcStrictFormulaChecking",e.CalcWorksheetFunctions="CalcWorksheetFunctions",e.CalcDateTimeFunctions="CalcDateTimeFunctions",e.CalcDynamicArrayOperators="CalcDynamicArrayOperators",e.CalcExcelMath="CalcExcelMath",e.CalcClosingParen="CalcClosingParen",e.CalcFieldValueFunction="CalcFieldValueFunction",e.CalcRecordFunctions="CalcRecordFunctions",e.CalcLetFunction="CalcLetFunction",e.CalcLetRecFunction="CalcLetRecFunction",e.CalcFunFunctions="CalcFunFunctions",e.CalcWebWorkerTest="CalcWebWorkerTest",e["OfficeVSO:3852168_CalcCGIFS"]="OfficeVSO:3852168_CalcCGIFS",e["OfficeVSO:3852168_CalcCGSWITCH"]="OfficeVSO:3852168_CalcCGSWITCH",e["OfficeVSO:3852168_CalcCGAVERAGEIF"]="OfficeVSO:3852168_CalcCGAVERAGEIF",e["OfficeVSO:3852168_CalcCGAVERAGEIFS"]="OfficeVSO:3852168_CalcCGAVERAGEIFS",e["OfficeVSO:3852168_CalcCGCOUNT"]="OfficeVSO:3852168_CalcCGCOUNT",e["OfficeVSO:3852168_CalcCGCOUNTIF"]="OfficeVSO:3852168_CalcCGCOUNTIF",e["OfficeVSO:3852168_CalcCGCOUNTIFS"]="OfficeVSO:3852168_CalcCGCOUNTIFS",e["OfficeVSO:3852168_CalcCGMEDIAN"]="OfficeVSO:3852168_CalcCGMEDIAN",e["OfficeVSO:3852168_CalcCGSUMSQ"]="OfficeVSO:3852168_CalcCGSUMSQ",e["OfficeVSO:3852168_CalcCGSUMIF"]="OfficeVSO:3852168_CalcCGSUMIF",e["OfficeVSO:3852168_CalcCGSUMIFS"]="OfficeVSO:3852168_CalcCGSUMIFS",e["OfficeVSO:3852168_CalcCGROWS"]="OfficeVSO:3852168_CalcCGROWS",e["OfficeVSO:3852168_CalcCGCOLUMNS"]="OfficeVSO:3852168_CalcCGCOLUMNS",e["OfficeVSO:3852168_CalcCGINDEX"]="OfficeVSO:3852168_CalcCGINDEX",e["OfficeVSO:3852168_CalcCGMATCH"]="OfficeVSO:3852168_CalcCGMATCH",e["OfficeVSO:3852168_CalcCGLOOKUP"]="OfficeVSO:3852168_CalcCGLOOKUP",e["OfficeVSO:3852168_CalcCGHLOOKUP"]="OfficeVSO:3852168_CalcCGHLOOKUP",e["OfficeVSO:3852168_CalcCGVLOOKUP"]="OfficeVSO:3852168_CalcCGVLOOKUP",e["OfficeVSO:3852168_CalcCGLARGE"]="OfficeVSO:3852168_CalcCGLARGE",e["OfficeVSO:3852168_CalcCGSMALL"]="OfficeVSO:3852168_CalcCGSMALL",e["OfficeVSO:3852168_CalcCGPERCENTILE"]="OfficeVSO:3852168_CalcCGPERCENTILE",e["OfficeVSO:3852168_CalcCGPERCENTILE_EXC"]="OfficeVSO:3852168_CalcCGPERCENTILE_EXC",e["OfficeVSO:3852168_CalcCGQUARTILE"]="OfficeVSO:3852168_CalcCGQUARTILE",e["OfficeVSO:3852168_CalcCGQUARTILE_EXC"]="OfficeVSO:3852168_CalcCGQUARTILE_EXC",e["OfficeVSO:3852168_CalcCGRANK"]="OfficeVSO:3852168_CalcCGRANK",e["OfficeVSO:3852168_CalcCGRANK_AVG"]="OfficeVSO:3852168_CalcCGRANK_AVG",e["OfficeVSO:3852168_CalcCGTRIMMEAN"]="OfficeVSO:3852168_CalcCGTRIMMEAN",e["OfficeVSO:3852168_CalcCGTRUE"]="OfficeVSO:3852168_CalcCGTRUE",e["OfficeVSO:3852168_CalcCGFALSE"]="OfficeVSO:3852168_CalcCGFALSE",e["OfficeVSO:3852168_CalcCGNOT"]="OfficeVSO:3852168_CalcCGNOT",e["OfficeVSO:3852168_CalcCGNA"]="OfficeVSO:3852168_CalcCGNA",e["OfficeVSO:3852168_CalcCGAVERAGEA"]="OfficeVSO:3852168_CalcCGAVERAGEA",e["OfficeVSO:3852168_CalcCGMAXA"]="OfficeVSO:3852168_CalcCGMAXA",e["OfficeVSO:3852168_CalcCGMINA"]="OfficeVSO:3852168_CalcCGMINA",e["OfficeVSO:3852168_CalcCGMAXIFS"]="OfficeVSO:3852168_CalcCGMAXIFS",e["OfficeVSO:3852168_CalcCGMINIFS"]="OfficeVSO:3852168_CalcCGMINIFS",e["OfficeVSO:3852168_CalcCGXOR"]="OfficeVSO:3852168_CalcCGXOR",e["OfficeVSO:3852168_CalcCGT"]="OfficeVSO:3852168_CalcCGT",e["OfficeVSO:3852168_CalcCGN"]="OfficeVSO:3852168_CalcCGN",e["OfficeVSO:3852168_CalcCGHYPERLINK"]="OfficeVSO:3852168_CalcCGHYPERLINK",e["OfficeVSO:3852168_CalcCGAGGREGATE"]="OfficeVSO:3852168_CalcCGAGGREGATE",e["OfficeVSO:3852168_CalcCGSUBTOTAL"]="OfficeVSO:3852168_CalcCGSUBTOTAL",e["OfficeVSO:3852168_CalcCGVAR"]="OfficeVSO:3852168_CalcCGSVAR",e["OfficeVSO:3852168_CalcCGVARP"]="OfficeVSO:3852168_CalcCGVARP",e["OfficeVSO:3852168_CalcCGSTDEV"]="OfficeVSO:3852168_CalcCGSTDEV",e["OfficeVSO:3852168_CalcCGSTDEVP"]="OfficeVSO:3852168_CalcCGSTDEVP",e["OfficeVSO:3852168_CalcCGVARA"]="OfficeVSO:3852168_CalcCGSVARA",e["OfficeVSO:3852168_CalcCGVARPA"]="OfficeVSO:3852168_CalcCGVARPA",e["OfficeVSO:3852168_CalcCGSTDEVA"]="OfficeVSO:3852168_CalcCGSTDEVA",e["OfficeVSO:3852168_CalcCGSTDEVPA"]="OfficeVSO:3852168_CalcCGSTDEVPA",e["OfficeVSO:3852168_CalcCGAVEDEV"]="OfficeVSO:3852168_CalcCGAVEDEV",e["OfficeVSO:3852168_CalcCGDEVSQ"]="OfficeVSO:3852168_CalcCGDEVSQ",e["OfficeVSO:3852168_CalcCGMODE"]="OfficeVSO:3852168_CalcCGMODE",e["OfficeVSO:3852168_CalcCGMODE_MULT"]="OfficeVSO:3852168_CalcCGMODE_MULT",e["OfficeVSO:3852168_CalcCGTYPE"]="OfficeVSO:3852168_CalcCGTYPE",e["OfficeVSO:3852168_CalcCGERROR_TYPE"]="OfficeVSO:3852168_CalcCGERROR_TYPE",e["OfficeVSO:3852168_CalcCGAREAS"]="OfficeVSO:3852168_CalcCGAREAS",e["OfficeVSO:3852168_CalcCGSHEETS"]="OfficeVSO:3852168_CalcCGSHEETS",e["OfficeVSO:3852168_CalcCGROW"]="OfficeVSO:3852168_CalcCGROW",e["OfficeVSO:3852168_CalcCGCOLUMN"]="OfficeVSO:3852168_CalcCGCOLUMN",e["OfficeVSO:3852168_CalcCGSHEET"]="OfficeVSO:3852168_CalcCGSHEET",e["OfficeVSO:3852168_CalcCGOFFSET"]="OfficeVSO:3852168_CalcCGOFFSET",e["OfficeVSO:3852168_CalcCGEXACT"]="OfficeVSO:3852168_CalcCGEXACT",e["OfficeVSO:3852168_CalcCGREPT"]="OfficeVSO:3852168_CalcCGREPT",e["OfficeVSO:3852168_CalcCGTRIM"]="OfficeVSO:3852168_CalcCGTRIM",e["OfficeVSO:3852168_CalcCGCLEAN"]="OfficeVSO:3852168_CalcCGCLEAN",e["OfficeVSO:3852168_CalcCGCHAR"]="OfficeVSO:3852168_CalcCGCHAR",e["OfficeVSO:3852168_CalcCGUNICHAR"]="OfficeVSO:3852168_CalcCGUNICHAR",e["OfficeVSO:3852168_CalcCGCODE"]="OfficeVSO:3852168_CalcCGCODE",e["OfficeVSO:3852168_CalcCGUNICODE"]="OfficeVSO:3852168_CalcCGUNICODE",e["OfficeVSO:3852168_CalcCGLOWER"]="OfficeVSO:3852168_CalcCGLOWER",e["OfficeVSO:3852168_CalcCGUPPER"]="OfficeVSO:3852168_CalcCGUPPER",e["OfficeVSO:3852168_CalcCGPROPER"]="OfficeVSO:3852168_CalcCGPROPER",e["OfficeVSO:3852168_CalcCGFIND"]="OfficeVSO:3852168_CalcCGFIND",e["OfficeVSO:3852168_CalcCGSEARCH"]="OfficeVSO:3852168_CalcCGSEARCH",e["OfficeVSO:3852168_CalcCGREPLACE"]="OfficeVSO:3852168_CalcCGREPLACE",e["OfficeVSO:3852168_CalcCGSUBSTITUTE"]="OfficeVSO:3852168_CalcCGSUBSTITUTE",e["OfficeVSO:3852168_CalcCGISFORMULA"]="OfficeVSO:3852168_CalcCGISFORMULA",e["OfficeVSO:3852168_CalcCGFORMULATEXT"]="OfficeVSO:3852168_CalcCGFORMULATEXT",e["OfficeVSO:3852168_CalcCGINFO"]="OfficeVSO:3852168_CalcCGINFO",e["OfficeVSO:3852168_CalcCGDELTA"]="OfficeVSO:3852168_CalcCGDELTA",e["OfficeVSO:3852168_CalcCGGESTEP"]="OfficeVSO:3852168_CalcCGGESTEP",e["OfficeVSO:3852168_CalcCGTRANSPOSE"]="OfficeVSO:3852168_CalcCGTRANSPOSE",e["OfficeVSO:3852168_CalcCGADDRESS"]="OfficeVSO:3852168_CalcCGADDRESS",e["OfficeVSO:3852168_CalcCGINDIRECT"]="OfficeVSO:3852168_CalcCGINDIRECT",e["OfficeVSO:3852168_CalcCGTEXTJOIN"]="OfficeVSO:3852168_CalcCGTEXTJOIN",e["OfficeVSO:3852168_CalcCGCHOOSE"]="OfficeVSO:3852168_CalcCGCHOOSE",e["OfficeVSO:3852168_CalcCGSQRTPI"]="OfficeVSO:3852168_CalcCGSQRTPI",e["OfficeVSO:3852168_CalcCGFACTDOUBLE"]="OfficeVSO:3852168_CalcCGFACTDOUBLE",e["OfficeVSO:3852168_CalcCGINT"]="OfficeVSO:3852168_CalcCGINT",e["OfficeVSO:3852168_CalcCGTRUNC"]="OfficeVSO:3852168_CalcCGTRUNC",e["OfficeVSO:3852168_CalcCGODD"]="OfficeVSO:3852168_CalcCGODD",e["OfficeVSO:3852168_CalcCGMROUND"]="OfficeVSO:3852168_CalcCGMROUND",e["OfficeVSO:3852168_CalcCGQUOTIENT"]="OfficeVSO:3852168_CalcCGQUOTIENT",e["OfficeVSO:3852168_CalcCGFLOOR.MATH"]="OfficeVSO:3852168_CalcCGFLOOR.MATH",e["OfficeVSO:3852168_CalcCGFLOOR.PRECISE"]="OfficeVSO:3852168_CalcCGFLOOR.PRECISE",e["OfficeVSO:3852168_CalcCGCEILING.MATH"]="OfficeVSO:3852168_CalcCGCEILING.MATH",e["OfficeVSO:3852168_CalcCGCEILING.PRECISE"]="OfficeVSO:3852168_CalcCGCEILING.PRECISE",e["OfficeVSO:3852168_CalcCGYEAR"]="OfficeVSO:3852168_CalcCGYEAR",e["OfficeVSO:3852168_CalcCGMONTH"]="OfficeVSO:3852168_CalcCGMONTH",e["OfficeVSO:3852168_CalcCGDAY"]="OfficeVSO:3852168_CalcCGDAY",e["OfficeVSO:3852168_CalcCGHOUR"]="OfficeVSO:3852168_CalcCGHOUR",e["OfficeVSO:3852168_CalcCGMINUTE"]="OfficeVSO:3852168_CalcCGMINUTE",e["OfficeVSO:3852168_CalcCGSECOND"]="OfficeVSO:3852168_CalcCGSECOND",e["OfficeVSO:3852168_CalcCGWEEKNUM"]="OfficeVSO:3852168_CalcCGWEEKNUM",e["OfficeVSO:3852168_CalcCGISOWEEKNUM"]="OfficeVSO:3852168_CalcCGISOWEEKNUM",e["OfficeVSO:3852168_CalcCGWEEKDAY"]="OfficeVSO:3852168_CalcCGWEEKDAY",e["OfficeVSO:3852168_CalcCGDATE"]="OfficeVSO:3852168_CalcCGDATE",e["OfficeVSO:3852168_CalcCGTIME"]="OfficeVSO:3852168_CalcCGTIME",e["OfficeVSO:3852168_CalcCGDAYS360"]="OfficeVSO:3852168_CalcCGDAYS360",e["OfficeVSO:3852168_CalcCGDAYS"]="OfficeVSO:3852168_CalcCGDAYS",e["OfficeVSO:3852168_CalcCGDATEDIF"]="OfficeVSO:3852168_CalcCGDATEDIF",e["OfficeVSO:3852168_CalcCGWORKDAY"]="OfficeVSO:3852168_CalcCGWORKDAY",e["OfficeVSO:3852168_CalcCGWORKDAY.INTL"]="OfficeVSO:3852168_CalcCGWORKDAY.INTL",e["OfficeVSO:3852168_CalcCGEDATE"]="OfficeVSO:3852168_CalcCGEDATE",e["OfficeVSO:3852168_CalcCGEOMONTH"]="OfficeVSO:3852168_CalcCGEOMONTH",e["OfficeVSO:3852168_CalcCGENETWORKDAYS"]="OfficeVSO:3852168_CalcCGENETWORKDAYS",e["OfficeVSO:3852168_CalcCGENETWORKDAYS.INTL"]="OfficeVSO:3852168_CalcCGENETWORKDAYS.INTL",e["OfficeVSO:3852168_CalcCGEYEARFRAC"]="OfficeVSO:3852168_CalcCGEYEARFRAC"}(hn||(hn={}));var Cn,Sn=function(e){return!1},yn={};function En(e){return void 0===yn[e]&&(yn[e]=Sn(e)),yn[e]}function On(e,t){if(1==(1&e.length))throw new Error("Invalid class length");for(var r=0;r<e.length;r+=2)for(var n=e[r],a=e[r+1],i=n;i<a;i+=1)t(i,n,a)}!function(e){e[e.Ordinal=15]="Ordinal",e[e.DigitClass=16]="DigitClass",e[e.IdentStartClass=32]="IdentStartClass",e[e.IdentContinueClass=64]="IdentContinueClass"}(Cn||(Cn={}));var kn=function(e,t,r){var n;function a(e){n[e]|=Cn.IdentStartClass}function i(e){n[e]|=Cn.IdentContinueClass}function o(e,t){n[e]|=Cn.DigitClass,n[e]|=e-t}return function(u){if(void 0===n){var c=pr(e[e.length-1],pr(t[t.length-1],r[r.length-1]));n=new Uint8Array(c),On(e,a),On(t,i),On(r,o);for(var s=4969;s<4978;s+=1)o(s,4968)}var l=n[u];return void 0!==l?l:0}}([65,91,92,93,95,96,97,123,170,171,181,182,186,187,192,215,216,247,248,706,710,722,736,741,748,749,750,751,880,885,886,888,890,894,895,896,902,903,904,907,908,909,910,930,931,1014,1015,1154,1162,1328,1329,1367,1369,1370,1376,1417,1488,1515,1519,1523,1568,1611,1646,1648,1649,1748,1749,1750,1765,1767,1774,1776,1786,1789,1791,1792,1808,1809,1810,1840,1869,1958,1969,1970,1994,2027,2036,2038,2042,2043,2048,2070,2074,2075,2084,2085,2088,2089,2112,2137,2144,2155,2208,2229,2230,2238,2308,2362,2365,2366,2384,2385,2392,2402,2417,2433,2437,2445,2447,2449,2451,2473,2474,2481,2482,2483,2486,2490,2493,2494,2510,2511,2524,2526,2527,2530,2544,2546,2556,2557,2565,2571,2575,2577,2579,2601,2602,2609,2610,2612,2613,2615,2616,2618,2649,2653,2654,2655,2674,2677,2693,2702,2703,2706,2707,2729,2730,2737,2738,2740,2741,2746,2749,2750,2768,2769,2784,2786,2809,2810,2821,2829,2831,2833,2835,2857,2858,2865,2866,2868,2869,2874,2877,2878,2908,2910,2911,2914,2929,2930,2947,2948,2949,2955,2958,2961,2962,2966,2969,2971,2972,2973,2974,2976,2979,2981,2984,2987,2990,3002,3024,3025,3077,3085,3086,3089,3090,3113,3114,3130,3133,3134,3160,3163,3168,3170,3200,3201,3205,3213,3214,3217,3218,3241,3242,3252,3253,3258,3261,3262,3294,3295,3296,3298,3313,3315,3333,3341,3342,3345,3346,3387,3389,3390,3406,3407,3412,3415,3423,3426,3450,3456,3461,3479,3482,3506,3507,3516,3517,3518,3520,3527,3585,3643,3648,3663,3713,3715,3716,3717,3718,3723,3724,3748,3749,3750,3751,3761,3762,3764,3773,3774,3776,3781,3782,3783,3804,3808,3840,3841,3904,3912,3913,3949,3976,3981,4096,4139,4159,4160,4176,4182,4186,4190,4193,4194,4197,4199,4206,4209,4213,4226,4238,4239,4256,4294,4295,4296,4301,4302,4304,4347,4348,4681,4682,4686,4688,4695,4696,4697,4698,4702,4704,4745,4746,4750,4752,4785,4786,4790,4792,4799,4800,4801,4802,4806,4808,4823,4824,4881,4882,4886,4888,4955,4992,5008,5024,5110,5112,5118,5121,5741,5743,5760,5761,5787,5792,5867,5870,5881,5888,5901,5902,5906,5920,5938,5952,5970,5984,5997,5998,6001,6016,6068,6103,6104,6108,6109,6176,6265,6272,6313,6314,6315,6320,6390,6400,6431,6480,6510,6512,6517,6528,6572,6576,6602,6656,6679,6688,6741,6823,6824,6917,6964,6981,6988,7043,7073,7086,7088,7098,7142,7168,7204,7245,7248,7258,7294,7296,7305,7312,7355,7357,7360,7401,7405,7406,7412,7413,7415,7418,7419,7424,7616,7680,7958,7960,7966,7968,8006,8008,8014,8016,8024,8025,8026,8027,8028,8029,8030,8031,8062,8064,8117,8118,8125,8126,8127,8130,8133,8134,8141,8144,8148,8150,8156,8160,8173,8178,8181,8182,8189,8305,8306,8319,8320,8336,8349,8450,8451,8455,8456,8458,8468,8469,8470,8472,8478,8484,8485,8486,8487,8488,8489,8490,8506,8508,8512,8517,8522,8526,8527,8544,8585,11264,11311,11312,11359,11360,11493,11499,11503,11506,11508,11520,11558,11559,11560,11565,11566,11568,11624,11631,11632,11648,11671,11680,11687,11688,11695,11696,11703,11704,11711,11712,11719,11720,11727,11728,11735,11736,11743,12293,12296,12321,12330,12337,12342,12344,12349,12353,12439,12443,12448,12449,12539,12540,12544,12549,12592,12593,12687,12704,12731,12784,12800,13312,19894,19968,40944,40960,42125,42192,42238,42240,42509,42512,42528,42538,42540,42560,42607,42623,42654,42656,42736,42775,42784,42786,42889,42891,42944,42946,42951,42999,43010,43011,43014,43015,43019,43020,43043,43072,43124,43138,43188,43250,43256,43259,43260,43261,43263,43274,43302,43312,43335,43360,43389,43396,43443,43471,43472,43488,43493,43494,43504,43514,43519,43520,43561,43584,43587,43588,43596,43616,43639,43642,43643,43646,43696,43697,43698,43701,43703,43705,43710,43712,43713,43714,43715,43739,43742,43744,43755,43762,43765,43777,43783,43785,43791,43793,43799,43808,43815,43816,43823,43824,43867,43868,43880,43888,44003,44032,55204,55216,55239,55243,55292,63744,64110,64112,64218,64256,64263,64275,64280,64285,64286,64287,64297,64298,64311,64312,64317,64318,64319,64320,64322,64323,64325,64326,64434,64467,64830,64848,64912,64914,64968,65008,65020,65136,65141,65142,65277,65313,65339,65345,65371,65382,65471,65474,65480,65482,65488,65490,65496,65498,65501],[46,47,48,58,63,64,65,91,92,93,95,96,97,123,162,167,168,171,174,177,178,182,183,187,188,191,192,215,216,247,248,888,890,894,895,896,900,907,908,909,910,930,931,1328,1329,1367,1369,1370,1376,1417,1421,1424,1425,1470,1471,1472,1473,1475,1476,1478,1479,1480,1488,1515,1519,1523,1536,1545,1547,1548,1550,1563,1564,1565,1567,1642,1646,1748,1749,1792,1807,1867,1869,1970,1984,2039,2042,2043,2045,2094,2112,2140,2144,2155,2208,2229,2230,2238,2259,2404,2406,2416,2417,2436,2437,2445,2447,2449,2451,2473,2474,2481,2482,2483,2486,2490,2492,2501,2503,2505,2507,2511,2519,2520,2524,2526,2527,2532,2534,2557,2558,2559,2561,2564,2565,2571,2575,2577,2579,2601,2602,2609,2610,2612,2613,2615,2616,2618,2620,2621,2622,2627,2631,2633,2635,2638,2641,2642,2649,2653,2654,2655,2662,2678,2689,2692,2693,2702,2703,2706,2707,2729,2730,2737,2738,2740,2741,2746,2748,2758,2759,2762,2763,2766,2768,2769,2784,2788,2790,2800,2801,2802,2809,2816,2817,2820,2821,2829,2831,2833,2835,2857,2858,2865,2866,2868,2869,2874,2876,2885,2887,2889,2891,2894,2902,2904,2908,2910,2911,2916,2918,2936,2946,2948,2949,2955,2958,2961,2962,2966,2969,2971,2972,2973,2974,2976,2979,2981,2984,2987,2990,3002,3006,3011,3014,3017,3018,3022,3024,3025,3031,3032,3046,3067,3072,3085,3086,3089,3090,3113,3114,3130,3133,3141,3142,3145,3146,3150,3157,3159,3160,3163,3168,3172,3174,3184,3192,3204,3205,3213,3214,3217,3218,3241,3242,3252,3253,3258,3260,3269,3270,3273,3274,3278,3285,3287,3294,3295,3296,3300,3302,3312,3313,3315,3328,3332,3333,3341,3342,3345,3346,3397,3398,3401,3402,3408,3412,3428,3430,3456,3458,3460,3461,3479,3482,3506,3507,3516,3517,3518,3520,3527,3530,3531,3535,3541,3542,3543,3544,3552,3558,3568,3570,3572,3585,3643,3647,3663,3664,3674,3713,3715,3716,3717,3718,3723,3724,3748,3749,3750,3751,3774,3776,3781,3782,3783,3784,3790,3792,3802,3804,3808,3840,3844,3859,3860,3861,3898,3902,3912,3913,3949,3953,3973,3974,3992,3993,4029,4030,4045,4046,4048,4053,4057,4096,4170,4176,4294,4295,4296,4301,4302,4304,4347,4348,4681,4682,4686,4688,4695,4696,4697,4698,4702,4704,4745,4746,4750,4752,4785,4786,4790,4792,4799,4800,4801,4802,4806,4808,4823,4824,4881,4882,4886,4888,4955,4957,4960,4969,4989,4992,5018,5024,5110,5112,5118,5121,5742,5743,5760,5761,5787,5792,5867,5870,5881,5888,5901,5902,5909,5920,5941,5952,5972,5984,5997,5998,6001,6002,6004,6016,6100,6103,6104,6107,6110,6112,6122,6128,6138,6155,6159,6160,6170,6176,6265,6272,6315,6320,6390,6400,6431,6432,6444,6448,6460,6464,6465,6470,6510,6512,6517,6528,6572,6576,6602,6608,6619,6622,6684,6688,6751,6752,6781,6783,6794,6800,6810,6823,6824,6832,6847,6912,6988,6992,7002,7009,7037,7040,7156,7168,7224,7232,7242,7245,7294,7296,7305,7312,7355,7357,7360,7376,7379,7380,7419,7424,7674,7675,7958,7960,7966,7968,8006,8008,8014,8016,8024,8025,8026,8027,8028,8029,8030,8031,8062,8064,8117,8118,8133,8134,8148,8150,8156,8157,8176,8178,8181,8182,8191,8203,8208,8234,8239,8255,8257,8260,8261,8274,8275,8276,8277,8288,8293,8294,8306,8308,8317,8319,8333,8336,8349,8352,8384,8400,8433,8448,8588,8592,9001,9003,9255,9280,9291,9312,10088,10102,10181,10183,10214,10224,10627,10649,10712,10716,10748,10750,11124,11126,11158,11160,11311,11312,11359,11360,11508,11517,11518,11520,11558,11559,11560,11565,11566,11568,11624,11631,11632,11647,11671,11680,11687,11688,11695,11696,11703,11704,11711,11712,11719,11720,11727,11728,11735,11736,11743,11744,11776,11823,11824,11904,11930,11931,12020,12032,12246,12272,12284,12292,12296,12306,12308,12320,12336,12337,12349,12350,12352,12353,12439,12441,12448,12449,12539,12540,12544,12549,12592,12593,12687,12688,12731,12736,12772,12784,12831,12832,19894,19904,40944,40960,42125,42128,42183,42192,42238,42240,42509,42512,42540,42560,42611,42612,42622,42623,42738,42752,42944,42946,42951,42999,43052,43056,43066,43072,43124,43136,43206,43216,43226,43232,43256,43259,43260,43261,43310,43312,43348,43360,43389,43392,43457,43471,43482,43488,43519,43520,43575,43584,43598,43600,43610,43616,43715,43739,43742,43744,43760,43762,43767,43777,43783,43785,43791,43793,43799,43808,43815,43816,43823,43824,43880,43888,44011,44012,44014,44016,44026,44032,55204,55216,55239,55243,55292,63744,64110,64112,64218,64256,64263,64275,64280,64285,64311,64312,64317,64318,64319,64320,64322,64323,64325,64326,64450,64467,64830,64848,64912,64914,64968,65008,65022,65024,65040,65056,65072,65075,65077,65101,65104,65122,65123,65124,65127,65129,65130,65136,65141,65142,65277,65279,65280,65284,65285,65291,65292,65296,65306,65308,65311,65313,65339,65342,65371,65372,65373,65374,65375,65382,65471,65474,65480,65482,65488,65490,65496,65498,65501,65504,65511,65512,65519,65529,65534],[48,58,1632,1642,1776,1786,1984,1994,2406,2416,2534,2544,2662,2672,2790,2800,2918,2928,3046,3056,3174,3184,3302,3312,3430,3440,3558,3568,3664,3674,3792,3802,3872,3882,4160,4170,4240,4250,6112,6122,6160,6170,6470,6480,6608,6618,6784,6794,6800,6810,6992,7002,7088,7098,7232,7242,7248,7258,42528,42538,43216,43226,43264,43274,43472,43482,43504,43514,43600,43610,44016,44026,65296,65306]);function An(e,t){return{key:e,value:t}}var bn=function(){function e(e,t,r){this.keyCompare=e,this.keys=t,this.values=r}return e.create=function(t){return new e(t,[],[])},e.prototype.setValue=function(e,t){return this.setValues([e,t])},e.prototype.remove=function(e){return void 0===this.getKeyIndex(e)?this:this.filter((function(t){return t!==e}))},e.prototype.getOrSetValue=function(e,t){var r=this.getKeyIndex(e);if(void 0===r){var n=t();return[this.setValue(e,n),n]}return[this,this.values[r]]},e.prototype.filter=function(e){for(var t=[],r=0;r<this.keys.length;r+=1){var n=this.keys[r],a=this.values[r];e(n,a)&&t.push([n,a])}return t.length===this.getCount()?this:this.ofSequence(t)},e.prototype.getCount=function(){return this.keys.length},e.prototype.getValue=function(e){var t=this.getKeyIndex(e);if(void 0!==t)return this.values[t]},e.prototype.getEntry=function(e){var t=this.getKeyIndex(e);if(void 0!==t)return An(this.keys[t],this.values[t])},e.prototype.contains=function(e){return void 0!==this.getKeyIndex(e)},e.prototype.forEach=function(e){for(var t=0;t<this.keys.length;t+=1)if(!e(this.keys[t],this.values[t]))return!1;return!0},e.prototype.setValues=function(){for(var e=this,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=this.keys.map((function(t,r){return[t,e.values[r],r]})),a=n.length;t.forEach((function(e,t){var r=e[0],i=e[1];return n.push([r,i,t+a])})),n.sort((function(t,r){var n=t[0],a=t[2],i=r[0],o=r[2],u=e.keyCompare(n,i);return 0!==u?u:a-o}));for(var i=[],o=void 0,u=0;u<n.length;u+=1){var c=n[u],s=c[0],l=c[1];void 0===o||0!==this.keyCompare(s,o)?(i.push([s,l]),o=s):i[i.length-1]=[s,l]}return this.ofSequence(i)},e.prototype.getKeyIndex=function(e){for(var t=Rn;t>=0&&t<this.keys.length;){var r=this.keyCompare(e,this.keys[t]);if(0===r)return t;r<0?t=In(t):r>0&&(t=Tn(t))}},e.prototype.ofSequence=function(t){var r=this,n=t.slice();n.sort((function(e,t){var n=e[0],a=t[0];return r.keyCompare(n,a)}));for(var a=new Array(n.length),i=new Array(n.length),o=function(e){var t=new Array(e);return function e(t,r,n,a){if(t>=r.length)return;var i=function(e){var t=function(e){if(0===e)return 0;var t=e;return t=((t=((t=((t=((t=(t|t>>>1)>>>0)|t>>>2)>>>0)|t>>>4)>>>0)|t>>>8)>>>0)|t>>>16)>>>0,(t+=1)/2}(e);if(t/2-1<=e-t)return t-1;return e-t/2}(a);r[t]=n+i,e(In(t),r,n,i),e(Tn(t),r,n+i+1,a-i-1)}(Rn,t,0,e),t}(n.length),u=0;u<n.length;u+=1){var c=n[o[u]],s=c[0],l=c[1];a[u]=s,i[u]=l}return new e(this.keyCompare,a,i)},e}(),Rn=0;function In(e){return 2*e+1}function Tn(e){return 2*e+2}function Nn(e){return isFinite(e)?e:Ae}function Fn(e,t){return e<t?-1:e>t?1:0}var _n=["0","1","2","3","4","5","6","7","8","9"];var Mn={zero:0,one:1,pi:Math.PI,add:function(e,t){return Nn(e+t)},sub:function(e,t){return Nn(e-t)},mul:function(e,t){return Nn(e*t)},div:function(e,t){return 0===t?ye:Nn(e/t)},power:function(e,t){var r=Math.pow(e,t);return isFinite(r)?r:isNaN(r)?ye:Ae},percent:function(e){return e/100},neg:function(e){return-e},compare:Fn,formatGeneral:function(e,t,r){var n=e.decimalSeparator,a=String(t).replace("e","E");return"."!==n&&(a=a.replace(".",n)),a},parse:function(e,t,r,n){return Number((t?"":"-")+"0."+function(e,t){for(var r=e.getOrdinal,n="",a=0;a<t.length;a+=1)n+=_n[r(t.charCodeAt(a))];return n}(e,n)+"E"+r)},trunc:function(e){return e<0?Math.ceil(e):Math.floor(e)},ceil:Math.ceil.bind(Math),floor:Math.floor.bind(Math),abs:Math.abs.bind(Math),cond:function(e){return Fn(e,0)},cond2:Fn,fromNumber:sr,toNumber:sr,sqrt:function(e){return Nn(Math.sqrt(e))},exp:function(e){return Nn(Math.exp(e))},ln:function(e){return Nn(Math.log(e))},log:function(e){return Nn(Math.log(e)/Math.LN10)},sin:Math.sin.bind(Math),cos:Math.cos.bind(Math),tan:Math.tan.bind(Math),asin:function(e){return Nn(Math.asin(e))},acos:function(e){return Nn(Math.acos(e))},atan:function(e){return Nn(Math.atan(e))},atan2:function(e,t){return Math.atan2(t,e)},round:function(e,t){if(0===e)return 0;var r=e.toExponential(),n=r.substring(r.indexOf("e")+1),a=parseInt(n,10),i=Mn.trunc(t)+a+1;if(0===i){var o=parseFloat("5e"+n);if(Math.abs(e)>=o)return Nn((e<0?-1:1)*parseFloat("10e"+n))}return i<1?0:i>21?e:Nn(parseFloat(e.toExponential(i-1)))},roundUp:function(e,t){if(0===e)return 0;var r=e.toExponential(),n=r.indexOf("e"),a="-"===r.substring(0,1)?"-":"",i=r.substring(a.length,n),o=r.substring(n+1),u=parseInt(o,10),c=Mn.trunc(t)+u+1;return c<1?Nn(parseFloat(a+"10e"+(u-c))):c>21?e:Nn(parseFloat(a+function(e,t){var r=e.replace(".","");if(r.length<=t)return e;for(var n=r.substring(0,t),a=0,i=n.length-1;i>=0&&n.charCodeAt(i)-48==9;i-=1)a+=1;if(a===n.length)return"10";var o=n.substring(0,n.length-a-1)+String.fromCharCode(n.charCodeAt(n.length-a-1)+1);return o.substring(0,1)+"."+o.substring(1)}(i,c)+"e"+o))},roundDown:function(e,t){if(0===e)return 0;var r=e.toExponential(),n=r.indexOf("e"),a="-"===r.substring(0,1)?"-":"",i=r.substring(a.length,n),o=r.substring(n+1),u=parseInt(o,10),c=Mn.trunc(t)+u+1;if(c<1)return 0;if(c>21)return e;var s=i.substring(0,c+1);return Nn(parseFloat(a+s+"e"+o))},checkAlmostCancellation:function(e,t){return t},fix:function(e){var t=Math.abs(e);return t>=4294967296?4294967295:Math.floor(t)},lfix:function(e){var t=Mn.trunc(e);return t<-2147483648||t>2147483647?-2147483648:t},sfix:function(e){var t=Mn.floor(e);return t<-2147483648?-2147483648:t>2147483647?2147483647:t},viewRound:sr},Dn=r(2),wn=Dn.mathpack.zero(),Ln=Dn.mathpack.one(),Un=Dn.mathpack.pi();function xn(e){return 0!=(e.num&Dn.mathpack.MathErrorNum.DivBy0)?ye:Ae}function Pn(e){return function(t){return A("calc.runtime."+e+": error "+JSON.stringify(t))}}function Gn(e,t){return function(r){var n=e(r);return"number"==typeof n?n:t(n)}}function Vn(e,t){return function(r,n){var a=e(r,n);return"number"==typeof a?a:t(a)}}var Bn=Vn((function(e,t){return Dn.mathpack.equal(t,2)?Dn.mathpack.mul(e,e):Dn.mathpack.power(e,t)}),xn),Wn=Gn((function(e){return Dn.mathpack.div(e,100)}),Pn("xlPercent"));var jn=Gn(Dn.mathpack.ceil,Pn("xlCeil")),Hn=Gn(Dn.mathpack.floor,Pn("xlFloor")),Kn=Gn(Dn.mathpack.cond,Pn("xlCond")),qn=Vn(Dn.mathpack.cond2,Pn("xlCond2"));var Yn=Gn(Dn.mathpack.sfix,Pn("xlSfix")),Jn=Gn(Dn.mathpack.viewRound,Pn("xlViewRound"));var Qn={zero:wn,one:Ln,pi:Un,add:Vn(Dn.mathpack.add,xn),sub:Vn(Dn.mathpack.sub,xn),mul:Vn(Dn.mathpack.mul,xn),div:Vn(Dn.mathpack.div,xn),power:Bn,percent:Wn,neg:function(e){return 0!==Kn(e)?Dn.mathpack.neg(e):e},compare:Dn.mathpack.compare,formatGeneral:function(e,t,r){var n=Dn.mathpack.formatGeneral(e,t,r);return"string"!=typeof n?A("calc.runtime.xlFormatGeneral: error "+JSON.stringify(n)):n},parse:function(e,t,r,n){var a=Dn.mathpack.pack(e,t,r,n);return"number"!=typeof a?A("calc.runtime.xlParse: error "+JSON.stringify(a)):a},trunc:Dn.mathpack.trunc,ceil:jn,floor:Hn,abs:Dn.mathpack.abs,cond:Kn,cond2:qn,fromNumber:function(e){return b("calc.runtime.xlFromNumber",isFinite(e)),e},toNumber:function(e){return b("calc.runtime.xlToNumber",isFinite(e)),e},sqrt:Gn(Dn.mathpack.sqrt,xn),exp:Gn(Dn.mathpack.exp,xn),ln:Gn(Dn.mathpack.ln,xn),log:Gn(Dn.mathpack.log,xn),sin:Gn(Dn.mathpack.sin,xn),cos:Gn(Dn.mathpack.cos,xn),tan:Gn(Dn.mathpack.tan,xn),asin:Gn(Dn.mathpack.asin,xn),acos:Gn(Dn.mathpack.acos,xn),atan:Gn(Dn.mathpack.atan,xn),atan2:Vn(Dn.mathpack.atan2,xn),round:Vn(Dn.mathpack.round,xn),roundUp:Vn(Dn.mathpack.roundUp,xn),roundDown:Vn(Dn.mathpack.roundDown,xn),checkAlmostCancellation:function(e,t){return Dn.mathpack.exp32(e)-Dn.mathpack.exp32(t)>=52428800?wn:t},fix:Dn.mathpack.fix,lfix:Dn.mathpack.lfix,sfix:Yn,viewRound:Jn},Xn=Math.pow(2,-52),zn=Math.pow(2,-1022);function Zn(e){return Math.abs(e)<zn?0:e}function $n(e){return isFinite(e)?Zn(e):Ae}var ea=Math.pow(2,32)-2;function ta(e,t){var r=Math.pow(e,t);return isFinite(r)?Zn(r):t<0?ye:Ae}var ra=Mn.fix,na=Mn.lfix;var aa={zero:0,one:1,pi:Math.PI,add:function(e,t){var r=e+t;return isFinite(r)?Zn(r):Ae},sub:function(e,t){var r=e-t;return isFinite(r)?Zn(r):Ae},mul:function(e,t){return $n(e*t)},div:function(e,t){return 0===Zn(t)?ye:$n(e/t)},power:function(e,t){return 0===t?0===e?Ae:1:0===e?t<0?ye:0:e>0?ta(e,t):function(e){if(e<-ea||e>ea)return!1;if(e===Math.floor(e))return!0;var t=Math.abs(e);return 1+-22.5*Xn<=t&&t<=1+2*Xn}(t)?ta(e,Math.round(t)):Ae},percent:function(e){return Zn(e/100)},neg:Mn.neg,compare:Mn.compare,formatGeneral:Mn.formatGeneral,parse:Mn.parse,trunc:Mn.trunc,ceil:Mn.ceil,floor:Mn.floor,abs:Mn.abs,cond:Mn.cond,cond2:Mn.cond2,fromNumber:sr,toNumber:sr,sqrt:function(e){return $n(Math.sqrt(e))},exp:function(e){return $n(Math.exp(e))},ln:function(e){return $n(Math.log(e))},log:function(e){return $n(Math.log(e)/Math.LN10)},sin:function(e){return Math.abs(e)<Math.pow(2,27)?$n(Math.sin(e)):Ae},cos:function(e){return Math.abs(e)<Math.pow(2,27)?$n(Math.cos(e)):Ae},tan:function(e){return Math.abs(e)<Math.pow(2,27)?$n(Math.tan(e)):Ae},asin:function(e){return $n(Math.asin(e))},acos:function(e){return $n(Math.acos(e))},atan:function(e){return $n(Math.atan(e))},atan2:function(e,t){return 0===e&&0===t?ye:Zn(Math.atan2(t,e))},round:function(e,t){if(0===e)return 0;var r=e.toExponential(),n=r.indexOf("e"),a="-"===r.substring(0,1)?"-":"",i=r.substring(a.length,n),o=r.substring(n+1),u=parseInt(o,10),c=Mn.trunc(t)+u+1;return 0===c&&i.charCodeAt(0)-48>=5?$n(parseFloat(a+"10e"+o)):c<1?0:c>21?e:$n(parseFloat(a+function(e,t){var r=e.replace(".","");if(r.length<=t)return e;if(r.charCodeAt(t)-48>=5){for(var n=r.substring(0,t),a=0,i=n.length-1;i>=0&&n.charCodeAt(i)-48==9;i-=1)a+=1;if(a===n.length)return"10";var o=n.substring(0,n.length-a-1)+String.fromCharCode(n.charCodeAt(n.length-a-1)+1);return o.substring(0,1)+"."+o.substring(1)}return e.substring(0,t+1)}(i,c)+"e"+o))},roundUp:Mn.roundUp,roundDown:Mn.roundDown,checkAlmostCancellation:function(e,t){return t},fix:ra,lfix:na,sfix:function(e){var t=e+1048576+2146435072;return t<0?-2147483648:ra(t)-2147483648},viewRound:sr};function ia(){return En(hn.CalcExcelMath)?Qn:aa}var oa=function(e,t,r,n,a){return{bias:e,standardDate:t,standardBias:r,daylightDate:n,daylightBias:a}},ua=oa(0,void 0,0,void 0,0),ca=Dn.dtr.Rounding,sa=Dn.dtr.dtr;var la,fa={fromNum:function(e,t,r){return Dn.dtr.fromNum(t,r,e.date1904,e.dateCompatibility)},toNum:function(e,t){var r=Dn.dtr.toNum(t,e.date1904,e.dateCompatibility);return"number"==typeof r?r:Ae},daysPerMonth:Dn.dtr.daysPerMonth,toDays:function(e,t){return Dn.dtr.toDays(t,e.date1904,e.dateCompatibility)}};function da(e,t,r,n,a,i,o){return void 0===t&&(t=F.A1),void 0===r&&(r=ia()),void 0===n&&(n=!1),void 0===a&&(a=!0),void 0===i&&(i=ua),void 0===o&&(o=fa),{localeInfo:e,refStyle:t,mathpack:r,date1904:n,dateCompatibility:a,timezone:i,datepack:o}}var ha=!1,va=void 0,pa=/^(https)|(http)|(file):\/\//;function ma(e,t,r){if(ha){O.ULS.traceTag(595910878,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,"calc.config.initCalc: Calc is already initialized")}else{var n;if(function(e){O.ULS=e}(e),function(e){pn.ULS=e}(e),"function"==typeof(n=t)&&(Sn=n),null!=r){if(!pa.test(r)){var a="calc.config.initCalc: calcAbsUrl is not absolute: "+r;O.ULS.traceTag(595910879,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Warning,a)}vn.setConfig({onWorkerError:function(e){var t,r=Object(j.a)(Object(j.a)({},e.info),{error:void 0}),n={error:e.message,info:r,innerError:null===(t=e.info.error)||void 0===t?void 0:t.message},a="calc.onWorkerError: "+JSON.stringify(n);O.ULS.traceTag(593335298,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Warning,a)},onCreateWorker:function(e){var t="calc.onCreateWorker: "+JSON.stringify(e);O.ULS.traceTag(593335299,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,t)}})}va=r,ha=!0;O.ULS.traceTag(594642132,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,"calc.config.initCalc: Calc version 13.7.0 (production) initialized")}}function ga(){return ha}function Ca(){return va}function Sa(e,t,r,n,a,i,o,u,c,s,l,f,d,h,v,p,m,g,C,S,y,E){function O(e){return 92===e||95===e||u(String.fromCharCode(e))}return ya(e,r,n,(function(e){return a(String.fromCharCode(e))}),(function(e){return i(String.fromCharCode(e))}),O,(function(e){return O(e)||46===e||63===e||a(String.fromCharCode(e))}),c,s,l,f,d,h,v,p,m,g,C,S,y,E)}function ya(e,t,r,n,a,i,o,u,c,s,l,f,d,h,v,p,m,g,C,S,y){return{parseNumber:e,getWorksheetFuncId:function(e){return t(e.toLocaleUpperCase())},getWorksheetFuncName:r,isNumeral:n,getOrdinal:a,isIdentStart:i,isIdentContinue:o,stringCompareCI:u,errorNames:c,trueName:s,falseName:l,rowLetter:f,columnLetter:d,leftBrace:h,rightBrace:v,leftBracket:p,rightBracket:m,decimalSeparator:g,listSeparator:C,columnSeparator:S,rowSeparator:y}}function Ea(e){return function(t){for(var r=0;r<t.length&&Sr(t.charCodeAt(r));)r+=1;var n=!1;if(r<t.length){var a=t.charCodeAt(r);if(43===a||45===a)for(n=45===a,r+=1;r<t.length&&Sr(t.charCodeAt(r));)r+=1}var i=kr(this,e,t,r);if(void 0!==i&&void 0!==i.value){for(r=i.i;r<t.length&&Sr(t.charCodeAt(r));)r+=1;if(r===t.length)return n?e.neg(i.value):i.value}}}function Oa(e){return 0!=(kn(e)&Cn.DigitClass)}function ka(e){var t=kn(e);return 0==(t&Cn.DigitClass)?A("calc.config.getOrdinal: expected numeral; given "+C(e)):t&Cn.Ordinal}function Aa(e){return 0!=(kn(e)&Cn.IdentStartClass)}function ba(e){return 0!=(kn(e)&Cn.IdentContinueClass)}var Ra=v(((la={})[pe.NULL]="#NULL!",la[pe.DIV0]="#DIV/0!",la[pe.VALUE]="#VALUE!",la[pe.REF]="#REF!",la[pe.NAME]="#NAME?",la[pe.NUM]="#NUM!",la[pe.NA]="#N/A",la[pe.GETTING_DATA]="#GETTING_DATA",la[pe.FIELD]="#FIELD",la)),Ia=void 0;function Ta(e){var t=_a()[e];return void 0===t?"wsf:"+e:t}function Na(e){if(e===Ue.Isect)return" ";if(e===Ue.Union)return",";var t=je[e];return void 0===t?"op:"+e:t}var Fa=/_/g;function _a(){if(null==Ia)for(var e in Ia=[],De){var t=Number(e);if(!isNaN(t)){var r=xe[t],n=null!=r?r:De[e].replace(Fa,".");Ia[t]=n}}return Ia}function Ma(e,t){var r=function(e,t){var r,n=[];return t.forEach((function(e,t){null!=e&&n.push([e,t])})),(r=bn.create(e)).setValues.apply(r,n)}(e,t);return{getWorksheetFuncId:function(e){return r.getValue(e)},getWorksheetFuncName:function(e){var r=t[e];return null==r?A("calc.config.getWorksheetFuncName: unknown function ID "+e):r}}}var Da,wa=void 0;function La(){var e,t,r,n,a;return null==wa&&(e=_a(),t=gr("en-US"),r=Ma(t,e),n=r.getWorksheetFuncId,a=r.getWorksheetFuncName,wa=ya(Ea(ia()),n,a,Oa,ka,Aa,ba,t,Ra,"TRUE","FALSE","R","C","{","}","[","]",".",",",",",";")),wa}function Ua(e){return{kind:Da.NoOriginSheet,origin:e}}function xa(e){if(void 0===e)return!0;if(null===e||"object"!=typeof e)return!1;switch(e.kind){case Mt.NotImplemented:case Mt.Unavailable:case Da.NoOriginSheet:return!0}return!1}function Pa(e,t,r){return function(n,a){return void 0===a?t(n):xa(a)?r(a,n):e(a)}}function Ga(e,t,r){var n=Jr(e.row,t.row,1<<20,r),a=Jr(e.col,t.col,16384,r);return void 0!==n&&void 0!==a?Zt(n,a):void 0}function Va(e,t){if(t.kind!==M.Error){var r=e.originGridCell;if(!ot(r))return r.reason;var n=r.value,a=e.wrapCellReferences;switch(t.kind){case M.Single:return Ga(n,t,a);case M.Range:var i=Ga(n,t.ref1,a),o=Ga(n,t.ref2,a);return void 0!==i&&void 0!==o?yt(i,o):void 0;case M.Row:var u=Jr(n.row,t.row1,1<<20,a),c=Jr(n.row,t.row2,1<<20,a);return void 0!==u&&void 0!==c?yt(Zt(u,0),Zt(c,16383)):void 0;case M.Col:var s=Jr(n.col,t.col1,16384,a),l=Jr(n.col,t.col2,16384,a);return void 0!==s&&void 0!==l?yt(Zt(0,s),Zt(1048575,l)):void 0;default:return k("calc.runtime.resolverService.resolveGridRef",t)}}}function Ba(e){function t(t,r){var n;if(void 0===r){var a=t.originSheet;return ot(a)?[r,a.value.document]:[r,a.reason]}var i=e.getDocumentLoc(r.path,r.document);if(!ot(i))return[r,i.reason];var o=null==r.path?void 0:fr(i.value)?r.path:i.value.path;return[q(fr(i.value)?r.document:i.value.name,o,r.isQuoted,r.label),(n=i.value,null!=n?n:void 0)]}function r(t,r){if(xa(r))return[t,r];var n=e.getSheetIndex(r,t);if(!ot(n))return[t,n.reason];if(null==n.value)return[t,void 0];var a=e.getSheetName(r,n.value);return ot(a)?[a.value,Yt(r,n.value)]:[t,a.reason]}function n(e,n){var a=t(e,n.document),i=a[0],o=a[1],u=r(n.sheet,o),c=u[0],s=u[1];return[Y(c,i,n.isQuoted,n.label),s]}function a(a,i){switch(i.kind){case _.Error:return[i,void 0];case _.Sheet:return n(a,i);case _.SheetRange:return function(n,a){var i,o=t(n,a.document),u=o[0],c=o[1],s=r(a.sheet1,c),l=s[0],f=s[1],d=r(a.sheet2,c),h=d[0],v=d[1],p=l,m=h;if(xa(c))i=c;else if(xa(f))i=f;else if(xa(v))i=v;else{if(pt(f,v))return[Y(p,u,a.isQuoted,a.label),Yt(c,f.index)];var g=e.getSheetRangeIndexes(f),C=e.getSheetRangeIndexes(v);ot(g)?ot(C)?C.value.position<g.value.position&&(p=h,m=l):i=C.reason:i=g.reason,i=qt(c,f.index,v.index)}return[Q(p,m,u,a.isQuoted,a.label),i]}(a,i);default:return k("calc.runtime.resolverService.resolveCellRefQualifier",i)}}return{resolveName:function(r,a){var i,o,u,c=a.qualifier,s=a.whole;if(void 0===c||c.kind===_.Relative){var l=r.originSheet;if(!ot(l))return[a,l.reason];var f=l.value;if(void 0===f.index)return[a,Ua(f)];var d=e.getNameLoc(f,s);if(!ot(d))return[a,d.reason];if(!fr(d.value))return[fe(d.value.name,c,a.label),d.value];o=c,u=ar(f.document)}else o=(i=function(e,r){switch(r.kind){case _.Document:var a=t(e,r);return[s=a[0],xa(l=a[1])?l:ar(l)];case _.Sheet:return n(e,r);case _.Ident:var i=n(e,Y(r.name,void 0)),o=i[0],u=i[1];if(void 0!==u)return xa(u)?[r,u]:[J(o.sheet,r.isQuoted,r.label),u];var c=t(e,q(r.name)),s=c[0],l=c[1];return[J(s.document,r.isQuoted,r.label),xa(l)?l:ar(l)];default:return k("calc.runtime.resolverService.resolveNameQualifier",r)}}(r,c))[0],u=i[1];var h,v=s;if(xa(u))h=u;else{var p=e.getNameLoc(u,s);ot(p)?fr(p.value)||(v=p.value.name,h=p.value):h=p.reason}return[fe(v,o,a.label),h]},resolveGridRef:Va,resolveCellRef:function(e,t){var r,n,i,o,u=t.qualifier,c=t.ref,s=Va(e,c);if(void 0===u||u.kind===_.Relative){n=u;var l=e.originSheet;if(ot(l)){var f=l.value;i=void 0===f.index?Ua(f):f}else i=l.reason}else n=(r=a(e,u))[0],i=r[1];return o=xa(s)?s:xa(i)?i:er(i,s),[de(c,n,t.label),o]},resolveUserDefinedFunc:function(r,n){var a,i,o,u,c,s,l=n.qualifier,f=n.whole,d=null!=(o=null===(i=r.config)||void 0===i?void 0:i.localeInfo)?o:e.config.localeInfo;if(void 0===l){var h=r.originSheet;if(!ot(h))return[n,h.reason];u=l,c=h.value.document}else u=(a=function(e,r){switch(r.kind){case _.Document:return t(e,r);case _.Ident:var n=t(e,q(r.name)),a=n[0],i=n[1];return[J(a.document,r.isQuoted,r.label),i];default:return k("calc.runtime.resolverService.resolveUserDefinedFuncQualifier",r)}}(r,l))[0],c=a[1];if(xa(c))s=c;else{var v=function(e,t,r,n){var a=n;return a.length>"_xludf.".length&&0===t.stringCompareCI(a.substr(0,"_xludf.".length),"_xludf.")&&(a=a.substr("_xludf.".length)),e.getUserDefinedFuncLoc(r,a)}(e,d,c,f);ot(v)?0!==v.value.length&&(s=v.value):s=v.reason}return[fe(f,u,n.label),s]}}}!function(e){e.NoOriginSheet="NoOriginSheet"}(Da||(Da={}));function Wa(e,t,r){return void 0===r&&(r=100),t.maxDepth=r,t.level=0,ja(e,t)}function ja(e,t){if(t.level===t.maxDepth)throw"AST is too deep to continue the visit. Currently as level "+t.level;var r;switch(t.level+=1,e.kind){case L.Literal:r=function(e,t){if("boolean"==typeof e)return t.visitBoolean(e);if("number"==typeof e)return t.visitNumber(e);if("string"==typeof e)return t.visitString(e);if(e.kind===x.Missing)return t.visitMissing(e);if(e.kind===x.Error)return t.visitError(e);throw"Tried to visit unrecognized AST node: "+e.kind+"."}(e.oper,t.operVisitor);break;case L.Array:r=t.visitArray(e);break;case L.App:r=t.visitApp(e);break;case L.Paren:r=t.visitParen(e);break;case L.Name:r=t.visitName(e);break;case L.CellRef:r=t.visitCellRef(e);break;case L.Bad:r=t.visitBad(e);break;case L.Operator:r=t.visitOperator(e);break;case M.Error:r=t.visitRefError(e);break;case M.Single:r=t.visitSingle(e);break;case M.Range:r=t.visitRange(e);break;case M.Row:r=t.visitRow(e);break;case M.Col:r=t.visitCol(e);break;case _.Error:r=t.visitNameError(e);break;case _.Relative:r=t.visitRelative(e);break;case _.Document:r=t.visitDocument(e);break;case _.Sheet:r=t.visitSheet(e);break;case _.Ident:r=t.visitIdent(e);break;case _.SheetRange:r=t.visitSheetRange(e);break;default:throw"Tried to visit unrecognized AST node: "+e.kind+"."}return t.level-=1,r}function Ha(e){return{visitString:e,visitBoolean:e,visitNumber:e,visitMissing:e,visitError:e}}function Ka(e,t,r){return{level:0,operVisitor:e,visitArray:dr(r.vArray,t),visitApp:dr(r.vApp,t),visitParen:dr(r.vParen,t),visitName:dr(r.vName,t),visitCellRef:dr(r.vCellRef,t),visitBad:dr(r.vBad,t),visitOperator:dr(r.vOperator,t),visitRefError:dr(r.vRefError,t),visitSingle:dr(r.vSingle,t),visitRange:dr(r.vRange,t),visitRow:dr(r.vRow,t),visitCol:dr(r.vCol,t),visitNameError:dr(r.vNameError,t),visitRelative:dr(r.vRelative,t),visitDocument:dr(r.vDocument,t),visitSheet:dr(r.vSheet,t),visitIdent:dr(r.vIdent,t),visitSheetRange:dr(r.vSheetRange,t)}}var qa,Ya=/"/g,Ja=/'/g,Qa=rr(Yt(Kt(void 0,"Book1"),0),Zt(0,0)),Xa=Pa((function(){}),(function(){}),(function(e){if(e.kind!==Da.NoOriginSheet)throw new Za(it(e))})),za=function(){function e(e,t,r,n,a){var i,o,u,c,s,l;this.spans=r,this.annotations=n,this.anonymize=a,this.level=0,this.operVisitor=this,this.locals=t,this.localeInfo=null!=(u=null===(o=null===(i=t)||void 0===i?void 0:i.config)||void 0===o?void 0:o.localeInfo)?u:e.config.localeInfo,this.mathpack=e.config.mathpack,this.refStyle=null!=(l=null===(s=null===(c=t)||void 0===c?void 0:c.config)||void 0===s?void 0:s.refStyle)?l:e.config.refStyle,this.resolver=Ba(e)}return e.prototype.anon=function(e){return this.anonymize?Ai(e):e},e.prototype.pre=function(e,t){var r,n;return this.anonymize?t:null!=(n=null===(r=this.spans[e.label])||void 0===r?void 0:r.pre)?n:t},e.prototype.post=function(e,t){var r,n;return this.anonymize?t:null!=(n=null===(r=this.spans[e.label])||void 0===r?void 0:r.post)?n:t},e.prototype.visitString=function(e){return'"'+this.anon(e).replace(Ya,'""')+'"'},e.prototype.visitBoolean=function(e){return e?this.localeInfo.trueName:this.localeInfo.falseName},e.prototype.visitNumber=function(e){return this.anon(this.mathpack.formatGeneral(this.localeInfo,e,21))},e.prototype.visitMissing=function(e){return""},e.prototype.visitError=function(e){var t=this.localeInfo.errorNames[e.type];if(void 0===t)throw"No locale data for error oper";return t},e.prototype.visitArray=function(e){var t=this,r=[];return e.nodes.forEach((function(e){var n=[];e.forEach((function(e){n.push(ja(e,t))})),r.push(n.join(t.localeInfo.columnSeparator))})),this.localeInfo.leftBrace+r.join(this.localeInfo.rowSeparator)+(e.isClosed?this.localeInfo.rightBrace:"")},e.prototype.visitApp=function(e){var t=this;if(bt(e.head)){var r=ja(e.head,this);if(1===e.args.length){var n=ja(e.args[0],this);switch(e.head.id){case Ue.Percent:return n+this.pre(e.head,"")+r;case Ue.Pound:return n+r;default:return r+this.post(e.head,"")+n}}if(2===e.args.length){var a=ja(e.args[0],this),i=ja(e.args[1],this);return a+this.pre(e.head," ")+r+this.post(e.head,e.head.id===Ue.Isect?"":" ")+i}throw"Tried to pretty print operator with 0 or more than 2 operators"}var o=e.args.map((function(e,r){return t.pre(e,0===r||function(e){return e.kind===L.Literal&&"object"==typeof e.oper&&e.oper.kind===x.Missing}(e)?"":" ")+ja(e,t)}));return this.visitAppFormulaHead(e.head)+"("+o.join(this.localeInfo.listSeparator)+(0===e.args.length?"":this.post(e.args[e.args.length-1],""))+(e.isClosed?")":"")},e.prototype.visitParen=function(e){return"("+this.pre(e.node,"")+ja(e.node,this)+this.post(e.node,"")+(e.isClosed?")":"")},e.prototype.visitName=function(e){return this.visitNameImpl(e,!1)},e.prototype.visitCellRef=function(e){var t="",r=this.resolver.resolveCellRef(this.locals,e),n=r[0],a=r[1];return Xa(void 0,a),void 0!==n.qualifier&&(t=ja(n.qualifier,this)+"!"),t+ja(e.ref,this)},e.prototype.visitBad=function(e){var t=this;if(e.type===U.Sequence){var r=[];return e.contents.forEach((function(e){r.push(t.pre(e,"")+ja(e,t)+t.post(e,""))})),r.join("")}return this.pre(e,"")+this.anon(e.contents)+this.post(e,"")},e.prototype.visitOperator=function(e){switch(e.id){case Ue.Isect:return"";case Ue.Union:return this.localeInfo.listSeparator;default:var t=je[e.id];if(void 0===t)throw"Invalid operator";return t}},e.prototype.visitRefError=function(){var e=this.localeInfo.errorNames[pe.REF];if(void 0===e)throw"No locale data for #REF";return e},e.prototype.visitSingle=function(e){var t=an(this.localeInfo,this.refStyle,this.locals.originGridCell.value,e.row,e.col,this.locals.wrapCellReferences);return void 0!==t?this.anon(t):this.visitRefError()},e.prototype.visitRange=function(e){var t=on(this.localeInfo,this.refStyle,this.locals.originGridCell.value,e.ref1.row,e.ref1.col,e.ref2.row,e.ref2.col,this.locals.wrapCellReferences);return void 0!==t?this.anon(t):this.visitRefError()},e.prototype.visitRow=function(e){var t=tn(this.localeInfo,this.refStyle,this.locals.originGridCell.value.row,e.row1,e.row2,this.locals.wrapCellReferences);return void 0!==t?this.anon(t):this.visitRefError()},e.prototype.visitCol=function(e){var t=rn(this.localeInfo,this.refStyle,this.locals.originGridCell.value.col,e.col1,e.col2,this.locals.wrapCellReferences);return void 0!==t?this.anon(t):this.visitRefError()},e.prototype.visitNameError=function(e){var t=this.localeInfo.errorNames[pe.REF];if(void 0===t)throw"No locale data for #REF";return t.replace("!","")},e.prototype.visitRelative=function(e){return""},e.prototype.visitDocument=function(e){return fn(this.localeInfo,this.refStyle,this.anon(void 0!==e.path?e.path+"/"+e.document:e.document))},e.prototype.visitSheet=function(e){return fn(this.localeInfo,this.refStyle,this.anon(this.visitSheetDocument(e.document)+e.sheet))},e.prototype.visitIdent=function(e){return fn(this.localeInfo,this.refStyle,this.anon(e.name))},e.prototype.visitSheetRange=function(e){var t=this.anon(this.visitSheetDocument(e.document)+e.sheet1),r=this.anon(e.sheet2),n=t+":"+r;return ln(this.localeInfo,this.refStyle,t)||ln(this.localeInfo,this.refStyle,r)?"'"+n.replace(Ja,"''")+"'":n},e.prototype.visitAppFormulaHead=function(e){var t,r,n=null===(t=this.annotations)||void 0===t?void 0:t[e.label];return(null===(r=n)||void 0===r?void 0:r.kind)===w.WorksheetFuncName?this.localeInfo.getWorksheetFuncName(n.id):e.kind===L.Name?this.visitNameImpl(e,!0):ja(e,this)},e.prototype.visitNameImpl=function(e,t){var r,n=e;if(void 0!==this.annotations){var a=this.annotations[e.label];if(void 0===e.qualifier&&(null===(r=a)||void 0===r?void 0:r.kind)===w.LocalName)return this.anon(a.name);var i=this.resolver.resolveName(this.locals,e),o=i[0],u=i[1];if(Xa(void 0,u),n=o,void 0===u&&t&&(void 0===e.qualifier||e.qualifier.kind===_.Document||e.qualifier.kind===_.Ident)){e.qualifier;var c=this.resolver.resolveUserDefinedFunc(this.locals,e),s=c[0],l=c[1];Xa(void 0,l),n=s}}var f="";return void 0!==n.qualifier&&(f=ja(n.qualifier,this)+"!"),f+this.anon(n.whole)},e.prototype.visitSheetDocument=function(e){if(void 0===e)return"";var t=e.path,r=e.document;return(null!=t?t:"")+this.localeInfo.leftBracket+r+this.localeInfo.rightBracket},e}(),Za=function(e){this.failure=e},$a=function(){function e(e){this.config=e}return e.prototype.getDocumentLoc=function(e,t){return at(Kt(e,t))},e.prototype.getSheetIndex=function(e,t){return at(t)},e.prototype.getSheetName=function(e,t){return at(t)},e.prototype.getNameLoc=function(e,t){return at(or(e,t))},e.prototype.getUserDefinedFuncLoc=function(e,t){return at([ur(e,t)])},e.prototype.getSheetRangeIndexes=function(e){return at(Qt([e.index],0))},e}();function ei(e,t,r){return{config:null!=r?r:void 0,lexicalSource:e,originGridCell:at(t.range),originSheet:at(t.sheet),wrapCellReferences:!1}}function ti(e,t,r){return{config:null!=r?r:void 0,lexicalSource:e,originGridCell:at(t.range),originSheet:at(t.sheet),wrapCellReferences:!0}}function ri(e,t,r,n){void 0===n&&(n=!1);try{var a=new za(e,t,r.spans,r.annotations,n);return at("="+a.pre(r.node,"")+Wa(r.node,a))}catch(e){if(O.ULS.traceTag(595964180,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,"calc.lang.printFormula: Format failed: "+("string"==typeof e?e:p(e))),"string"==typeof e)return it(Lt("calc.lang.printFormula: "+e));if(e instanceof Za)return e.failure;throw e}}function ni(){var e;return void 0===qa&&(e=da(La(),F.A1),qa=new $a(e)),qa}function ai(e,t){try{var r=t.kind===Vt.Cell||t.kind===Vt.Range?ei(t,St(t.range)):t.kind===Vt.NameManager?ti(t,Qa):k("calc.lang.anonymizeFormula",t),n=ri(ni(),r,e,!0);if(n.kind===Be.Success)return n.value}catch(e){}return C(e)}var ii,oi,ui,ci,si,li,fi,di,hi,vi,pi,mi,gi,Ci,Si,yi,Ei=new RegExp("[^=\\[\\]\\.\\\\\\/%#\\-\\+,;\\(\\):?\"&<>'!\\{\\}~\\^\\*$¢£¤¥₠₡₢₣₤₥₦₧₨₩₪₫€₭₮₯₰₱₲₳₴₵₶₷₸₹\\sꃂd]","g"),Oi=/[0-9]/g,ki=/d/g;function Ai(e){return e.toLowerCase().replace(ki,"w").replace(Oi,"d").replace(Ei,"w")}(oi=ii||(ii={})).LexicalKind=Vt,oi.sheetRows=1<<20,oi.sheetCols=16384,oi.lexicalSourceCell=Bt,oi.lexicalSourceRange=Wt,oi.lexicalSourceName=Ht,oi.documentLoc=Kt,oi.sheetIndex=Yt,oi.sheetRange=qt,oi.gridCell=Zt,oi.gridRange=zt,oi.allSheetsRange=Jt,oi.sheetRangeIndexes=Qt,oi.sheetGridCell=rr,oi.sheetGridRange=tr,oi.sheetGridCube=er,oi.originCell=nr,oi.documentScope=ar,oi.nameLoc=or,oi.nameScope=ir,oi.userDefinedFuncLoc=ur,(ci=ui||(ui={})).SpecialPrecs=G,ci.PrecsBound=W,ci.OperKind=x,ci.ErrorType=pe,ci.ErrorTypeBounds=me,ci.precedents=ge,ci.errorOper=Ce,ci.nullErrorOper=Se,ci.div0ErrorOper=ye,ci.valueErrorOper=Ee,ci.refErrorOper=Oe,ci.nameErrorOper=ke,ci.numErrorOper=Ae,ci.naErrorOper=be,ci.gettingDataErrorOper=Re,ci.fieldErrorOper=Ie,ci.arrayOper=Fe,ci.rangeSeqOper=_e,ci.range3DOper=Me,ci.missingOper=we,ci.blankOper=Le,(li=si||(si={})).RefStyle=F,li.QualifierKind=_,li.CellRefKind=M,li.PosKind=D,li.NodeKind=L,li.BadType=U,li.errorQualifier=H,li.relativeQualifier=K,li.documentQualifier=q,li.sheetQualifier=Y,li.identQualifier=J,li.sheetRangeQualifier=Q,li.pos=X,li.cellRefError=z,li.cellRefSingle=Z,li.cellRefRange=$,li.cellRefRow=ee,li.cellRefCol=te,li.formula=re,li.formulaSpan=ne,li.literalNode=oe,li.arrayNode=ue,li.appNode=ce,li.operatorNode=se,li.parenNode=le,li.nameNode=fe,li.cellRefNode=de,li.badNode=he,li.AnnotationKind=w,li.worksheetFuncNameAnnotation=ae,li.localNameAnnotation=ie,(di=fi||(fi={})).SignatureType=P,di.FunctionFlags=V,di.OperatorId=Ue,di.WorksheetFuncId=De,di.SpecialPrecs=G,di.functionType=ve,di.unknownFunctionType=Ve,di.getOperatorType=tt,di.getWorksheetFuncType=rt,(vi=hi||(hi={})).isSheetIndex=ct,vi.isSheetGridRange=ft,vi.isGridCell=lt,vi.isSheetGridCell=dt,vi.isDocumentLocEqual=vt,vi.isSheetIndexEqual=pt,vi.isGridCellEqual=mt,vi.isSheetGridCellEqual=gt,vi.isWellFormed=st,vi.isUnqualifiedNameNode=Rt,vi.isOperatorNode=bt,vi.gridRangeAnchor=Ct,vi.sheetGridRangeAnchor=St,vi.gridCellRange=yt,vi.getArguments=At,vi.getArgType=It,vi.isValidArgsLength=Tt,vi.operKind=Nt,vi.ResultKind=Be,vi.success=at,vi.failure=it,vi.FailureError=Ut,vi.isSuccess=ot,vi.ReasonKind=Mt,vi.notImplemented=Dt,vi.unavailable=wt,vi.internal=Lt,vi.javaScriptError=ut,vi.columnName=qr,vi.formatRow=Xr,vi.formatCol=zr,vi.formatRowRange=tn,vi.formatColRange=rn,vi.formatCellPos=an,vi.formatGridRangeA1=dn,vi.parseGridCellA1=Wr,vi.parseGridRangeA1=jr,vi.getSubExpressionFromPosition=Et,vi.ResolveReasonKind=Da,vi.noOriginSheet=Ua,vi.createResolver=Ba,vi.createResolutionHandler=Pa,vi.defaultLiteralVisitor=Ha,vi.defaultFormulaVisitor=Ka,vi.dispatch=ja,vi.startVisit=Wa,vi.printFormula=ri,vi.printLocalsGrid=ei,vi.printLocalsName=ti,(mi=pi||(pi={})).LogCategory=f.LogCategory,mi.TraceLevel=f.TraceLevel,mi.localeInfo=Sa,mi.localeInfo2=ya,mi.calcConfig=da,mi.initCalc=ma,mi.createSimpleLocaleInfo=La,mi.getEnglishLocaleInfo=La,mi.createWorksheetFuncNameCallbacks=Ma,mi.isCalcInit=ga,mi.getCalcAbsUrl=Ca,(Ci=gi||(gi={})).ieeeMathpack=Mn,Ci.xlMathpack=Qn,(yi=Si||(Si={})).Rounding=ca,yi.tzData=oa,yi.tzUTC=ua,yi.dateTime=sa,yi.xlDatepack=fa;var bi,Ri=hi.ReasonKind,Ii=hi.notImplemented;function Ti(e){return{config:e}}function Ni(e,t,r){return{config:null!=r?r:void 0,lexicalKind:e,originGridCell:at(t)}}!function(e){e.BadFormulaString="BadFormulaString"}(bi||(bi={}));var Fi=Object(j.a)(Object(j.a)({},Ri),bi),_i=ei,Mi=ti;function Di(e){return{kind:Fi.BadFormulaString,message:e}}function wi(e,t){var r=t-1;return function(t){if(t<=r){var n=e+": internal error: no progress made at index "+t;return O.ULS.assertTag(595980821,f.LogCategory.msoulscat_ES_EWAJS,!1,n)}r=t}}function Li(e,t,r){for(var n=t;n<e.length&&r(e[n]);n+=1);return[e.substring(t,n),n]}function Ui(e,t,r,n,a){var i=e[t];return r(i)?1:i===n&&t+1<e.length&&a(e[t+1])?2:0}function xi(e,t,r,n,a){for(var i=[],o=t,u=t;u<e.length;){var c=Ui(e,u,r,n,a);if(0===c)break;2===c&&(o!==u&&i.push(e.substring(o,u)),o=u+1),u+=c}return o!==u&&i.push(e.substring(o,u)),[i.join(""),u]}var Pi,Gi,Vi,Bi,Wi=fi.OperatorId;function ji(e,t,r){return{kind:e,start:t,chars:r}}!function(e){e[e.End=1]="End",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.Sep=4]="Sep",e[e.Operator=5]="Operator",e[e.Spaces=6]="Spaces",e[e.Ident=7]="Ident",e[e.CellRef=8]="CellRef",e[e.Literal=9]="Literal",e[e.SpecialRef=10]="SpecialRef",e[e.Unexpected=11]="Unexpected"}(Pi||(Pi={})),function(e){e[e.Paren=1]="Paren",e[e.Bracket=2]="Bracket",e[e.Brace=3]="Brace",e[e.SQuote=4]="SQuote"}(Gi||(Gi={})),function(e){e[e.List=1]="List",e[e.Row=2]="Row",e[e.Col=3]="Col",e[e.Qual=4]="Qual"}(Vi||(Vi={})),function(e){e[e.All=1]="All",e[e.Data=2]="Data",e[e.Headers=3]="Headers",e[e.Totals=4]="Totals",e[e.ThisRow=5]="ThisRow"}(Bi||(Bi={}));var Hi=function(e){return ji(Pi.End,e,"")},Ki=function(e,t){return ji(Pi.Spaces,e,t)};function qi(e,t,r){return void 0===r&&(r=!1),{kind:Pi.Unexpected,start:e,chars:t,isQualPart:r}}var Yi=function(e,t){return ji(Pi.Ident,e,t)};function Ji(e,t,r,n){return{kind:e,start:t,chars:r,value:n}}var Qi=function(e,t){return Ji(Pi.Left,e,t,Gi.Bracket)},Xi=function(e,t){return Ji(Pi.Left,e,t,Gi.Brace)},zi=function(e){return Ji(Pi.Right,e,")",Gi.Paren)},Zi=function(e,t){return Ji(Pi.Right,e,t,Gi.Bracket)},$i=function(e,t){return Ji(Pi.Right,e,t,Gi.Brace)},eo=function(e){return Ji(Pi.Right,e,"'",Gi.SQuote)},to=function(e,t){return Ji(Pi.Sep,e,t,Vi.List)},ro=function(e,t){return Ji(Pi.Sep,e,t,Vi.Col)},no=function(e,t){return Ji(Pi.Sep,e,t,Vi.Row)},ao=function(e){return Ji(Pi.Sep,e,"!",Vi.Qual)},io={"#ALL":function(e,t){return Ji(Pi.SpecialRef,e,t,Bi.All)},"#DATA":function(e,t){return Ji(Pi.SpecialRef,e,t,Bi.Data)},"#HEADERS":function(e,t){return Ji(Pi.SpecialRef,e,t,Bi.Headers)},"#TOTALS":function(e,t){return Ji(Pi.SpecialRef,e,t,Bi.Totals)},"#THIS ROW":function(e,t){return Ji(Pi.SpecialRef,e,t,Bi.ThisRow)}};function oo(e,t,r,n,a,i,o,u,c){return{kind:Pi.CellRef,start:e,chars:t,row:r,col:n,refStyle:a,isName:i,isNumber:o,isQualPart:u,isBadLocale:c}}function uo(e){for(var t=0;t<e.length;t+=1)if("+"===e[t]||"-"===e[t]||"*"===e[t]||" "===e[t]||"/"===e[t])return!1;return!0}function co(e,t,r,n){void 0===n&&(n=!0);var a="number"==typeof r&&uo(t);return{kind:Pi.Literal,start:e,chars:t,oper:r,hasRight:n,isQualPart:a}}function so(e,t,r){return 0===e.stringCompareCI(e.falseName,r)?co(t,r,!1):0===e.stringCompareCI(e.trueName,r)?co(t,r,!0):Yi(t,r)}function lo(e){var t=je[e];if(null==t)throw new Error("operatorTokenMaker: invalid operator "+e);return function(r){return{kind:Pi.Operator,start:r,chars:t,value:e}}}var fo=lo(Wi.Add),ho=lo(Wi.Sub),vo=lo(Wi.Mul),po=lo(Wi.Div),mo=lo(Wi.Pow),go=lo(Wi.Percent),Co=lo(Wi.Concat),So=lo(Wi.Eq),yo=lo(Wi.Lt),Eo=lo(Wi.Gt),Oo=lo(Wi.Ne),ko=lo(Wi.Le),Ao=lo(Wi.Ge),bo=lo(Wi.Range),Ro=(lo(Wi.And),lo(Wi.Or),lo(Wi.Xor),lo(Wi.Dot),lo(Wi.At)),Io=lo(Wi.Pound);function To(e,t,r){return r.push(t),t.start+e}var No=si.RefStyle,Fo="+-*/^%&=<>:",_o=!1;function Mo(e){return!_o&&En(hn.CalcDynamicArrayOperators)&&(Fo+="@#",_o=!0),Fo.indexOf(e)>=0}var Do={"+":fo,"-":ho,"*":vo,"/":po,"^":mo,"%":go,"&":Co,"=":So,"<":yo,">":Eo,":":bo,"@":Ro,"#":Io},wo={"<>":Oo,"<=":ko,">=":Ao};function Lo(e,t,r){if(t<e.length-1){var n=wo[e.substr(t,2)];if(null!=n)return To(2,n(t),r)}var a=Do[e[t]];if(null!=a)return To(1,a(t),r);return O.ULS.assertTag(595980822,f.LogCategory.msoulscat_ES_EWAJS,!1,"calc.parse.tokenizeOperator: internal error: expected operator")}function Uo(e,t,r,n,a){var i=kr(e,t,r,n);if(void 0!==i){var o=i.value,u=i.i;if(void 0!==o)return To(u-n,co(n,r.substring(n,u),o,!0),a),u;if(e.isNumeral(r.charCodeAt(n))){var c=r.substring(n,u);return To(u-n,qi(n,c,uo(c)),a),u}}}function xo(e,t,r){var n=xi(e,t+1,(function(e){return'"'!==e}),'"',(function(e){return'"'===e})),a=n[0],i=n[1],o=e.substring(t,i+1);return i<e.length?To(i+1-t,co(t,o,a,!0),r):To(i-t,co(t,o,a,!1),r)}function Po(e,t,r,n){for(var a=1;a<e.errorNames.length;a+=1){var i=e.errorNames[a];if(void 0!==i){var o=t.substr(r,i.length);if(0===e.stringCompareCI(i,o))return To(i.length,co(r,o,Ce(a)),n)}}}var Go=Object.getOwnPropertyNames(io);function Vo(e,t,r,n){for(var a=0;a<Go.length;a+=1){var i=Go[a],o=t.substr(r,i.length);if(0===e.stringCompareCI(i,o))return To(i.length,io[i](r,o),n)}}function Bo(e,t){return"'"!==t&&"#"!==t&&t!==e.leftBracket&&t!==e.rightBracket}function Wo(e,t,r,n){var a=To(1,Qi(r,t[r]),n);"#"===t[a]&&(null!=(s=Vo(e,t,a,n))&&(a=s));for(var i=function(t){return Bo(e,t)},o=function(t){return!Bo(e,t)},u=wi("calc.parse.tokenizeBracketedColRef",a);a<t.length;){u(a);var c=t[a];if(c===e.rightBracket)return To(1,Zi(a,c),n);if(Ui(t,a,i,"'",o)>0){var s,l=xi(t,a,i,"'",o),f=l[0];a=To((s=l[1])-a,Yi(a,f),n)}else a=To(1,qi(a,c),n)}return a}function jo(e,t){return!Sr(t.charCodeAt(0))&&"'"!==t&&"#"!==t&&":"!==t&&t!==e.listSeparator&&t!==e.leftBracket&&t!==e.rightBracket}function Ho(e,t,r,n){var a=To(1,Qi(r,t[r]),n);"#"===t[a]&&(null!=(f=Vo(e,t,a,n))&&(a=f));for(var i=function(t){return jo(e,t)},o=function(t){return!jo(e,t)},u=wi("calc.parse.tokenizeBracketedRef",a);a<t.length;){u(a);var c=t[a];if(c===e.rightBracket)return To(1,Zi(a,c),n);if(Ui(t,a,i,"'",o)>0){var s=xi(t,a,i,"'",o),l=s[0];a=To((f=s[1])-a,Yi(a,l),n)}else if(Sr(c.charCodeAt(0))){var f,d=Li(t,a,(function(e){return Sr(e.charCodeAt(0))}));l=d[0];a=To((f=d[1])-a,Ki(a,l),n)}else a=":"!==c?c!==e.listSeparator?c!==e.leftBracket?To(1,qi(a,c),n):Wo(e,t,a,n):To(1,to(a,c),n):To(1,bo(a),n)}return a}var Ko;function qo(e,t,r,n){for(var a,i=To(1,(a=r,Ji(Pi.Left,a,"'",Gi.SQuote)),n),o=function(t){return function(e,t){return"':*?".indexOf(t)<0&&t!==e.leftBracket&&t!==e.rightBracket}(e,t)},u=function(e){return"'"===e},c=wi("calc.parse.tokenizeQuotedQualifier",i);i<t.length;){c(i);var s=t[i];if("'"===s&&"'"!==t[i+1])return To(1,eo(i),n);if(":"!==s)if(s!==e.leftBracket)if(Ui(t,i,o,"'",u)>0){var l=xi(t,i,o,"'",u),f=l[0];i=To(l[1]-i,Yi(i,f),n)}else i=To(1,qi(i,s),n);else i=Ho(e,t,i,n);else i=To(1,bo(i),n)}return i}function Yo(e,t,r,n,a,i){var o,u,c,s,l,f,d,h=Br(e,t,r,n,a);if(null!=h){var v=h.i,p=n.substring(v,a);return To(v-a,h.refStyle===No.A1?(o=a,u=p,c=h.row,s=h.col,l=null==c&&null!=s&&s.kind===si.PosKind.Rel,f=null==s&&null!=c&&c.kind===si.PosKind.Rel,d=!(null!=c&&c.kind!==si.PosKind.Rel||null!=s&&s.kind!==si.PosKind.Rel),oo(o,u,c,s,si.RefStyle.A1,l,f,d,!1)):function(e,t,r,n,a){void 0===a&&(a=!1);var i=!(!1!==r&&null!=r&&r.kind!==si.PosKind.Abs||!1!==n&&null!=n&&n.kind!==si.PosKind.Abs);return oo(e,t,!1===r?si.pos(si.PosKind.Rel,0):r,!1===n?si.pos(si.PosKind.Rel,0):n,si.RefStyle.R1C1,!1,!1,i,a)}(a,p,h.row,h.col,h.enLocale),i)}}function Jo(e,t,r,n){for(var a=e[t],i=t+1;i<e.length;i+=1){var o=e[i];if(o.kind!==r)break;a=n(a,o)}return[a,i]}function Qo(e,t,r,n,a,i){for(var o=function(e,t,r,n,a,i){for(var o,u=[],c=[],s=Ko.Decimal,l=i,d=wi("calc.parse.tokenize",l);l<a.length;){d(l);var h=Yo(e,r,n,a,l,u);if(null==h){var v=a[l];if(s===Ko.Decimal&&v===e.decimalSeparator||e.isNumeral(v.charCodeAt(0))){var p=Uo(e,t,a,l,u);if(null!=p){l=p,s=Ko.FieldAccess;continue}if(v!==e.decimalSeparator){var m="calc.parse.tokenize: failed to tokenize numeral at "+l;return O.ULS.assertTag(595980823,f.LogCategory.msoulscat_ES_EWAJS,!1,m)}}if('"'!==v)if(e.isIdentStart(v.charCodeAt(0))){var g=Li(a,l,(function(t){return e.isIdentContinue(t.charCodeAt(0))})),C=g[0];l=To(g[1]-l,so(e,l,C),u),s=Ko.FieldAccess}else if("#"!==v)if(Mo(v))l=Lo(a,l,u),s=Ko.Decimal;else if(Sr(v.charCodeAt(0))){var S=Li(a,l,(function(e){return Sr(e.charCodeAt(0))}));C=S[0];l=To(S[1]-l,Ki(l,C),u),s=Ko.Decimal}else if("("!==v)if(")"!==v)if(v!==e.leftBrace)if(v!==e.rightBrace)if(v!==e.leftBracket)if(v!==e.rightBracket){if(c.length>0&&c[c.length-1]===Gi.Brace){if(v===e.columnSeparator){l=To(1,ro(l,v),u),s=Ko.Decimal;continue}if(v===e.rowSeparator){l=To(1,no(l,v),u),s=Ko.Decimal;continue}}v!==e.listSeparator?"!"!==v?"'"!==v?(l=To(1,qi(l,v),u),s=Ko.Decimal):(l=qo(e,a,l,u),s=Ko.Decimal):(l=To(1,ao(l),u),s=Ko.Decimal):(l=To(1,to(l,v),u),s=Ko.Decimal)}else l=To(1,Zi(l,v),u),s=Ko.FieldAccess;else l=Ho(e,a,l,u),s=Ko.FieldAccess;else c.length>0&&c[c.length-1]===Gi.Brace&&c.pop(),l=To(1,$i(l,v),u),s=Ko.FieldAccess;else c.push(Gi.Brace),l=To(1,Xi(l,v),u),s=Ko.Decimal;else c.length>0&&c[c.length-1]===Gi.Paren&&c.pop(),l=To(1,zi(l),u),s=Ko.FieldAccess;else c.push(Gi.Paren),l=To(1,(o=l,Ji(Pi.Left,o,"(",Gi.Paren)),u),s=Ko.Decimal;else{var y=Po(e,a,l,u);if(null!=y){l=y,s=Ko.FieldAccess;continue}En(hn.CalcDynamicArrayOperators)?(l=Lo(a,l,u),s=Ko.Decimal):(l=To(1,qi(l,v),u),s=Ko.Decimal)}else l=xo(a,l,u),s=Ko.FieldAccess}else l=h,s=Ko.FieldAccess}return u}(e,t,r,n,a,i),u=[],c=0;c<o.length;){var s=o[c];if(s.kind!==Pi.Unexpected)u.push(s),c+=1;else{var l=Jo(o,c,Pi.Unexpected,(function(e,t){var r=e,n=t;return qi(r.start,r.chars+n.chars,r.isQualPart&&n.isQualPart)})),d=l[0],h=l[1];u.push(d),c=h}}return u.push(Hi(a.length)),u}function Xo(e,t,r,n){var a=void 0;if(function(e){for(var t=e;null!=t;)t=t()}(e(t,r,n,(function(e,t){a=[e,t]}),(function(){a=!1}))),null==a){var i="calc.parse.runParser: internal error: parser did not call resolve or reject on "+C(t);return O.ULS.assertTag(595980827,f.LogCategory.msoulscat_ES_EWAJS,!1,i)}return a}function zo(){var e={impl:function(e,t,r,n,a){return O.ULS.assertTag(595980828,f.LogCategory.msoulscat_ES_EWAJS,!1,"calc.parse.delayed: internal error: unassigned DelayedParser")},parser:function(t,r,n,a,i){return function(){return e.impl(t,r,n,a,i)}}};return e}function Zo(e){return function(t,r,n,a,i){return a(e,r)}}!function(e){e[e.Decimal=1]="Decimal",e[e.FieldAccess=2]="FieldAccess"}(Ko||(Ko={}));var $o,eu=function(e,t,r,n,a){return a};function tu(e,t){return function(r,n,a,i,o){return e(r,n,a,(function(e,n){return t(a,e)(r,n,a,i,o)}),o)}}function ru(e,t){return function(r,n,a,i,o){return e(r,n,a,i,(function(){return t(r,n,a,i,o)}))}}function nu(e){return 0===e.length?eu:e.reduce(ru)}function au(e,t){return function(r,n,a,i,o){return e(r,n,a,i,(function(){return i(t,n)}))}}function iu(e,t){return function(r,n,a,i,o){var u=r[n];if(null==u)return o;var c=e(a,u);return null==c?o:i(c,n+t)}}function ou(e){return iu(e,1)}function uu(e){return iu(e,0)}function cu(e){return function(t,r,n,a,i){var o=t[r],u=t[r+1];if(null==o||null==u)return i;var c=e(n,o,u);return null==c?i:a(c,r+1)}}function su(e,t,r){return function(n,a,i,o,u){var c=r,s=a;function l(){return e(n,s,i,d,h)}function d(e,r){if(r<=s){var a=C(n),o="calc.parse.reduce: internal error: no progress made at index "+s+" on "+a;return O.ULS.assertTag(595980829,f.LogCategory.msoulscat_ES_EWAJS,!1,o)}return c=t(i,e,c),s=r,l}function h(){return o(c,s)}return l}}function lu(e,t){return su(e,(function(e,t,r){return r.push(t),r}),t)}function fu(e){return function(t,r,n,a,i){return lu(e,[])(t,r,n,a,i)}}function du(e,t){return tu(e,(function(e,r){return lu(t,[r])}))}function hu(e){var t=e.length;return function(r,n,a,i,o){var u=n,c=[];function s(){return e[c.length](r,u,a,l,o)}function l(e,r){return u=r,c.push(e),c.length<t?s:i(c,u)}return s}}function vu(e,t){return hu([e,t])}function pu(e,t,r,n,a){return hu([e,t,r,n,a])}function mu(e,t){return function(r,n,a,i,o){return e(r,n,a,(function(e,r){return i(t(a,e),r)}),o)}}function gu(e,t,r){return mu(hu([e,t]),(function(e,t){return r(e,t[0],t[1])}))}function Cu(e,t,r,n){return mu(hu([e,t,r]),(function(e,t){return n(e,t[0],t[1],t[2])}))}function Su(e,t,r,n,a){return mu(hu([e,t,r,n]),(function(e,t){return a(e,t[0],t[1],t[2],t[3])}))}function yu(e,t,r,n,a,i){return mu(hu([e,t,r,n,a]),(function(e,t){return i(e,t[0],t[1],t[2],t[3],t[4])}))}function Eu(e,t){return gu(e,t,(function(e,t,r){return t}))}function Ou(e,t){return gu(e,t,(function(e,t,r){return r}))}function ku(e,t){var r=e.spans[t.label];if(null==r){var n="calc.parse.getNodeSpan: internal error: expected node to have a span; given "+C(t);return O.ULS.assertTag(595980824,f.LogCategory.msoulscat_ES_EWAJS,!1,n)}return r}function Au(e,t,r,n,a){var i=e.label;return e.label+=1,e.spans[i]=si.formulaSpan(t,r,n,a),i}function bu(e,t,r,n){var a=ku(e,r);return a.pre=t,a.post=n,r}function Ru(e,t,r){return function(n,a,i,o,u){var c=i.leftDelim,s=i.listSep;return i.leftDelim=e,i.listSep=t,r(n,a,i,(function(e,t){return i.leftDelim=c,i.listSep=s,o(e,t)}),(function(){return i.leftDelim=c,i.listSep=s,u}))}}function Iu(e,t){return t.kind===Pi.Spaces||t.kind===Pi.End?t.start:ku(e,t).start}!function(e){e[e.Union=1]="Union",e[e.Arg=2]="Arg"}($o||($o={}));var Tu=au(ou((function(e,t){return t.kind===Pi.Spaces?t.chars:void 0})),""),Nu=function(e,t,r,n,a){var i=e[t];if(null==i){var o="calc.parse.pStart: internal error: expected term at "+t+" in "+C(e);return O.ULS.assertTag(595980864,f.LogCategory.msoulscat_ES_EWAJS,!1,o)}return n(Iu(r,i),t)};function Fu(e){return Cu(Tu,ou(e),Tu,bu)}function _u(e){return gu(Tu,ou(e),(function(e,t,r){return bu(e,t,r,"")}))}function Mu(e){return gu(ou(e),Tu,(function(e,t,r){return bu(e,"",t,r)}))}var Du=Fu((function(e,t){return t.kind!==si.NodeKind.Operator||t.id!==fi.OperatorId.Add&&t.id!==fi.OperatorId.Sub?void 0:t})),wu=Mu((function(e,t){if(t.kind===si.NodeKind.Operator){if(t.id===fi.OperatorId.Add)return si.operatorNode(fi.OperatorId.Pos,t.label);if(t.id===fi.OperatorId.Sub)return si.operatorNode(fi.OperatorId.Neg,t.label)}}));function Lu(e,t){if(t.kind===si.NodeKind.Operator&&t.id===fi.OperatorId.At)return si.operatorNode(fi.OperatorId.At,t.label)}var Uu=Mu(Lu),xu=_u((function(e,t){return t.kind===si.NodeKind.Operator&&t.id===fi.OperatorId.Pound?t:void 0})),Pu=Fu((function(e,t){return t.kind!==si.NodeKind.Operator||t.id!==fi.OperatorId.Mul&&t.id!==fi.OperatorId.Div?void 0:t})),Gu=Fu((function(e,t){return t.kind===si.NodeKind.Operator&&t.id===fi.OperatorId.Pow?t:void 0})),Vu=_u((function(e,t){return t.kind===si.NodeKind.Operator&&t.id===fi.OperatorId.Percent?t:void 0})),Bu=Fu((function(e,t){return t.kind===si.NodeKind.Operator&&t.id===fi.OperatorId.Concat?t:void 0})),Wu=Fu((function(e,t){return t.kind===si.NodeKind.Operator&&t.id>=fi.OperatorId.Eq&&t.id<=fi.OperatorId.Ge?t:void 0})),ju=Fu((function(e,t){return t.kind===si.NodeKind.Operator&&t.id===fi.OperatorId.Range?t:void 0})),Hu=Fu((function(e,t){return t.kind===si.NodeKind.Operator&&t.id===fi.OperatorId.Union?t:void 0})),Ku=cu((function(e,t,r){if(t.kind===Pi.Spaces&&r.kind!==Pi.End&&(r.kind!==si.NodeKind.Operator||r.id===fi.OperatorId.At)){var n=Au(e,t.start,Iu(e,r),t.chars,"");return si.operatorNode(fi.OperatorId.Isect,n)}}));function qu(e,t,r,n){return void 0===n&&(n=e),gu(n,fu(vu(t,e)),(function(e,t,n){return 0===n.length?t:n.reduce(r(e),t)}))}function Yu(e,t,r){return gu(fu(t),e,(function(e,t,n){return 0===t.length?n:t.reduceRight(r(e),n)}))}function Ju(e,t,r){return gu(e,fu(t),(function(e,t,n){return 0===n.length?t:n.reduce(r(e),t)}))}function Qu(e){return function(t,r){var n=r[0],a=r[1],i=ku(e,t).start,o=ku(e,a).end,u=Au(e,i,o,"","");return si.appNode(n,[t,a],!0,u)}}function Xu(e){return function(t,r){var n=ku(e,t).start,a=ku(e,r).end,i=Au(e,n,a,"","");return si.appNode(r,[t],!0,i)}}function zu(e){var t=!0;return function(r,n){var a=ku(e,n).start,i=ku(e,r).end,o=Au(e,a,i,"","");if(t&&(t=!1,r.kind===si.NodeKind.Literal&&"number"==typeof r.oper&&""===ku(e,n).post)){var u=n.id===fi.OperatorId.Pos?r.oper:e.mathpack.neg(r.oper);return si.literalNode(u,!0,o)}return si.appNode(n,[r],!0,o)}}function Zu(e){return function(t,r){var n=ku(e,r).start,a=ku(e,t).end,i=Au(e,n,a,"","");return si.appNode(r,[t],!0,i)}}var $u,ec,tc,rc,nc,ac,ic,oc,uc,cc,sc,lc,fc,dc,hc=ou((function(e,t){return t.kind!==si.NodeKind.Operator&&t.kind!==Pi.Spaces&&t.kind!==Pi.End?t:void 0}));function vc(e,t){var r=Au(e,ku(e,t[0]).start,ku(e,t[t.length-1]).end,"","");return si.badNode(si.BadType.Sequence,t,r)}var pc=!1;function mc(e,t){!function(){if(!pc){if(En(hn.CalcDynamicArrayOperators)){$u=gu(Nu,fu(hc),(function(e,t,r){return 0===r.length?si.literalNode(ui.missingOper,!0,Au(e,t,t,"","")):1===r.length?r[0]:vc(e,r)})),ec=Ju($u,xu,Xu);var e=zo(),t=Ou(uu(Lu),e.parser);tc=qu(ru(t,ec),ju,Qu,ec),rc=qu(ru(t,tc),Ku,Qu,tc),nc=Yu(rc,Uu,Zu),e.impl=nc,ac=qu(nc,Hu,Qu),ic=Yu(ac,wu,zu),oc=Ju(ic,Vu,Xu),uc=qu(oc,Gu,Qu),cc=qu(uc,Pu,Qu),sc=qu(cc,Du,Qu),lc=qu(sc,Bu,Qu),fc=qu(lc,Wu,Qu)}else tc=gu(Nu,fu(hc),(function(e,t,r){return 0===r.length?si.literalNode(ui.missingOper,!0,Au(e,t,t,"","")):1===r.length?r[0]:vc(e,r)})),rc=qu(tc,ju,Qu),nc=qu(rc,Ku,Qu),ac=qu(nc,Hu,Qu),ic=Yu(ac,wu,zu),oc=Ju(ic,Vu,Xu),uc=qu(oc,Gu,Qu),cc=qu(uc,Pu,Qu),sc=qu(cc,Du,Qu),lc=qu(sc,Bu,Qu),fc=qu(lc,Wu,Qu);dc=gu(fc,fu(Ou(uu((function(e,t){return t.kind===Pi.End?void 0:t})),fc)),(function(e,t,r){return 0===r.length?t:vc(e,[t].concat(r))})),pc=!0}}();var r=e.length-1;if(r<0){var n="calc.parse.parseTerms: internal error: expected at least 1 term";return O.ULS.assertTag(595980865,f.LogCategory.msoulscat_ES_EWAJS,!1,n)}if(e[0].kind===Pi.Spaces){n="calc.parse.parseTerms: internal error: array[0].kind === Spaces in "+C(e);return O.ULS.assertTag(595980866,f.LogCategory.msoulscat_ES_EWAJS,!1,n)}if(r-1>=0&&e[r-1].kind===Pi.Spaces){n="calc.parse.parseTerms: internal error: array[n-1].kind === Spaces in "+C(e);return O.ULS.assertTag(595980867,f.LogCategory.msoulscat_ES_EWAJS,!1,n)}if(e[r].kind!==Pi.End){n="calc.parse.parseTerms: internal error: array[n].kind !== End in "+C(e);return O.ULS.assertTag(595980868,f.LogCategory.msoulscat_ES_EWAJS,!1,n)}var a=Xo(dc,e,0,t);if(!1===a){n="calc.parse.parseTerms: internal error: failed to parse "+C(e);return O.ULS.assertTag(595980869,f.LogCategory.msoulscat_ES_EWAJS,!1,n)}var i=a[0],o=a[1];if(o<r){n="calc.parse.parseTerms: internal error: consumed "+o+" out of "+r+" in "+C(e);return O.ULS.assertTag(595980870,f.LogCategory.msoulscat_ES_EWAJS,!1,n)}return i}var gc=au(ou((function(e,t){return t.kind===Pi.Spaces?t.chars:void 0})),""),Cc=function(e,t,r,n,a){var i=e[t];if(null==i){var o="calc.parse.pStart: internal error: expected token at "+t+" in "+C(e);return O.ULS.assertTag(595980830,f.LogCategory.msoulscat_ES_EWAJS,!1,o)}return n(i.start,t)};function Sc(e){return ou((function(t,r){return r.kind===Pi.Sep&&r.value===e||void 0}))}function yc(e){return ou((function(t,r){return r.kind===Pi.Left&&r.value===e?r.start:void 0}))}function Ec(e){return ou((function(t,r){return r.kind===Pi.Right&&r.value===e||void 0}))}var Oc=Sc(Vi.List),kc=Sc(Vi.Row),Ac=Sc(Vi.Col),bc=Sc(Vi.Qual),Rc=yc(Gi.Paren),Ic=Ec(Gi.Paren),Tc=yc(Gi.Brace),Nc=Ec(Gi.Brace),Fc=yc(Gi.SQuote),_c=Ec(Gi.SQuote),Mc=ou((function(e,t){return t.kind===Pi.Operator&&t.value===fi.OperatorId.Range||void 0})),Dc=zo(),wc=Cu(gc,Dc.parser,gc,bu),Lc=Su(Rc,Ru(Gi.Paren,$o.Union,wc),au(Ic,!1),Cc,(function(e,t,r,n,a){var i=Au(e,t,a,"","");return si.parenNode(r,n,i)})),Uc=du(wc,Ou(Ac,wc)),xc=du(Uc,Ou(kc,Uc)),Pc=Su(Tc,Ru(Gi.Brace,$o.Union,xc),au(Nc,!1),Cc,(function(e,t,r,n,a){var i=Au(e,t,a,"","");return si.arrayNode(r,n,i)})),Gc=function(e){return e.kind===Pi.Ident||e.kind===Pi.CellRef&&e.isQualPart||e.kind===Pi.Literal&&e.isQualPart||e.kind===Pi.Unexpected&&e.isQualPart||e.kind===Pi.Operator&&e.value===fi.OperatorId.Dot},Vc=du(ou((function(e,t){return Gc(t)&&t.chars.length>0&&46!==t.chars.charCodeAt(0)?t.chars:void 0})),ou((function(e,t){return Gc(t)?t.chars:void 0}))),Bc=ou((function(e,t){return t.kind===Pi.Ident?t.chars:void 0}));function Wc(e){return e.kind===Pi.Literal&&"object"==typeof e.oper&&e.oper.kind===ui.OperKind.Error&&e.oper.type===ui.ErrorType.REF}function jc(e,t,r,n){return null==t?[si.identQualifier(e,r,n),r?"'"+e.replace(/'/g,"")+"'":e]:[si.sheetRangeQualifier(e,t,void 0,r,n),r?"'"+e.replace(/'/g,"")+":"+t.replace(/'/g,"")+"'":e+":"+t]}var Hc=Su(Cc,Vc,au(Ou(Mc,Vc),void 0),Cc,(function(e,t,r,n,a){var i=Au(e,t,a,"","");return jc(r.join(""),null!=n?n.join(""):void 0,!1,i)})),Kc=yu(Fc,Bc,au(Ou(Mc,Bc),void 0),_c,Cc,(function(e,t,r,n,a,i){return jc(r,n,!0,Au(e,t,i,"",""))})),qc=Su(Fc,fu(ou((function(e,t){return t.kind===Pi.End||t.kind===Pi.Right&&t.value===Gi.SQuote?void 0:t.chars}))),au(vu(_c,au(Eu(bc,gc),!1)),[!1,!1]),Cc,(function(e,t,r,n,a){var i=n[0],o=n[1],u="'"+r.join("")+(i?"'":"")+(o?"!":""),c=Au(e,t,a,"","");return[si.badNode(si.BadType.Qualifier,u,c),u]})),Yc=cu((function(e,t,r){if(Wc(t)){var n=Au(e,t.start,r.start,"","");return[si.errorQualifier(n),t.chars]}})),Jc=gu(nu([Hc,Kc,uu((function(e,t){var r=Au(e,t.start,t.start,"","");return[si.relativeQualifier(r),""]}))]),Eu(bc,gc),(function(e,t,r){return[t[0],t[1]+"!"]})),Qc=nu([Yc,Jc,qc]);function Xc(e,t){return t.kind===Pi.CellRef&&e.refStyle===t.refStyle&&!t.isBadLocale}var zc=cu((function(e,t,r){return Xc(e,t)?[t,r.start]:void 0}));function Zc(e,t){if(null!=e.row&&null!=e.col)return si.cellRefSingle(e.row,e.col,t);if(null!=e.row)return si.cellRefRow(e.row,e.row,t);if(null!=e.col)return si.cellRefCol(e.col,e.col,t);var r="calc.parse.cellRefToken2cellRef: bad token "+C(e);return O.ULS.assertTag(595980831,f.LogCategory.msoulscat_ES_EWAJS,!1,r)}var $c=cu((function(e,t,r){if(Xc(e,t)&&(t.refStyle!==si.RefStyle.A1||null!=t.row&&null!=t.col))return Zc(t,n=Au(e,t.start,r.start,"",""));if(Wc(t)){var n=Au(e,t.start,r.start,"","");return si.cellRefError(n)}})),es=ru(tu(pu(zc,gc,Mc,gc,zc),(function(e,t){var r=t[0],n=r[0],a=r[1],i=t[1],o=(t[2],t[3]),u=t[4],c=u[0],s=u[1],l=Au(e,n.start,a,"",i),f=Au(e,c.start,s,o,""),d=Zc(n,l),h=Zc(c,f),v=void 0;if(d.kind===si.CellRefKind.Single&&h.kind===si.CellRefKind.Single){var p=Au(e,n.start,s,"","");v=si.cellRefRange(d,h,p)}else if(0===i.length&&0===o.length)if(d.kind===si.CellRefKind.Row&&h.kind===si.CellRefKind.Row){p=Au(e,n.start,s,"","");v=si.cellRefRow(d.row1,h.row1,p)}else if(d.kind===si.CellRefKind.Col&&h.kind===si.CellRefKind.Col){p=Au(e,n.start,s,"","");v=si.cellRefCol(d.col1,h.col1,p)}return null==v?eu:n.isQualPart&&c.isQualPart?uu((function(e,t){return t.kind===Pi.Sep&&t.value===Vi.Qual?void 0:v})):Zo(v)})),$c),ts=ou((function(e,t){return t.kind===Pi.Ident||t.kind===Pi.CellRef&&t.isName?t.chars:void 0})),rs=tu(pu(Cc,Qc,Cc,au(ru(es,ts),void 0),Cc),(function(e,t){var r=t[0],n=t[1],a=n[0],i=n[1],o=t[2],u=t[3],c=t[4];if(null==u)return a.kind!==si.QualifierKind.SheetRange||a.isQuoted?a.kind===si.QualifierKind.Error?Zo(si.literalNode(ui.refErrorOper,!0,a.label)):Zo(a.kind===si.NodeKind.Bad?a:si.badNode(si.BadType.Qualifier,i,a.label)):eu;if("string"==typeof u){if(a.kind===si.QualifierKind.SheetRange&&!a.isQuoted)return eu;var s=Au(e,r,c,"","");if(a.kind===si.NodeKind.Bad||a.kind===si.QualifierKind.Error||a.kind===si.QualifierKind.SheetRange){var l=a.kind===si.NodeKind.Bad?a:si.badNode(si.BadType.Qualifier,i,a.label),f=si.nameNode(u,void 0,Au(e,o,c,"",""));return Zo(si.badNode(si.BadType.Sequence,[l,f],s))}return Zo(si.nameNode(u,a,s))}var d=Au(e,r,c,"","");if(a.kind===si.NodeKind.Bad||a.kind===si.QualifierKind.Document){var h=a.kind===si.NodeKind.Bad?a:si.badNode(si.BadType.Qualifier,i,a.label);f=si.cellRefNode(u,void 0,Au(e,o,c,"",""));return Zo(si.badNode(si.BadType.Sequence,[h,f],d))}var v=a.kind===si.QualifierKind.Ident?si.sheetQualifier(a.name,void 0,a.isQuoted,a.label):a;return Zo(si.cellRefNode(u,v,d))})),ns=Cu(Cc,ru(es,ts),Cc,(function(e,t,r,n){var a=Au(e,t,n,"","");return"string"==typeof r?si.nameNode(r,void 0,a):r.kind===si.CellRefKind.Error?si.literalNode(ui.refErrorOper,!0,a):si.cellRefNode(r,void 0,a)})),as=cu((function(e,t,r){if(t.kind===Pi.Literal)return si.literalNode(t.oper,t.hasRight,Au(e,t.start,r.start,"",""));if(t.kind===Pi.CellRef&&t.isNumber&&"object"==typeof t.row){var n=t.row.index+e.origin.row+1;return si.literalNode(e.mathpack.fromNumber(n),!0,Au(e,t.start,r.start,"",""))}}));function is(e){return cu((function(t,r,n){if(e(r)){var a=Au(t,r.start,n.start,"","");return si.badNode(si.BadType.Unexpected,r.chars,a)}}))}var os=is((function(e){return e.kind===Pi.Left&&e.value===Gi.Bracket})),us=is((function(e){return e.kind===Pi.Right&&e.value===Gi.Bracket})),cs=yu(Cc,os,Ru(Gi.Bracket,$o.Union,wc),au(us,void 0),Cc,(function(e,t,r,n,a,i){var o=[r,n];null!=a&&o.push(a);var u=Au(e,t,i,"","");return si.badNode(si.BadType.Sequence,o,u)})),ss=cu((function(e,t,r){switch(t.kind){case Pi.End:case Pi.Operator:case Pi.Spaces:return;case Pi.Sep:if(t.value!==Vi.Qual&&(e.leftDelim===Gi.Brace||t.value!==Vi.Col&&t.value!==Vi.Row))return;break;case Pi.Right:if(t.value===e.leftDelim)return}var n=t.kind===Pi.CellRef?si.BadType.CellRef:si.BadType.Unexpected,a=Au(e,t.start,r.start,"","");return si.badNode(n,t.chars,a)})),ls=cu((function(e,t,r){if((t.kind===Pi.Ident||t.kind===Pi.CellRef||t.kind===Pi.Literal&&"boolean"==typeof t.oper)&&r.kind===Pi.Left&&r.value===Gi.Paren&&null!=Gt(e.localeInfo,t.chars)){var n=Au(e,t.start,r.start,"","");return si.nameNode(t.chars,void 0,n)}})),fs=Su(Rc,Ru(Gi.Paren,$o.Arg,du(wc,Ou(Oc,wc))),au(Ic,!1),Cc,(function(e,t,r,n,a){return[r,n,a]})),ds=gu(ls,fs,(function(e,t,r){var n=r[0],a=r[1],i=r[2],o=Au(e,ku(e,t).start,i,"","");return si.appNode(t,n,a,o)})),hs=gu(nu([ds,rs,ns,as,Lc,Pc,cs,ss]),fu(fs),(function(e,t,r){var n=ku(e,t).start;return r.reduce((function(t,r){var a=r[0],i=r[1],o=r[2],u=Au(e,n,o,"","");return si.appNode(t,a,i,u)}),t)})),vs=cu((function(e,t,r){var n=void 0;if(t.kind===Pi.Operator&&(n=t.value),t.kind===Pi.Sep&&t.value===Vi.List&&e.listSep===$o.Union&&(n=fi.OperatorId.Union),null!=n){var a=Au(e,t.start,r.start,"","");return si.operatorNode(n,a)}})),ps=ou((function(e,t){return t.kind===Pi.Spaces?t:void 0})),ms=ru(hs,vs),gs=tu(ms,(function(e,t){return su(vu(au(ps,void 0),ms),(function(e,t,r){var n=t[0],a=t[1];return null!=n&&r.push(n),r.push(a),r}),[t])})),Cs=gu(au(gs,void 0),Cc,(function(e,t,r){if(null==t){var n=Au(e,r,r,"","");return si.literalNode(ui.missingOper,!0,n)}if(1===t.length){var a=t[0];if(a.kind!==si.NodeKind.Operator&&a.kind!==Pi.Spaces)return a}return t.push(Hi(r)),mc(t,e)}));function Ss(e,t,r,n,a,i){var o=i.length-1;if(o<0){var u="calc.parse.parseTokens: internal error: expected at least 1 token";return O.ULS.assertTag(595980832,f.LogCategory.msoulscat_ES_EWAJS,!1,u)}if(i[o].kind!==Pi.End){u="calc.parse.parseTokens: internal error: array[n] !== End in "+C(i);return O.ULS.assertTag(595980833,f.LogCategory.msoulscat_ES_EWAJS,!1,u)}var c=function(e,t,r,n,a){return{localeInfo:e,mathpack:t,refStyle:r,lexicalKind:n,origin:a,leftDelim:void 0,listSep:$o.Union,label:1,spans:[]}}(e,t,r,n,a),s=Xo(wc,i,0,c);if(!1===s){u="calc.parse.parseTokens: internal error: failed to parse "+C(i);return O.ULS.assertTag(595980834,f.LogCategory.msoulscat_ES_EWAJS,!1,u)}var l=s[0],d=s[1];if(d<o){u="calc.parse.parseTokens: internal error: consumed "+d+" out of "+o+" in "+C(i);return O.ULS.assertTag(595980835,f.LogCategory.msoulscat_ES_EWAJS,!1,u)}return si.formula(l,c.spans)}Dc.impl=Cs;var ys={getDocumentLoc:function(){return it(wt(["defaultPrintGlobals getDocumentLoc"]))},getSheetIndex:function(){return it(wt(["defaultPrintGlobals getSheetIndex"]))},getSheetName:function(){return it(wt(["defaultPrintGlobals getSheetName"]))},getNameLoc:function(){return it(wt(["defaultPrintGlobals getNameLoc"]))},getUserDefinedFuncLoc:function(){return it(wt(["defaultPrintGlobals getUserDefinedFuncLoc"]))},getSheetRangeIndexes:function(){return it(wt(["defaultPrintGlobals getSheetRangeIndexes"]))}};var Es={"=":1,"+":0,"-":0,"@":-1};function Os(e,t,r){var n,a,i,o,u=r[0],c=null!=u?Es[u]:void 0;if(null==c)return hi.failure(Di("first character is not '=', '+', '-' or '@'"));if(c<0)return hi.failure(Ii(["Lotus 1-2-3 syntax"]));var s=null!=(a=null===(n=t.config)||void 0===n?void 0:n.localeInfo)?a:e.config.localeInfo,l=null!=(o=null===(i=t.config)||void 0===i?void 0:i.refStyle)?o:e.config.refStyle,f=e.config.mathpack,d=Qo(s,f,l,t.originGridCell.value,r,c),h=Ss(s,f,l,t.lexicalKind,t.originGridCell.value,d);return hi.success(h)}function ks(e){return{parseFormula:function(t,r,n,a){if("number"==typeof t){if(null==r){return O.ULS.assertTag(595980825,f.LogCategory.msoulscat_ES_EWAJS,!1,"calc.parse.parseFormula: expected range to be defined")}var i=t,o=r;return Os(e,Ni(n,hi.gridRangeAnchor(function(e){return void 0===e.range}(o)?o:o.range),{refStyle:i}),a)}return Os(e,t,r)},formatFormula:function(t,r){return hi.printFormula(function(e){var t,r,n,a,i,o,u,c,s,l,f,d;return{config:e.config,getDocumentLoc:(r=null===(t=e.getDocumentLoc)||void 0===t?void 0:t.bind(e),null!=r?r:ys.getDocumentLoc),getSheetIndex:(a=null===(n=e.getSheetIndex)||void 0===n?void 0:n.bind(e),null!=a?a:ys.getSheetIndex),getSheetName:(o=null===(i=e.getSheetName)||void 0===i?void 0:i.bind(e),null!=o?o:ys.getSheetName),getNameLoc:(c=null===(u=e.getNameLoc)||void 0===u?void 0:u.bind(e),null!=c?c:ys.getNameLoc),getUserDefinedFuncLoc:(l=null===(s=e.getUserDefinedFuncLoc)||void 0===s?void 0:s.bind(e),null!=l?l:ys.getUserDefinedFuncLoc),getSheetRangeIndexes:(d=null===(f=e.getSheetRangeIndexes)||void 0===f?void 0:f.bind(e),null!=d?d:ys.getSheetRangeIndexes)}}(e),t,r)}}}var As=si.QualifierKind,bs=si.CellRefKind,Rs=si.NodeKind,Is=hi.ResultKind;function Ts(e){return e.kind===Is.Success}function Ns(e,t){var r=e[t];return null==r?A("ParseResultHelper.getFormulaSpan: expected span for label "+t+" to be defined"):r}function Fs(e,t,r){return!!Ts(e)&&(function(e,t,r){if(null==e||null==r)return;var n={};null!=t?t.forEach((function(e){n[e]=!0})):n["*"]=!0;var a=[];a.push(e.node);for(;a.length>0;){var i=a.pop();if(null!=i)switch(i.kind){case Rs.Literal:c("literal")&&r("literal",{label:i.label,value:i});break;case Rs.Array:i.nodes.map((function(e){return e.map((function(e){a.push(e)}))}));break;case Rs.App:if("object"!=typeof i.head)c("literal")&&r("literal",{label:i.label,value:i.head});else{var o=i.head;switch(o.kind){case Rs.Operator:c("operator")&&r("operator",{label:i.label,value:o.id});break;case Rs.Name:c("function")&&r("function",{label:i.label,name:o.whole,isClosed:i.isClosed,args:i.args});break;default:a.push(o)}}i.args.map((function(e){a.push(e)}));break;case Rs.Paren:a.push(i.node);break;case Rs.Name:if(c("namedRange")){var u=i.whole.split(".");r("namedRange",{label:i.label,name:u[0],names:u.slice(1),qualifier:s(i)})}break;case Rs.CellRef:c("range")&&l(i);break;case Rs.Bad:break;default:return k("calc.parse.traverseFormula",i)}}function c(e){return n[e]||n["*"]}function s(e){if(null!=e.qualifier){var t={};switch(e.qualifier.kind){case As.Sheet:var r=e.qualifier;t.type=As.Sheet,t.sheet=r.sheet,null!=r.document&&(t.document=r.document.document,null!=r.document.path&&(t.documentPath=r.document.path));break;case As.SheetRange:var n=e.qualifier;t.type=As.SheetRange,t.sheet1=n.sheet1,t.sheet2=n.sheet2;break;case As.Ident:var a=e.qualifier;t.type=As.Ident,t.name=a.name;break;case As.Document:var i=e.qualifier;t.document=i.document,null!=i.path&&(t.documentPath=i.path)}return t}}function l(t){if(null!=e&&null!=r)switch(t.ref.kind){case bs.Error:break;case bs.Col:var n=t.ref;r("range",{label:t.label,type:"col",startIndex:n.col1,endIndex:n.col2,span:Ns(e.spans,n.label),qualifier:s(t)});break;case bs.Row:var a=t.ref;r("range",{label:t.label,type:"row",startIndex:a.row1,endIndex:a.row2,span:Ns(e.spans,a.label),qualifier:s(t)});break;case bs.Single:var i=t.ref;r("range",{label:t.label,type:"cell",row:i.row,col:i.col,span:Ns(e.spans,i.label),qualifier:s(t)});break;case bs.Range:var o=t.ref;r("range",{label:t.label,type:"range",top:o.ref1.row,left:o.ref1.col,bottom:o.ref2.row,right:o.ref2.col,topLeftSpan:Ns(e.spans,o.ref1.label),bottomRightSpan:Ns(e.spans,o.ref2.label),qualifier:s(t)})}}}(e.value,t,r),!0)}var _s,Ms,Ds,ws={isSuccess:Ts,traverse:Fs,extractReferences:function(e){if(Ts(e)){var t=[];return Fs(e,["range","namedRange"],(function(r,n){var a={kind:r,ref:n,span:Ns(e.value.spans,n.label)};t.push(a)})),t.sort((function(e,t){return e.span.start-t.span.start})),t}}};!function(e){e.Unclosed_application="Unclosed_application",e.Unclosed_paren="Unclosed_paren",e.Unclosed_array="Unclosed_array",e.Unclosed_literal="Unclosed_literal",e.Illegal_array_literal_element="Illegal_array_literal_element",e.Empty_array_literal="Empty_array_literal",e.Irregular_array_shape="Irregular_array_shape",e.Empty_parenthesis="Empty_parenthesis",e.Missing_operation_argument="Missing_argument_for_operator",e.Bad_node="Bad_node",e.Invalid_binder="Invalid_binder",e.Empty_formula="Empty_formula",e.Invalid_rel_sheet_qualifier_in_cell="Invalid_rel_sheet_qualifier_in_cell",e.Invalid_rel_sheet_qualifier_in_name="Invalid_rel_sheet_qualifier_in_name",e.Invalid_unqualified_cell="Invalid_unqualified_cell",e.Unexpected_closing_paren="Unexpected_closing_paren",e.Unexpected_closing_brace="Unexpected_closing_brace",e.Unexpected_closing_bracket="Unexpected_closing_bracket",e.Unexpected_character="Unexpected_character",e.Unsupported_struct_ref="Unsupported_struct_ref",e.Unsupported_doc_qual="Unsupported_doc_qual"}(Ms||(Ms={})),function(e){e.Types_not_related="Types_not_related",e.Unexpected_application_head="Unexpected_application_head",e.Unexpected_application_head_with_fix="Unexpected_application_head_with_fix",e.Incorrect_number_of_operator_arguments="Incorrect_number_of_arguments_for_operator",e.Excess_function_arguments="Excess_arguments_for_function",e.Insufficient_function_arguments="Insufficient_arguments_for_function"}(Ds||(Ds={}));var Ls=((_s={})[Ms.Unclosed_application]={kind:Ms.Unclosed_application},_s[Ms.Unclosed_paren]={kind:Ms.Unclosed_paren},_s[Ms.Unclosed_array]={kind:Ms.Unclosed_array},_s[Ms.Unclosed_literal]={kind:Ms.Unclosed_literal},_s[Ms.Illegal_array_literal_element]={kind:Ms.Illegal_array_literal_element},_s[Ms.Empty_array_literal]={kind:Ms.Empty_array_literal},_s[Ms.Irregular_array_shape]={kind:Ms.Irregular_array_shape},_s[Ms.Empty_parenthesis]={kind:Ms.Empty_parenthesis},_s[Ms.Bad_node]={kind:Ms.Bad_node},_s[Ms.Invalid_binder]={kind:Ms.Invalid_binder},_s[Ms.Empty_formula]={kind:Ms.Empty_formula},_s[Ms.Invalid_rel_sheet_qualifier_in_cell]={kind:Ms.Invalid_rel_sheet_qualifier_in_cell},_s[Ms.Invalid_rel_sheet_qualifier_in_name]={kind:Ms.Invalid_rel_sheet_qualifier_in_name},_s[Ms.Invalid_unqualified_cell]={kind:Ms.Invalid_unqualified_cell},_s[Ms.Unexpected_closing_paren]={kind:Ms.Unexpected_closing_paren},_s[Ms.Unexpected_closing_brace]={kind:Ms.Unexpected_closing_brace},_s[Ms.Unexpected_closing_bracket]={kind:Ms.Unexpected_closing_bracket},_s[Ms.Unsupported_struct_ref]={kind:Ms.Unsupported_struct_ref},_s[Ms.Unsupported_doc_qual]={kind:Ms.Unsupported_doc_qual},_s[Ds.Types_not_related]={kind:Ds.Types_not_related},_s[Ds.Unexpected_application_head]={kind:Ds.Unexpected_application_head},_s[Ds.Unexpected_application_head_with_fix]={kind:Ds.Unexpected_application_head_with_fix},_s);function Us(e){switch(e.kind){case Ds.Insufficient_function_arguments:case Ds.Excess_function_arguments:return e.kind+": "+Ta(e.funcId);case Ms.Missing_operation_argument:case Ds.Incorrect_number_of_operator_arguments:return e.kind+": "+Na(e.opId);case Ms.Unexpected_character:return e.kind+": "+Ai(e.text);default:return e.kind}}var xs,Ps,Gs=hi.ReasonKind,Vs=hi.FailureError;!function(e){e[e.General=0]="General",e[e.CurrencyDec=11]="CurrencyDec",e[e.CoCurrencyDec=12]="CoCurrencyDec",e[e.Percentage0=13]="Percentage0",e[e.Percentage=14]="Percentage",e[e.MMDDYY=19]="MMDDYY",e[e.HHMMAP=23]="HHMMAP",e[e.MDYHMS=27]="MDYHMS",e[e.AbsHMMSS=31]="AbsHMMSS"}(xs||(xs={})),function(e){e.BadOperation="BadOperation",e.BadFormula="BadFormula"}(Ps||(Ps={}));var Bs,Ws,js=Object(j.a)(Object(j.a)({},Gs),Ps),Hs=Vs;function Ks(e){if(void 0!==e){var t={};return Object.keys(e).forEach((function(r){e[Number(r)].forEach((function(e){var r,n=Us(e);t[n]=(null!=(r=t[n])?r:0)+1}))})),t}}function qs(e,t,r,n,a,i){return{config:e,getDocumentLoc:t,getSheetIndex:r,getCellFormat:n,getKnownFormat:a,getSheetName:i}}function Ys(e,t,r){return{config:null!=r?r:void 0,lexicalKind:e,originGridCell:at(t.range),originSheet:at(t.sheet),allowRelativeQualifier:!1,allowUnqualifiedCell:!0}}function Js(e,t){return{config:null!=t?t:void 0,lexicalKind:Vt.NameManager,originGridCell:at(e.range),originSheet:at(e.sheet),allowRelativeQualifier:!0,allowUnqualifiedCell:!1}}function Qs(e,t){var r=St(e.range);return{config:null!=t?t:void 0,lexicalSource:e,originGridCell:at(r.range),originSheet:at(r.sheet),wrapCellReferences:!1}}!function(e){e[e.Red=0]="Red",e[e.Black=1]="Black"}(Bs||(Bs={})),function(e){e[e.DoubleBlack=2]="DoubleBlack"}(Ws||(Ws={}));var Xs=Bs.Red,zs=Bs.Black,Zs=Ws.DoubleBlack,$s={c:zs,l:void 0,r:void 0},el={c:Zs,l:void 0,r:void 0};function tl(e){return void 0===e.l}function rl(e){return e.c===Xs}function nl(e){return e.c===zs&&void 0!==e.l}function al(e){return e.c===zs&&void 0===e.l}var il=$s;function ol(e,t,r,n,a){return{c:e,l:t,key:r,value:n,r:a}}function ul(e,t){return ol(e,t.l,t.key,t.value,t.r)}function cl(e){return tl(e)?$s:ul(zs,e)}function sl(e,t,r){if(!tl(r)){var n=e.keyCompare(t,r.key);return n<0?sl(e,t,r.l):n>0?sl(e,t,r.r):r}}function ll(e,t){return!!tl(t)||!!ll(e,t.l)&&(!!e(t.key,t.value)&&ll(e,t.r))}function fl(e,t,r,n,a){if(e===zs){if(rl(t)&&rl(t.l))return ol(Xs,ul(zs,t.l),t.key,t.value,ol(zs,t.r,r,n,a));if(rl(a)&&rl(a.r))return ol(Xs,ol(zs,t,r,n,a.l),a.key,a.value,ul(zs,a.r));if(rl(t)&&rl(t.r))return ol(Xs,ol(zs,t.l,t.key,t.value,t.r.l),t.r.key,t.r.value,ol(zs,t.r.r,r,n,a));if(rl(a)&&rl(a.l))return ol(Xs,ol(zs,t,r,n,a.l.l),a.l.key,a.l.value,ol(zs,a.l.r,a.key,a.value,a.r))}if(e===Zs){if(rl(a)&&rl(a.l))return ol(zs,ol(zs,t,r,n,a.l.l),a.l.key,a.l.value,ol(zs,a.l.r,a.key,a.value,a.r));if(rl(t)&&rl(t.r))return ol(zs,ol(zs,t.l,t.key,t.value,t.r.l),t.r.key,t.r.value,ol(zs,t.r.r,r,n,a))}return ol(e,t,r,n,a)}function dl(e,t,r,n,a){return e===Xs&&t.c===Zs&&nl(a)?fl(zs,ol(Xs,cl(t),r,n,a.l),a.key,a.value,a.r):e===Xs&&nl(t)&&a.c===Zs?fl(zs,t.l,t.key,t.value,ol(Xs,t.r,r,n,cl(a))):e===zs&&t.c===Zs&&nl(a)?fl(Zs,ol(Xs,cl(t),r,n,a.l),a.key,a.value,a.r):e===zs&&nl(t)&&a.c===Zs?fl(Zs,t.l,t.key,t.value,ol(Xs,t.r,r,n,cl(a))):e===zs&&t.c===Zs&&rl(a)&&nl(a.l)?ol(zs,fl(zs,ol(Xs,cl(t),r,n,a.l.l),a.l.key,a.l.value,a.l.r),a.key,a.value,a.r):e===zs&&rl(t)&&nl(t.r)&&a.c===Zs?ol(zs,t.l,t.key,t.value,fl(zs,t.r.l,t.r.key,t.r.value,ol(Xs,t.r.r,r,n,cl(a)))):(b("calc.common.rbTree.rotate: expected R|B",t.c!==Zs&&a.c!==Zs),ol(e,t,r,n,a))}function hl(e,t,r,n){return function(e){return!rl(e)||e.l.c!==Xs&&e.r.c!==Xs?e:ul(zs,e)}(function e(t,r,n,a){if(tl(a))return ol(Xs,$s,r,n,$s);var i=t.keyCompare(r,a.key);return i<0?fl(a.c,e(t,r,n,a.l),a.key,a.value,a.r):i>0?fl(a.c,a.l,a.key,a.value,e(t,r,n,a.r)):ol(a.c,a.l,r,n,a.r)}(e,t,r,n))}function vl(e,t,r){if(tl(r))return r;if(r.c===Xs&&al(r.l)&&al(r.r))return 0===e.keyCompare(t,r.key)?$s:r;if(r.c===zs&&al(r.l)&&al(r.r))return 0===e.keyCompare(t,r.key)?el:r;if(r.c===zs&&rl(r.l)&&al(r.l.l)&&al(r.l.r)&&al(r.r)){var n=e.keyCompare(t,r.key);return n<0?ol(zs,vl(e,t,r.l),r.key,r.value,$s):n>0?r:ol(zs,$s,r.l.key,r.l.value,$s)}var a=e.keyCompare(t,r.key);if(a<0)return dl(r.c,vl(e,t,r.l),r.key,r.value,r.r);if(a>0)return dl(r.c,r.l,r.key,r.value,vl(e,t,r.r));b("calc.common.rbTree.rem: expected node",!tl(r.r));var i=function e(t){if(t.c===Xs&&al(t.l)&&al(t.r))return[t.key,t.value,$s];if(t.c===zs&&al(t.l)&&al(t.r))return[t.key,t.value,el];if(t.c===zs&&al(t.l)&&rl(t.r))return[t.key,t.value,ul(zs,t.r)];b("calc.common.rbTree.remMin: expected node",!tl(t.l));var r=e(t.l),n=r[0],a=r[1],i=r[2];return[n,a,dl(t.c,i,t.key,t.value,t.r)]}(r.r),o=i[0],u=i[1],c=i[2];return dl(r.c,r.l,o,u,c)}function pl(e,t,r){var n=vl(e,t,function(e){return nl(e)&&e.l.c===zs&&e.r.c===zs?ul(Xs,e):e}(r));return b("calc.common.rbTree.remove: expected R|B",n.c===Xs||n.c===zs),n}var ml=function(){function e(e,t,r){this.root=e,this.count=t,this.keyCompare=r}return e.create=function(t){return new e(il,0,t)},e.prototype.getCount=function(){return this.count},e.prototype.getValue=function(e){var t;return null===(t=sl(this,e,this.root))||void 0===t?void 0:t.value},e.prototype.getEntry=function(e){return sl(this,e,this.root)},e.prototype.contains=function(e){return void 0!==this.getValue(e)},e.prototype.forEach=function(e){return ll(e,this.root)},e.prototype.setValue=function(t,r){return new e(hl(this,t,r,this.root),this.contains(t)?this.count:this.count+1,this.keyCompare)},e.prototype.remove=function(t){return this.contains(t)?new e(pl(this,t,this.root),this.count-1,this.keyCompare):this},e.prototype.getOrSetValue=function(t,r){var n=this.getValue(t);if(void 0!==n)return[this,n];var a=r();return[new e(hl(this,t,a,this.root),this.count+1,this.keyCompare),a]},e.prototype.filter=function(t){var r=this,n=il,a=0;return this.forEach((function(e,i){return t(e,i)&&(n=hl(r,e,i,n),a+=1),!1})),new e(n,a,this.keyCompare)},e}(),gl=function(){function e(e,t,r){R("calc.common.StrictArray2D",e),R("calc.common.StrictArray2D",t);var n=r.length;n<e&&A("calc.common.StrictArray2D: expected elements.length >= "+e+"; given "+n);for(var a=0;a<n;a+=1){var i=r[a].length;i<t&&A("calc.common.StrictArray2D: expected elements["+a+"].length >= "+e+"; given "+i)}this.rows=e,this.cols=t,this.elements=r}return e.prototype.get=function(e,t){return T("calc.common.StrictArray2D.get",e,this.rows),T("calc.common.StrictArray2D.get",t,this.cols),this.elements[e][t]},e.prototype.strict=function(){return this},e.prototype.map=function(e){var t=this;return new Sl(this.rows,this.cols,(function(r,n){return e(t.elements[r][n])}))},e}();var Cl=function(){function e(e,t,r,n,a,i){R("calc.common.StrictSparseArray2D",e),R("calc.common.StrictSparseArray2D",t),T("calc.common.StrictSparseArray2D",r,e+1),T("calc.common.StrictSparseArray2D",n,t+1);var o=a.length;o<r&&A("calc.common.StrictSparseArray2D: expected elements.length >= "+r+"; given "+o);for(var u=0;u<o;u+=1){var c=a[u].length;c<n&&A("calc.common.StrictSparseArray2D: expected elements["+u+"].length >= "+n+"; given "+c)}this.rows=e,this.cols=t,this.denseRows=r,this.denseCols=n,this.denseElements=a,this.sparseElement=i}return e.prototype.get=function(e,t){return T("calc.common.StrictSparseArray2D.get",e,this.rows),T("calc.common.StrictSparseArray2D.get",t,this.cols),e<this.denseRows&&t<this.denseCols?this.denseElements[e][t]:this.sparseElement},e.prototype.getSparse=function(){return this.sparseElement},e.prototype.strict=function(){return this},e.prototype.map=function(e){var t=this;return new yl(this.rows,this.cols,this.denseRows,this.denseCols,(function(r,n){return e(t.denseElements[r][n])}),(function(){return e(t.sparseElement)}))},e}(),Sl=function(){function e(e,t,r){R("calc.common.NonstrictArray2D",e),R("calc.common.NonstrictArray2D",t),this.rows=e,this.cols=t,this.func=r}return e.prototype.get=function(e,t){return T("calc.common.NonstrictArray2D.get",e,this.rows),T("calc.common.NonstrictArray2D.get",t,this.cols),this.func(e,t)},e.prototype.strict=function(){var e=El(this.rows,this.cols,this.func);return new gl(this.rows,this.cols,e)},e.prototype.map=function(t){var r=this;return new e(this.rows,this.cols,(function(e,n){return t(r.func(e,n))}))},e}(),yl=function(){function e(e,t,r,n,a,i){R("calc.common.NonstrictSparseArray2D",e),R("calc.common.NonstrictSparseArray2D",t),T("calc.common.NonstrictSparseArray2D",r,e+1),T("calc.common.NonstrictSparseArray2D",n,t+1),this.rows=e,this.cols=t,this.denseRows=r,this.denseCols=n,this.denseFunc=a,this.sparseFunc=i}return e.prototype.get=function(e,t){return T("calc.common.NonstrictSparseArray2D.get",e,this.rows),T("calc.common.NonstrictSparseArray2D.get",t,this.cols),e<this.denseRows&&t<this.denseCols?this.denseFunc(e,t):this.sparseFunc()},e.prototype.getSparse=function(){return this.sparseFunc()},e.prototype.strict=function(){var e=El(this.denseRows,this.denseCols,this.denseFunc),t=this.sparseFunc();return new Cl(this.rows,this.cols,this.denseRows,this.denseCols,e,t)},e.prototype.map=function(t){var r=this;return new e(this.rows,this.cols,this.denseRows,this.denseCols,(function(e,n){return t(r.denseFunc(e,n))}),(function(){return t(r.sparseFunc())}))},e}();function El(e,t,r){for(var n=[],a=0;a<e;a+=1){for(var i=[],o=0;o<t;o+=1)i[o]=r(a,o);n[a]=i}return n}function Ol(e,t,r){for(var n=[],a=[],i=0;i<t;i+=1)a[i]=r;for(var o=0;o<e;o+=1)n[o]=a;return n}function kl(e,t,r){return new Sl(e,t,(function(e,t){return r}))}var Al,bl=hi.ResultKind,Rl=hi.ReasonKind,Il=hi.notImplemented,Tl=hi.unavailable;!function(e){e.Timeout="Timeout",e.Stopped="Stopped",e.NameCycle="NameCycle",e.CellCycle="CellCycle",e.PreviousFailure="PreviousFailure",e.PreviousNameFailure="PreviousNameFailure",e.LimitExceeded="LimitExceeded",e.IllFormedFormula="IllFormedFormula"}(Al||(Al={}));var Nl=Object(j.a)(Object(j.a)({},Rl),Al);function Fl(e){return{config:e}}function _l(e,t,r){return{config:null!=r?r:void 0,lexicalKind:e,originGridCell:at(t)}}var Ml,Dl,wl,Ll=function(e,t){return I("calc.runtime.interval: end",t),T("calc.runtime.interval: start",e,t),{start:e,end:t}};function Ul(e,t,r){return{kind:Nl.IllFormedFormula,message:e,mode:t,diagnostics:r}}function xl(e){return{kind:Ml.FinalValue,oper:e}}function Pl(e){return{kind:Ml.PendingValue,anchor:e}}function Gl(e,t){return{kind:Ml.Formula,source:e,formula:t}}!function(e){e.FinalValue="FinalValue",e.PendingValue="PendingValue",e.Formula="Formula"}(Ml||(Ml={})),function(e){e[e.Continue=1]="Continue",e[e.Stop=2]="Stop"}(Dl||(Dl={})),function(e){e[e.CellChain=0]="CellChain",e[e.NameChain=1]="NameChain",e[e.LambdaCalls=2]="LambdaCalls",e[e.LambdaDepth=3]="LambdaDepth"}(wl||(wl={}));var Vl={kind:Nl.Stopped};function Bl(e,t){return{arity:e,func:t}}function Wl(e,t,r,n,a,i,o,u,c,s,l,f,d,h,v,p,m,g,C,S,y,E){return{config:e,getDocumentLoc:t,getSheetIndex:r,getSheetName:n,getSheetRangeIndexes:a,getNameLoc:i,getUserDefinedFuncLoc:o,getCellValue:u,getCellValues:c,getWorksheetFunc:s,getUserDefinedFunc:l,getNameFormula:f,getCellFormula:d,getUsedRange:h,interruptToken:[Dl.Continue],getHiddenRows:v,isInFilterMode:p,schedulerConfig:null!=y?y:{},limits:null!=E?E:{},setCellValue:m,setCellValues:g,setCellFailure:C,setDynamicPrecs:S}}var jl,Hl=function(e,t,r,n,a,i,o,u,c){return{lexicalSource:e,originGridCell:t,originSheet:r,calcingArray:n,reflectionGridCell:a,reflectionSheet:i,implicitIntersect:o,wrapCellReferences:u,followHyperlinks:c}};function Kl(e){return{kind:Nl.NameCycle,names:e}}function ql(e){return{kind:Nl.CellCycle,cells:e}}function Yl(e){return{kind:Nl.PreviousFailure,range:e}}function Jl(e){return{kind:Nl.LimitExceeded,limit:e}}function Ql(e){return{kind:bl.Paused,reason:Nl.Timeout,resume:e}}function Xl(e){if(e.kind===bl.Failure)return e.reason.kind}function zl(e,t,r){return{kind:e,machine:t,receiver:r}}!function(e){e[e.Next=1]="Next",e[e.CallMachine=2]="CallMachine"}(jl||(jl={}));var Zl=zl(jl.Next,void 0,void 0);function $l(e,t){return zl(jl.CallMachine,e,t)}var ef={receiveResult:function(e){return ot(e)?Zl:e}};function tf(){return ef}var rf,nf=function(e){function t(t,r){var n=this.constructor,a=e.call(this,"Cycle detected: tried to call an already-running Machine")||this;a.machine=t,a.stackDepth=r;var i=n.prototype;return Object.getPrototypeOf(a)!==i&&(null!=Object.setPrototypeOf?Object.setPrototypeOf(a,i):a.__proto__=i),a}return Object(j.c)(t,e),t}(Error),af=function(){function e(e){this.numSteps=0,this.stack=[],this.pushFrame($l(e,{receiveResult:function(e){return e}})),this.transition=Zl}return e.resetStats=function(){e.maxStackDepth=0,e.numPauses=0,e.numCycles=0},e.prototype.pushFrame=function(t){var r=this.stack.length,n=t.machine;if(n.isRunning)throw e.numCycles+=1,new nf(n,r);n.isRunning=!0,this.stack.push(t),e.maxStackDepth<r+1&&(e.maxStackDepth=r+1)},e.prototype.step=function(){this.numSteps+=1;var e=this.transition;try{switch(e.kind){case jl.Next:return void(this.transition=this.stack[this.stack.length-1].machine.next());case jl.CallMachine:return this.pushFrame(e),void(this.transition=e.machine.next());default:var t=this.stack.pop();return t?(t.machine.isRunning=!1,void(this.transition=t.receiver.receiveResult(e))):e}}catch(e){return void(this.transition=it(ut(e)))}},e.prototype.run=function(t){if(void 0===t&&(t=function(){return!1}),this.result)return this.result;try{for(;;){var r=this.step();if(r)return this.result=r;if(t())return void(e.numPauses+=1)}}catch(e){return this.result=it(ut(e))}},e.maxStackDepth=0,e.numPauses=0,e.numCycles=0,e}(),of=function(){function e(e){this.machines=e,this.isRunning=!1,this.values=[]}return e.prototype.next=function(){return this.values.length<this.machines.length?$l(this.machines[this.values.length],this):at(this.values)},e.prototype.receiveResult=function(e){return ot(e)?(this.values.push(e.value),this.next()):e},e}();function uf(e){return{kind:rf.MachineCall,machine:e}}function cf(e){return"object"==typeof e&&e.kind===rf.MachineCall}!function(e){e.MachineCall="MachineCall"}(rf||(rf={}));var sf=function(){function e(e,t,r,n){this.context=e,this.rows=t,this.cols=r,this.func=n,this.isRunning=!1,this.toDeref=void 0,this.row=[],this.opers=[]}return e.prototype.next=function(){var e;try{if(void 0!==this.toDeref){var t=this.context.coerceOper(_f(this.context,this.toDeref,!0),mf);b("calc.runtime.ArrayMachine.next",!Ef(t)&&!Of(t)),yf(t)&&(t=t.opers[0][0]),this.row.push(t),this.row.length===this.cols&&(this.opers.push(this.row),this.row=[]),this.toDeref=void 0}if(this.opers.length>=this.rows)return at(Fe(this.rows,this.cols,this.opers));var r=this.func(this.opers.length,this.row.length);return cf(r)?$l(r.machine,this):(this.toDeref=r,Zl)}catch(t){return null!=(e=this.context.handleEvaluationError(t))?e:it(ut(t))}},e.prototype.receiveResult=function(e){return ot(e)?(this.toDeref=e.value,this.next()):e},e}(),lf=ii.gridCell,ff=ui.arrayOper,df=ui.naErrorOper,hf=ui.OperKind,vf=hf.Number|hf.String|hf.Boolean|hf.Error|hf.Rich|hf.Array,pf=hf.Number|hf.String|hf.Boolean|hf.Error|hf.Blank|hf.Rich,mf=pf|hf.Array;function gf(e,t,r){var n=e+": generated Excel error, type "+t+"; "+r;O.ULS.traceTag(596120270,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Verbose,n)}function Cf(e){return"object"==typeof e&&e.kind===hf.Error}function Sf(e){return"object"==typeof e&&e.kind===hf.Blank}function yf(e){return"object"==typeof e&&e.kind===hf.Array}function Ef(e){return"object"==typeof e&&e.kind===hf.Missing}function Of(e){return"object"==typeof e&&e.kind===hf.Range}function kf(e){return"object"==typeof e&&e.kind===hf.Rich}function Af(e){return e.kind===Be.Success?e.value:void 0}function bf(e,t){switch(e.kind){case Be.Success:return at(xl(e.value));case Be.Failure:return it(Yl(t))}}function Rf(e,t,r){var n=yf(r)?function(e,t,r,n,a,i){if(e===r&&t===n)return a;if(1===e&&1===t)return Ol(r,n,void 0===a[0]?i:a[0][0]);var o,u=[];o=1===e?function(e,r){return r<t?a[0][r]:i}:1===t?function(t,r){return t<e?a[t][0]:i}:function(r,n){return r<e&&n<t?a[r][n]:i};for(var c=0;c<r;c+=1){u.push([]);for(var s=0;s<n;s+=1)u[c][s]=o(c,s)}return u}(r.rows,r.cols,e,t,r.opers,df):Ol(e,t,r);return ff(e,t,n)}function If(e,t){var r=e.row,n=e.col,a=e.rows,i=e.cols,o=t.row,u=t.col,c=t.rows,s=t.cols,l=vr(r,o),f=vr(n,u);return Xt(l,f,pr(r+a,o+c)-l,pr(n+i,u+s)-f)}function Tf(e){return 0===e.length&&A("calc.runtime.gridRangesJoin: expected nonempty range array"),e.reduce(If)}function Nf(e,t){var r=e.row,n=e.col,a=e.rows,i=e.cols,o=t.row,u=t.col,c=t.rows,s=t.cols,l=pr(r,o),f=pr(n,u),d=vr(r+a,o+c)-l,h=vr(n+i,u+s)-f;if(!(d<=0||h<=0))return Xt(l,f,d,h)}function Ff(e){return e.rows*e.cols}function _f(e,t,r){if(!Of(t))return t;if(!ct(t.sheets))return Ee;if(!r)return 1===t.ranges.length&&lt(t.ranges[0])?e.dereferenceOper(t,P.All&~hf.Range):e.dereferenceOper(t,hf.Array);var n=e.dereferenceOper(t,P.All&~(hf.Range|hf.Array));return yf(n)?df:n}function Mf(e){var t=function(e){return e&~(hf.Array|hf.Range)};return ve(e.minArgs,e.headTypes.map(t),e.restTypes.map(t),e.tailTypes.map(t),e.returnType,e.staticPrecs,e.flags)}function Df(e,t,r,n,a){if("object"!=typeof n)return kl(t,r,n);switch(n.kind){case hf.Missing:case hf.Blank:return kl(t,r,e.zero);case hf.Array:return 0!=(a&hf.Array)?kl(t,r,n):function(e,t,r,n){return r.rows===e&&r.cols===t?r:1===r.rows&&1===r.cols?kl(e,t,r.get(0,0)):1===r.rows?new Sl(e,t,(function(e,t){return t<r.cols?r.get(0,t):n})):1===r.cols?new Sl(e,t,(function(e,t){return e<r.rows?r.get(e,0):n})):new Sl(e,t,(function(e,t){return e<r.rows&&t<r.cols?r.get(e,t):n}))}(t,r,new gl(n.rows,n.cols,n.opers),df);case hf.Range:default:return kl(t,r,n)}}function wf(e,t,r,n){for(var a=0,i=0,o=0;o<n.length;o+=1){var u=n[o];yf(u)&&0==(It(t,o,n.length)&hf.Array)?(a=pr(a,u.rows),i=pr(i,u.cols)):(a=pr(a,1),i=pr(i,1))}var c=n.map((function(r,n,o){return Df(e.mathpack,a,i,r,It(t,n,o.length))}));return uf(new sf(e,a,i,(function(e,t){return r(c.map((function(r){return r.get(e,t)})))})))}var Lf=si.NodeKind,Uf=si.QualifierKind,xf=si.BadType,Pf=ui.OperKind,Gf=ui.ErrorType,Vf=fi.SignatureType,Bf=fi.SpecialPrecs,Wf=fi.getOperatorType,jf=fi.WorksheetFuncId,Hf=fi.getWorksheetFuncType,Kf=hi.operKind,qf=hi.getArguments,Yf=hi.getArgType,Jf=hi.defaultLiteralVisitor,Qf=hi.defaultFormulaVisitor,Xf=hi.dispatch,zf=hi.startVisit,Zf=hi.isUnqualifiedNameNode,$f={};function ed(e,t){return{context:e,result:t}}function td(e){return function(t){return t.kind===Lf.Literal&&e(t.oper)}}var rd=td((function(e){return Kf(e)===Pf.Missing})),nd=td((function(e){return 0!=(Kf(e)&(Pf.String|Pf.Error|Pf.Boolean))}));function ad(e,t,r,n){void 0===n&&(n=!1),n||(e.errorData=e.reportError(t,r,e.errorData))}function id(e,t){return t!==Pf.Range||0!=(e&Pf.Range)}function od(e,t){switch(t.type){case xf.Sequence:if(i=e.localeInfo,2===(o=t.contents).length&&Zf(o[0])&&gd(i,o[1]))return ad(e,t,Ls.Unsupported_struct_ref);if(null!=function(e,t){if(2!==t.length)return;var r=t[0],n=t[1];if(gd(e,r))return function(e){return e.kind===Lf.Name&&null!=e.qualifier&&e.qualifier.kind===Uf.Ident}(n)?Lf.Name:function(e){return e.kind===Lf.CellRef&&null!=e.qualifier&&e.qualifier.kind===Uf.Sheet&&null==e.qualifier.document}(n)?Lf.CellRef:void 0;if(function(e,t){return t.kind===Lf.Bad&&t.type===xf.Qualifier&&t.contents.indexOf(e.leftBracket)>=0}(e,r))return Zf(n)?Lf.Name:function(e){return e.kind===Lf.CellRef&&null==e.qualifier}(n)?Lf.CellRef:void 0;return}(e.localeInfo,t.contents))return ad(e,t,Ls.Unsupported_doc_qual);for(var r=0,n=t.contents;r<n.length;r++){var a=n[r];if(a.kind===Lf.Bad)return od(e,a)}return ad(e,t,Ls.Bad_node);case xf.Unexpected:switch(t.contents){case")":return ad(e,t,Ls.Unexpected_closing_paren);case e.localeInfo.rightBrace:return ad(e,t,Ls.Unexpected_closing_brace);case e.localeInfo.rightBracket:return ad(e,t,Ls.Unexpected_closing_bracket);default:return ad(e,t,{kind:Ms.Unexpected_character,text:t.contents})}case xf.CellRef:case xf.Qualifier:return ad(e,t,Ls.Bad_node)}var i,o}function ud(e,t){if(t.kind===Lf.Literal)switch(ad(e,t,Ls.Unclosed_literal,t.isClosed),Kf(t.oper)){case Pf.Number:case Pf.Boolean:case Pf.String:case Pf.Error:return;default:return void ad(e,t,Ls.Illegal_array_literal_element)}ad(e,t,Ls.Illegal_array_literal_element)}function cd(e,t,r){ad(e,t,Ls.Types_not_related,id(Pf.Array,r)),ad(e,t,Ls.Unclosed_array,t.isClosed);var n=t.nodes.length>0;if(ad(e,t,Ls.Empty_array_literal,n),!n)return ed(e,r);for(var a=t.nodes[0].length,i=0;i<t.nodes.length;i+=1){var o=t.nodes[i],u=o.length;ad(e,t,Ls.Irregular_array_shape,u===a);for(var c=0;c<u;c+=1)ud(e,o[c])}return ed(e,r)}function sd(e,t,r){if(e.earlyExit&&!e.isOk())throw $f;switch(t.kind){case Lf.Array:return cd(e,t,r);case Lf.Paren:return ad(e,t,Ls.Unclosed_paren,t.isClosed),ad(e,t,Ls.Empty_parenthesis,!rd(t.node)),sd(e,t.node,r);case Lf.Bad:case Lf.Name:case Lf.CellRef:case Lf.App:case Lf.Literal:var n=hd(e,t);return ad(e,t,Ls.Types_not_related,id(n.result,r)),n.result=r,n;default:return k("calc.analyze.checker.check: unhandled formula case",t)}}function ld(e,t,r){return Zf(r)?(ad(e,r,Ls.Invalid_binder,!t.contains(r.whole)),t.setValue(r.whole,!0)):(ad(e,r,Ls.Invalid_binder),t)}function fd(e,t,r){var n,a=Hf(t),i=a.minArgs,o=a.headTypes,u=a.restTypes,c=a.tailTypes,s=r.args,l=s.length,f=qf(r),d=f.length;d<i&&ad(e,void 0===(n=s[l-1])?r:n,{kind:Ds.Insufficient_function_arguments,funcId:t});0===u.length&&d>o.length&&ad(e,void 0===(n=s[l-1])?r:n,{kind:Ds.Excess_function_arguments,funcId:t});u.length>1&&d>o.length&&((d-o.length)%u.length>c.length&&ad(e,void 0===(n=s[l-1])?r:n,{kind:Ds.Insufficient_function_arguments,funcId:t}));for(var h=0;h<d;h+=1)sd(e,f[h],Yf(a,h,d));return e.specialDependencies|=a.staticPrecs,function(e,t,r){switch(t){case jf.LET:case jf.LETREC:if(!En(t===jf.LET?hn.CalcLetFunction:hn.CalcLetRecFunction))return;r.length>=3&&r.length%2!=1&&ad(e,r[r.length-1],{kind:Ds.Insufficient_function_arguments,funcId:t});for(var n=e.localeInfo,a=ml.create(n.stringCompareCI),i=0;i+1<r.length;i+=2)a=ld(e,a,r[i]);return;case jf.FUN:if(!En(hn.CalcFunFunctions))return;for(n=e.localeInfo,a=ml.create(n.stringCompareCI),i=0;i<r.length-1;i+=1)a=ld(e,a,r[i])}}(e,t,s),ed(e,a.returnType)}function dd(e,t){ad(e,t,Ls.Unclosed_application,t.isClosed);var r=t.args;if(bt(t.head))return function(e,t,r){var n=Wf(t.id),a=r.length,i=a===n.minArgs;ad(e,t,{kind:Ds.Incorrect_number_of_operator_arguments,opId:t.id},i);for(var o=0;o<a;o+=1){var u=r[o];rd(u)&&(i=!1,ad(e,u,{kind:Ms.Missing_operation_argument,opId:t.id})),sd(e,u,Yf(n,o,a))}return i?(e.specialDependencies|=n.staticPrecs,ed(e,n.returnType)):ed(e,Vf.All)}(e,t.head,r);if(Zf(t.head)){var n=Gt(e.localeInfo,t.head.whole);if(void 0!==n)return fd(e,n,t)}for(var a=0;a<r.length;a+=1)sd(e,r[a],Vf.All);var i=t.head,o=hd(e,i);return id(o.result,Pf.Range)||0!=(o.result&(Pf.Array|Pf.Rich))||ad(e,i,nd(i)||i.kind===Lf.Array?Ls.Unexpected_application_head:Ls.Unexpected_application_head_with_fix),ed(e,Vf.All)}function hd(e,t){if(e.earlyExit&&!e.isOk())throw $f;switch(t.kind){case Lf.App:return dd(e,t);case Lf.Array:return cd(e,t,Pf.Array);case Lf.Bad:return od(e,t),ed(e,Vf.All);case Lf.CellRef:return e.locals.allowRelativeQualifier||void 0===t.qualifier||t.qualifier.kind!==Uf.Relative?e.locals.allowUnqualifiedCell||void 0!==t.qualifier?ed(e,Pf.Range):(ad(e,t,Ls.Invalid_unqualified_cell),ed(e,Vf.All)):(ad(e,t,Ls.Invalid_rel_sheet_qualifier_in_cell),ed(e,Vf.All));case Lf.Literal:return ad(e,t,Ls.Unclosed_literal,t.isClosed),ed(e,Kf(t.oper)|(Cf(t.oper)&&t.oper.type===Gf.REF?Pf.Range:0));case Lf.Name:return e.locals.allowRelativeQualifier||void 0===t.qualifier||t.qualifier.kind!==Uf.Relative||ad(e,t,Ls.Invalid_rel_sheet_qualifier_in_name),ed(e,Vf.All);case Lf.Paren:return ad(e,t,Ls.Unclosed_paren,t.isClosed),ad(e,t,Ls.Empty_parenthesis,!rd(t.node)),hd(e,t.node);default:return k("calc.analyze.checker.infer: unhandled formula case",t)}}var vd={ok:!0,isOk:sr,collect:function(e,t,r){return!1}};function pd(e,t,r,n){var a,i;void 0===n&&(n=!0);var o={globals:e,locals:t,localeInfo:(i=null===(a=t.config)||void 0===a?void 0:a.localeInfo,null!=i?i:e.config.localeInfo),reportError:r.collect,isOk:function(){return r.isOk(o.errorData)},earlyExit:n,specialDependencies:Bf.None,errorData:r.ok};return o}function md(e,t){try{return ad(e,t.node,Ls.Empty_formula,!rd(t.node)),sd(e,t.node,Vf.All)}catch(t){return t!==$f&&O.ULS.traceTag(595952020,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,"calc.analyze.check.runChecker: Exception "+p(t)),ed(e,Vf.All)}}function gd(e,t){if(t.kind!==Lf.Bad||t.type!==xf.Sequence||3!==t.contents.length)return!1;var r=t.contents[0],n=t.contents[2];return r.kind===Lf.Bad&&r.type===xf.Unexpected&&r.contents===e.leftBracket&&(n.kind===Lf.Bad&&n.type===xf.Unexpected&&n.contents===e.rightBracket)}function Cd(e){if(e.kind===Lf.Literal&&e.isClosed)switch(Kf(e.oper)){case Pf.Number:case Pf.Boolean:case Pf.String:case Pf.Error:return!0;default:return!1}return!1}function Sd(e,t,r){var n,a,i=r.head,o=i.kind!==Lf.Operator;if(!r.isClosed||r.args.some((function(r){return!yd(e,t,r,o)})))return!1;if(i.kind===Lf.Operator)return(c=Wf(i.id)).minArgs===r.args.length;if(!yd(e,t,i,!1))return!1;if(Zf(i)){var u=Gt(null!=(a=null===(n=t.config)||void 0===n?void 0:n.localeInfo)?a:e.config.localeInfo,i.whole);if(void 0!==u){var c,s=(c=Hf(u)).minArgs,l=c.headTypes,f=c.restTypes,d=c.tailTypes,h=qf(r).length;if(h<s)return!1;if(0===f.length&&h>l.length)return!1;if(f.length>1&&h>l.length)if((h-l.length)%f.length>d.length)return!1;return function(e,t){switch(e){case jf.LET:case jf.LETREC:if(!En(e===jf.LET?hn.CalcLetFunction:hn.CalcLetRecFunction))return!0;if(t.length%2!=1)return!1;for(var r=0;r+1<t.length;r+=2)if(!Zf(t[r]))return!1;return!0;case jf.FUN:return!En(hn.CalcFunFunctions)||t.slice(0,t.length-1).every(Zf);default:return!0}}(u,r.args)}}return!0}function yd(e,t,r,n){switch(r.kind){case Lf.Literal:return r.isClosed&&(!!n||Kf(r.oper)!==Pf.Missing);case Lf.Name:case Lf.CellRef:return t.allowRelativeQualifier||!(void 0!==r.qualifier&&r.qualifier.kind===Uf.Relative);case Lf.Array:return r.isClosed&&r.nodes.length>0&&r.nodes.every((function(e){return t=e,n=r.nodes[0].length,t.length===n&&t.every(Cd);var t,n}));case Lf.App:return Sd(e,t,r);case Lf.Paren:return r.isClosed&&yd(e,t,r.node,!1);case Lf.Bad:return!1;default:return k("calc.analyze.isWF",r)}}var Ed=Qf(Jf((function(e){return 1})),(function(e){return 1}),{vArray:function(e){var t=-1;return e.nodes.forEach((function(e){e.forEach((function(e){var r=Xf(e,Ed);t=Math.max(t,r)}))})),1+t},vRange:function(e){var t=Xf(e.ref1,Ed),r=Xf(e.ref2,Ed);return 1+Math.max(t,r)},vBad:function(e){if(e.type===xf.Sequence){var t=-1;return e.contents.forEach((function(e){var r=Xf(e,Ed);t=Math.max(t,r)})),1+t}return 1},vCellRef:function(e){var t=-1;if(void 0!==e.qualifier){var r=Xf(e.qualifier,Ed);t=Math.max(t,r)}return 1+Math.max(t,Xf(e.ref,Ed))},vParen:function(e){return 1+Xf(e.node,Ed)},vApp:function(e){var t=-1;return e.args.forEach((function(e){var r=Xf(e,Ed);t=Math.max(t,r)})),1+t}});var Od,kd=[];function Ad(e,t,r,n){if(En(hn.CalcStrictFormulaChecking))if(kd.length<10){var a=(i=r.node,zf(i,Ed,-1));kd.push(a)}else O.ULS.traceTag(595957962,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,"calc.analyze.checkFormula: 10 tree depths = "+kd.join("; ")),kd=[];var i,o=function(e,t,r){var n=md(pd(e,t,vd),r).context.errorData;return Object(j.a)(Object(j.a)({},r),{isWellFormed:n})}(e,t,r);if(!En(hn.CalcStrictFormulaChecking)){var u=yd(e,t,r.node,!1);if(o.isWellFormed!==u){var c=rr(Yt(Kt(void 0,"Book1"),0),Zt(0,0));O.ULS.traceTag(592995977,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,"calc.analyze.checkFormula: old isWellFormed = "+u+", new isWellFormed = "+o.isWellFormed+"; operation: "+n+"; anonymize: "+ai(r,Bt(c)))}}return o}var bd=si.NodeKind,Rd=ui.OperKind,Id=fi.OperatorId,Td=fi.getWorksheetFuncType,Nd=fi.WorksheetFuncId,Fd=hi.success,_d=hi.failure,Md=hi.operKind,Dd=hi.isSuccess,wd=hi.getArguments,Ld=hi.unavailable,Ud=hi.sheetGridRangeAnchor,xd=hi.createResolutionHandler,Pd=hi.createResolver,Gd=hi.ResolveReasonKind,Vd=hi.isSheetGridRange,Bd=hi.isValidArgsLength,Wd={kind:js.BadOperation},jd={kind:js.BadFormula},Hd={getDocumentLoc:function(){return _d(Ld(["defaultInferenceGlobals getDocumentLoc"]))},getSheetIndex:function(){return _d(Ld(["defaultInferenceGlobals getSheetIndex"]))},getSheetName:function(){return Fd("not used")},getNameLoc:function(){return _d(Ld(["defaultInferenceGlobals getNameLoc"]))},getUserDefinedFuncLoc:function(){return _d(Ld(["defaultInferenceGlobals getUserDefinedFuncLoc"]))},getSheetRangeIndexes:function(){return Fd(Qt([],0))},getCellFormat:function(){return _d(Ld(["defaultInferenceGlobals getCellFormat"]))},getKnownFormat:function(){return _d(Ld(["defaultInferenceGlobals getKnownFormat"]))}};function Kd(e){var t,r,n,a,i,o,u,c;return{config:e.config,getDocumentLoc:(r=null===(t=e.getDocumentLoc)||void 0===t?void 0:t.bind(e),null!=r?r:Hd.getDocumentLoc),getSheetIndex:(a=null===(n=e.getSheetIndex)||void 0===n?void 0:n.bind(e),null!=a?a:Hd.getSheetIndex),getSheetName:Hd.getSheetName,getNameLoc:(o=null===(i=e.getNameLoc)||void 0===i?void 0:i.bind(e),null!=o?o:Hd.getNameLoc),getUserDefinedFuncLoc:(c=null===(u=e.getUserDefinedFuncLoc)||void 0===u?void 0:u.bind(e),null!=c?c:Hd.getUserDefinedFuncLoc),getSheetRangeIndexes:Hd.getSheetRangeIndexes}}function qd(e){var t,r,n,a,i,o,u,c,s,l,f,d;return{getDocumentLoc:(r=null===(t=e.getDocumentLoc)||void 0===t?void 0:t.bind(e),null!=r?r:Hd.getDocumentLoc),getSheetIndex:(a=null===(n=e.getSheetIndex)||void 0===n?void 0:n.bind(e),null!=a?a:Hd.getSheetIndex),getNameLoc:(o=null===(i=e.getNameLoc)||void 0===i?void 0:i.bind(e),null!=o?o:Hd.getNameLoc),getUserDefinedFuncLoc:(c=null===(u=e.getUserDefinedFuncLoc)||void 0===u?void 0:u.bind(e),null!=c?c:Hd.getUserDefinedFuncLoc),getCellFormat:(l=null===(s=e.getCellFormat)||void 0===s?void 0:s.bind(e),null!=l?l:Hd.getCellFormat),getKnownFormat:(d=null===(f=e.getKnownFormat)||void 0===f?void 0:f.bind(e),null!=d?d:Hd.getKnownFormat)}}function Yd(e,t,r,n){return{strongFormat:e,category:t,iformat:r,decimals:n}}var Jd,Qd={Number:1,Currency:2,Accounting:2,Percentage:3,Date:4,Time:5,Fraction:6,Scientific:7,Text:8,Custom:9,Special:9,General:0};!function(e){e[e.Propagate=-1]="Propagate",e[e.Ignore=-2]="Ignore"}(Jd||(Jd={}));var Xd=((Od={})[Nd.INT]=Jd.Propagate,Od[Nd.MOD]=Jd.Propagate,Od[Nd.ROUND]=Jd.Propagate,Od[Nd.SUM]=Jd.Propagate,Od[Nd.TRUNC]=Jd.Propagate,Od[Nd.AVERAGE]=Jd.Propagate,Od[Nd.MAX]=Jd.Propagate,Od[Nd.MEDIAN]=Jd.Propagate,Od[Nd.MIN]=Jd.Propagate,Od[Nd.ROUNDUP]=Jd.Propagate,Od[Nd.ROUNDDOWN]=Jd.Propagate,Od[Nd.NPV]=xs.CoCurrencyDec,Od[Nd.PV]=xs.CoCurrencyDec,Od[Nd.FV]=xs.CoCurrencyDec,Od[Nd.PMT]=xs.CoCurrencyDec,Od[Nd.RATE]=xs.Percentage0,Od[Nd.MIRR]=xs.Percentage0,Od[Nd.IRR]=xs.Percentage0,Od[Nd.DATE]=xs.MMDDYY,Od[Nd.TIME]=xs.HHMMAP,Od[Nd.NOW]=xs.MDYHMS,Od[Nd.SLN]=xs.CoCurrencyDec,Od[Nd.SYD]=xs.CoCurrencyDec,Od[Nd.DDB]=xs.CoCurrencyDec,Od[Nd.IPMT]=xs.CoCurrencyDec,Od[Nd.PPMT]=xs.CoCurrencyDec,Od[Nd.TODAY]=xs.MMDDYY,Od[Nd.VDB]=xs.CoCurrencyDec,Od[Nd.DB]=xs.CoCurrencyDec,Od);var zd=[["General","Number","Currency","Percentage","Date","Time","Fraction","Scientific","Text","Custom"],["General","Number","Currency","Percentage","Date","Time","Number","Scientific","Text","Custom"],["General","General","Currency","General","General","General","Currency","Currency","Text","Custom"],["General","General","General","Percentage","General","General","Percentage","Percentage","Text","Custom"],["General","General","General","General","General","Date","General","General","Text","Custom"],["General","General","General","General","General","Time","General","General","Text","Custom"],["General","General","General","General","General","General","Fraction","Scientific","Text","Custom"],["General","General","General","General","General","General","General","Scientific","Text","Custom"],["General","General","General","General","General","General","General","General","Text","Custom"],["General","General","General","General","General","General","General","General","General","Custom"]],Zd=[["General","Number","Currency","General","Date","Time","Fraction","Scientific","Text","Custom"],["General","Number","Currency","Number","Date","Time","Fraction","Scientific","Text","Custom"],["General","General","General","Currency","General","General","Currency","Currency","Text","Custom"],["General","General","General","Percentage","Date","Time","Percentage","Scientific","Text","Custom"],["General","General","General","General","General","General","Date","Date","Text","Custom"],["General","General","General","General","General","General","Time","Time","Text","Custom"],["General","General","General","General","General","General","Fraction","Scientific","Text","Custom"],["General","General","General","General","General","General","General","Scientific","Text","Custom"],["General","General","General","General","General","General","General","General","Text","Custom"],["General","General","General","General","General","General","General","General","General","Custom"]];function $d(e,t,r){if(2===t.length)return r(e,uh(e,t[0]),uh(e,t[1]));throw new Hs(jd)}function eh(e,t,r,n){var a=r.iformat,i=n.iformat,o=r.category,u=n.category,c=Qd[o],s=Qd[u],l=c<=s?t[c][s]:t[s][c],f=Qd[l],d=n.decimals>r.decimals?n.decimals:r.decimals;switch(f){case c:return Yd(!0,o,a,d);case s:return Yd(!0,u,i,d);default:return e.unitlessFormat}}function th(e,t,r){return eh(e,Zd,t,r)}function rh(e,t,r){var n=t.iformat,a=r.iformat,i=t.category,o=r.category;if(n===a&&i===o&&"Time"===i)return Yd(!0,i,n,0);if("Date"===i&&"Time"===o||"Time"===i&&"Date"===o){var u=e.globals.getKnownFormat(xs.MDYHMS);if(!Dd(u))throw new Hs(u.reason);return Yd(!0,u.value.category,u.value.iformat,u.value.decimals)}return eh(e,zd,t,r)}var nh=function(e){return e.unitlessFormat};function ah(e,t,r){var n=t.iformat;return n===r.iformat?Yd(!0,t.category,n,t.decimals):e.unitlessFormat}function ih(e,t){return Qd[t]===Qd[e.defaultFormat.category]}var oh=xd(Fd,(function(e){return _d(Ld([e]))}),(function(e,t){return e.kind===Gd.NoOriginSheet?_d(Ld([t])):_d(e)}));function uh(e,t){switch(t.kind){case bd.App:var r=t.head;if(bt(r))return function(e,t,r){switch(t){case Id.Mul:case Id.Div:return e.multOrDivTainted=!0,$d(e,r.args,th);case Id.Pow:return $d(e,r.args,th);case Id.Add:case Id.Sub:return $d(e,r.args,rh);case Id.Percent:if(1===r.args.length){var n=r.args[0];if(n.kind!==bd.Literal||"number"!=typeof n.oper)return e.defaultFormat;var a=uh(e,n);return Yd(a.strongFormat,"Percentage",xs.Percentage,a.decimals)}throw new Hs(jd);case Id.Pound:case Id.At:return e.defaultFormat;case Id.Neg:case Id.Pos:if(1===r.args.length)return uh(e,r.args[0]);throw new Hs(jd);case Id.Lt:case Id.Le:case Id.Eq:case Id.Ge:case Id.Gt:case Id.Ne:return $d(e,r.args,nh);case Id.Isect:case Id.Union:case Id.Range:case Id.Concat:return $d(e,r.args,ah);case Id.And:case Id.Or:case Id.Xor:case Id.Min:case Id.Max:case Id.Dot:throw new Hs(Wd);default:return k("calc.analyzer.inferFormat: unexpected operator id",t)}}(e,r.id,t);if(Rt(r)){var n=Gt(e.localeInfo,r.whole);if(void 0!==n){var a=dr(Xd[n],Jd.Ignore),i=Td(n),o=wd(t);if(!Bd(i,o.length))throw new Hs(jd);if(n===Nd.HYPERLINK&&(e.hyperlinkTainted=!0),a===Jd.Ignore)return e.defaultFormat;if(a===Jd.Propagate){if(0===o.length)return e.defaultFormat;var u=uh(e,o[0]),c=u.iformat,s=u.category,l=u.decimals,f=!ih(e,s);if(!u.strongFormat&&f)return e.unitlessFormat;for(var d=f,h=1;h<o.length;h+=1){var v=uh(e,o[h]),p=!ih(e,v.category);if(!v.strongFormat&&p)return e.unitlessFormat;d||(c=v.iformat,s=v.category,l=v.decimals,d=p)}return Yd(!0,s,c,l)}var m=e.globals.getKnownFormat(a);if(!Dd(m))throw new Hs(m.reason);return Yd(!0,m.value.category,a,m.value.decimals)}}return uh(e,r);case bd.Array:return e.defaultFormat;case bd.CellRef:var g=e.resolver.resolveCellRef(e.locals,t)[1],C=oh(t.ref,g);if(!Dd(C))throw new Hs(C.reason);var S=C.value;if(!Vd(S))return e.unitlessFormat;var y=Ud(S),E=e.globals.getCellFormat(y);if(!Dd(E))throw new Hs(E.reason);var O=E.value.iformat,A=E.value.category;return Yd(!0,A,O,"Date"!==A&&"Time"!==A&&"Text"!==A&&"Custom"!==A&&"Special"!==A?E.value.decimals:0);case bd.Literal:var b=Md(t.oper);switch(b){case Rd.String:case Rd.Boolean:case Rd.Error:case Rd.Missing:return e.defaultFormat;case Rd.Number:var R=e.mathpack.formatGeneral(e.localeInfo,t.oper,21),I=R.indexOf(".");l=I>=0?R.length-I-1:0;return Yd(!1,e.defaultFormat.category,e.defaultFormat.iformat,l);default:return k("calc.analyze.inferFormat: unexpected literal oper",b)}case bd.Name:return e.defaultFormat;case bd.Paren:return uh(e,t.node);case bd.Bad:throw new Hs(jd);default:return k("calc.analyzer.inferFormat",t)}}function ch(e,t,r){try{var n=function(e,t){var r,n;return{globals:qd(e),locals:t,config:e.config,localeInfo:(n=null===(r=t.config)||void 0===r?void 0:r.localeInfo,null!=n?n:e.config.localeInfo),mathpack:e.config.mathpack,defaultFormat:Yd(!1,"General",xs.General,0),unitlessFormat:Yd(!0,"General",xs.General,0),resolver:Pd(Kd(e)),multOrDivTainted:!1,hyperlinkTainted:!1}}(e,t),a=uh(n,r);return O.ULS.traceTag(595948253,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Verbose,"calc.analyze.inferFormat: inferred format info = "+a),Fd(Object(j.a)(Object(j.a)({},a),{multOrDivTainted:n.multOrDivTainted,hyperlinkTainted:n.hyperlinkTainted}))}catch(e){return e instanceof Hs?(O.ULS.traceTag(595948254,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,"calc.analyze.inferFormat: inference failed = "+C(e.reason)),e.reason):(O.ULS.traceTag(595948255,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,"calc.analyze.inferFormat: caught exception = "+p(e)),_d(ut(e)))}}var sh={getSheetName:function(){return it(wt(["defaultCallbacks getSheetName"]))}};var lh=function(e){this.failure=e},fh=function(){function e(e,t){this.seenUnclosed=!1,this.seenParen=!1,this.seenMissing=!1,this.globals=function(e){var t,r;return{getSheetName:(r=null===(t=e.getSheetName)||void 0===t?void 0:t.bind(e),null!=r?r:sh.getSheetName)}}(e),this.locals=t}return e.prototype.autocorrect=function(e,t){var r=this;if(t>100)return e;switch(e.kind){case L.Literal:return e.isClosed||(this.seenUnclosed=!0),t>=2&&Ef(e.oper)&&(this.seenMissing=!0),e;case L.Name:case L.Bad:return e;case L.Array:var n=e.nodes.map((function(e){return e.map((function(e){return r.autocorrect(e,t+1)}))}));return e.isClosed||(this.seenUnclosed=!0),ue(n,e.isClosed,e.label);case L.App:var a=e.head.kind===L.Operator?e.head:this.autocorrect(e.head,t+1),i=e.args.map((function(e){return r.autocorrect(e,t+1)})),o=e.isClosed;return bt(e.head)||e.isClosed||0!==t||this.seenParen||this.seenUnclosed||this.seenMissing||(o=!0),e.isClosed||(this.seenUnclosed=!0),bt(e.head)||(this.seenParen=!0),ce(a,i,o,e.label);case L.Paren:n=this.autocorrect(e.node,t+1);return e.isClosed||(this.seenUnclosed=!0),this.seenParen=!0,n===e.node?e:le(n,e.isClosed,e.label);case L.CellRef:if(this.locals.allowUnqualifiedCell||void 0!==e.qualifier)return e;var u=this.locals.originSheet;if(!ot(u))throw new lh(u);if(void 0===u.value.index)return e;var c=this.globals.getSheetName(u.value.document,u.value.index);if(!ot(c))throw new lh(c);return de(e.ref,Y(c.value,void 0),e.label)}},e}();var dh,hh,vh,ph,mh=ui.SpecialPrecs,gh=ui.PrecsBound,Ch=ui.precedents;function Sh(e){return{checkFormula:function(t,r,n){return Ad(e,t,r,null!=n?n:"undefined")},checkFormulaWithDiagnostics:function(t,r,n){return function(e,t,r,n){var a=md(pd(e,t,{ok:void 0,isOk:function(e){return void 0===e},collect:function(e,t,r){var n,a=null!=r?r:[];return(n=a[e.label],null!=n?n:a[e.label]=[]).push(t),a}},!1),r).context.errorData;if(!En(hn.CalcStrictFormulaChecking)){var i=void 0===a,o=yd(e,t,r.node,!1);if(i!==o){var u=rr(Yt(Kt(void 0,"Book1"),0),Zt(0,0));O.ULS.traceTag(592995976,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,"calc.analyze.checkFormula: old isWellFormed = "+o+", new isWellFormed = "+i+", new diagnostics = "+JSON.stringify(a)+"; operation: "+n+"; anonymize: "+ai(r,Bt(u)))}}return[Object(j.a)(Object(j.a)({},r),{isWellFormed:void 0===a}),a]}(e,t,r,null!=n?n:"undefined")},autocorrectFormula:function(t,r){return function(e,t,r){try{var n=r.spans,a=r.annotations,i=r.node;return at(re(i=new fh(e,t).autocorrect(i,0),n,a))}catch(e){if(e instanceof lh)return e.failure;throw e}}(e,t,r)},findStaticPrecedents:function(e,t){return Ch([],[],mh.All,gh.Upper)},findBestFormat:function(t,r){return ch(e,t,r.node)}}}function yh(e){return{kind:dh.RangeValues,arrays:e}}!function(e){e.RangeValues="RangeValues"}(dh||(dh={})),function(e){e[e.Array=-2147483648]="Array",e[e.Fun=-2147483647]="Fun",e[e.Let=-2147483646]="Let",e[e.App=-2147483645]="App",e[e.Name=-2147483644]="Name",e[e.Udf=-2147483643]="Udf",e[e.CellRef=-2147483642]="CellRef",e[e.ReadStack=-2147483641]="ReadStack",e[e.ReadClosure=-2147483640]="ReadClosure",e[e.Conditional=-2147483639]="Conditional",e[e.CallLambda=-2147483638]="CallLambda"}(ph||(ph={}));var Eh,Oh=(hh=cr(sr,sr)).wrap,kh=hh.unwrap,Ah=(vh=cr((function(e){return-e}),(function(e){return-e}))).wrap,bh=vh.unwrap;function Rh(e){return e>0}function Ih(e){return{kind:e,data:void 0,children:void 0}}function Th(e,t,r){var n=Ih(ph.Array);return n.children=r,n.data={rows:e,cols:t},n}function Nh(e,t,r,n){var a=Ih(ph.Fun);return a.children=n,a.data={arity:e,closureId:t,closedIdents:r},a}function Fh(e,t,r){var n=Ih(ph.Let);return n.children=Object(j.f)(e,[r]),n.data={rec:t},n}function _h(e,t,r,n){var a=Ih(ph.App);return a.children=n,a.data={funName:e,funType:t,isFormulaRoot:r},a}function Mh(e,t,r){var n=Ih(ph.Name);return n.data={name:e,qualifier:t},n.children=r,n}function Dh(e,t,r){var n=Ih(ph.Udf);return n.data={name:e,qualifier:t},n.children=r,n}function wh(e){var t=Ih(ph.ReadStack);return t.data=e,t}function Lh(e,t,r,n,a){var i=Ih(ph.Conditional);return i.children=Object(j.f)([n],a),i.data={funName:e,funType:t,isFormulaRoot:r},i}function Uh(e){return"object"!=typeof e||e.kind>0}function xh(e,t){for(var r,n=0;n<e.length;n+=1){var a=e[n],i=t(a);void 0===r?i!==a&&(r=e.slice(0,n)).push(i):r.push(i)}return void 0!==r?r:e}function Ph(e,t){return xh(e,function(e){return function(t){return xh(t,e)}}(t))}function Gh(e,t){return t(function(e,t){if(Uh(e))return e;switch(e.kind){case ph.Let:var r=xh(e.children,t);return r===e.children?e:Fh(r.slice(0,r.length-1),e.data.rec,r[r.length-1]);case ph.App:var n=xh(e.children,t);return n===e.children?e:_h(e.data.funName,e.data.funType,e.data.isFormulaRoot,n);case ph.Conditional:var a=e.children,i=a[0],o=a.slice(1),u=t(i),c=xh(o,t);return i===u&&o===c?e:Lh(e.data.funName,e.data.funType,e.data.isFormulaRoot,u,c);case ph.Fun:var s=t(e.children);return s===e.children?e:Nh(e.data.arity,e.data.closureId,e.data.closedIdents,s);case ph.Array:var l=Ph(e.children,t);return l===e.children?e:Th(e.data.rows,e.data.cols,l);case ph.Name:return(f=void 0===e.children?void 0:t(e.children))===e.children?e:Mh(e.data.name,e.data.qualifier,f);case ph.Udf:var f;return(f=void 0===e.children?void 0:t(e.children))===e.children?e:Dh(e.data.name,e.data.qualifier,f);case ph.CellRef:case ph.ReadStack:case ph.ReadClosure:return e}}(e,(function(e){return Gh(e,t)})))}var Vh=j.a,Bh=si.NodeKind,Wh=hi.getArguments,jh=ui.arrayOper,Hh=fi.WorksheetFuncId,Kh=fi.OperatorId,qh=hi.success,Yh=ve(1,[x.Number|x.String|x.Boolean|x.Rich|x.Error|x.Blank],[x.Number|x.String|x.Boolean|x.Rich|x.Error|x.Blank|x.Missing|x.Array|x.Range],[],P.All,G.None,V.Allow3dRef),Jh=Mf(rt(Hh.IF)),Qh=Mf(rt(Hh.CHOOSE));function Xh(e){return"object"!=typeof e||Uh(e)&&("object"!=typeof(t=e)||t.kind===hf.Error||t.kind===hf.Array||t.kind===hf.Rich);var t}var zh=function(){function e(e){this.id=e,this.slots=[],this.idToSlot={}}return e.prototype.mapStackId=function(e){var t=this.idToSlot[e];return null!=t?t:this.idToSlot[e]=this.slots.push(e)-1},e}(),Zh=ml.create((function(e,t){return e-t}));function $h(e,t,r,n,a,i,o){switch(void 0===i&&(i=!1),void 0===o&&(o=!1),a.kind){case Bh.Array:var u=a.nodes.map((function(a){return a.map((function(a){return $h(e,t,r,n,a)}))}));return N=(T=u).length,F=void 0===T[0]?0:T[0].length,T.every((function(e){return e.every(Xh)}))?jh(N,F,T):Th(N,F,T);case Bh.App:var c=a.head;if(bt(c)){var s=Wh(a).map((function(a){return $h(e,t,r,n,a)})),l=fi.getOperatorType(c.id);return _h(Oh(c.id),l,o,s)}if(Rt(c))if(null!=(S=Gt(e.localeInfo,c.whole))){var d=void 0;switch(S){case Hh.LET:case Hh.LETREC:if(!En(S===Hh.LET?hn.CalcLetFunction:hn.CalcLetRecFunction))break;d=function(e,t,r,n,a,i){if(a.args.length>=3&&a.args.length%2==1&&a.args.every((function(e,t,r){return t===r.length-1||t%2==1||Rt(e)}))){for(var o=t,u=a.args.length>>1,c=[],s=0;s+1<a.args.length;s+=2){var l=a.args[s].whole;e.annotations[a.args[s].label]=ie(l)}if(i){for(s=0;s+1<a.args.length;s+=2){l=a.args[s].whole;var f=r+s/2;o=o.setValue(l,[n.getCount(),f])}for(s=0;s+1<a.args.length;s+=2)c.push($h(e,o,r+u,n,a.args[s+1]))}else for(s=0;s+1<a.args.length;s+=2){l=a.args[s].whole,f=r+s/2;c.push($h(e,o,f,n,a.args[s+1])),o=o.setValue(l,[n.getCount(),f])}return Fh(c,i,$h(e,o,r+u,n,a.args[a.args.length-1]))}}(e,t,r,n,a,S===Hh.LETREC);break;case Hh.FUN:if(!En(hn.CalcFunFunctions))break;d=function(e,t,r,n,a){var i=a.args.slice(0,a.args.length-1);if(a.args.length>0&&i.every(Rt)){var o=new zh(n.getCount()+1),u=n.setValue(o.id,o),c=i.reduceRight((function(t,n,a){var i=n.whole;return e.annotations[n.label]=ie(i),t.setValue(i,[u.getCount(),r+a])}),t),s=$h(e,c,r+i.length,u,a.args[a.args.length-1]),l=o.slots.map((function(e){return r-e-1}));return Nh(i.length,o.id,l,s)}}(e,t,r,n,a);break;case Hh.IF:d=function(e,t,r,n,a){var i=a.args;return 3===i.length?Lh(Ah(Hh.IF),Jh,!1,$h(e,t,r,n,i[0]),[$h(e,t,r,n,i[1]),$h(e,t,r,n,i[2])]):2===i.length?Lh(Ah(Hh.IF),Jh,!1,$h(e,t,r,n,i[0]),[$h(e,t,r,n,i[1]),!1]):void 0}(e,t,r,n,a);break;case Hh.CHOOSE:if(En(hn.CalcWorksheetFunctions)&&En(hn["OfficeVSO:3852168_CalcCGCHOOSE"]))d=function(e,t,r,n,a){var i=a.args;if(i.length>=1)return Lh(Ah(Hh.CHOOSE),Qh,!1,$h(e,t,r,n,i[0]),i.slice(1).map((function(a){return $h(e,t,r,n,a)})))}(e,t,r,n,a);else{var h=Wh(a).map((function(a){return $h(e,t,r,n,a)})),v=fi.getWorksheetFuncType(S);d=_h(Ah(S),v,!1,h)}break;case Hh.IFERROR:case Hh.IFNA:d=function(e,t,r,n,a,i){var o=a.args;if(2===o.length){var u=wh(0),c=Lh(Ah(Hh.IF),Jh,!1,_h(Ah(i),fi.getWorksheetFuncType(i),!1,[u]),[$h(e,t,r+1,n,o[1]),u]);return Fh([$h(e,t,r,n,o[0])],!1,c)}}(e,t,r,n,a,S===Hh.IFERROR?Hh.ISERROR:Hh.ISNA);break;default:s=Wh(a).map((function(a){return $h(e,t,r,n,a)})),l=fi.getWorksheetFuncType(S);d=_h(Ah(S),l,!1,s)}if(void 0!==d)return e.annotations[c.label]=ae(S),d}return function(e,t,r,n,a){var i=Wh(a).map((function(a){return $h(e,t,r,n,a)}));return _h(Ah(Hh._UDF),Yh,!1,[$h(e,t,r,n,a.head,!0)].concat(i))}(e,t,r,n,a);case Bh.Paren:return $h(e,t,r,n,a.node);case Bh.Name:if(null==a.qualifier){var p=t.getEntry(a.whole);if(void 0!==p){e.annotations[a.label]=ie(p.key);var m=p.value,g=m[0],S=m[1];if(g===n.getCount())return wh(r-S-1);var y=n.getValue(g+1);return b("calc.runtime.formulaToTermIR: closure",void 0!==y),function(e,t){var r=Ih(ph.ReadClosure);return r.data=[e,t],r}(y.id,y.mapStackId(S))}}return function(e,t,r){return!t||void 0!==e.qualifier&&e.qualifier.kind!==_.Document&&e.qualifier.kind!==_.Ident||(r=Dh(e.whole,e.qualifier,r)),Mh(e.whole,e.qualifier,r)}(a,i,void 0);case Bh.CellRef:return A=a.ref,R=a.qualifier,(I=Ih(ph.CellRef)).data={ref:A,qualifier:R},I;case Bh.Literal:return a.oper;case Bh.Bad:var E="calc.runtime.compile: unexpected bad node "+C(a);return O.ULS.assertTag(595980820,f.LogCategory.msoulscat_ES_EWAJS,!1,E);default:return k("calc.runtime.compile",a)}var A,R,I,T,N,F}var ev=((Eh={})[Kh.At]=Hh.SINGLE,Eh[Kh.Pound]=Hh.ANCHORARRAY,Eh[Kh.Dot]=Hh._FV,Eh);var tv=function(e){if(!Uh(e)&&e.kind===ph.App&&Rh(e.data.funName)){var t=ev[kh(e.data.funName)];if(void 0!==t)return _h(Ah(t),fi.getWorksheetFuncType(t),e.data.isFormulaRoot,e.children)}return e};var rv;function nv(e,t){return function(e){return"__compiledFormulaBrand__"===e.kind}(t)?t.term:k(e+": expected known compiled formula type; given "+C(t),t)}function av(e,t,r){var n,a,i=null!=(a=null===(n=t.config)||void 0===n?void 0:n.localeInfo)?a:e.config.localeInfo,o=ml.create(i.stringCompareCI),u=Vh([],r.annotations),c=$h({globals:e,locals:t,localeInfo:i,annotations:u},o,0,Zh,r.node,void 0,!0),s=Gh(c,tv);return qh(function(e,t,r){return Object(j.a)(Object(j.a)({kind:"__compiledFormulaBrand__"},e),{annotations:t,term:r})}(r,u,s))}function iv(e){return{compileFormula:function(t,r){return av(e,t,r)}}}function ov(e){return 0===e.length&&A("calc.runtime.unevaluated: expected nonempty array"),{kind:rv.Unevaluated,anchors:e}}!function(e){e.Unevaluated="Unevaluated"}(rv||(rv={}));var uv=Ut;function cv(e){throw new uv(e)}function sv(e,t,r){var n;switch(r.kind){case rv.Unevaluated:if(t.map.getCount()+1>(null!=(n=e.globals.limits.maxCellChain)?n:1/0))return it(Jl(wl.CellChain));var a=r.anchors.map((function(r){return e.createCellEvaluationMachine(e,t,r,!0)}));return $l(new of(a),tf());default:return it(r)}}function lv(){return ge([],[],G.None,W.Lower)}function fv(e,t,r){return void 0===e?void 0===t?0:-1:void 0===t?1:r(e,t)}function dv(e,t){return e<t?-1:e===t?0:1}function hv(e,t){return"string"==typeof e?"string"!=typeof t?1:dv(e,t):"string"==typeof t||e<t?-1:e===t?0:1}function vv(e,t){var r;return 0!==(r=dv(e.name,t.name))?r:fv(e.path,t.path,dv)}function pv(e,t){return{current:e,map:t}}var mv=pv(void 0,ml.create((function(e,t){var r;return 0!=(r=e.range.col-t.range.col)||0!=(r=e.range.row-t.range.row)||0!==(r=hv(e.sheet.index,t.sheet.index))?r:vv(e.sheet.document,t.sheet.document)})));function gv(e,t){return{current:e,map:t}}var Cv=gv(void 0,ml.create((function(e,t){var r;return 0!==(r=dv(e.name,t.name))||0!==(r=fv(e.scope.index,t.scope.index,hv))?r:vv(e.scope.document,t.scope.document)})));var Sv=function(){function e(e,t,r){this.transition=e,this.onFulfilled=t,this.onRejected=r,this.isRunning=!1}return e.prototype.setState=function(e,t,r){return this.onFulfilled=t,this.onRejected=r,this.transition=e},e.prototype.next=function(){return this.transition instanceof e?this.transition=$l(this.transition,this):this.transition},e.prototype.receiveResult=function(t){var r;try{if(ot(t)){if(!this.onFulfilled)return this.setState(t,void 0,void 0);r=this.onFulfilled(t.value)}else{if(!this.onRejected)return this.setState(t,void 0,void 0);r=this.onRejected(t.reason)}}catch(e){return this.setState(it(ut(e)),void 0,void 0)}return r instanceof e?(this.setState(r.transition,r.onFulfilled,r.onRejected),r.setState(this,void 0,void 0),this.next()):this.setState(at(r),void 0,void 0)},e.prototype.bind=function(t){return new e(this,t,void 0)},e.prototype.catch=function(t){return new e(this,void 0,t)},e.prototype.finally=function(t){return new e(this,(function(e){return t(),e}),(function(r){return t(),e.reject(r)}))},e.all=function(t){return e.fromMachine(new of(t.map(e.resolve)))},e.prototype.settle=function(){return new af(this).run()},e.resolve=function(t){return t instanceof e?t:new e(at(t),void 0,void 0)},e.reject=function(t){return new e(it(t),void 0,void 0)},e.undefined=e.resolve(void 0),e.fromMachine=function(t){if(t instanceof e)return t;var r=new e(e.undefined,void 0,void 0);return r.transition=$l(t,r),r},e.try=function(t){return e.undefined.bind(t)},e.guardStackDepth=0,e.guard=function(t){if(e.guardStackDepth>=7)return e.undefined.bind(t);e.guardStackDepth+=1;try{return e.resolve(t())}catch(t){return e.reject(ut(t))}finally{e.guardStackDepth-=1}},e.RepeatMachine=function(){function t(e,t){this.onLoop=e,this.accum=t,this.isRunning=!1}return t.prototype.next=function(){var t=this.onLoop(this.accum);return t instanceof e?$l(t,this):this.receiveSuccess(t)},t.prototype.receiveResult=function(e){return ot(e)?this.receiveSuccess(e.value):e},t.prototype.receiveSuccess=function(e){return void 0===e?at(this.accum):(this.accum=e,this.next())},t}(),e.repeat=function(t,r){return e.resolve(r).bind((function(r){return e.fromMachine(new e.RepeatMachine(t,r))}))},e}(),yv=function(){function e(e,t,r,n){var a=this;this.context=e,this.visitedCells=t,this.cell=r,this.isPrecedent=n,this.receiveSuccess=function(e){return function(t){if("object"==typeof t&&(t.kind===x.Range||t.kind===x.Missing)){var r="calc.runtime.CellEvaluationMachine.receiveSuccess: "+("expected ReadOper; given "+C(t));return O.ULS.assertTag(595980815,f.LogCategory.msoulscat_ES_EWAJS,!1,r)}return a.writeSuccess(e.source,t,e.precedents),t}},this.receiveFailure=function(e){return function(t){if(t.kind===rv.Unevaluated){var r="calc.runtime.CellEvaluationMachine.receiveFailure: "+("unexpected reason "+C(t));return O.ULS.assertTag(595980817,f.LogCategory.msoulscat_ES_EWAJS,!1,r)}var n=t.kind===Nl.PreviousFailure&&void 0!==e.cycle?e.cycle:t;return a.writeFailure(e.source,n,e.precedents),Sv.reject(a.isPrecedent?Yl(e.source.range):n)}}}return e.prototype.evalCell=function(){var e=this.context.globals.getCellValue(this.cell);if(e.kind===Be.Failure)return Sv.reject(e.reason);var t=e.value;if(t.kind===Ml.FinalValue)return t.oper;var r=this.context.globals.getCellFormula(t.anchor);if(r.kind===Be.Failure){var n="calc.runtime.CellEvaluationMachine.next: unexpected Failure from getCellFormula";return O.ULS.assertTag(595980813,f.LogCategory.msoulscat_ES_EWAJS,!1,n)}var a=r.value;if(null==a){n="calc.runtime.CellEvaluationMachine.next: "+("client error: expected getCellFormula("+C(t.anchor)+") != null");return O.ULS.assertTag(595980814,f.LogCategory.msoulscat_ES_EWAJS,!1,n)}var i,o,u,c,s,l,d=this.visitAnchor(a),h=this.context.createFormulaEvaluationMachine(this.context,(u=d.source,c=St(u.range),s=at(c.range),l=at(c.sheet),Hl(u,s,l,u.kind===Vt.Range,s,l,u.kind===Vt.Cell,!1,at(!1))),d.precedents,(i=this.visitedCells,b("calc.runtime.appendVisitedCell",(o=d).previous===i.current),pv(o,i.map.setValue(o.cell,o))),a.formula);return Sv.fromMachine(h).bind(this.receiveSuccess(d)).catch(this.receiveFailure(d))},e.prototype.visitAnchor=function(e){var t=St(e.source.range),r=this.visitedCells.map.getValue(t);if(null!=r){var n="calc.runtime.CellEvaluationMachine.visitAnchor: "+("unexpected visitValue at "+C(t)+"; given "+C(r));return O.ULS.assertTag(595980812,f.LogCategory.msoulscat_ES_EWAJS,!1,n)}return{cell:t,cycle:void 0,previous:this.visitedCells.current,source:e.source,precedents:lv()}},e.prototype.writeSuccess=function(e,t,r){this.setCellValue(e,t,r),this.context.globals.setDynamicPrecs(e.range,r)},e.prototype.writeFailure=function(e,t,r){this.context.globals.setCellFailure(e.range,t,r),this.context.globals.setDynamicPrecs(e.range,r)},e.prototype.setCellValue=function(e,t,r){var n=this.context.globals.config.mathpack.zero,a=Sf(t)?n:t;if(e.kind===Vt.Cell){if(yf(a)){var i=void 0===a.opers[0]?be:a.opers[0][0],o=Sf(i)?n:i;return this.context.globals.setCellValue(e.range,o,r)}return this.context.globals.setCellValue(e.range,a,r)}var u=e.range.range,c=Rf(u.rows,u.cols,a).opers,s=function(e){return Sf(e)?n:e},l=c.map((function(e){return e.map(s)}));return this.context.globals.setCellValues(e.range,l,r)},e}();function Ev(e,t,r,n){return Sv.try((function(){return new yv(e,t,r,n).evalCell()}))}function Ov(e,t){for(var r=Rv(e),n=[],a=0;a<t.length;a+=1)n.push(Ev(r.machineContext,mv,t[a],!1));return new Tv(r,n)}function kv(e){return{yieldIntervalMs:e.yieldIntervalMs,endTimeMs:null==e.totalTimeMs?void 0:Cr()+e.totalTimeMs,scheduleFunction:null!=e.scheduleFunction?e.scheduleFunction:function(e){return setTimeout(e,0)}}}function Av(e){if(void 0!==e.yieldIntervalMs||void 0!==e.endTimeMs){if(void 0===e.yieldIntervalMs)return e.endTimeMs;var t=Cr()+e.yieldIntervalMs;return void 0===e.endTimeMs?t:Math.min(e.endTimeMs,t)}}var bv={kind:Nl.Timeout};function Rv(e){return{globals:e,timer:{doTimeout:function(e){return void 0!==e&&Cr()>=e}},machineContext:Iv(e)}}function Iv(e){return{globals:e,resolver:Ba(e),parser:ks(e),analyzer:Sh(e),createCellEvaluationMachine:Ev,createFormulaEvaluationMachine:Lp,createLambdaEvaluationMachine:Up}}var Tv=function(){function e(e,t){I("calc.runtime.EvaluationRuntime",t.length),this.context=e,this.machineRuntimes=t.map((function(e){return new af(e)})),this.results=[]}return e.prototype.evaluateAsync=function(e){var t=this;if(this.context.globals.interruptToken[0]===Dl.Stop)return this.generatePartialResults(),Promise.resolve(this.results);if(this.context.timer.doTimeout(e.endTimeMs))return this.generatePartialResults(),Promise.resolve(this.results);try{var r=this.evaluate(Av(e));return r instanceof Array?Promise.resolve(r):new Promise((function(r){return e.scheduleFunction((function(){return r(t.evaluateAsync(e))}))}))}catch(e){return Promise.reject(it(e))}},e.prototype.evaluateSync=function(e){var t=this,r=function(n){if(t.context.globals.interruptToken[0]===Dl.Stop||t.context.timer.doTimeout(e.endTimeMs))return t.generatePartialResults(),t.results;var a=t.evaluate(n);return a instanceof Array?a:Ql((function(t){return r(void 0!==t?t:Av(e))}))};return r(Av(e))},e.prototype.evaluate=function(e){var t=this,r=function(){return t.context.timer.doTimeout(e)};try{for(;this.results.length<this.machineRuntimes.length;){var n=this.machineRuntimes[this.results.length].run(r);if(!n)return bv;this.pushResult(n)}return this.results}catch(e){var a="calc.runtime.EvaluationRuntime.evaluate: unhandled error "+p(e);return O.ULS.assertTag(595980807,f.LogCategory.msoulscat_ES_EWAJS,!1,a)}},e.prototype.pushResult=function(e){return this.results.push(e),Zl},e.prototype.generatePartialResults=function(){for(;this.results.length<this.machineRuntimes.length;)this.results.push(it(Vl))},e}(),Nv=ii.sheetIndex,Fv=ui.OperKind,_v=ui.rangeSeqOper,Mv=ui.ErrorType,Dv=ui.valueErrorOper,wv=ui.nullErrorOper,Lv=fi.OperatorId,Uv=hi.operKind,xv=hi.isSheetIndex,Pv=hi.isDocumentLocEqual;function Gv(e,t){switch(e){case Lv.Eq:return 0===t;case Lv.Ne:return 0!==t;case Lv.Lt:return t<0;case Lv.Gt:return t>0;case Lv.Le:return t<=0;case Lv.Ge:return t>=0}}function Vv(e,t,r){return Gv(e,t-r)}function Bv(e,t,r,n){return Gv(t,e.stringCompareCI(r,n))}function Wv(e,t,r,n){return Gv(t,e.compare(r,n))}function jv(e,t,r){if(xv(t.sheets))if(xv(r.sheets))if(Pv(t.sheets.document,r.sheets.document)){if(t.sheets.index===r.sheets.index)return Nv(t.sheets.document,t.sheets.index);n="different sheet, range1 = "+C(t)+", range2 = "+C(r);gf(e,Mv.VALUE,n)}else{var n="different document, range1 = "+C(t)+", range2 = "+C(r);gf(e,Mv.VALUE,n)}else gf(e,Mv.VALUE,"3D reference, range2 = "+C(r));else gf(e,Mv.VALUE,"3D reference, range1 = "+C(t))}function Hv(e,t,r,n){void 0===n&&(n=!1);var a,i,o,u=e.config.mathpack;if(1===r.length){var c=r[0];switch(t){case Lv.Percent:return u.percent(c);case Lv.Neg:return u.neg(c);case Lv.Pos:return c;default:var s="calc.runtime.applyOperator: "+("bad application of "+t+" to 1 argument");return O.ULS.assertTag(593372496,f.LogCategory.msoulscat_ES_EWAJS,!1,s)}}if(2===r.length){c=r[0];var l=r[1];switch(t){case Lv.Add:var d=u.add(c,l);return n&&"number"==typeof d?u.checkAlmostCancellation(c,d):d;case Lv.Sub:d=u.sub(c,l);return n&&"number"==typeof d?u.checkAlmostCancellation(c,d):d;case Lv.Mul:return u.mul(c,l);case Lv.Div:return u.div(c,l);case Lv.Pow:return u.power(c,l);case Lv.Concat:return(c+l).substring(0,32767);case Lv.Eq:case Lv.Ne:case Lv.Lt:case Lv.Le:case Lv.Gt:case Lv.Ge:return function(e,t,r,n){var a=e.config,i=a.localeInfo,o=a.mathpack,u=Uv(r),c=Uv(n);if(u!==c){if(u===Fv.Blank)switch(c){case Fv.Number:return Wv(o,t,o.zero,n);case Fv.String:return Bv(i,t,"",n);case Fv.Boolean:return Vv(t,!1,n)}if(c===Fv.Blank)switch(u){case Fv.Number:return Wv(o,t,r,o.zero);case Fv.String:return Bv(i,t,r,"");case Fv.Boolean:return Vv(t,r,!1)}return Gv(t,u-c)}switch(u){case Fv.Number:return Wv(o,t,r,n);case Fv.String:return Bv(i,t,r,n);case Fv.Boolean:return Vv(t,r,n);case Fv.Blank:return Gv(t,0);default:return!1}}(e,t,c,l);case Lv.Range:return function(e,t){var r=jv("calc.runtime.applyRangeOp",e,t);if(null==r)return Dv;var n=[If(Tf(e.ranges),Tf(t.ranges))];return _v(r,n)}(c,l);case Lv.Isect:return function(e,t){var r=jv("calc.runtime.applyIsectOp",e,t);if(null==r)return Dv;for(var n=[],a=0;a<e.ranges.length;a+=1)for(var i=0;i<t.ranges.length;i+=1){var o=Nf(e.ranges[a],t.ranges[i]);null!=o&&n.push(o)}if(0===n.length){var u="empty intersection, range1 = "+C(e)+", range2 = "+C(t);return gf("calc.runtime.applyIsectOp",Mv.NULL,u),wv}return _v(r,n)}(c,l);case Lv.Union:return null==(o=jv("calc.runtime.applyUnionOp",a=c,i=l))?Dv:_v(o,a.ranges.concat(i.ranges));case Lv.And:return c&&l;case Lv.Or:return c||l;case Lv.Xor:return c!==l;case Lv.Min:return u.cond2(c,l)<=0?c:l;case Lv.Max:return u.cond2(c,l)>=0?c:l;default:var h="calc.runtime.applyOperator: "+("bad application of "+t+" to 2 arguments");return O.ULS.assertTag(593372497,f.LogCategory.msoulscat_ES_EWAJS,!1,h)}}var v="calc.runtime.applyOperator: "+("bad application of "+t+" to "+r.length+" arguments");return O.ULS.assertTag(593372498,f.LogCategory.msoulscat_ES_EWAJS,!1,v)}function Kv(e,t,r,n){if(r.kind===D.Abs)return r;var a=Yr(e,r.index,n)-t;return a===r.index?r:X(D.Rel,a)}function qv(e,t,r){var n=Kv(e.row,t.row,r.row,1<<20),a=Kv(e.col,t.col,r.col,16384);return n===r.row&&a===r.col?r:Z(n,a,r.label)}function Yv(e,t,r){switch(r.kind){case M.Error:return r;case M.Single:return qv(e,t,r);case M.Range:var n=qv(e,t,r.ref1),a=qv(e,t,r.ref2);return n===r.ref1&&a===r.ref2?r:$(n,a,r.label);case M.Row:var i=Kv(e.row,t.row,r.row1,1<<20),o=Kv(e.row,t.row,r.row2,1<<20);return i===r.row1&&o===r.row2?r:ee(i,o,r.label);case M.Col:var u=Kv(e.col,t.col,r.col1,16384),c=Kv(e.col,t.col,r.col2,16384);return u===r.col1&&c===r.col2?r:te(u,c,r.label)}}function Jv(e,t,r){if(mt(e,t))return r;var n,a,i=(n=r.node,a=Yv.bind(void 0,e,t),function e(t){switch(t.kind){case L.Name:case L.Literal:case L.Bad:return t;case L.Array:return ue(r=t.nodes.map((function(t){return t.map(e)})),t.isClosed,t.label);case L.App:return ce(t.head.kind===L.Operator?t.head:e(t.head),t.args.map(e),t.isClosed,t.label);case L.Paren:return(r=e(t.node))===t.node?t:le(r,t.isClosed,t.label);case L.CellRef:var r;return(r=a(t.ref))===t.ref?t:de(r,t.qualifier,t.label)}}(n));return i===r.node?r:Object(j.a)(Object(j.a)({},r),{node:i})}var Qv=ii.sheetGridCell,Xv=ii.sheetGridRange,zv=ui.OperKind,Zv=ui.ErrorType,$v=ui.refErrorOper,ep=ui.valueErrorOper,tp=ui.arrayOper,rp=hi.ResultKind,np=hi.isGridCell,ap=hi.isSheetIndex,ip=hi.getArgType;function op(e,t){var r=t.map.getValue(e);if(void 0!==r)return cv(function(e,t){for(var r=[],n=ql(r),a=t;r.push(a.cell),a.cycle=n,a!==e;a=a.previous);return r.reverse(),n}(r,t.current))}function up(e,t,r){e.precedents.cells.push(t);var n=e.globals.getCellValue(t);if(n.kind===rp.Failure)return cv(n.reason);var a=n.value;if(a.kind===Ml.FinalValue)return a.oper;op(a.anchor,e.visitedCells),r.push(a.anchor)}function cp(e,t,r,n){var a;if(e.precedents.cells.push(t),!n||Ff(t.range)<=16)a=t;else{var i=e.globals.getUsedRange(t.sheet),o=void 0;ot(i)?o=null==i.value?void 0:i.value.range:cv(i.reason);var u=void 0===o?void 0:Nf(t.range,zt(0,0,o.row+o.rows,o.col+o.cols));if(void 0===u)return new Cl(t.range.rows,t.range.cols,0,0,[],Le);a=Xv(t.sheet,u)}var c=e.globals.getCellValues(a);if(c.kind===rp.Failure)return cv(c.reason);var s=r.length,l=function(e,t,r,n,a){var i=[],o=n.length,u=0;b("calc.runtime.deference: readIntoArray2D number of rows",o===r.rows);for(var c=0;c<o;c+=1){i.push([]);var s=n[c].length;b("calc.runtime.deference: readIntoArray2D number of cols",s===r.cols),u=0===c?s:vr(s,u);for(var l=0;l<s;l+=1){var f=n[c][l];Ml.FinalValue===f.kind?i[c][l]=f.oper:(op(f.anchor,e.visitedCells),b("calc.runtime.deference: readIntoArray2D correct sheet",pt(f.anchor.sheet,t.sheet)),a.push(f.anchor),i[c][l]=$v)}}return new Cl(t.range.rows,t.range.cols,o,u,i,Le)}(e,t,a.range,c.value,r);return s===r.length?l:void 0}function sp(e,t,r){var n,a=cp(e,t,r,!1);if(null!=a)return tp(a.rows,a.cols,a.rows===a.denseRows&&a.cols===a.denseCols?a.denseElements:El((n=a).rows,n.cols,n.get.bind(n)))}function lp(e,t,r,n){if(0!=(r&zv.Range))return t;if("object"!=typeof t||t.kind!==zv.Range)return t;var a=t.sheets;if(!ap(a))return gf("calc.runtime.dereference",Zv.REF,"3D range, oper = "+C(t)),$v;if(1!==t.ranges.length)return gf("calc.runtime.dereference",Zv.VALUE,"union range, oper = "+C(t)),ep;var i=t.ranges[0];if(0!=(r&pf)){if(np(i))return up(e,Qv(a,i),n);if(e.locals.implicitIntersect&&!En(hn.CalcSupportDynamicArrays)&&!En(hn.CalcPreventSpillingHack)){var o=e.locals.originGridCell;if(!ot(o))return cv(o.reason);var u=function(e,t){var r=e.row,n=e.col,a=t.row,i=t.col,o=t.rows,u=t.cols,c=a<=r&&r<a+o,s=i<=n&&n<i+u;return c&&s?lf(r,n):c&&1===u?lf(r,i):s&&1===o?lf(a,n):void 0}(o.value,i);return null==u?(gf("calc.runtime.dereference",Zv.VALUE,"empty intersection, oper = "+C(t)),ep):up(e,Qv(a,u),n)}return sp(e,Xv(a,i),n)}return 0!=(r&zv.Array)?sp(e,Xv(a,i),n):(gf("calc.runtime.dereference",Zv.VALUE,"bad target type "+r),ep)}function fp(e,t,r){var n=[],a=lp(e,t,r,n);if(null==a){if(n.length>0)return cv(ov(n));var i="calc.runtime.dereferenceOper: internal error: expected nonempty anchors; oper = "+C(t);return O.ULS.assertTag(595980819,f.LogCategory.msoulscat_ES_EWAJS,!1,i)}return a}function dp(e,t,r){for(var n=[],a=0;a<t.length;a+=1){var i=lp(e,t[a],ip(r,a,t.length),n);null!=i&&(t[a]=i)}if(n.length>0)return cv(ov(n))}var hp=ui.OperKind,vp=ui.valueErrorOper,pp=ui.arrayOper,mp=hi.operKind,gp=hi.notImplemented;function Cp(e,t){return 0!=(t&hp.Number)?e.zero:0!=(t&hp.String)?"":0==(t&hp.Boolean)&&vp}function Sp(e,t,r){var n=function e(t,r,n){var a=t.config,i=a.localeInfo,o=a.mathpack;if("number"==typeof r){if(0!=(n&hp.Number))return r;if(0!=(n&hp.String)){return o.formatGeneral(i,r,20)}return 0!=(n&hp.Boolean)?0!==o.cond(r):0!=(n&hp.Array)?pp(1,1,[[r]]):vp}if("string"==typeof r){if(0!=(n&hp.String))return r;if(0!=(n&hp.Number)){if(0===r.length)return vp;var u=i.parseNumber(r);if(Ft(u))return u;throw new uv(gp(["string -> number coercion: "+Ai(r)]))}return 0!=(n&hp.Boolean)?0===i.stringCompareCI(r,i.trueName)||0!==i.stringCompareCI(r,i.falseName)&&vp:0!=(n&hp.Array)?pp(1,1,[[r]]):vp}if("boolean"==typeof r)return 0!=(n&hp.Boolean)?r:0!=(n&hp.Number)?r?o.one:o.zero:0!=(n&hp.String)?r?i.trueName:i.falseName:0!=(n&hp.Array)?pp(1,1,[[r]]):vp;if(0!=(n&r.kind))return r;switch(r.kind){case hp.Error:return r;case hp.Missing:return 0!=(n&hp.Blank)?ui.blankOper:Cp(o,n);case hp.Blank:return Cp(o,n);case hp.Rich:return e(t,r.getFallback(),n);default:return vp}}(e,t,r);return Cf(n)&&!Cf(t)&&gf("calc.runtime.coerceOper",n.type,"kind = "+mp(t)),n}var yp,Ep=function(){function e(e,t){void 0===t&&(t=Ee),this._fields=e,this._fallback=t,this.kind=x.Rich}return e.prototype.getFallback=function(){return this._fallback},e.prototype.getField=function(e){return this._fields.getValue(e)},e}(),Op=function(){function e(e,t,r,n){this.arity=e,this.kind=x.Rich,this.locals=t,this.env=r,this.term=n}return e.prototype.getFallback=function(){return Ee},e.prototype.getField=function(e){},e}();function kp(e,t){return b("calc.runtime.lambdaCall",t.length===e.arity),{kind:yp.LambdaCall,lambda:e,args:t}}function Ap(e){return"object"==typeof e&&e.kind===yp.LambdaCall}!function(e){e.LambdaCall="LambdaCall"}(yp||(yp={}));var bp=function(){function e(e){this.kind=x.Rich,this.arity=e.arity,this.func=e.func}return e.prototype.getFallback=function(){return A("calc.runtime.UdfOper.getFallback")},e.prototype.getField=function(e){return A("calc.runtime.UdfOper.getField")},e}(),Rp=function(){function e(e,t,r,n,a,i){this.context=e,this.locals=t,this.precedents=r,this.visitedCells=n,this.visitedNames=a,this.usage=i;var o=e.globals.config.refStyle;this.config={localeInfo:e.globals.config.localeInfo,get refStyle(){return r.special|=G.RefStyle,o},mathpack:e.globals.config.mathpack,date1904:e.globals.config.date1904,dateCompatibility:e.globals.config.dateCompatibility,timezone:e.globals.config.timezone,datepack:fa},this.mathpack=this.config.mathpack}return Object.defineProperty(e.prototype,"globals",{get:function(){return this.context.globals},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"calcingArray",{get:function(){return this.locals.calcingArray},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"originGridCell",{get:function(){var e=this.locals.originGridCell;return ot(e)?e.value:cv(e.reason)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"originSheet",{get:function(){var e=this.locals.originSheet;return ot(e)?e.value:cv(e.reason)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reflectionGridCell",{get:function(){var e=this.locals.reflectionGridCell;return ot(e)?e.value:cv(e.reason)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reflectionSheet",{get:function(){var e=this.locals.reflectionSheet;return ot(e)?e.value:cv(e.reason)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"followHyperlinks",{get:function(){var e=this.locals.followHyperlinks;return ot(e)?e.value:cv(e.reason)},enumerable:!0,configurable:!0}),e.prototype.applyFunction=function(e,t){var r=rt(e),n=t.some((function(e){return"object"==typeof e&&e.kind===x.Range}))?t.slice(0):t;return dp(this,n,r),this.handleLambda(this.dispatchFunction(Ah(e),r,!1,n))},e.prototype.applyLambda=function(e,t){return this.handleLambda(kp(e,t))},e.prototype.handleEvaluationError=function(e){if(e instanceof uv)return sv(this.context,this.visitedCells,e.reason)},e.prototype.applyOperatorOrFunction=function(e,t,r){if(Rh(e))return Hv(this.globals,kh(e),t,r);var n=bh(e);if(n===De._UDF){if(t[0]instanceof Op){var a=t[0];return t.length-1!==a.arity?be:kp(a,t.slice(1))}if(t[0]instanceof bp){var i=t[0];if(t.length-1!==i.arity)return Ee;var o=i.func(this,t.slice(1));if("object"==typeof o&&o.kind===x.Error){var u="UDF function return value";gf("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",o.type,u)}return o}return t.length>0&&Cf(t[0])?t[0]:Oe}var c=this.globals.getWorksheetFunc(n);if(c.kind===Be.Failure)return cv(c.reason);var s=c.value;if(null==s){u="nonexistent worksheet function "+n;return gf("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",pe.NAME,u),ke}var l=s(this,t);if("object"==typeof l&&l.kind===x.Error){u="worksheet function "+n+" return value";gf("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",l.type,u)}return l},e.prototype.handleLambda=function(e){return Ap(e)?uf(this.context.createLambdaEvaluationMachine(this.context,this.locals,this.precedents,this.visitedCells,this.visitedNames,this.usage,e.lambda,e.args)):e},e.prototype.dispatchFunction=function(e,t,r,n){var a=this;if(!Tt(t,n.length)){var i=JSON.stringify(t),o="calc.runtime.FunctionDispatcher.dispatchFunction: "+(m="bad application of "+JSON.stringify(e)+" to "+n.length+" arguments, ftype = "+i);return O.ULS.assertTag(593372499,f.LogCategory.msoulscat_ES_EWAJS,!1,o)}for(var u=n.length,c=P.None,s=0;s<u;s+=1){var l=n[s],d=Nt(l);0==(d&It(t,s,u))&&(c|=d),Of(l)&&0==(t.flags&V.Allow3dRef)&&!ct(l.sheets)&&(c|=d)}if(c===P.None)return this.applyOperatorOrFunction(e,n,r);if(0!=(c&x.Array)){return wf(this,t,(function(r){return a.handleLambda(a.dispatchFunction(e,t,!1,r))}),n)}c&=~x.Array;var h=[];for(s=0;s<u;s+=1){var v=n[s];if(0!=(c&Nt(v))){var p=It(t,s,u);if(Nt(v=this.coerceOper(v,p))===x.Error&&0==(p&x.Error))return v;if(Of(v)&&0==(t.flags&V.Allow3dRef)&&!ct(v.sheets)){var m="3D reference, oper = "+C(v);return gf("calc.runtime.FunctionDispatcher.dispatchFunction",pe.VALUE,m),Ee}}h[s]=v}return this.applyOperatorOrFunction(e,h,r)},e.prototype.getAvailableFormula=function(e){var t=this.globals.getCellFormula(e);return ot(t)?fr(t.value)?void 0:t.value:cv(t.reason)},e.prototype.getNameFormula=function(e,t){var r=this,n=Pa((function(e){r.precedents.names.push(e);var t=r.globals.getNameFormula(e);return ot(t)?[e,t.value]:cv(t.reason)}),(function(e){}),(function(e,t){return e.kind===Da.NoOriginSheet?void 0:cv(e)}))(e,this.context.resolver.resolveName(this.locals,fe(t,e))[1]);if(null!=n){var a=n[0],i=n[1];if(null!=i)return[a,i.node]}},e.prototype.getCellRef=function(e,t,r,n){var a={originGridCell:at(r.range),originSheet:at(r.sheet),wrapCellReferences:n};return Pa((function(e){return Me(e.sheet,e.range)}),(function(e){}),(function(e,t){return e.kind===Da.NoOriginSheet?void 0:cv(e)}))(e,this.context.resolver.resolveCellRef(a,de(t,e))[1])},e.prototype.dereferenceOper=function(e,t){return fp(this,e,t)},e.prototype.dereferenceOpers=function(e,t){dp(this,e,t)},e.prototype.getCellFormula=function(e){this.precedents.cells.push(e);var t=this.globals.getCellValue(e);return ot(t)?this.getAvailableFormula(e):cv(t.reason)},e.prototype.getSheetIndex=function(e,t){var r=this.globals.getSheetIndex(e,t);return ot(r)?(this.precedents.special|=G.OwnDocSheets,null==r.value?void 0:Yt(e,r.value)):cv(r.reason)},e.prototype.getSheetRangePosition=function(e){this.precedents.special|=G.OwnDocSheets;var t=this.globals.getSheetRangeIndexes(e);return ot(t)?t.value.position:cv(t.reason)},e.prototype.getSheetRangeIndexes=function(e){if(void 0!==e.index&&e.index===e.index2)return[e.index];this.precedents.special|=G.OwnDocSheets;var t=this.globals.getSheetRangeIndexes(e);return ot(t)?t.value.sheets:cv(t.reason)},e.prototype.dereferenceAllOpersInner=function(e,t,r){var n=this;void 0===r&&(r=!1);for(var a=[],i=[],o=function(o){var c=e[o];if(!Of(c))return i.push(c),"continue";for(var s=[],l=function(e){var r=cp(n,e,a,!0);void 0!==r&&s.push(t(r,e))},f=u.getSheetRangeIndexes(c.sheets),d=function(e){for(var t=Yt(c.sheets.document,f[e]),n=function(e){var n=c.ranges[e];if(!r)return l(tr(t,n)),"continue";var a=u.globals.getHiddenRows(t,n.row,n.row+n.rows);if(!ot(a))return{value:cv(a.reason)};var i=a.value;if(0===i.length)return l(tr(t,n)),"continue";for(var o=function(e,r){var a=zt(e,n.col,r-e,n.cols);l(tr(t,a))},s=0;s<i.length;s+=1){var f=i[s],d=f.start,h=f.end,v=0===s?n.row:i[s-1].end;b("calc.runtime.FunctionDispatcher.dereferenceAllOpersInner: valid interval",v<=d&&d<h&&h<=n.row+n.rows),v!==d&&o(v,d);var p=zt(d,n.col,h-d,n.cols);u.precedents.cells.push(tr(t,p))}var m=i[i.length-1].end;m!==n.row+n.rows&&o(m,n.row+n.rows)},a=0;a<c.ranges.length;a+=1){var i=n(a);if("object"==typeof i)return i}},h=0;h<f.length;h+=1){var v=d(h);if("object"==typeof v)return v}i.push({kind:dh.RangeValues,arrays:s})},u=this,c=0;c<e.length;c+=1){var s=o(c);if("object"==typeof s)return s.value}return a.length>0?cv(ov(a)):i},e.prototype.dereferenceAllOpers=function(e,t){return this.dereferenceAllOpersInner(e,sr,t)},e.prototype.dereferenceAllOpersAndFormulae=function(e,t){var r=this;return this.dereferenceAllOpersInner(e,(function(e,t){return new yl(e.rows,e.cols,e.denseRows,e.denseCols,(function(n,a){var i=e.get(n,a),o=rr(t.sheet,Zt(t.range.row+n,t.range.col+a));return[i,r.getAvailableFormula(o)]}),(function(){return[e.getSparse(),void 0]})).strict()}),t)},e.prototype.parseFormula=function(e,t,r,n){var a=this.context.parser.parseFormula(Ni(r.lexicalKind,t,{refStyle:e}),n);if(!ot(a))return a;var i=this.context.analyzer.checkFormula(r,a.value,"indirect");return st(i)?at(i):it(Ul("ill-formed indirect formula","indirect"))},e.prototype.coerceOper=function(e,t){return Sp(this.globals,e,t)},e.prototype.getBinaryOperator=function(e){var t=this,r=tt(e),n=[!1,!1];return function(a,i){n[0]=a,n[1]=i,dp(t,n,r);var o=t.dispatchFunction(Oh(e),r,!1,n);return b("calc.runtime.FunctionDispatcher.getBinaryOperator",!Ap(o)&&!cf(o)),o}},e.prototype.getUnaryOperator=function(e){var t=this,r=tt(e),n=[!1];return function(a){n[0]=a,dp(t,n,r);var i=t.dispatchFunction(Oh(e),r,!1,n);return b("calc.runtime.FunctionDispatcher.getUnaryOperator",!Ap(i)&&!cf(i)),i}},e.prototype.isInFilterMode=function(e){this.precedents.special|=G.InFilterMode;for(var t=0,r=e;t<r.length;t++){var n=r[t];if("object"==typeof n&&n.kind===x.Range)for(var a=0,i=this.getSheetRangeIndexes(n.sheets);a<i.length;a++){var o=i[a],u=this.globals.isInFilterMode(Yt(n.sheets.document,o));if(!ot(u))return cv(u.reason);if(u.value)return!0}}return!1},e.prototype.formatFormula=function(e,t){var r=rr(e.source.range.sheet,t),n=this.context.parser.formatFormula(_i(e.source,r,{refStyle:this.config.refStyle}),Jv(Ct(e.source.range.range),t,e.formula));return ot(n)?n.value:cv(n.reason)},e}(),Ip=[void 0,ke],Tp=[void 0,Oe],Np=function(){function e(){}return Object.defineProperty(e.prototype,"value",{get:function(){return void 0===this._value?cv(Il(["LETREC cycle"])):this._value},set:function(e){this._value=e},enumerable:!0,configurable:!0}),e}(),Fp=ml.create((function(e,t){return e-t})),_p={kind:ph.CallLambda};var Mp,Dp,wp=function(){function e(e,t,r,n,a,i,o,u,c,s,l){var f=this;this.context=e,this.locals=t,this.precedents=r,this.visitedCells=n,this.visitedNames=a,this.stackEnv=i,this.closureEnv=o,this.usage=u,this.target=c,this.isLambda=s,this.isRunning=!1,this.cellEvaluator=Pa((function(e){return Me(e.sheet,e.range)}),(function(e){var t="error ref, qualifier = "+C(e.data.qualifier);return gf("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",pe.REF,t),Oe}),(function(e,t){if(e.kind===Da.NoOriginSheet){var r="error ref, no sheet, qualifier = "+C(t.data.qualifier);return gf("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",pe.REF,r),Oe}return cv(e)})),this.udfEvaluator=function(e,t,r){return Pa((function(e){if(e.length>1){return gf("calc.runtime.FormulaEvaluationMachine.evalUdfTerm",pe.NAME,"UDF resolution, ambiguous name"),ke}var t=f.globals.getUserDefinedFunc(e[0]);return ot(t)?new bp(t.value):cv(t.reason)}),void 0!==r?function(){return r}:function(e){var t="UDF resolution, qualifier = "+C(e.data.qualifier);return gf("calc.runtime.FormulaEvaluationMachine.evalUdfTerm",pe.NAME,t),ke},(function(e,t){return cv(e)}))(e,t)},this.term=l,this.continuation=[]}return Object.defineProperty(e.prototype,"globals",{get:function(){return this.context.globals},enumerable:!0,configurable:!0}),e.prototype.next=function(){try{return this.doNext()}catch(e){if(e instanceof uv)return sv(this.context,this.visitedCells,e.reason);throw e}},e.prototype.receiveResult=function(e){return ot(e)?this.updateTermTransition(e.value):e},e.prototype.doNext=function(){if(Uh(this.term)){var e=this.continuation;if(0===e.length){var t=fp(this,this.term,this.target),r=Sp(this.globals,t,this.target);return this.precedents.bound=W.Exact,!En(hn.CalcPreventSpillingHack)||this.isLambda||this.locals.lexicalSource.kind!==Vt.Cell||!yf(r)||1===r.rows&&1===r.cols?at(r):it(Il(["spilling"]))}var n=e[e.length-1];return this.applyContinuation(this.term,n)}return this.reduceFormula(this.term)},e.prototype.applyContinuation=function(e,t){var r=t.context;switch(r.kind){case ph.App:var n=t.holeIndex,a=r.children.length;return(i=t.locals)[n]=e,n+1<a?this.nextHoleTransition(t,r.children[n+1]):this.dispatchFunction(i,i,r.data);case ph.Conditional:var i;if(0===(n=t.holeIndex)){var o=bh(r.data.funName),u=o===De.IF?x.Boolean:x.Number,c=fp(this,e,u);if(yf(c))return t.locals=[c],this.nextHoleTransition(t,r.children[n+1]);if(kf(c))return it(Il(["IF/CHOOSE with a rich value condition"]));if(c=Sp(this.globals,c,u),o===De.IF&&"boolean"==typeof c)return this.popContextTransition(r.children[c?1:2]);if(o===De.CHOOSE&&"number"==typeof c){var s=this.context.globals.config.mathpack.fix(c);if(s<1||s>r.children.length-1){var l="CHOOSE; out of bounds option = "+C(s);return gf("calc.runtime.FormulaEvaluationMachine.applyContinuation",pe.VALUE,l),this.popContextTransition(Ee)}return this.popContextTransition(r.children[s])}return b("calc.runtime.FormulaEvaluationMachine.applyContinuation",Cf(c)),this.popContextTransition(c)}return(i=t.locals)[n]=e,n+1<r.children.length?this.nextHoleTransition(t,r.children[n+1]):this.dispatchFunction(i,i,r.data);case ph.Name:var f=this.popContextTransition(e),d=t.locals;return this.locals=d.locals,this.visitedNames=d.visitedNames,f;case ph.Let:n=t.holeIndex;var h=r.children.length-1;if(n>=h){f=this.popContextTransition(e),d=t.locals;return this.stackEnv.length=d.stackEnvLen,f}if(r.data.rec){var v=this.stackEnv.length-h+n;this.stackEnv[v].value=e,this.stackEnv[v]=e}else this.stackEnv.push(e);return this.nextHoleTransition(t,r.children[n+1]);case ph.Array:var p=fp(this,e,vf),m=r.data,g=m.rows,S=m.cols,y=t.holeIndex,E=y%S,O=S===E+1,A=(y-E)/S,R=t.locals;if(R[A][E]=Sp(this.globals,p,vf),g===A+1&&O)return this.popContextTransition(Fe(g,S,R));var I=O?A+1:A,T=O?0:E+1;return this.nextHoleTransition(t,r.children[I][T]);case ph.CallLambda:f=this.popContextTransition(e),d=t.locals;return this.locals=d.locals,this.stackEnv.length=d.stackEnvLen,this.closureEnv=d.closureEnv,this.usage.lambdaDepth-=1,f;default:return k("calc.runtime.FormulaEvaluationMachine.applyContinuation",r)}},e.prototype.reduceFormula=function(e){var t=this;switch(e.kind){case ph.CellRef:return this.updateTermTransition(this.evalCellRefTerm(e));case ph.App:var r=e.data.funName;if(!Rh(r)){var n=bh(r);if(n!==De._UDF){var a=this.globals.getWorksheetFunc(n);if(a.kind===Be.Failure)return cv(a.reason)}}return 0===e.children.length?Ap(i=new Rp(this.context,this.locals,this.precedents,this.visitedCells,this.visitedNames,this.usage).dispatchFunction(r,e.data.funType,e.data.isFormulaRoot,[]))?this.evaluateLambdaTransition(void 0,i):cf(i)?this.evaluateMachineTransition(void 0,i):this.updateTermTransition(i):this.pushContextTransition(e,e.children[0],[]);case ph.Conditional:return this.pushContextTransition(e,e.children[0],void 0);case ph.Let:return this.evaluateLetTransition(e);case ph.Name:var i;if(void 0!==(i=this.evalNameTerm(e))[0]){var o=i[0],u=i[1],c=i[2],s=this.pushContextTransition(e,u,{locals:this.locals,visitedNames:this.visitedNames});return this.locals=function(e,t){var r,n=e.name.scope;if(void 0!==n.index)r=at(n);else{var a=t.originSheet;if(!ot(a))return cv(a.reason);r=vt(a.value.document,n.document)?a:at(n)}var i=t.originGridCell;return Hl(e,i,r,t.calcingArray,i,r,!1,!0,at(!1))}(Ht(o),this.locals),this.visitedNames=c,s}var l=i[1];return this.updateTermTransition(l);case ph.Udf:return this.updateTermTransition(this.evalUdfTerm(e));case ph.ReadStack:return b("calc.runtime.FormulaEvaluationMachine.reduceFormula",void 0!==(f=this.stackEnv[this.stackEnv.length-1-e.data])),this.updateTermTransition(f instanceof Np?f.value:f);case ph.ReadClosure:var f;return b("calc.runtime.FormulaEvaluationMachine.reduceFormula",void 0!==(h=this.closureEnv.getValue(e.data[0]))),b("calc.runtime.FormulaEvaluationMachine.reduceFormula",void 0!==(f=h[e.data[1]])),f instanceof Np&&(f=f.value,h[e.data[1]]=f),this.updateTermTransition(f);case ph.Array:return this.pushContextTransition(e,e.children[0][0],e.children.map((function(){return[]})));case ph.Fun:var d=e.data.closedIdents.map((function(e){var r=t.stackEnv[t.stackEnv.length-1-e];return b("calc.runtime.FormulaEvaluationMachine.reduceFormula",void 0!==r),r})),h=this.closureEnv.setValue(e.data.closureId,d);return this.updateTermTransition(new Op(e.data.arity,this.locals,h,e.children));default:return k("calc.runtime.FormulaEvaluationMachine.reduceFormula",e)}},e.prototype.dispatchFunction=function(e,t,r){var n=r.funName,a=r.funType,i=r.isFormulaRoot;dp(this,t,a);var o=new Rp(this.context,this.locals,this.precedents,this.visitedCells,this.visitedNames,this.usage).dispatchFunction(n,a,i,t);return Ap(o)?this.evaluateLambdaTransition(e,o):cf(o)?this.evaluateMachineTransition(e,o):this.popContextTransition(o)},e.prototype.pushContextTransition=function(e,t,r){var n=function(e,t){return{context:e,holeIndex:0,locals:t}}(e,r);return this.continuation[this.continuation.length]=n,this.updateTermTransition(t)},e.prototype.popContextTransition=function(e){return this.continuation.pop(),this.updateTermTransition(e)},e.prototype.evaluateMachineTransition=function(e,t){var r=t.machine;return void 0!==e&&this.continuation.pop(),$l(r,this)},e.prototype.evaluateLambdaTransition=function(e,t){var r,n,a,i,o,u=t.lambda,c=t.args,s=this.continuation[this.continuation.length-1-(void 0!==e?1:0)],l=(null===(n=s)||void 0===n?void 0:n.context.kind)===ph.CallLambda?s:void 0;return this.usage.lambdaCalls[0]+1>(null!=(a=this.globals.limits.maxLambdaCalls)?a:1/0)?cv(Jl(wl.LambdaCalls)):void 0===l&&this.usage.lambdaDepth+1>(null!=(i=this.globals.limits.maxLambdaDepth)?i:1/0)?cv(Jl(wl.LambdaDepth)):(void 0!==e&&this.continuation.pop(),void 0!==l?(o=this.updateTermTransition(u.term),this.stackEnv.length=l.locals.stackEnvLen):(o=this.pushContextTransition(_p,u.term,{locals:this.locals,stackEnvLen:this.stackEnv.length,closureEnv:this.closureEnv}),this.usage.lambdaDepth+=1),(r=this.stackEnv).push.apply(r,c),this.closureEnv=u.env,this.locals=function(e,t){return Hl(e.locals.lexicalSource,e.locals.originGridCell,e.locals.originSheet,t.calcingArray,t.reflectionGridCell,t.reflectionSheet,t.implicitIntersect,e.locals.wrapCellReferences,at(!1))}(u,this.locals),this.usage.lambdaCalls[0]+=1,o)},e.prototype.evaluateLetTransition=function(e){var t=this.pushContextTransition(e,e.children[0],{stackEnvLen:this.stackEnv.length});if(e.data.rec)for(var r=e.children.length-1,n=0;n<r;n+=1)this.stackEnv.push(new Np);return t},e.prototype.nextHoleTransition=function(e,t){return e.holeIndex+=1,this.updateTermTransition(t)},e.prototype.updateTermTransition=function(e){return this.term=e,Zl},e.prototype.getNameFormulaAsTerm=function(e){this.precedents.names.push(e);var t=this.globals.getNameFormula(e);if(t.kind===Be.Failure)return cv(t.reason);var r=t.value;return null!=r?nv("calc.runtime.FormulaEvaluationMachine.getNameFormulaAsTerm",r):void 0},e.prototype.checkForNameCycle=function(e){var t,r=this.visitedNames,n=r.map.getValue(e);return void 0!==n?cv(function(e,t){for(var r=[],n=t;r.push(n.name),n!==e;n=n.previous);return r.reverse(),Kl(r)}(n,r.current)):this.visitedNames.map.getCount()+1>(null!=(t=this.globals.limits.maxNameChain)?t:1/0)?cv(Jl(wl.NameChain)):function(e,t){var r={name:t,previous:e.current};return gv(r,e.map.setValue(t,r))}(this.visitedNames,e)},e.prototype.nameEvaluator=function(e,t,r){var n=this,a=void 0!==r?function(){return[void 0,r]}:function(e){var t="name resolution; qualifier = "+C(e.data.qualifier);return gf("calc.runtime.FormulaEvaluationMachine.evalName",pe.NAME,t),Ip};return Pa((function(t){var r=n.getNameFormulaAsTerm(t);return void 0===r?a(e):[t,r,n.checkForNameCycle(t)]}),a,(function(e,t){if(e.kind===Da.NoOriginSheet){var r="name resolution, no sheet; qualifier = "+C(t.data.qualifier);return gf("calc.runtime.FormulaEvaluationMachine.evalName",pe.REF,r),Tp}return cv(e)}))(e,t)},e.prototype.evalNameTerm=function(e){var t=this.context.resolver.resolveName(this.locals,fe(e.data.name,e.data.qualifier))[1];return this.nameEvaluator(e,t,e.children)},e.prototype.evalCellRefTerm=function(e){var t=this.context.resolver.resolveCellRef(this.locals,de(e.data.ref,e.data.qualifier))[1];return this.cellEvaluator(e,t)},e.prototype.evalUdfTerm=function(e){var t=this.context.resolver.resolveUserDefinedFunc(this.locals,fe(e.data.name,e.data.qualifier))[1];return this.udfEvaluator(e,t,e.children)},e}();function Lp(e,t,r,n,a){return new wp(e,t,r,n,Cv,[],Fp,{lambdaCalls:[0],lambdaDepth:0},mf,!1,nv("calc.runtime.createFormulaEvaluationMachine",a))}function Up(e,t,r,n,a,i,o,u){return b("calc.runtime.createLambdaEvaluationMachine",u.length===o.arity),new wp(e,t,r,n,a,Object(j.f)(u),o.env,i,P.All,!0,o.term)}function xp(e,t,r){var n,a=Rv(e),i=lv(),o=Lp(a.machineContext,t,i,mv,r),u=new Tv(a,[o]),c=kv(null!=(n=t.schedulerConfig)?n:e.schedulerConfig);return function e(t){return Array.isArray(t)?t[0]:Ql((function(r){return e(t.resume(r))}))}(u.evaluateSync(c))}function Pp(e){return{evalFormula:function(t,r){return xp(e,t,r)},evalCells:function(t){return function(e,t){if(0===t.length)return[];var r=Ov(e,t),n=kv(e.schedulerConfig);return r.evaluateSync(n)}(e,t)},evalCellsAsync:function(t){return function(e,t){if(0===t.length)return Promise.resolve([]);var r=Ov(e,t),n=kv(e.schedulerConfig);return r.evaluateAsync(n)}(e,t)}}}(Dp=Mp||(Mp={})).DerefOperKind=dh,Dp.machine=i;var Gp=function(e,t){return{functionId:e,functionName:t}},Vp=function(e,t){return{errorType:e,errorName:t}},Bp=function(e,t,r,n,a,i,o,u,c,s,l,f,d,h){var v=[];return t.forEach((function(e,t){"string"==typeof e?v.push(Vp(t,e)):lr(e)&&v.push(e)})),{worksheetFunctionNames:e,errorTypeNames:v,errorNames:[],trueName:r,falseName:n,rowLetter:a,columnLetter:i,leftBrace:o,rightBrace:u,leftBracket:c,rightBracket:s,decimalSeparator:l,listSeparator:f,columnSeparator:d,rowSeparator:h}};function Wp(e,t,r,n,a){return"number"==typeof a&&"string"==typeof n?{iformat:e,category:n,decimals:a}:"boolean"!=typeof r?{iformat:e,category:t,decimals:r}:A("calc.calc.numberFormat")}var jp=function(e,t){return{sheetId:e,sheetName:t}},Hp={kind:"Blank"},Kp=function(e){return{kind:"Error",type:e}},qp=function(e){return{kind:"Rich",fields:e}};function Yp(e){return"object"==typeof e?e.kind:typeof e}var Jp=function(e,t){return{row:e,column:t}},Qp=function(e,t,r,n){return{row:e,column:t,lastRow:r,lastColumn:n}},Xp=function(e,t,r,n,a){return{sheetId:e,row:t,column:r,lastRow:n,lastColumn:a}},zp=function(e,t,r,n,a){return void 0===a&&(a="Inferred"),{formulaBarText:e,value:t,iformat:r,failureReason:n,kind:a}};function Zp(e,t,r,n){return zp(e,t,r,n,"CellFormula")}function $p(e,t,r){return zp(void 0,e,t,r,"ArrayFormula")}function em(e,t,r,n){return zp(e,t,r,n,"Value")}var tm=function(e,t,r,n,a){return{range:e,data:t,fromStateId:r,excludeRows:n,excludeColumns:a}},rm=function(e,t,r,n){return tm(e,t,void 0,r,n)};function nm(e,t,r,n){return tm(e,void 0,t,r,n)}var am=function(e,t){return{isSpilled:e,formulaBarText:t}},im=function(e,t,r){return{range:e,data:t,fromStateId:r}};function om(e,t){return im(e,t,void 0)}function um(e,t){return im(e,void 0,t)}var cm=function(e,t){return{sheetId:e,usedRange:t}},sm=function(e){return{kind:"NamedValue",value:e}},lm=function(e){return{kind:"NamedFormula",formulaBarText:e}},fm=function(e){return{kind:"NamedRange",range:e}},dm=function(e,t){return{kind:"NamedFailure",failureReason:e,objectKind:t}},hm=function(e,t){return{name:e,data:t}},vm=function(e,t,r){return{scope:e,objects:t,fromStateId:r}};function pm(e,t){return vm(e,t,void 0)}function mm(e){return vm(e,void 0,void 0)}function gm(e,t){return vm(e,void 0,t)}var Cm=function(e,t,r,n,a,i){return void 0===i&&(i="Inferred"),{range:Array.isArray(e)?e:[e],formulaBarText:t,value:r,origin:n,viewport:a,kind:i}};function Sm(e,t,r,n){return Cm(e,t,void 0,r,n,"CellFormula")}function ym(e,t,r,n){return Cm(e,t,r,void 0,n,"Value")}function Em(e,t,r,n){return Cm(e,t,void 0,r,n,"Inferred")}var Om,km,Am,bm,Rm=function(e,t,r,n){return{range:e,formulaBarText:t,origin:r,viewport:n}},Im=function(e,t,r,n,a){return{isExact:e,iformat:t,hasHyperlink:r,category:n,decimals:a}},Tm=function(e,t,r){return{formulaBarText:e,value:t,format:r}},Nm=function(e,t){return{range:e,data:t}},Fm=function(e,t){return{range:e,data:t}},_m=function(e,t,r){return{range:e,task:t,reason:r}},Mm=function(e,t,r,n,a,i){return{stateId:e,priorityGroup:t,isFinished:r,rangeDeltas:n,arrayDeltas:a,rangeFailures:[]}},Dm=function(e,t,r){return{rangeUpdateRanges:e,arrayUpdateRanges:t,namesUpdateScopes:r}},wm=function(e,t){return{name:e,param:t}},Lm=function(e,t,r,n,a,i,o,u,c,s){return{totalEvalTimeMs:e,samplePrecisionEvalRate:t,samplePrecisionPrintFormulaRate:s,sampleRecalcStatisticsRate:u,sampleWorkbookStatisticsRate:n,rngSeed:r,sampleRecalcEditedStopwatchRate:a,sampleRecalcViewportStopwatchRate:i,sampleCellEvalStopwatchRate:o,runExperiments:c}},Um=function(e,t,r){return{date1904:e,dateCompatibility:t,timezone:r}};function xm(e,t){return e.then((function(e){return t(),e}),(function(e){return t(),Promise.reject(e)}))}function Pm(){var e;return[new Promise((function(t,r){return e=[t,r]})),e]}function Gm(e,t){var r=Pm(),n=r[0],a=r[1],i=a[0],o=a[1],u=setTimeout(t,Math.max(0,e));return[n,[function(e){clearTimeout(u),i(e)},function(e){clearTimeout(u),o(e)}]]}function Vm(e,t,r){var n=Gm(e,(function(){return s(t())})),a=n[0],i=n[1],o=i[0],u=i[1],c=!1;function s(e){u(e),c=!0}var l=Promise.resolve().then((function(e){return r(s,(function(){return c}))}));return xm(Promise.race([a,l]),o)}function Bm(e,t){var r;return new Promise((function(n,a){Promise.resolve(t).then((function t(i){if(void 0!==i){r=i;try{Promise.resolve(e(r)).then(t,a)}catch(e){a(e)}}else n(r)}),a)}))}function Wm(e,t){return{setMessageListeners:function(t){e.onmessage=function(e){return t.onMessage(e.data)},e.onmessageerror=function(e){return t.onMessageError(e.data)}},postMessage:e.postMessage.bind(e),close:t.bind(e)}}function jm(e){return null!=e&&(e instanceof Error||"string"==typeof e.name&&"string"==typeof e.message&&(void 0===e.stack||"string"==typeof e.stack))}!function(e){e.FunctionCall="FunctionCall",e.MessageChannel="MessageChannel",e.Dedicated="Dedicated"}(Om||(Om={})),function(e){e.PostCallError="PostCallError",e.PostNotifyError="PostNotifyError",e.PostResultError="PostResultError",e.UnhandledNotifyError="UnhandledNotifyError",e.UnhandledError="UnhandledError"}(km||(km={})),function(e){e.App="App",e.Result="Result",e.Close="Close"}(Am||(Am={})),function(e){e[e.Fulfilled=0]="Fulfilled",e[e.Rejected=1]="Rejected"}(bm||(bm={}));var Hm,Km={Error:Error,EvalError:EvalError,RangeError:RangeError,ReferenceError:ReferenceError,SyntaxError:SyntaxError,TypeError:TypeError,URIError:URIError};function qm(e){return[e.name,e.message,e.stack]}function Ym(e){var t,r=e[0],n=e[1],a=e[2],i=Km[r];return null!=i?t=new i(n):(t=new Error(n)).name=r,void 0!==a&&(t.stack=a),t}function Jm(e){return jm(e)?[Hm.Error,qm(e)]:[Hm.Unknown,e]}function Qm(e,t,r,n){var a=new Error(e);return a.stack=e+"\n    at "+t+":"+r+":"+n,a}!function(e){e[e.Unknown=0]="Unknown",e[e.Error=1]="Error"}(Hm||(Hm={}));function Xm(e){var t=e.message.indexOf("__START_ERROR__"),r=e.message.indexOf("__END_ERROR__");return t>=0&&r>=0?Ym(JSON.parse(e.message.substring(t+"__START_ERROR__".length,r))):null!=e.error?e.error:Qm(e.message,e.filename,e.lineno,e.colno)}function zm(e,t,r,n){var a=e[t];null!=a&&(delete e[t],a[r](n))}function Zm(e,t,r,n,a,i){var o={port:t,callbacks:{},lastAppId:-1,modules:{}};function u(){if(null==o)throw new Error("endpoint is closed");return o}function c(e,t,r,n,a){var i;try{i=u()}catch(e){return Promise.reject(e)}var o=i.lastAppId+1,c=[Am.App,o,e,t,r,a],s=Gm(n,(function(){l(c,new Error("exceeded timeout; callTimeout = "+n+"ms"))})),f=s[0],d=s[1];i.callbacks[o]=d,i.lastAppId=o;try{i.port.postMessage(c)}catch(e){l(c,e)}return f}function s(e,t,r,n){var a=u(),i=[Am.App,-1,e,t,r,n];try{a.port.postMessage(i)}catch(e){l(i,e)}}function l(e,t){var r=e[1],n=e[5];null!=o&&(r>=0&&zm(o.callbacks,r,bm.Rejected,t),n?g(r>=0?km.PostCallError:km.PostNotifyError,t,!0):(r<0&&g(km.PostNotifyError,t,!1),c("","",[],Math.max(C.callTimeout,C.initTimeout),!0).catch((function(e){}))))}function f(e){var t=e[1],r=e[2],n=e[3],a=e[4],i=e[5];if(null!=o)if(""!==r||""!==n){var u=Promise.resolve().then((function(e){if(null!=o){var t=r,i=n,u=o.modules[t],c=null!=u?u[i]:void 0;if(null==c)throw new Error("method "+t+"."+i+" has not been exported");return c.apply(u,a)}}));t>=0?u.then((function(e){return d(t,bm.Fulfilled,e,i)}),(function(e){return d(t,bm.Rejected,e,i)})):u.catch((function(e){g(km.UnhandledNotifyError,function(e,t,r){var n=t+"."+r+".notify: ";if(jm(e))return e.message=n+e.message,null!=e.stack&&(e.stack=n+e.stack),e;var a=new Error(n+e);return a.stack=void 0,a}(e,r,n),!1)}))}else d(t,bm.Fulfilled,void 0,i)}function d(e,t,r,n){if(null!=o){var a=[Am.Result,e,t,Jm(r),n];try{o.port.postMessage(a)}catch(e){h(a,e)}}}function h(e,t){var r=e[1],n=e[4];null!=o&&(n?g(km.PostResultError,t,!0):d(r,bm.Rejected,Jm(t),!0))}function v(e){var t=e[1],r=e[2],n=e[3];null!=o&&zm(o.callbacks,t,r,function(e){return e[0]===Hm.Unknown?e[1]:Ym(e[1])}(n))}function m(e){if(void 0===e&&(e=!0),null!=o){var t=o.port,r=o.callbacks;if(o=void 0,e)try{t.postMessage([Am.Close])}catch(e){}var n=new Error((e?"this":"other")+" endpoint closed while waiting for a response");for(var a in r)zm(r,Number(a),bm.Rejected,n);try{t.close()}catch(e){}if(null!=i)try{i(C)}catch(n){var u=p(n);console.log("calc.worker.createPortEndpoint.close: unhandled error: "+u)}}}function g(e,t,r){if(null!=o){var n=void 0;try{a(C,{kind:e,closing:r,error:t})||(n=[t])}catch(t){n=[t]}if(r&&m(),null!=n){var i=p(n[0]);console.log("calc.worker.createPortEndpoint.dispatchError: unhandled error: "+i)}}}var C={workerKind:e,initTimeout:r,callTimeout:n,setExports:function(e,t){return u().modules[e]=t},getImports:function(e,t){var r={};return t.forEach((function(t){return r[t]=function(e,t){var r={callTimeout:void 0,isCritical:!1,call:function(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];var i=null!=r.callTimeout?r.callTimeout:C.callTimeout;return c(e,t,n,i,r.isCritical)},notify:function(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];s(e,t,n,r.isCritical)}};return r}(e,t)})),r},close:m,dispatchError:g};return o.port.setMessageListeners({onMessage:function(e){switch(e[0]){case Am.App:return f(e);case Am.Result:return v(e);case Am.Close:return m(!1);default:return k("calc.worker.createPortEndpoint.onMessage",e)}},onMessageError:function(e){var t=new Error("failed to send "+e[0]+" message");switch(e[0]){case Am.App:return l(e,t);case Am.Result:return h(e,t);case Am.Close:return;default:return k("calc.worker.createPortEndpoint.onMessageError",e)}}}),C}function $m(e,t,r){var n=this,a=null!=t.initTimeout?t.initTimeout:6e4,i=null!=t.callTimeout?t.callTimeout:3e4;return Vm(a,(function(){return new Error("exceeded timeout; initTimeout = "+a+"ms")}),(function(o,u){return Object(j.b)(n,void 0,void 0,(function(){function n(e){return function(t,r){return s?null!=e.onError&&(e.onError(t,r),!0):(o(r.error),!0)}}function c(e){return function(t){s&&null!=e.onClosed&&e.onClosed(t)}}var s,l,f;return Object(j.d)(this,(function(o){switch(o.label){case 0:return s=!1,l=Zm(e,r.outside,a,i,n(t.outside),c(t.outside)),f=Zm(e,r.inside,a,i,n(t.inside),c(t.inside)),u()||null==t.inside.onInit?[3,2]:[4,t.inside.onInit(f)];case 1:o.sent(),o.label=2;case 2:return u()||null==t.outside.onInit?[3,4]:[4,t.outside.onInit(l)];case 3:o.sent(),o.label=4;case 4:return s=!0,[2,l]}}))}))}))}function eg(){return"undefined"!=typeof MessageChannel}var tg=function(){function e(){this.other=void 0}return e.prototype.onMessage=function(e){return A("calc.worker.FunctionCallPort.onMessage: "+("expected onMessage to be set before receiving messages; received "+JSON.stringify(e)))},e.prototype.open=function(e){this.other=e,e.other=this},e.prototype.setMessageListeners=function(e){null!=this.other&&(this.onMessage=e.onMessage)},e.prototype.postMessage=function(e){null!=this.other&&this.other.onMessage(e)},e.prototype.close=function(){if(null!=this.other){var e=this.other;this.other=e.other=void 0,this.onMessage=e.onMessage=function(){}}},e}();var rg,ng;function ag(){if(null==pi.getCalcAbsUrl()){return O.ULS.traceTag(595907587,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,"calc.worker.isDedicatedWorkerSupported: initCalc was not passed calcAbsUrl"),!1}return"undefined"!=typeof Worker}function ig(e){setTimeout((function(){try{e.terminate()}catch(e){}}),100)}function og(){var e={};for(var t in hn){var r=hn[t];null!=r&&(e[r]=En(r))}return e}var ug=((rg={})[Om.FunctionCall]=function(){return!0},rg[Om.MessageChannel]=eg,rg[Om.Dedicated]=ag,rg);function cg(e){return ug[e]()}var sg=((ng={})[Om.FunctionCall]=function(e){return $m(Om.FunctionCall,e,(t=new tg,r=new tg,t.open(r),{outside:t,inside:r}));var t,r},ng[Om.MessageChannel]=function(e){if(!eg())return A("calc.worker.createMessageChannelWorker: expected an execution context where message channel workers are supported");var t=function(){var e=new MessageChannel;return{outside:Wm(e.port1,e.port1.close.bind(e.port1)),inside:Wm(e.port2,e.port2.close.bind(e.port1))}}();try{return $m(Om.MessageChannel,e,t)}catch(e){try{t.outside.close()}catch(e){}throw e}},ng[Om.Dedicated]=function(e){var t=this,r=e.outside,n=e.inside,a=e.initTimeout,i=e.callTimeout,o=n.scriptName;if(null==o)return A("calc.worker.createDedicatedWorker: expected workerDef.inside.scriptName to be defined");var u=pi.getCalcAbsUrl();if(!ag()||null==u)return A("calc.worker.createDedicatedWorker: expected a context where dedicated workers are supported");var c=null!=a?a:6e4,s=null!=i?i:3e4;return Vm(c,(function(){return new Error("exceeded timeout; initTimeout = "+c+"ms")}),(function(e,n){return gn("calc.worker.createDedicatedWorker (total)",(function(){return Object(j.b)(t,void 0,void 0,(function(){function t(t){return Object(j.b)(this,void 0,void 0,(function(){function a(t,n){return o?null!=r.onError&&(r.onError(t,n),!0):(e(n.error),!0)}function i(e){o&&null!=r.onClosed&&r.onClosed(e)}var o,l,f,d,h;return Object(j.d)(this,(function(e){switch(e.label){case 0:o=!1,e.label=1;case 1:return e.trys.push([1,6,,7]),l=new Worker(t),d=Wm(l,(function(){return ig(l)})),f=Zm(Om.Dedicated,d,c,s,a,i),l.onerror=function(e){var r;e.preventDefault(),r=null==e.message?new Error("worker.onerror received non-ErrorEvent (worker script fetch probably failed); url = "+t):Xm(e),f.dispatchError(km.UnhandledError,r,!o)},function(e,t){var r={shipAssertTag:function(e,r,n,a){try{t.ULS.shipAssertTag(e,r,n,a)}catch(e){}},assertTag:function(e,r,n,a){try{t.ULS.assertTag(e,r,n,a)}catch(e){}},traceTag:function(e,r,n,a){try{t.ULS.traceTag(e,r,n,a)}catch(e){}},debugTraceTag:function(e,r,n,a){try{t.ULS.debugTraceTag(e,r,n,a)}catch(e){}}};e.setExports("",r)}(f,O),n()?[3,3]:[4,gn("calc.worker.createDedicatedWorker (inside)",(function(){var e=f.getImports("",["init"]).init;return e.callTimeout=c,e.isCritical=!0,e.call({initTimeout:c,callTimeout:s,calcAbsUrl:u,features:og()})}))];case 2:e.sent(),e.label=3;case 3:return n()||null==r.onInit?[3,5]:[4,r.onInit(f)];case 4:e.sent(),e.label=5;case 5:return o=!0,[2,f];case 6:throw h=e.sent(),null!=f?f.close():null!=l&&ig(l),h;case 7:return[2]}}))}))}var a,i,l,d;return Object(j.d)(this,(function(e){switch(e.label){case 0:n=o+(/\.min\.js$/.test(r=u)?".min.js":".js"),c=r.lastIndexOf("/"),a=r.substring(0,c+1)+n,i="calc.worker.createDedicatedWorker: workerUrl = "+a,O.ULS.traceTag(595907588,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,i),e.label=1;case 1:e.trys.push([1,6,,7]),l=new Blob(['importScripts("'+encodeURI(a)+'");'],{type:"application/javascript"}),d=URL.createObjectURL(l),e.label=2;case 2:return e.trys.push([2,,4,5]),[4,t(d)];case 3:return[2,e.sent()];case 4:return URL.revokeObjectURL(d),[7];case 5:return[3,7];case 6:return e.sent(),O.ULS.traceTag(595881991,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Warning,"calc.worker.createDedicatedWorker: failed to start worker from blob url for "+a+". Attempting with string url instead..."),[2,t(a)];case 7:return[2]}var r,n,c}))}))}))}))},ng);function lg(e,t){return sg[e](t)}function fg(e,t){return Object(j.b)(this,void 0,void 0,(function(){var r,n,a,i,o;return Object(j.d)(this,(function(u){switch(u.label){case 0:r=0,u.label=1;case 1:if(!(r<e.length))return[3,6];if(!cg(n=e[r]))return[3,5];u.label=2;case 2:return u.trys.push([2,4,,5]),[4,lg(n,t)];case 3:return[2,u.sent()];case 4:return a=u.sent(),i=p(a),o="calc.worker.tryCreateWorker: starting "+n+" worker threw "+i,O.ULS.traceTag(595907598,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Warning,o),[3,5];case 5:return r+=1,[3,1];case 6:return[2,void 0]}}))}))}function dg(){setTimeout((function(){try{self.close()}catch(e){}}),100)}function hg(e,t,r,n){var a=t.initTimeout,i=t.callTimeout,o=t.calcAbsUrl,u=t.features;return Object(j.b)(this,void 0,void 0,(function(){var t,c,s,l,f=this;return Object(j.d)(this,(function(d){switch(d.label){case 0:return function(){if("undefined"==typeof self||null!=self.document)throw new Error("not in a worker execution context")}(),[4,Vm(a,(function(){return new Error("exceeded timeout; initTimeout = "+a+"ms")}),(function(e,t){return Object(j.b)(f,void 0,void 0,(function(){function c(t,r){return l?null!=n.onError&&(n.onError(t,r),!0):(e(r.error),!0)}function s(e){l&&null!=n.onClosed&&n.onClosed(e)}var l,f,d,h,v,p;return Object(j.d)(this,(function(e){switch(e.label){case 0:l=!1,e.label=1;case 1:return e.trys.push([1,4,,5]),d=Wm(self,dg),f=Zm(Om.Dedicated,d,a,i,c,s),h=function(e){var t=e.getImports("",["shipAssertTag","assertTag","traceTag","debugTraceTag"]);function r(e){return"["+(new Date).toISOString()+"] "+e}return{shipAssertTag:function(e,n,a,i){if(t.shipAssertTag.notify(e,n,a,r(i)),!a)throw new Error("shipAssertTag: "+e+" "+n+" "+i)},assertTag:function(e,n,a,i){if(t.assertTag.notify(e,n,a,r(i)),!a)throw new Error("assertTag: "+e+" "+n+" "+i)},traceTag:function(e,n,a,i){t.traceTag.notify(e,n,a,r(i))},debugTraceTag:function(e,n,a,i){t.debugTraceTag.notify(e,n,a,r(i))}}}(f),v=function(e){return!0===u[e]},r.config.initCalc(h,v,o),t()||null==n.onInit?[3,3]:[4,n.onInit(f)];case 2:e.sent(),e.label=3;case 3:return l=!0,[3,5];case 4:throw p=e.sent(),null!=f?f.close():dg(),p;case 5:return[2]}}))}))})).then((function(e){return[bm.Fulfilled,e]}),(function(e){return[bm.Rejected,e]}))];case 1:t=d.sent(),c=t[0],s=t[1],l=[Am.Result,e,c,Jm(s),!0];try{self.postMessage(l)}catch(e){throw dg(),e}return[2]}}))}))}var vg=[{name:"self",test:function(){return"undefined"!=typeof self}},{name:"fetch",test:function(){return"function"==typeof fetch}},{name:"Set",test:function(){return"function"==typeof Set}},{name:"Map",test:function(){return"function"==typeof Map}},{name:"WeakMap",test:function(){return"function"==typeof WeakMap}},{name:"Symbol",test:function(){return"function"==typeof Symbol}},{name:"WebAssembly",test:function(){return"object"==typeof WebAssembly}},{name:"Atomics",test:function(){return"object"==typeof Atomics}},{name:"BigInt",test:function(){return"function"==typeof BigInt}},{name:"String.startsWith",test:function(){return"function"==typeof"".startsWith}},{name:"String.codePointAt",test:function(){return"function"==typeof"".codePointAt}},{name:"Object.assign",test:function(){return"function"==typeof Object.assign}},{name:"Object.setPrototypeOf",test:function(){return"function"==typeof Object.setPrototypeOf}},{name:"Number.EPSILON",test:function(){return"number"==typeof Number.EPSILON}},{name:"Number.isFinite",test:function(){return"function"==typeof Number.isFinite}},{name:"Number.parseInt",test:function(){return"function"==typeof Number.parseInt}},{name:"Math.acosh",test:function(){return"function"==typeof Math.acosh}},{name:"Math.hypot",test:function(){return"function"==typeof Math.hypot}},{name:"Math.log1p",test:function(){return"function"==typeof Math.log1p}},{name:"Math.trunc",test:function(){return"function"==typeof Math.trunc}},{name:"Promise.finally",test:function(){return"function"==typeof Promise.resolve().finally}},{name:"RegExp_flags",test:function(){return new RegExp("x","i")&&!0}},{name:"RegExp.flags",test:function(){return"string"==typeof/x/.flags}},{name:"Array.of",test:function(){return"function"==typeof Array.of}},{name:"Array.entries",test:function(){return"function"==typeof[].entries}},{name:"Array.find",test:function(){return"function"==typeof[].find}},{name:"performance",test:function(){return"object"==typeof performance}},{name:"performance.now",test:function(){return"function"==typeof performance.now}},{name:"performance.timeOrigin",test:function(){return"number"==typeof performance.timeOrigin}},{name:"performance.memory",test:function(){return"object"==typeof performance.memory}}];function pg(){return vg.map((function(e){var t=e.name,r=e.test;try{return r()?"":t}catch(e){return t}})).filter((function(e){return e.length>0}))}function mg(){var e="object"==typeof performance?performance.memory:void 0;return null!=e?{jsHeapSizeLimit:e.jsHeapSizeLimit,totalJSHeapSize:e.totalJSHeapSize,usedJSHeapSize:e.usedJSHeapSize}:void 0}var gg=function(e){var t=e.config,r=e.connection;"Thread"===r.createMode&&vn.setConfig(t);var n=[];return vn.Endpoint.createInside(r,(function(){return{startMemoryTest:function(e){var t=mg(),r=0;try{for(;r<e;r+=1){var a=new Uint8Array(1024);a[0]=0,a[1023]=255,n.push(a)}}catch(e){}return[t,r,mg()]},endMemorytest:function(){n=[]},ping:function(e){return e+1},getMissingJSFeatures:pg}}))},Cg=!1,Sg=void 0;function yg(){null!=Sg&&Sg.close(),Cg=!1}var Eg=Promise.resolve();function Og(e,t,r,n){return void 0===n&&(n=0),En(hn.CalcWebWorkerTest)?(yg(),Eg=Eg.then((function(r){return function(e,t,r,n){return Object(j.b)(this,void 0,void 0,(function(){var r,a,i,o,u,c,s,l,d,h,v,p,m,g,C,S,y=this;return Object(j.d)(this,(function(E){switch(E.label){case 0:Cg=!0,E.label=1;case 1:if(E.trys.push([1,8,9,10]),S="calc.twSmokeTest.runSmokeTest: starting; duration = "+e+" ms, pingInterval = "+t+" ms",O.ULS.traceTag(593335264,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,S),null==(r=Ca()))throw new Error("initCalc was not passed calcAbsUrl");return[4,vn.createWorker({id:"SmokeTest",createMode:"ThreadOrLocal"},{local:gg,thread:{scriptUrl:r,insideInitName:"excelOnlineCalc.worker.smokeTestInsideInit"}})];case 2:if(Sg=E.sent(),!Cg)throw a="smoke test canceled during worker creation",O.ULS.traceTag(593335265,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Warning,a),new Error(a);return S="calc.twSmokeTest.runSmokeTest: worker created; outside.createMode = "+Sg.createMode,O.ULS.traceTag(593335266,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,S),[4,Sg.call.ping(-1)];case 3:if(0!==(i=E.sent()))throw new Error("expected 0; got "+i);return n>0&&"Thread"===Sg.createMode?(o=mg(),[4,Sg.call.startMemoryTest(n)]):[3,5];case 4:u=E.sent(),c=u[0],s=u[1],l=u[2],d=mg(),h={startMain:o,startThread:c,kb:s,endThread:l,endMain:d},v="calc.twSmokeTest.runSmokeTest: memory = "+JSON.stringify(h),O.ULS.traceTag(592488325,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,v),Sg.post.endMemorytest(),E.label=5;case 5:return m={main:pg()},[4,Sg.call.getMissingJSFeatures()];case 6:return m.worker=E.sent(),p=m,S="calc.twSmokeTest.runSmokeTest: missing = "+JSON.stringify(p),O.ULS.traceTag(593335267,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,S),g=Date.now(),[4,Bm((function(r){return Object(j.b)(y,void 0,void 0,(function(){var n;return Object(j.d)(this,(function(a){switch(a.label){case 0:return Date.now()>=g+e||!Sg||Sg.hasBeenClosed()?[2,void 0]:r%1e3!=0?[3,2]:(n=mn("calc.twSmokeTest.runSmokeTest: ping call roundtrip"),[4,Sg.call.ping(r)]);case 1:a.sent(),n.stop(),a.label=2;case 2:return[4,new Promise((function(e){return setTimeout((function(){return e()}),t)}))];case 3:return a.sent(),Sg.post.ping(r),[2,r+1]}}))}))}),0)];case 7:return E.sent(),S="calc.twSmokeTest.runSmokeTest: success",O.ULS.traceTag(593335296,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,S),[3,10];case 8:return C=E.sent(),Cg&&(S="calc.twSmokeTest.runSmokeTest: failure: "+C.message,O.ULS.traceTag(593335297,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Warning,S)),[3,10];case 9:return yg(),Sg=void 0,[7];case 10:return[2]}}))}))}(e,t,0,n)}))):Promise.resolve()}var kg={onError:function(e,t){var r=null!=t.error.stack?t.error.stack:t.error.message,n="calc.worker.smokeTestInsideDef.onError: "+JSON.stringify({kind:t.kind,closing:t.closing,message:r});O.ULS.traceTag(595908699,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Error,n)},onClosed:function(e){},onInit:function(e){var t=e.getImports("talk",["ping"]);e.setExports("location",ii),e.setExports("talk",{start:function(e,r,n){return Object(j.b)(this,void 0,void 0,(function(){var a,i=this;return Object(j.d)(this,(function(o){switch(o.label){case 0:return a=Date.now(),[4,Bm((function(o){return Object(j.b)(i,void 0,void 0,(function(){return Object(j.d)(this,(function(i){switch(i.label){case 0:return Date.now()>=a+e?[2,void 0]:[4,new Promise((function(e){return setTimeout((function(){return e()}),r)}))];case 1:return i.sent(),t.ping.notify(o,n),[2,o+1]}}))}))}),0)];case 1:return o.sent(),[2]}}))}))},memoryTest:function(e){var t=[],r=0;try{for(;r<e;r+=1){var n=new Uint8Array(1024);n[0]=0,n[1023]=255,t.push(n)}}catch(e){}t=[];var a="calc.worker.smokeTestInsideDef.memoryTest: memory allocated = "+r+"KB";O.ULS.traceTag(595906820,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,a)},ping:function(e,t){if(t&&e%1e3==0){var r="calc.worker.smokeTestInsideDef.ping: n = "+e;O.ULS.traceTag(595907656,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,r)}return e+1},logMessage:function(e,t){if(t){var r="calc.worker.smokeTestInsideDef.logMessage: msg = "+e;O.ULS.traceTag(595714188,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,r)}}})},scriptName:"excelOnlineCalcSmokeTest.worker"};function Ag(e,t){var r=e[0],n=e[1],a=t[0],i=t[1];return[vr(r,a),pr(n,i)]}function bg(e,t){var r=e[0],n=e[1],a=t[0],i=t[1];return[pr(r,a),vr(n,i)]}function Rg(e,t){var r=e[0],n=e[1],a=t[0],i=t[1];return pr(r,a)<vr(n,i)}function Ig(e,t){var r=e[0],n=e[1],a=t[0],i=t[1];return r<a&&i>=n?[r,a]:r>=a&&i<n?[i,n]:void 0}function Tg(e,t){var r=e[0],n=e[1],a=t[0],i=t[1];return r===a&&n===i?0:r>=a&&n<=i?-1:r<=a&&n>=i?1:void 0}var Ng,Fg=j.a;function _g(e){var t,r,n,a=Object(j.a)(Object(j.a)({},e),{split:(t=e.split,r=e.top,void 0===n&&(n=10),function(e){if(void 0!==e.split)return e.split;var a=t(e),i=e===r?0:e.depth;return void 0!==i&&i<n&&(e.split=a,a[0][0].depth=i+1,a[1][0].depth=i+1),a})});return function(e){return Mg(a,qg(a,a.top,e))}}function Mg(e,t){return t===Hg||t===jg?t:{setOperations:e,root:t}}function Dg(e,t){return t===Hg?e:t===jg||e===Hg?t:e===jg?e:Mg(e.setOperations,wg(e.setOperations,e.setOperations.top,e.root,t.root))}function wg(e,t,r,n){if(n===Hg)return r;if(n===jg)return n;if(r===Hg)return n;if(r===jg)return r;if(r.isExact&&n.isExact){var a=function(e,t,r,n){var a=r.key,i=n.key,o=e.compare(a,i);if(void 0!==o)return o<0?n:r;var u=e.union(a,i);if(void 0!==u){var c=e.compare(u,t);return void 0!==c&&0===c?jg:Yg(e,t,u,!0)}return}(e,t,r,n);if(void 0!==a)return a}var i=Jg(e,t,r),o=Jg(e,t,n),u=e.split(t),c=u[0][0],s=u[1][0];return Wg(e,c,s,wg(e,c,i.left,o.left),wg(e,s,i.right,o.right))}function Lg(e,t){return e===Hg?e:t===Hg||e===jg?t:t===jg?e:Mg(e.setOperations,Ug(e.setOperations,e.setOperations.top,e.root,t.root))}function Ug(e,t,r,n){if(r===Hg)return r;if(n===Hg)return n;if(r===jg)return n;if(n===jg)return r;if(r.isExact&&n.isExact){var a=function(e,t,r,n){var a=r.key,i=n.key;if(!e.meets(a,i))return Hg;var o=e.compare(a,i);if(void 0!==o)return o<0?r:n;var u=e.intersect(a,i);if(void 0!==u)return Yg(e,t,u,!0);return}(e,t,r,n);if(void 0!==a)return a}var i=Jg(e,t,r),o=Jg(e,t,n),u=e.split(t),c=u[0][0],s=u[1][0];return Wg(e,c,s,Ug(e,c,i.left,o.left),Ug(e,s,i.right,o.right))}function xg(e,t,r,n){if(r===Hg||n===Hg)return!1;if(r===jg||n===jg)return!0;if(r.isExact&&n.isExact)return e.meets(r.key,n.key);var a=Jg(e,t,r),i=Jg(e,t,n),o=e.split(t),u=o[0][0],c=o[1][0];return xg(e,u,a.left,i.left)||xg(e,c,a.right,i.right)}function Pg(e,t){return e===Hg||t===Hg?e:t===jg?Hg:e===jg?Mg(t.setOperations,Gg(t.setOperations,t.setOperations.top,e,t.root)):Mg(e.setOperations,Gg(e.setOperations,e.setOperations.top,e.root,t.root))}function Gg(e,t,r,n){if(r===Hg)return r;if(n===Hg)return r;if(n===jg)return Hg;if(r===jg){var a=Jg(e,t,n),i=e.split(t),o=i[0][0],u=i[1][0];return Wg(e,o,u,Gg(e,o,jg,a.left),Gg(e,u,jg,a.right))}if(r.isExact&&n.isExact){var c=function(e,t,r,n){var a=r.key,i=n.key;if(!e.meets(a,i))return r;var o=e.except(a,i);if(void 0!==o)return Yg(e,t,o,!0);return}(e,t,r,n);if(void 0!==c)return c}var s=Jg(e,t,r),l=Jg(e,t,n),f=e.split(t),d=f[0][0],h=f[1][0];return Wg(e,d,h,Gg(e,d,s.left,l.left),Gg(e,h,s.right,l.right))}function Vg(e,t){if(void 0!==e&&void 0!==t)return 0===e?t:0===t||e===t?e:void 0}function Bg(e,t,r,n){if(r===n)return 0;if(r===Hg)return-1;if(n===Hg)return 1;if(r===jg)return n===jg?0:1;if(n===jg)return-1;if(r.isExact&&n.isExact)return function(e,t,r){return e.compare(t.key,r.key)}(e,r,n);var a=Jg(e,t,r),i=Jg(e,t,n),o=e.split(t),u=o[0][0],c=o[1][0],s=Bg(e,u,a.left,i.left);if(void 0!==s){var l=Bg(e,c,a.right,i.right);if(void 0!==l)return Vg(s,l)}}function Wg(e,t,r,n,a){return n===Hg?a===Hg?Hg:a===jg?Kg(n,a,void 0,!1,e.infimum(r,r),e.supremum(r,r)):Kg(n,a,void 0,!1,a.infimum,a.supremum):a===Hg?n===jg?Kg(n,a,void 0,!1,e.infimum(t,t),e.supremum(t,t)):Kg(n,a,void 0,!1,n.infimum,n.supremum):n===jg?a===jg?jg:Kg(n,a,void 0,!1,e.combineInfima(e.infimum(t,t),a.infimum),e.combineSuprema(e.supremum(t,t),a.supremum)):a===jg?Kg(n,a,void 0,!1,e.combineInfima(n.infimum,e.infimum(r,r)),e.combineSuprema(n.supremum,e.supremum(r,r))):Kg(n,a,void 0,!1,e.combineInfima(n.infimum,a.infimum),e.combineSuprema(n.supremum,a.supremum))}!function(e){e[e.Dense=0]="Dense",e[e.Empty=1]="Empty"}(Ng||(Ng={}));var jg=Ng.Dense,Hg=Ng.Empty;function Kg(e,t,r,n,a,i){return{key:r,left:e,right:t,isExact:n,infimum:a,supremum:i}}function qg(e,t,r){if(!e.meets(t,r))return Hg;var n=e.compare(t,r);if(void 0!==n)return n<=0?jg:Yg(e,t,r,!0);var a=e.intersect(t,r);return void 0!==a?Yg(e,t,a,!0):Yg(e,t,r,!1)}function Yg(e,t,r,n){return Kg(void 0,void 0,r,!!n,e.infimum(r,t),e.supremum(r,t))}function Jg(e,t,r){if(void 0!==r.left)return r;var n=e.split(t),a=n[0][0],i=n[1][0],o=Wg(e,a,i,qg(e,a,r.key),qg(e,i,r.key));if(o===Hg||o===jg)throw new Error("incorrect set operations implementation");var u=o;return Fg(r,{left:u.left,right:u.right})}function Qg(e){return e===Hg||e===jg?0:function e(t){if(void 0===t||t===Hg||t===jg)return 0;return e(t.left)+e(t.right)+1}(e.root)}function Xg(e,t){return e===Hg||function(e,t,r){return function t(n,a){if(a===Hg)return!0;if(a===jg)return r(n);if(a.isExact)return r(a.key);var i=Jg(e,n,a),o=e.split(n),u=o[0][0],c=o[1][0];return t(u,i.left)&&t(c,i.right)}(e.top,t)}(e.setOperations,e.root,t)}function zg(e,t,r){var n=function(e,t,r){var n=Math.pow(t,e),a=1-Math.pow(t/r,e),i=Math.pow(r,e),o=i*n,u=i-n,c=-1/e;return{cdf:1===e?function(e){return(1-n/e)/a}:function(t){return(1-n*Math.pow(t,-e))/a},invCdf:1===e?function(e){return 1/((i-e*u)/o)}:function(e){return Math.pow((i-e*u)/o,c)}}}(e,t,r);return{canSplit:function(e){var t=e[0];return e[1]-t>1},split:function(e){var t=e[0],r=e[1],a=n.cdf(r),i=n.cdf(t+1),o=n.invCdf((a+i)/2),u=Math.min(Math.max(Math.round(o),t+1),r-1);return[[[t,u],n.cdf(u)-n.cdf(t+1)],[[u,r],n.cdf(r)-n.cdf(u)]]}}}function Zg(e,t,r,n,a){var i=zg(e,t,r);return{id:a,split:function(e){return i.split(e)},canSplit:function(e){return i.canSplit(e)},meets:Rg,intersect:bg,union:function(e,t){return n=t,a=(r=e)[0],i=r[1],o=n[0],u=n[1],pr(a,o)<=vr(i,u)?Ag(e,t):void 0;var r,n,a,i,o,u},except:Ig,compare:Tg,top:n,infimum:function(e){return e[0]},supremum:function(e){return e[1]},combineInfima:function(e,t){return vr(e,t)},combineSuprema:function(e,t){return pr(e,t)}}}var $g={},eC=function(e){for(var t=[],r=0,n=Object.keys(e);r<n.length;r++){var a=n[r];t.push([a,e[a].id])}var i=JSON.stringify(t.sort()),o=$g[i];return void 0===o&&(o={box:{},probabilities:{},depth:1},$g[i]=o),o};function tC(e){for(var t=!0,r=0,n=Object.keys(e);r<n.length;r++){var a=n[r];if(Object.prototype.hasOwnProperty.call(e,a)){t=!1;break}}return t?jg:{isSubspace:!0,bounds:e}}function rC(e){return e.isSubspace?1:e.subspaceCount}var nC=function(e,t,r){return{isSubspace:!1,left:e,right:t,bounds:r,subspaceCount:rC(e)+rC(t)}};function aC(e,t){if(t===jg)return t;if(t.isSubspace){for(var r=!1,n=0,a=Object.keys(t.bounds);n<a.length;n++){var i=a[n];if(Object.prototype.hasOwnProperty.call(e,i)){r=!0;break}}if(!r)return jg}return{productOperations:e,root:t}}function iC(e){return void 0===e?jg:e}var oC={unzip:function(e){for(var t={},r={},n=0,a=Object.keys(e);n<a.length;n++){var i=a[n];if(Object.prototype.hasOwnProperty.call(e,i)){var o=e[i];if(o===Hg)return Hg;if(o===jg)continue;t[i]=o.setOperations,r[i]=o.root}}return aC(t,tC(r))},combineProduct:function(e,t,r,n){for(var a={},i=0,o=Object.keys(e);i<o.length;i++){var u=o[i];if(Object.prototype.hasOwnProperty.call(e,u)){var c=n(e[u],e[u].top,iC(t[u]),iC(r[u]));if(c===Hg)return c;if(c===jg)continue;a[u]=c}}return a},restrict:function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var n={},a=0,i=t;a<i.length;a++){var o=i[a];if(Object.prototype.hasOwnProperty.call(e,o)){var u=e[o];n[o]=u}}return n},fromUntypedProduct:function(e,t,r){for(var n={},a=0,i=r;a<i.length;a++){var o=i[a],u=t[o];n[o]=Mg(e[o],void 0!==u?u:jg)}return n},denseProduct:function(e){for(var t={},r=0,n=e;r<n.length;r++){t[n[r]]=jg}return t}},uC=oC.unzip.bind(oC);function cC(e,t,r){var n=oC.combineProduct(e,t,r,wg);if(n===Hg)throw new Error("broken invariant: the union of two non-empty products cannot be empty");return n}function sC(e,t,r){for(var n=0,a=0,i=Object.keys(e);a<i.length;a++){var o=i[a];if(Object.prototype.hasOwnProperty.call(e,o)){var u=iC(t[o]),c=iC(r[o]),s=e[o];if(void 0===(n=Vg(n,Bg(s,s.top,u,c))))return}}return n}var lC,fC=(lC={},function(e,t,r){var n;if(t===lC.left&&r===lC.right)return lC.res;lC.left=t,lC.right=r;var a,i=sC(e,t.bounds,r.bounds);if(void 0!==i)return lC.res=i<=0?r:t;for(var o=0,u=Object.keys(e);o<u.length;o++){var c=u[o];if(Object.prototype.hasOwnProperty.call(e,c)&&0!==Bg(e[c],e[c].top,iC(t.bounds[c]),iC(r.bounds[c]))){if(void 0!==a)return lC.res=void 0;a=c}}if(void 0!==a){var s=wg(e[a],e[a].top,iC(t.bounds[a]),iC(r.bounds[a]));if(s===Hg)return lC.res=Hg;if(s===jg){var l=t.bounds,f=a,d=(l[f],Object(j.e)(l,["symbol"==typeof f?f:f+""]));return lC.res=tC(d)}var h=Object(j.a)(Object(j.a)({},t.bounds),((n={})[a]=s,n));return lC.res=tC(h)}return lC.res=void 0});function dC(e,t,r){if(r===Hg)return t;if(r===jg)return r;if(t===Hg)return r;if(t===jg)return t;if(!t.isSubspace||!r.isSubspace)return nC(t,r,cC(e,t.bounds,r.bounds));var n=fC(e,t,r);return void 0!==n?n:nC(t,r,cC(e,t.bounds,r.bounds))}function hC(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var a=oC.restrict.apply(oC,Object(j.f)([t.bounds],r));if(t.isSubspace)return tC(a);var i=hC.apply(void 0,Object(j.f)([e,t.left],r));if(i===jg)return jg;var o=hC.apply(void 0,Object(j.f)([e,t.right],r));return dC(e,i,o)}function vC(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(e===jg||e===Hg)return e;var n=oC.restrict.apply(oC,Object(j.f)([e.productOperations],t)),a=hC.apply(void 0,Object(j.f)([n,e.root],t));return a===Hg?a:aC(n,a)}function pC(e,t){var r,n,a,i;if(void 0!==t.children)return t.children;for(var o,u,c=t.box,s=t.probabilities,l=0,f=0,d=Object.keys(e);f<d.length;f++){var h=d[f];if(Object.prototype.hasOwnProperty.call(e,h)){var v=s[h],p=e[h];if(void 0===v){o=h,u=p.top;break}if(v>l){var m=iC(c[h]);if(m===Hg)throw new Error("the key split can never return empty");var g=p.top;if(m!==jg){if(!m.isExact)throw new Error("the key can always be represented exactly");g=m.key}if(!p.canSplit(g))continue;o=h,l=v,u=g}}}if(void 0===o||void 0===u)throw new Error("there has to be at least one dimension");var C=e[o],S=C.split(u),y=S[0],E=y[0],O=y[1],k=S[1],A=k[0],b=k[1],R=[{box:Object(j.a)(Object(j.a)({},c),(r={},r[o]=qg(C,C.top,E),r)),probabilities:Object(j.a)(Object(j.a)({},s),(n={},n[o]=O,n)),depth:t.depth+1},{box:Object(j.a)(Object(j.a)({},c),(a={},a[o]=qg(C,C.top,A),a)),probabilities:Object(j.a)(Object(j.a)({},s),(i={},i[o]=b,i)),depth:t.depth+1}];return t.depth<10&&(t.children=R),R}var mC=function(e,t,r,n){return function e(t,r,n,a){if(r===Hg)return[Hg,Hg];if(r===jg)return[tC(n),tC(a)];var i=sC(t,r.bounds,n);if(void 0!==i&&i<=0)return[r,Hg];var o=oC.combineProduct(t,r.bounds,n,Ug);if(o===Hg)return[Hg,r];var u=oC.combineProduct(t,r.bounds,a,Ug);if(r.isSubspace)return[tC(o),u===Hg?Hg:tC(u)];var c=e(t,r.left,n,a),s=c[0],l=c[1],f=e(t,r.right,n,a),d=f[0],h=f[1];return[dC(t,s,d),dC(t,l,h)]}(e,t,r.box,n.box)};function gC(e,t,r,n,a){var i=pC(e,n),o=i[0],u=i[1],c=mC(e,t,o,u),s=c[0],l=c[1],f=mC(e,r,o,u),d=f[0],h=f[1],v=a(e,s,d,o);return v===jg?jg:dC(e,v,a(e,l,h,u))}function CC(e,t,r,n){if(r===Hg)return t;if(t===Hg)return r;if(t===jg)return t;if(r===jg)return r;if(t.isSubspace&&r.isSubspace){var a=fC(e,t,r);if(void 0!==a)return a}return gC(e,t,r,n,CC)}function SC(e,t){if(t===Hg)return e;if(t===jg)return t;if(e===Hg)return t;if(e===jg)return e;var r=Object(j.a)(Object(j.a)({},e.productOperations),t.productOperations),n=CC(r,e.root,t.root,eC(r));return n===Hg?n:aC(r,n)}function yC(e,t,r,n){if(t===Hg||r===Hg)return Hg;if(t===jg)return r;if(r===jg)return t;if(t.isSubspace&&r.isSubspace){var a=oC.combineProduct(e,t.bounds,r.bounds,Ug);return a===Hg?Hg:tC(a)}return gC(e,t,r,n,yC)}function EC(e,t){if(e===Hg)return e;if(t===Hg)return t;if(e===jg)return t;if(t===jg)return e;var r=Object(j.a)(Object(j.a)({},e.productOperations),t.productOperations),n=yC(r,e.root,t.root,eC(r));return n===Hg?n:aC(r,n)}function OC(e,t,r,n){if(t===Hg)return t;if(r===jg)return Hg;if(r===Hg)return t;if(t===jg)return gC(e,t,r,n,OC);if(t.isSubspace&&r.isSubspace){var a=function(e,t,r){var n,a,i=sC(e,t.bounds,r.bounds);if(0===i||-1===i)return Hg;for(var o=0,u=Object.keys(e);o<u.length;o++){var c=u[o];if(Object.prototype.hasOwnProperty.call(e,c)){var s=Bg(e[c],e[c].top,iC(t.bounds[c]),iC(r.bounds[c]));if(void 0===s||s>0){if(void 0!==a)return;a=c}}}if(void 0!==a){var l=Gg(e[a],e[a].top,iC(t.bounds[a]),iC(r.bounds[a]));if(l===Hg)return Hg;if(l===jg){var f=t.bounds,d=a;f[d];return tC(Object(j.e)(f,["symbol"==typeof d?d:d+""]))}return tC(Object(j.a)(Object(j.a)({},t.bounds),((n={})[a]=l,n)))}}(e,t,r);if(void 0!==a)return a}return gC(e,t,r,n,OC)}function kC(e,t){if(e===Hg)return e;if(t===Hg)return e;if(t===jg)return Hg;if(e===jg){var r=OC(t.productOperations,jg,t.root,eC(t.productOperations));return r===Hg?r:aC(t.productOperations,r)}var n=Object(j.a)(Object(j.a)({},e.productOperations),t.productOperations),a=OC(n,e.root,t.root,eC(n));return a===Hg?a:aC(n,a)}function AC(e,t){if(e===t)return 0;if(e===Hg)return-1;if(t===Hg)return 1;if(e===jg)return t===jg?0:1;if(t===jg)return-1;var r=Object(j.a)(Object(j.a)({},e.productOperations),t.productOperations);return function e(t,r,n,a){if(r===n)return 0;if(r===Hg)return-1;if(n===Hg)return 1;if(r===jg)return n===jg?0:1;if(n===jg)return-1;if(r.isSubspace&&n.isSubspace)return sC(t,r.bounds,n.bounds);var i=pC(t,a),o=i[0],u=i[1],c=mC(t,r,o,u),s=c[0],l=c[1],f=mC(t,n,o,u),d=f[0],h=f[1],v=e(t,s,d,o);return void 0!==v?Vg(v,e(t,l,h,u)):void 0}(r,e.root,t.root,eC(r))}function bC(e,t,r,n){if(t===Hg||r===Hg)return!1;if(t===jg||r===jg)return!0;if(!function(e,t,r){for(var n=0,a=Object.keys(e);n<a.length;n++){var i=a[n];if(Object.prototype.hasOwnProperty.call(e,i)){var o=iC(t[i]),u=iC(r[i]),c=e[i];if(!xg(c,c.top,o,u))return!1}}return!0}(e,t.bounds,r.bounds))return!1;if(t.isSubspace&&r.isSubspace)return!0;var a=pC(e,n),i=a[0],o=a[1],u=mC(e,t,i,o),c=u[0],s=u[1],l=mC(e,r,i,o),f=l[0],d=l[1];return bC(e,c,f,i)||bC(e,s,d,o)}function RC(e,t){if(e===Hg||t===Hg)return!1;if(e===jg||t===jg)return!0;var r=Object(j.a)(Object(j.a)({},e.productOperations),t.productOperations);return bC(r,e.root,t.root,eC(r))}var IC;function TC(e){return e===Hg||e===jg?0:rC(e.root)}!function(e){e[e.AvailableSet=0]="AvailableSet",e[e.AvailableRead=1]="AvailableRead"}(IC||(IC={}));var NC=[IC.AvailableSet,IC.AvailableRead+1],FC=[0,1<<20],_C=[0,16384],MC={availability:Zg(1,NC[0]+1,NC[1],NC,"Availability operations, alpha = 1"),row:Zg(.2,FC[0]+1,FC[1],FC,"Row operations, alpha = 0.2"),col:Zg(.35,_C[0]+1,_C[1],_C,"Col operations, alpha = 0.35")},DC={availability:_g(MC.availability),row:_g(MC.row),col:_g(MC.col)};function wC(e){return uC({row:DC.row([e.row,e.row+e.rows]),col:DC.col([e.col,e.col+e.cols])})}function LC(e){if(e!==Hg){var t,r,n=e===jg?void 0:e.root.bounds.row,a=e===jg?void 0:e.root.bounds.col,i=void 0===n?MC.row.top:(t=Mg(MC.row,n),r=[],BC(t,(function(e){return r.push(e),!0})),r.reduce(Ag)),o=i[0],u=i[1],c=void 0===a?MC.col.top:function(e){var t=[];return WC(e,(function(e){return t.push(e),!0})),t.reduce(Ag)}(Mg(MC.col,a)),s=c[0];return zt(o,s,u-o,c[1]-s)}}var UC,xC,PC=uC({availability:DC.availability([IC.AvailableSet,IC.AvailableSet+1])}),GC=uC({availability:DC.availability([IC.AvailableRead,IC.AvailableRead+1])}),VC=uC({availability:DC.availability([IC.AvailableSet,IC.AvailableRead+1])});function BC(e,t){return e!==jg?Xg(e,t):t(MC.row.top)}function WC(e,t){return e!==jg?Xg(e,t):t(MC.col.top)}function jC(e,t){return function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var a=vC.apply(void 0,Object(j.f)([e],r));if(a===Hg)return!0;if(a===jg)return t(oC.denseProduct(r));var i=a.productOperations,o=a.root;function u(e){return e.isSubspace?t(oC.fromUntypedProduct(i,e.bounds,r)):u(e.left)&&u(e.right)}return u(o)}(e,(function(e){return BC(e.row,(function(r){var n=r[0],a=r[1];return WC(e.col,(function(e){var r=e[0],i=e[1];return t(zt(n,r,a-n,i-r))}))}))}),"row","col")}function HC(e,t){return jC(e,(function(e){return ht(e,t)}))}function KC(e,t){return{sheet:e,set:t}}!function(e){e.PrecisionTest="PrecisionTest",e.EditedCell="EditedCell",e.DependentCell="DependentCell",e.EvalFormula="EvalFormula"}(UC||(UC={})),function(e){e.EditedCell="EditedCell",e.DependentCell="DependentCell",e.IndependentCell="IndependentCell",e.UnknownNonEditedCell="UnknownNonEditedCell"}(xC||(xC={}));var qC,YC={calculatedCellCount:{},changedCellCount:{},continueCount:0,editFinishedCount:0,stateTimedOut:!1,recalcFinishedCount:0};function JC(e,t){var r;return Object(j.a)(Object(j.a)({},e),((r={})[t]=(e[t]||0)+1,r))}function QC(e,t){switch(t.message){case qC.ChangedCell:return Object(j.a)(Object(j.a)({},e),{changedCellCount:JC(e.changedCellCount,t.cellKind),calculatedCellCount:JC(e.calculatedCellCount,t.cellKind)});case qC.UnchangedCell:return Object(j.a)(Object(j.a)({},e),{calculatedCellCount:JC(e.calculatedCellCount,t.cellKind)});case qC.ContinueComputation:return Object(j.a)(Object(j.a)({},e),{continueCount:e.continueCount+1});case qC.StateTimedOut:return Object(j.a)(Object(j.a)({},e),{stateTimedOut:!0});case qC.EditFinished:return Object(j.a)(Object(j.a)({},e),{editFinishedCount:e.editFinishedCount+1});case qC.RecalcFinished:return Object(j.a)(Object(j.a)({},e),{recalcFinishedCount:e.recalcFinishedCount+1});default:return k("calc.calc.partialWorkbookMessages.mergeRecalcStatistics",t)}}function XC(e){var t=Math.abs(e);return 0===t?-1e4:Math.floor(Math.log2(t))}function zC(e){switch(typeof e){case"number":return{kind:"n",magnitude:XC(e)};case"string":return{kind:"s"};case"boolean":return{kind:"b"};case"object":switch(e.kind){case x.Error:return{kind:"e",type:(t=e.type,r=Ra[t],void 0===r?"error.type:"+t:r)};case x.Rich:return{kind:"r"};case x.Array:return{kind:"a"};case x.Blank:return{kind:"z"};default:return k("calc.calc.precisionValue",e)}}var t,r}!function(e){e.ChangedCell="ChangedCell",e.UnchangedCell="UnchangedCell",e.ContinueComputation="ContinueComputation",e.EditFinished="EditFinished",e.StateTimedOut="StateTimedOut",e.RecalcFinished="RecalcFinished"}(qC||(qC={}));var ZC={samples:[],failures:[]};function $C(e,t){return 0===t.length?e:0===e.length?t:e.concat(t)}var eS,tS,rS={samples:[],failures:[]};function nS(e,t){return{samples:$C(e.samples,t.samples),failures:$C(e.failures,t.failures)}}function aS(e,t,r){if(void 0!==r){var n=e.slice();return n[t]=r,n}var a=e.slice(0,-1);return t<e.length-1&&(a[t]=e[e.length-1]),a}function iS(e,t,r){return{kind:e,key:t,value:r}}function oS(e,t){return iS(1,e,t)}function uS(e,t){return iS(2,e,t)}function cS(e,t){return iS(3,e,t)}!function(e){e.SetSheetNames="SetSheetNames",e.SetRefStyle="SetRefStyle",e.SetLocaleInfo="SetLocaleInfo",e.SetNumberFormats="SetNumberFormats",e.WriteNamedObject="WriteNamedObject",e.WriteUndefinedNames="WriteUndefinedNames",e.PromoteNamedObjects="PromoteNamedObjects",e.ExtendUnusedRange="ExtendUnusedRange",e.WriteHiddenRows="WriteHiddenRows",e.WriteInFilterMode="WriteInFilterMode",e.SetCellContents="SetCellContents",e.SetRangeFormula="SetRangeFormula",e.PromoteCellContents="PromoteCellContents"}(eS||(eS={})),function(e){e.StateAdvanced="StateAdvanced",e.CellWrite="CellWrite",e.RangeWrite="RangeWrite",e.NameFailure="NameFailure",e.RangeFailure="RangeFailure",e.PrintFormulaFailure="PrintFormulaFailure",e.UnhandledFailure="UnhandledFailure",e.UpdateRequest="UpdateRequest",e.UpdateNamesRequest="UpdateNamesRequest",e.GarbageCollected="GarbageCollected",e.RecalcStatistics="RecalcStatistics",e.PrecisionEvalStatistics="PrecisionEvalStatistics",e.PrecisionPrintFormulaStatistics="PrecisionPrintFormulaStatistics",e.WorkbookStatistics="WorkbookStatistics",e.ExperimentRunResult="ExperimentRunResult"}(tS||(tS={}));var sS=function(){function e(e,t,r){this.lattice=e,this.root=t,this.count=r}return e.create=function(t,r,n,a,i){void 0===i&&(i=2);var o=i>1?Math.ceil(i):1;return new e({keyJoin:t,keyMeets:r,keyCompare:n,keyDistance:a,minChildren:o,maxChildren:2*o,keyGe:function(e,t){var r=n(e,t);return void 0!==r&&r>=0},keyLe:function(e,t){var r=n(e,t);return void 0!==r&&r<=0}},void 0,0)},e.prototype.getCount=function(){return this.count},Object.defineProperty(e.prototype,"bounds",{get:function(){var e;return null===(e=this.root)||void 0===e?void 0:e.key},enumerable:!0,configurable:!0}),e.prototype.getValue=function(e){if(void 0!==this.root)return function t(r,n){var a=r.keyCompare(n.key,e);if(1===n.kind)return 0===a?n.value:void 0;if(!(void 0===a||a<0))for(var i=0,o=n.value;i<o.length;i++){var u=t(r,o[i]);if(void 0!==u)return u}}(this.lattice,this.root)},e.prototype.getEntry=function(e){var t=this.getValue(e);return void 0===t?void 0:An(e,t)},e.prototype.setValue=function(t,r,n){void 0===n&&(n=function(e){return!0});var a=pS(this.lattice,this.root,t,n,r);return void 0!==a?a===this.root?this:new e(this.lattice,a,this.count):new e(this.lattice,vS(this.lattice,this.root,oS(t,r)),this.count+1)},e.prototype.filter=function(t){var r=new e(this.lattice,void 0,0);return this.forEach((function(e,n){return t(e,n)&&(r=r.setValue(e,n)),!0})),r},e.prototype.contains=function(e,t){return void 0===t&&(t=function(e){return!0}),void 0!==pS(this.lattice,this.root,e,t)},e.prototype.getOrSetValue=function(e,t){var r=this.getValue(e);if(void 0===r){var n=t();return[this.setValue(e,n),n]}return[this,r]},e.prototype.forEach=function(e){return lS(this.root,e)},e.prototype.forEachGe=function(e,t){var r=this;return lS(this.root,t,(function(t){return r.lattice.keyGe(t,e)}),(function(t){return r.lattice.keyGe(t,e)}))},e.prototype.forEachLe=function(e,t){var r=this;return lS(this.root,t,(function(t){return r.lattice.keyMeets(t,e)}),(function(t){return r.lattice.keyLe(t,e)}))},e.prototype.forEachMeets=function(e,t){var r=this;return lS(this.root,t,(function(t){return r.lattice.keyMeets(t,e)}),(function(t){return r.lattice.keyMeets(t,e)}))},e.prototype.remove=function(t){var r=this;if(null==this.root)return this;var n=[],a=this.lattice,i=function(e,r){var o=a.keyCompare(e.key,t);if(void 0===o||o<0)return hr(e,1);if(2===e.kind){for(var u=e.value,c=0;c<u.length;c+=1)if(0===a.keyCompare(u[c].key,t)){if((h=aS(u,c)).length<r){var s=uS(e.key,h);return n.push(s),hr(s,3)}return hr(uS(dS(a,h),h),2)}}else for(u=e.value,c=0;c<u.length;c+=1){var l=i(u[c],a.minChildren),f=l[0],d=l[1];if(3===d){var h;if((h=aS(u,c)).length>=r)return hr(cS(dS(a,h),h),2);s=cS(e.key,h);return n.push(s),hr(s,3)}if(2===d)return hr(cS(e.key,aS(u,c,f)),2)}return hr(e,1)},o=2===this.root.kind?1:2,u=i(this.root,o),c=u[0],s=u[1];if(c===this.root)return this;for(var l=3===s?void 0:c,f=0;f<n.length;f+=1)lS(n[f],(function(e,t){return l=vS(r.lattice,l,oS(e,t)),!0}));return new e(this.lattice,l,this.count-1)},e}();function lS(e,t,r,n){var a=void 0!==r?r:function(){return!0},i=void 0!==n?n:function(){return!0};if(null==e)return!0;var o=function(e){if(!a(e.key))return!0;if(2===e.kind)for(var r=e.value,n=0;n<r.length;n+=1){var u=r[n];if(i(u.key)&&!t(u.key,u.value))return!1}else for(r=e.value,n=0;n<r.length;n+=1)if(!o(r[n]))return!1;return!0};return o(e)}function fS(e,t){for(var r=function(e,t){for(var r=0,n=1,a=e.keyDistance(t[0].key,t[1].key),i=2;i<t.length;i+=1)for(var o=0;o<i;o+=1){var u=e.keyDistance(t[o].key,t[i].key);u>a&&(r=o,n=i,a=u)}return hr(r,n)}(e,t),n=r[0],a=r[1],i=t[n].key,o=t[a].key,u=[],c=0;c<t.length;c+=1){var s=t[c];u.push([s,e.keyDistance(i,s.key)-e.keyDistance(o,s.key)])}u.sort((function(e,t){return e[1]-t[1]}));for(var l=e.minChildren;l<t.length-e.minChildren&&u[l][1]<0;l+=1);var f=[],d=[];for(c=0;c<l;c+=1)f.push(u[c][0]);for(c=l;c<t.length;c+=1)d.push(u[c][0]);return hr(f,d)}function dS(e,t){for(var r=t[0].key,n=1;n<t.length;n+=1)r=e.keyJoin(r,t[n].key);return r}function hS(e,t,r){var n=fS(e,r),a=n[0],i=n[1];return hr(iS(t,dS(e,a),a),iS(t,dS(e,i),i))}function vS(e,t,r){if(null==t)return uS(r.key,[r]);var n=function t(n){if(2===n.kind){var a=Object(j.f)(n.value,[r]);if(a.length>e.maxChildren){var i=hS(e,n.kind,a),o=i[0],u=i[1];return hr(uS(o.key,o.value),u)}return hr(uS(e.keyJoin(n.key,r.key),a),void 0)}var c=n.value.slice(),s=function(e,t,r){for(var n=0,a=e.keyDistance(t[0].key,r),i=t[0].value.length,o=1;o<t.length;o+=1){var u=t[o],c=e.keyDistance(u.key,r);(c<a||c===a&&u.value.length<i)&&(n=o,a=c,i=u.value.length)}return n}(e,c,r.key),l=t(c[s]),f=l[0],d=l[1];if(c[s]=f,null!=d&&(c.push(d),c.length>e.maxChildren)){var h=hS(e,n.kind,c),v=h[0];u=h[1];return hr(cS(v.key,v.value),u)}return hr(cS(e.keyJoin(n.key,r.key),c),void 0)}(t),a=n[0],i=n[1];return null!=i?cS(e.keyJoin(a.key,i.key),[a,i]):a}function pS(e,t,r,n,a){if(void 0!==t)return function t(n){if(2!==n.kind)for(a=0;a<n.value.length;a+=1){o=n.value[a];if(e.keyMeets(o.key,r))if(void 0!==(u=t(o)))return cS(n.key,aS(n.value,a,u))}else for(var a=0;a<n.value.length;a+=1){var o,u;if(void 0!==(u=i(o=n.value[a])))return uS(n.key,aS(n.value,a,u))}}(t);function i(t){if(0===e.keyCompare(t.key,r))return void 0!==a&&t.value!==a&&n(t.value)?oS(t.key,a):t}}function mS(e,t){var r=e.row,n=e.col,a=e.rows,i=e.cols,o=t.row,u=t.col,c=t.rows,s=t.cols;return pr(r,o)<vr(r+a,o+c)&&pr(n,u)<vr(n+i,u+s)}function gS(e,t){var r=e.row,n=e.col,a=e.rows,i=e.cols,o=t.row,u=t.col,c=r+a,s=o+t.rows,l=n+i,f=u+t.cols;return r===o&&c===s&&n===u&&l===f?0:r<=o&&c>=s&&n<=u&&l>=f?1:r>=o&&c<=s&&n>=u&&l<=f?-1:void 0}function CS(e,t){var r=e.row,n=e.col,a=e.rows,i=e.cols,o=t.row,u=t.col,c=t.rows,s=t.cols;return mr(r-o+.5*(a-c))+mr(n-u+.5*(i-s))}function SS(){return sS.create(If,mS,gS,CS)}function yS(e){return Array.isArray(e)}var ES=function(e,t,r,n){return{isExact:e,iformat:t,category:r,decimals:n}},OS=ES(!0,xs.General,"General",0),kS=function(e,t){return e&&t===xs.General},AS={fmla:"",lexicalKind:Vt.Cell,origin:Zt(0,0),compiledFmla:void 0},bS={fmla:"",lexicalKind:Vt.Range,origin:Zt(0,0),compiledFmla:void 0},RS=function(e,t){return""===e&&!t},IS={oper:Le,clientFailure:void 0};function TS(e,t){return Sf(e)&&void 0===t}function NS(e,t,r){return e.setValue(t,r,(function(e){return e.fmla!==r.fmla||e.lexicalKind!==r.lexicalKind||void 0!==e.compiledFmla&&!mt(e.origin,r.origin)||null==e.compiledFmla!=(null==r.compiledFmla)}))}function FS(e,t){return e.forEachMeets(t,(function(t,r){if(r.fmla.length>0){var n=r.lexicalKind===Vt.Cell?AS:bS;e=e.setValue(t,n)}return!0})),e}var _S={values:SS(),formats:SS(),formulae:SS(),dirty:Hg},MS={serverFormulaeNodeCount:0,serverFormatsNodeCount:0,serverValuesNodeCount:0,serverDirtySetSubspaceCount:0,editedFormulaeNodeCount:0,editedFormatsNodeCount:0,editedValuesNodeCount:0,editedDirtySetSubspaceCount:0,recalcDirtySetSubspaceCount:0,recalcFailuresSetSubspaceCount:0,recalcTaintSetSubspaceCount:0,availabilitySetSubspaceCount:0,availabilityHistorySize:0,hiddenRowsNodeCount:0};var DS=zt(0,0,1<<20,16384);var wS,LS,US=function(){function e(e){this.sheet=e,this.oldAvailabilities={},this.availabilityHistorySize=0,this.inFilterMode=!1,this.filterModeAvailable=!1,this.serverContents=this.editedContents=_S,this.recalcDirty=this.editedContents.dirty,this.recalcFailures=Hg,this.editedTaint=this.recalcTaint=Hg,this.serverAvailability=this.editedAvailability=Hg,this.serverUsed=this.editedUsed=DS,this.hiddenRows=this.hiddenAvailability=Hg}return e.prototype.cloneServer=function(){var t=new e(this.sheet);return t.serverContents=this.serverContents,t.serverAvailability=this.serverAvailability,t.serverUsed=this.serverUsed,t},e.prototype.advanceState=function(e){this.editedContents=this.serverContents,this.recalcDirty=this.editedContents.dirty,this.recalcFailures=Hg,this.editedTaint=this.recalcTaint=Hg,this.oldAvailabilities[e]=this.serverAvailability,this.availabilityHistorySize+=1,this.serverAvailability=this.editedAvailability=Hg,this.serverUsed=this.editedUsed=DS,this.hiddenRows=this.hiddenAvailability=Hg,this.inFilterMode=this.filterModeAvailable=!1},e.prototype.allServerAvailable=function(e){return this.allAvailable(e,this.serverAvailability)},e.prototype.allEditedAvailable=function(e){return this.allAvailable(e,this.editedAvailability)},e.prototype.allAvailable=function(e,t){var r=AC(t,EC(wC(e),GC));return void 0!==r&&r>=0},e.prototype.hasRecalcDirty=function(e){return RC(this.recalcDirty,wC(e))},e.prototype.hasRecalcFailure=function(e){return RC(this.recalcFailures,wC(e))},e.prototype.hasEditedEditTaint=function(e){return RC(this.editedTaint,wC(e))},e.prototype.hasRecalcEditTaint=function(e){return RC(this.recalcTaint,wC(e))},e.prototype.getEditedUsedRange=function(){return this.editedUsed},e.prototype.getServerUsedRange=function(){return this.serverUsed},e.prototype.getServerAvailability=function(){return this.serverAvailability},e.prototype.getHiddenRows=function(e,t){var r,n,a=DC.row(hr(e,t)),i=(r=this.hiddenAvailability)===(n=a)?0:r===Hg?-1:n===Hg?1:r===jg?n===jg?0:1:n===jg?-1:Bg(r.setOperations,r.setOperations.top,r.root,n.root);if(!(void 0!==i&&i>=0))return it({kind:_R.HiddenRows});var o=[];return BC(Lg(this.hiddenRows,a),(function(e){var t=e[0],r=e[1];return o.push(Ll(t,r)),!0})),at(o)},e.prototype.setHiddenRows=function(e,t){var r=DC.row(hr(e.row,e.row+e.rows));this.hiddenRows=Dg(Pg(this.hiddenRows,r),Lg(t,r)),this.hiddenAvailability=Dg(this.hiddenAvailability,r)},e.prototype.isInFilterMode=function(){return this.filterModeAvailable?at(this.inFilterMode):it({kind:_R.InFilterMode})},e.prototype.setInFilterMode=function(e){this.inFilterMode=e,this.filterModeAvailable=!0},e.prototype.forEachNonBlankCellInSet=function(e,t,r,n,a){var i=EC(e,n);return jC(EC(r,i),(function(e){return a.formulae.forEachMeets(e,(function(r,n){return!!RS(n.fmla,void 0!==n.compiledFmla)||ht(Nf(e,r),t)}))}))},e.prototype.forEachEditedNonBlankCellInSet=function(e,t){return this.forEachNonBlankCellInSet(e,t,this.editedAvailability,PC,this.editedContents)},e.prototype.forEachServerNonBlankCellInSet=function(e,t){return this.forEachNonBlankCellInSet(e,t,this.serverAvailability,GC,this.serverContents)},e.prototype.promoteServerAvailability=function(e,t){var r=EC(e,PC),n=this.oldAvailabilities[t];if(void 0===n)return!1;var a=AC(n,r);return void 0!==a&&a>=0&&(this.unionAvailability(!0,EC(e,VC)),this.unionTaint(!0,Hg),this.unionUsed(!0,LC(e)),!0)},e.prototype.extendServerUnused=function(e){var t=void 0===e?Hg:wC(e),r=kC(jg,t),n=this.serverContents,a=n.values,i=n.formats,o=n.formulae,u=n.dirty;jC(r,(function(e){return a.forEachLe(e,(function(e,t){return TS(t.oper,t.clientFailure)||(a=a.setValue(e,IS)),!0})),i.forEachLe(e,(function(e,t){return"object"==typeof t&&kS(t.isExact,t.iformat)||(i=i.setValue(e,OS)),!0})),!0})),jC(r,(function(e){return o=FS(o,e),!0})),u=kC(u,r),this.setContents(!0,{values:a,formats:i,formulae:o,dirty:u});var c=this.serverAvailability;c=SC(c=EC(c,t),EC(r,GC)),this.serverAvailability=this.editedAvailability=c,this.editedTaint=this.recalcTaint=Hg;var s,l,f=this.serverUsed;l=e,f=void 0===(s=f)||void 0===l?void 0:Nf(s,l),this.serverUsed=this.editedUsed=f},e.prototype.setRecalcFailure=function(e){this.recalcFailures=SC(this.recalcFailures,e)},e.prototype.setRecalcEditTaint=function(e){this.recalcTaint=SC(this.recalcTaint,e)},e.prototype.setEditedAndRecalcValues=function(e,t){var r=this;ht(e,(function(e,n,a){return r.editedContents=Object(j.a)(Object(j.a)({},r.editedContents),{values:r.editedContents.values.setValue(e,{oper:yS(t)?t[n][a]:t,clientFailure:void 0})}),!0})),this.recalcDirty=kC(this.recalcDirty,wC(e))},e.prototype.getRecalcValue=function(e){var t=this.editedContents.values.getValue(e);return void 0===t?IS:t},e.prototype.getServerValue=function(e){var t=this.serverContents.values.getValue(e);return void 0===t?IS.oper:t.oper},e.prototype.getServerFormula=function(e){return this.serverContents.formulae.getValue(e)},e.prototype.setEditedFormat=function(e,t){this.editedContents=Object(j.a)(Object(j.a)({},this.editedContents),{formats:this.editedContents.formats.setValue(e,t)})},e.prototype.getEditedFormat=function(e){var t=this.editedContents.formats.getValue(e);return void 0!==t?t:OS},e.prototype.getServerFormat=function(e){var t=this.serverContents.formats.getValue(e);return void 0!==t?t:OS},e.prototype.getEditedFormula=function(e){var t=void 0;return this.editedContents.formulae.forEachGe(e,(function(e,r){return!!RS(r.fmla,void 0!==r.compiledFmla)||(t=[e,r],!1)})),t},e.prototype.setContents=function(e,t){e&&(this.serverContents=t),this.editedContents=t,this.recalcDirty=this.editedContents.dirty,this.recalcFailures=Hg},e.prototype.unionAvailability=function(e,t){var r=e?this.serverAvailability:this.editedAvailability;r=SC(r,t),e&&(this.serverAvailability=r),this.editedAvailability=r},e.prototype.unionTaint=function(e,t){this.editedTaint=e?Hg:SC(this.editedTaint,t),this.recalcTaint=this.editedTaint},e.prototype.unionUsed=function(e,t){var r,n,a=e?this.serverUsed:this.editedUsed;n=t,a=void 0===(r=a)?n:void 0===n?r:If(r,n),e&&(this.serverUsed=a),this.editedUsed=a},e.prototype.setCellContents=function(e,t,r,n,a,i,o){this.setCommon(e,t,void 0,r,n,a,i,o)},e.prototype.setRangeFormula=function(e,t,r,n,a,i){var o=wC(t);this.setCommon(e,o,t,r,n,void 0,a,i)},e.prototype.setCommon=function(e,t,r,n,a,i,o,u){var c=e?this.serverContents:this.editedContents,s=c.values,l=c.formats,f=c.formulae,d=c.dirty,h=void 0===n||void 0!==n.compiledFmla,v=n;void 0!==n&&(jC(t,(function(e){return f=FS(f,e),!0})),RS(n.fmla,void 0!==n.compiledFmla)&&(v=void 0));var p=void 0!==v&&void 0===r?n:void 0,m=void 0!==v&&void 0!==r?n:void 0,g=a;void 0!==a&&TS(a,i)&&(jC(t,(function(e){return s.forEachLe(e,(function(e,t){return TS(t.oper,t.clientFailure)||(s=s.setValue(e,IS)),!0})),!0})),d=kC(d,t),g=void 0);var C=void 0!==g?{oper:g,clientFailure:i}:void 0,S=o;"object"==typeof o&&kS(o.isExact,o.iformat)&&(jC(t,(function(e){return l.forEachLe(e,(function(e,t){return"object"==typeof t&&kS(t.isExact,t.iformat)||(l=l.setValue(e,OS)),!0})),!0})),S=void 0);var y=!1===S?void 0:S,E=!1===S?S:void 0,O=t;if(!e){var k=EC(t,PC);O=SC(vC(EC(this.editedAvailability,k),"row","col"),EC(t,void 0!==u?wC(u):Hg))}if(void 0===p&&void 0===y&&void 0===C||(HC(O,(function(e){return void 0!==p&&(f=NS(f,e,p)),void 0!==y&&(l=l.setValue(e,y)),void 0!==C&&(s=s.setValue(e,C)),!0})),void 0===p&&void 0===C||(d=h?SC(d,O):kC(d,O))),void 0!==m){f=NS(f,r,m);var A=wC(r);d=h?SC(d,A):kC(d,A)}void 0!==E&&(l=function(e,t,r){var n=EC(t,GC);return HC(kC(t,vC(EC(r,n),"row","col")),(function(t){return e=e.setValue(t,!1),!0})),e}(l,O,e?this.serverAvailability:this.editedAvailability));var b=void 0===a?Hg:O;this.setContents(e,{values:s,formats:l,formulae:f,dirty:d}),this.unionAvailability(e,EC(b,VC)),e||(this.editedAvailability=kC(this.editedAvailability,kC(t,O))),this.unionTaint(e,b),this.unionUsed(e,LC(t))},e.prototype.getDirtyEditedCells=function(){return EC(this.recalcDirty,this.editedTaint)},e.prototype.getDirtyDependentCells=function(){return kC(this.recalcDirty,this.editedTaint)},e.prototype.onCellModified=function(e){var t=e?this.serverContents:this.editedContents;this.setContents(e,t),this.unionAvailability(e,Hg),this.unionTaint(e,Hg),this.unionUsed(e,void 0)},e.prototype.clearCompiledFormulas=function(){for(var e=0,t=[this.serverContents.formulae,this.editedContents.formulae];e<t.length;e++){t[e].forEach((function(e,t){return void 0!==t.compiledFmla&&t.compiledFmla.reset(),!0}))}},e.prototype.getStatistics=function(){return{serverFormulaeNodeCount:this.serverContents.formulae.getCount(),serverFormatsNodeCount:this.serverContents.formats.getCount(),serverValuesNodeCount:this.serverContents.values.getCount(),serverDirtySetSubspaceCount:TC(this.serverContents.dirty),editedFormulaeNodeCount:this.editedContents.formulae.getCount(),editedFormatsNodeCount:this.editedContents.formats.getCount(),editedValuesNodeCount:this.editedContents.values.getCount(),editedDirtySetSubspaceCount:TC(this.editedContents.dirty),recalcDirtySetSubspaceCount:TC(this.recalcDirty),recalcFailuresSetSubspaceCount:TC(this.recalcFailures),recalcTaintSetSubspaceCount:TC(this.recalcTaint),availabilityHistorySize:this.availabilityHistorySize,availabilitySetSubspaceCount:TC(this.editedAvailability),hiddenRowsNodeCount:Qg(this.hiddenRows)+Qg(this.hiddenAvailability)}},e.prototype.collectGarbage=function(e){var t=Hg;for(var r in this.oldAvailabilities)if(this.oldAvailabilities.hasOwnProperty(r)){var n=Number(r);if(n>=e){t=SC(t,this.oldAvailabilities[n]);continue}delete this.oldAvailabilities[n],this.availabilityHistorySize-=1}function a(e){return RC(EC(wC(e),PC),t)}function i(e,t){return!RS(t.fmla,void 0!==t.compiledFmla)&&a(e)}function o(e,t){return("object"!=typeof t||!kS(t.isExact,t.iformat))&&a(e)}function u(e,t){return!TS(t.oper,t.clientFailure)&&a(e)}var c=vC(t,"row","col");this.serverContents={formulae:this.serverContents.formulae.filter(i),formats:this.serverContents.formats.filter(o),values:this.serverContents.values.filter(u),dirty:EC(this.serverContents.dirty,c)},this.editedContents={formulae:this.editedContents.formulae.filter(i),formats:this.editedContents.formats.filter(o),values:this.editedContents.values.filter(u),dirty:EC(this.editedContents.dirty,c)},this.recalcDirty=EC(this.recalcDirty,c)},e}();function xS(e,t){e[t]=(e[t]||0)+1}function PS(e,t,r){return e.push(t.join(".")+": expected "+r),!1}function GS(e,t,r){return void 0===r&&(r=!1),function(n,a,i){return lr(n)&&e(n)||PS(a,i,r?t+" (received "+n+")":t)}}function VS(e,t,r,n){for(var a=[],i=t(e,a,[n]),o=0,u=a;o<u.length;o++){xS(r,u[o])}return i}function BS(e,t,r,n){var a=n+".<index>";return e.filter((function(e){return VS(e,t,r,a)}))}function WS(e){return function(t,r,n){return!!fr(t)||e(t,r,n)}}function jS(e){return function(t,r,n){if(fr(t))return PS(r,n,"non-null object");var a=n.length;try{var i=!0;for(var o in e)n[a]=o,i=i&&e[o](t[o],r,n);return i}finally{n.length=a}}}function HS(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t,r,n){return e.reduce((function(e,a){return e&&a(t,r,n)}),!0)}}function KS(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return function(r,n,a){return t.reduce((function(e,t){return e&&t(r)(r,n,a)}),e(r,n,a))}}function qS(e){return function(t,r,n){if(!Array.isArray(t))return PS(r,n,"Array");n.push("<index>");try{return t.reduce((function(t,a){return t&&e(a,r,n)}),!0)}finally{n.pop()}}}function YS(e){var t="one of "+JSON.stringify(Object.getOwnPropertyNames(e));return function(r,n,a){if(fr(r))return PS(n,a,"non-null object");var i=a.length;try{var o="string"==typeof r.kind||"number"==typeof r.kind?e[r.kind]:void 0;return fr(o)?(a.push("kind"),PS(n,a,t)):o(r,n,a)}finally{a.length=i}}}function JS(e){var t="typeof one of "+JSON.stringify(Object.getOwnPropertyNames(e));return function(r,n,a){var i=e[typeof r];return fr(i)?PS(n,a,t):i(r,n,a)}}function QS(e){return"number"==typeof e&&e>-1/0&&e<1/0}function XS(e){return(0|e)===e||Math.floor(e)===e}function zS(e,t,r,n){return void 0===r&&(r=0!==e?"integer >= "+e+" and < "+t:"natural < "+t),void 0===n&&(n=!1),GS((function(r){return"number"==typeof r&&r>=e&&r<t&&XS(r)}),r,n)}var ZS=GS(QS,"finite number"),$S=GS((function(e){return QS(e)&&XS(e)}),"integer"),ey=zS(0,1/0,"natural"),ty=GS((function(e){return"string"==typeof e}),"string"),ry=GS((function(e){return"string"==typeof e&&e.length>0}),"nonempty string"),ny=GS((function(e){return"boolean"==typeof e}),"boolean"),ay=GS((function(e){return Array.isArray(e)}),"Array");function iy(e){return GS((function(t){return t===e}),JSON.stringify(e))}function oy(e){return"="===e[0]||"+"===e[0]||"-"===e[0]}var uy=GS((function(e){return"string"==typeof e&&oy(e)}),"formula text"),cy=jS({functionId:ey,functionName:ry}),sy=jS({errorType:ey,errorName:GS((function(e){return"string"==typeof e&&e.length>1&&"#"===e[0]}),"error name")}),ly={General:!0,Number:!0,Currency:!0,Accounting:!0,Date:!0,Time:!0,Percentage:!0,Fraction:!0,Scientific:!0,Text:!0,Special:!0,Custom:!0,MaxCategory:!1},fy=jS({iformat:ey,category:GS((function(e){return"string"==typeof e&&!0===ly[e]}),"NumberFormatCategory"),decimals:ey}),dy=GS((function(e){return"string"==typeof e||QS(e)}),"string or finite number"),hy=jS({sheetId:dy,sheetName:ty}),vy=zS(0,1<<20,void 0,!0),py=zS(0,16384,void 0,!0),my=jS({row:vy,column:py}),gy=HS(my,jS({lastRow:WS(vy),lastColumn:WS(py)})),Cy=HS(gy,jS({sheetId:dy})),Sy=jS({kind:iy("Blank")}),yy=jS({kind:iy("Error"),type:ey}),Ey=JS({number:ZS,string:ty,boolean:ny,object:YS({Blank:Sy,Error:yy})}),Oy=HS(jS({value:Ey,iformat:ey,failureReason:WS(ty)}),YS({CellFormula:jS({formulaBarText:uy}),ArrayFormula:jS({formulaBarText:WS(ty)}),Value:jS({formulaBarText:ty}),Inferred:jS({formulaBarText:WS(ty)})})),ky=jS({range:Cy,excludeRows:WS(qS(vy)),excludeColumns:WS(qS(py)),data:WS(Oy),fromStateId:WS($S)}),Ay=jS({isSpilled:ny,formulaBarText:uy}),by=jS({range:Cy,data:WS(Ay),fromStateId:WS($S)}),Ry=jS({sheetId:dy,usedRange:WS(gy)}),Iy=JS({number:ZS,string:ty,boolean:ny,object:YS({Error:yy})}),Ty=jS({kind:iy("NamedValue"),value:Iy}),Ny=jS({kind:iy("NamedFormula"),formulaBarText:uy}),Fy=jS({kind:iy("NamedRange"),range:Cy}),_y=jS({kind:iy("NamedFailure"),failureReason:ty,objectKind:WS(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r={},n=0,a=e;n<a.length;n++){var i=a[n];r[i]=!0}var o="one of "+JSON.stringify(e);return GS((function(e){return"string"==typeof e&&!0===r[e]}),o)}("NamedValue","NamedFormula","NamedRange","NamedTable"))}),My=jS({name:ty,data:WS(YS({NamedValue:Ty,NamedFormula:Ny,NamedRange:Fy,NamedFailure:_y}))}),Dy=jS({scope:WS(dy),objects:WS(ay),fromStateId:WS($S)}),wy=jS({value:WS(Ey)}),Ly=jS({value:Ey}),Uy=GS((function(e){return e.length>0}),"a non-empty array"),xy=GS((function(e){return e.every((function(t){return t.sheetId===e[0].sheetId}))}),"ranges on the same sheet"),Py=HS(jS({range:KS(qS(Cy),(function(e){return Uy}),(function(e){return xy})),origin:WS(my),viewport:WS(Cy)}),YS({CellFormula:jS({formulaBarText:uy,value:WS(Ey)}),Value:jS({formulaBarText:ty,value:Ey}),Inferred:KS(jS({formulaBarText:ty}),(function(e){return t=oy(e.formulaBarText)?wy:Ly,function(e,r,n){return t(e,r,n)};var t}))})),Gy=jS({range:Cy,formulaBarText:GS((function(e){return"string"==typeof e&&(0===e.length||oy(e))}),"empty string or text denoting formula"),origin:WS(my),viewport:WS(Cy)}),Vy=jS({yr:$S,mon:zS(1,13),dom:zS(1,6),wdy:zS(1,8),hour:zS(0,24),min:zS(0,60),sec:zS(0,60),fracSec:iy(0),rounding:zS(0,4)}),By=KS(jS({bias:ZS,standardDate:WS(Vy),standardBias:ZS,daylightDate:WS(Vy),daylightBias:ZS}),(function(e){return GS((function(e){return fr(e.standardDate)===fr(e.daylightDate)}),"standardDate iff daylightDate")})),Wy=jS({date1904:WS(ny),dateCompatibility:WS(ny),timezone:WS(By)}),jy={number:!0,string:!0,boolean:!0},Hy=((wS={})[x.Error]=!0,wS[x.Array]=!1,wS[x.Rich]=!1,wS),Ky=((LS={})[x.Error]=!0,LS[x.Array]=!1,LS[x.Blank]=!0,LS[x.Rich]=!1,LS),qy=GS((function(e){return!("object"!=typeof e||!Hy[e.kind])||!0===jy[typeof e]}),"supported WriteOper"),Yy=GS((function(e){return!("object"!=typeof e||!Ky[e.kind])||!0===jy[typeof e]}),"supported ReadOper"),Jy=function(e){return{kind:"NamedValue",value:e}},Qy=function(e){return{kind:"NamedFormula",fmla:e}},Xy=function(e,t){return{kind:"NamedFailure",failureReason:e,objectKind:t}},zy={namesCount:0,recalcFailuresCount:0,scopes:0,allAvailableScopes:0};var Zy,$y=function(){function e(e,t){this.names=e,this.allAvailable=t}return e.create=function(t){return new e(ml.create(t),!1)},e.prototype.update=function(t,r){return t!==this.names||r!==this.allAvailable?new e(t,r):this},e.prototype.getEntry=function(e,t){var r=this.names.getEntry(t);return void 0===r?this.allAvailable?at(void 0):it({kind:_R.NameLoc,name:or(e,t)}):at(!1!==r.value?r:void 0)},e.prototype.setValue=function(e,t){return this.update(this.names.setValue(e,t),this.allAvailable)},e.prototype.remove=function(e){return this.update(this.allAvailable?this.names.remove(e):this.names.setValue(e,!1),this.allAvailable)},e.prototype.setUndefined=function(){return this.update(this.names,!0)},e.prototype.getStatistics=function(e){return{namesCount:this.names.getCount(),recalcFailuresCount:e,scopes:1,allAvailableScopes:this.allAvailable?1:0}},e.prototype.collectGarbage=function(){return this.allAvailable?this.update(this.names.filter((function(e,t){return!1!==t})),!0):this},e.prototype.clearCompiledFormulas=function(){this.names.forEach((function(e,t){return!1!==t&&t.compiledFmla.reset(),!0}))},e}(),eE=function(){function e(e,t){this.scope=t,this.isCurrent=!1,this.isChanged=!1,this.oldContents=this.contents=this.emptyContents=$y.create(e),this.emptyRecalcFailures=this.recalcFailures=bn.create(e)}return e.prototype.advanceState=function(e){this.oldContents=this.contents,this.oldStateId=this.isCurrent?e:void 0,this.contents=this.emptyContents,this.isCurrent=this.isChanged=!1,this.recalcFailures=this.emptyRecalcFailures},e.prototype.getStatistics=function(){return this.contents.getStatistics(this.recalcFailures.getCount())},e.prototype.collectGarbage=function(e){void 0===this.oldStateId||this.oldStateId<e?(this.oldContents=this.emptyContents,this.oldStateId=void 0):this.oldContents=this.oldContents.collectGarbage(),this.contents=this.contents.collectGarbage()},e.prototype.getNameLoc=function(e){var t=this.contents.getEntry(this.scope,e);return ot(t)?at(void 0!==t.value?or(this.scope,t.value.key):void 0):t},e.prototype.getNameFormula=function(e){var t=this.contents.getEntry(this.scope,e);return ot(t)?at(void 0!==t.value?t.value.value:void 0):t},e.prototype.hasRecalcFailure=function(e){return this.recalcFailures.contains(e)},e.prototype.setRecalcFailure=function(e){this.recalcFailures=this.recalcFailures.setValue(e,!0)},e.prototype.onCellModified=function(e){this.recalcFailures=this.emptyRecalcFailures},e.prototype.clearCompiledFormulas=function(){this.contents.clearCompiledFormulas(),this.oldContents!==this.contents&&this.oldContents.clearCompiledFormulas()},e.prototype.setNamedObject=function(e,t,r){this.contents=void 0===r?this.contents.remove(t):this.contents.setValue(t,r),this.isCurrent=this.isChanged=!0},e.prototype.setUndefinedNames=function(){this.contents=this.contents.setUndefined(),this.isCurrent=this.isChanged=!0},e.prototype.promoteNamedObjects=function(e){return!this.isChanged&&e===this.oldStateId&&(this.contents=this.oldContents,this.isCurrent=!0,!0)},e}(),tE=function(){function e(e,t,r,n,a,i){void 0===r&&(r={}),void 0===n&&(n=[]),this.document=e,this.stringCompareCI=t,this.sheets=r,this.sheetPosToId=n,this.sheetNameToId=void 0===a?bn.create(t):a,this.globalNames=void 0===i?new eE(t,ar(e)):i}return e.prototype.cloneServer=function(){for(var t=Object(j.a)({},this.sheets),r=0,n=this.sheetPosToId;r<n.length;r++){var a=n[r],i=t[a];t[a]=Object(j.a)(Object(j.a)({},i),{grid:i.grid.cloneServer()})}return new e(this.document,this.stringCompareCI,t,this.sheetPosToId,this.sheetNameToId,this.globalNames)},e.prototype.setRecalcFailure=function(e,t){var r=this.getSheetById(e);return r.kind===Be.Failure?r:at(r.value.grid.setRecalcFailure(t))},e.prototype.setRecalcEditTaint=function(e,t){var r=this.getSheetById(e);return r.kind===Be.Failure?r:at(r.value.grid.setRecalcEditTaint(t))},e.prototype.setEditedAndRecalcValues=function(e,t){var r=this.getSheetById(e.sheet.index);return r.kind===Be.Failure?r:at(r.value.grid.setEditedAndRecalcValues(e.range,t))},e.prototype.setEditedFormat=function(e,t){var r=this.getSheetById(e.sheet.index);return r.kind===Be.Failure?r:at(r.value.grid.setEditedFormat(e.range,t))},e.prototype.setHiddenRows=function(e,t,r){var n=this.getSheetById(e);return n.kind===Be.Failure?n:at(n.value.grid.setHiddenRows(t,r))},e.prototype.setInFilterMode=function(e,t){var r=this.getSheetById(e);return r.kind===Be.Failure?r:at(r.value.grid.setInFilterMode(t))},e.prototype.setCellContents=function(e,t,r,n,a,i,o){var u=this.getSheetById(t.sheet.index);if(u.kind===Be.Failure)return u;var c=void 0!==o&&pt(t.sheet,o.sheet)?o.range:void 0;return at(u.value.grid.setCellContents(e,t.set,r,n,a,i,c))},e.prototype.setRangeFormula=function(e,t,r,n,a,i){var o=this.getSheetById(t.sheet.index);if(o.kind===Be.Failure)return o;var u=void 0!==i&&pt(t.sheet,i.sheet)?i.range:void 0;return at(o.value.grid.setRangeFormula(e,t.range,r,n,a,u))},e.prototype.getDirtyEditedCells=function(){var e=[];return this.forEachSheet((function(t){e.push(KC(t.grid.sheet,t.grid.getDirtyEditedCells()))})),e},e.prototype.getDirtyDependentCells=function(){var e=[];return this.forEachSheet((function(t){e.push(KC(t.grid.sheet,t.grid.getDirtyDependentCells()))})),e},e.prototype.setNamedObject=function(e,t,r){var n=this.getNameManager(t.scope.index);return n.kind===Be.Failure?n:at(n.value.setNamedObject(e,t.name,r))},e.prototype.setUndefinedNames=function(e){var t=this.getNameManager(e.index);return t.kind===Be.Failure?t:at(t.value.setUndefinedNames())},e.prototype.promoteNamedObjects=function(e,t){var r=this.getNameManager(e.index);return r.kind===Be.Failure?r:at(r.value.promoteNamedObjects(t))},e.prototype.setSheetNames=function(t){for(var r,n=[],a={},i=[],o=0;o<t.length;o+=1){var u=t[o],c=u.sheetName,s=u.sheetId;n[o]=s,i.push([c,s]);var l=this.sheets[s];if(void 0===l){var f=Yt(this.document,s);a[s]={grid:new US(f),names:new eE(this.stringCompareCI,f),pos:o,name:c}}else a[s]=Object(j.a)(Object(j.a)({},l),{pos:o})}var d=(r=bn.create(this.stringCompareCI)).setValues.apply(r,i);return new e(this.document,this.stringCompareCI,a,n,d,this.globalNames)},e.prototype.extendServerUnused=function(e,t){var r=this.getSheetById(e);return r.kind===Be.Failure?r:at(r.value.grid.extendServerUnused(t))},e.prototype.promoteServerAvailability=function(e,t,r){var n=this.getSheetById(e);return n.kind===Be.Failure?n:at(n.value.grid.promoteServerAvailability(t,r))},e.prototype.getNameLoc=function(e,t){var r=this.getNameManager(e);if(r.kind===Be.Failure)return r;var n=r.value.getNameLoc(t);return n.kind,Be.Failure,n},e.prototype.getNameFormula=function(e){var t=this.getNameManager(e.scope.index);return t.kind===Be.Failure?t:t.value.getNameFormula(e.name)},e.prototype.hasRecalcNameFailure=function(e){var t=this.getNameManager(e.scope.index);return t.kind===Be.Failure?t:at(t.value.hasRecalcFailure(e.name))},e.prototype.setRecalcNameFailure=function(e){var t=this.getNameManager(e.scope.index);return t.kind===Be.Failure?t:at(t.value.setRecalcFailure(e.name))},e.prototype.getNameManager=function(e){if(void 0===e)return at(this.globalNames);var t=this.getSheetById(e);return t.kind===Be.Failure?t:at(t.value.names)},e.prototype.getEditedFormula=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===Be.Failure?t:at(t.value.grid.getEditedFormula(e.range))},e.prototype.getEditedFormat=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===Be.Failure?t:at(t.value.grid.getEditedFormat(e.range))},e.prototype.isInFilterMode=function(e){var t=this.getSheetById(e);return t.kind===Be.Failure?t:t.value.grid.isInFilterMode()},e.prototype.getHiddenRows=function(e,t,r){var n=this.getSheetById(e);return n.kind===Be.Failure?n:n.value.grid.getHiddenRows(t,r)},e.prototype.getServerFormat=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===Be.Failure?t:at(t.value.grid.getServerFormat(e.range))},e.prototype.getRecalcValue=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===Be.Failure?t:at(t.value.grid.getRecalcValue(e.range))},e.prototype.getServerValue=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===Be.Failure?t:at(t.value.grid.getServerValue(e.range))},e.prototype.getServerFormula=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===Be.Failure?t:at(t.value.grid.getServerFormula(e.range))},e.prototype.getServerUsedRange=function(e){var t=this.getSheetById(e);return t.kind===Be.Failure?t:at(t.value.grid.getServerUsedRange())},e.prototype.allServerAvailable=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===Be.Failure?t:at(t.value.grid.allServerAvailable(e.range))},e.prototype.allEditedAvailable=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===Be.Failure?t:at(t.value.grid.allEditedAvailable(e.range))},e.prototype.hasRecalcDirty=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===Be.Failure?t:at(t.value.grid.hasRecalcDirty(e.range))},e.prototype.hasRecalcFailure=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===Be.Failure?t:at(t.value.grid.hasRecalcFailure(e.range))},e.prototype.hasEditedEditTaint=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===Be.Failure?t:at(t.value.grid.hasEditedEditTaint(e.range))},e.prototype.hasRecalcEditTaint=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===Be.Failure?t:at(t.value.grid.hasRecalcEditTaint(e.range))},e.prototype.forEachEditedNonBlankCellInSet=function(e,t,r){var n=this.getSheetById(e);return n.kind===Be.Failure?n:at(n.value.grid.forEachEditedNonBlankCellInSet(t,r))},e.prototype.forEachServerNonBlankCellInSet=function(e,t,r){var n=this.getSheetById(e);return n.kind===Be.Failure?n:at(n.value.grid.forEachServerNonBlankCellInSet(t,r))},e.prototype.getSheetIndex=function(e){var t=this.getSheetByName(e);return t.kind===Be.Failure||void 0===t.value?t:at(t.value.grid.sheet)},e.prototype.getSheetName=function(e){var t=this.getSheetById(e);return t.kind===Be.Failure?t:at(t.value.name)},e.prototype.getEditedUsedRange=function(e){var t=this.getSheetById(e);return t.kind===Be.Failure?t:at(t.value.grid.getEditedUsedRange())},e.prototype.getSheetRangeIds=function(e){var t,r;if(void 0===e.index)t=0,r=this.sheetPosToId.length;else{var n=this.getSheetById(e.index);if(!ot(n))return n;var a=this.getSheetById(e.index2);if(!ot(a))return a;t=vr(n.value.pos,a.value.pos),r=pr(n.value.pos,a.value.pos)+1}for(var i=[],o=t;o<r;o+=1)i.push(this.sheetPosToId[o]);return at(Qt(i,t))},e.prototype.onCellModified=function(e){this.forEachSheet((function(t){t.grid.onCellModified(e),t.names.onCellModified(e)})),this.globalNames.onCellModified(e)},e.prototype.collectGarbage=function(e){this.forEachSheet((function(t){t.grid.collectGarbage(e),t.names.collectGarbage(e)})),this.globalNames.collectGarbage(e)},e.prototype.advanceState=function(e){this.forEachSheet((function(t){t.grid.advanceState(e),t.names.advanceState(e)})),this.globalNames.advanceState(e)},e.prototype.clearCompiledFormulas=function(){this.forEachSheet((function(e){e.grid.clearCompiledFormulas(),e.names.clearCompiledFormulas()})),this.globalNames.clearCompiledFormulas()},e.prototype.getGridStatistics=function(){var e=MS;return this.forEachSheet((function(t){return r=e,n=t.grid.getStatistics(),e={serverFormulaeNodeCount:r.serverFormulaeNodeCount+n.serverFormulaeNodeCount,serverFormatsNodeCount:r.serverFormatsNodeCount+n.serverFormatsNodeCount,serverValuesNodeCount:r.serverValuesNodeCount+n.serverValuesNodeCount,serverDirtySetSubspaceCount:r.serverDirtySetSubspaceCount+n.serverDirtySetSubspaceCount,editedFormulaeNodeCount:r.editedFormulaeNodeCount+n.editedFormulaeNodeCount,editedFormatsNodeCount:r.editedFormatsNodeCount+n.editedFormatsNodeCount,editedValuesNodeCount:r.editedValuesNodeCount+n.editedValuesNodeCount,editedDirtySetSubspaceCount:r.editedDirtySetSubspaceCount+n.editedDirtySetSubspaceCount,recalcDirtySetSubspaceCount:r.recalcDirtySetSubspaceCount+n.recalcDirtySetSubspaceCount,recalcFailuresSetSubspaceCount:r.recalcFailuresSetSubspaceCount+n.recalcFailuresSetSubspaceCount,recalcTaintSetSubspaceCount:r.recalcTaintSetSubspaceCount+n.recalcTaintSetSubspaceCount,availabilitySetSubspaceCount:r.availabilitySetSubspaceCount+n.availabilitySetSubspaceCount,availabilityHistorySize:r.availabilityHistorySize+n.availabilityHistorySize,hiddenRowsNodeCount:r.hiddenRowsNodeCount+n.hiddenRowsNodeCount};var r,n})),e},e.prototype.getNameStatistics=function(){var e=this.globalNames.getStatistics();return this.forEachSheet((function(t){return r=e,n=t.names.getStatistics(),e={namesCount:r.namesCount+n.namesCount,recalcFailuresCount:r.recalcFailuresCount+n.recalcFailuresCount,scopes:r.scopes+n.scopes,allAvailableScopes:r.allAvailableScopes+n.allAvailableScopes};var r,n})),e},e.prototype.getServerAvailableCells=function(){for(var e=[],t=0,r=this.sheetPosToId;t<r.length;t++){var n=r[t],a=this.sheets[n],i=Yt(this.document,n);e.push({sheetIdx:i,availableCells:a.grid.getServerAvailability()})}return e},e.prototype.forEachSheet=function(e){for(var t in this.sheets){if(this.sheets.hasOwnProperty(t))e(this.sheets[t])}},e.prototype.getSheetById=function(e){var t=this.sheets[e];return void 0!==t?at(t):this.unavailableFailure({kind:_R.SheetId,document:this.document,sheetId:e})},e.prototype.getSheetByName=function(e){var t=this.sheetNameToId.getValue(e);return void 0===t?at(void 0):this.getSheetById(t)},e.prototype.unavailableFailure=function(e){return it(e)},e}(),rE=function(){function e(e){this.valueCreationFunc=e}return e.prototype.getValue=function(){return void 0===this.value&&(this.value=this.valueCreationFunc()),this.value},e.prototype.reset=function(){this.value=void 0},e}();!function(e){e[e.OP_DOT=-1]="OP_DOT",e[e.OP_DOTSTAR=-2]="OP_DOTSTAR"}(Zy||(Zy={}));var nE=function(){function e(e,t,r){void 0===r&&(r=!1),this.localeInfo=e,this.source=t,this.bytecode=[],this.blocks=[];for(var n="",a=0;a<t.length;a+=1){var i=t.charCodeAt(a);126===i&&a+1<t.length?(n+=t.charAt(a+1),a+=1):126!==i&&(63!==i&&42!==i?n+=t.charAt(a):(this.pushBlock(n),n="",this.pushMeta(i)))}this.pushBlock(n),r&&this.pushMeta(42)}return e.prototype.pushBlock=function(e){if(""!==e){var t=this.blocks.length;this.blocks.push(e),this.bytecode.push(t);for(var r=1;r<e.length;r+=1)this.bytecode.push(Zy.OP_DOT)}},e.prototype.pushMeta=function(e){63===e?this.bytecode.push(Zy.OP_DOT):this.bytecode.push(Zy.OP_DOTSTAR)},e.prototype.test=function(e){var t=Object.create(null);this.addState(t,0);for(var r=0;r<e.length;r+=1){var n=Object.keys(t);if(t=Object.create(null),0===n.length)return!1;for(var a=0;a<n.length;a+=1){var i=Number(n[a]);if(i!==this.bytecode.length){var o=this.bytecode[i];switch(o){case Zy.OP_DOT:this.addState(t,i+1);break;case Zy.OP_DOTSTAR:this.addState(t,i);break;default:var u=this.blocks[o];r+u.length<=e.length&&0===this.localeInfo.stringCompareCI(u,e.substring(r,r+u.length))&&this.addState(t,i+1)}}}}return this.bytecode.length in t},e.prototype.addState=function(e,t){e[t]=!0;for(var r=this.bytecode,n=t;n<r.length&&r[n]===Zy.OP_DOTSTAR;n+=1)e[n+1]=!0},e}(),aE={"=":Ue.Eq,"<":Ue.Lt,">":Ue.Gt},iE={"<>":Ue.Ne,"<=":Ue.Le,">=":Ue.Ge};function oE(e,t){(function(e,t){for(var r=0;r<t.length;r+=1)if(e.isNumeral(t.charCodeAt(r)))return!0;return!1})(e,t)&&cv(Dt(["potential string -> number coercion: "+Ai(t)]))}function uE(e,t){if("string"!=typeof t)return t;var r,n,a=(r=t).length>=2&&void 0!==(n=iE[r.substring(0,2)])?[n,r.substring(2)]:r.length>=1&&void 0!==(n=aE[r.substring(0,1)])?[n,r.substring(1)]:[void 0,r];return{kind:"FilterExpression",operator:a[0],operand:function(e,t){if(0===e.stringCompareCI(t,e.trueName))return!0;if(0===e.stringCompareCI(t,e.falseName))return!1;for(var r=1;r<e.errorNames.length;r+=1){var n=e.errorNames[r];if(void 0!==n&&0===e.stringCompareCI(n,t))return Ce(r)}var a=e.parseNumber(t);return Ft(a)?a:(oE(e,t),t)}(e,a[1])}}function cE(e,t,r,n){var a=function(e,t){var r="object"==typeof t&&"FilterExpression"===t.kind?t:{kind:"FilterExpression",operator:Ue.Eq,operand:t},n=e.config,a=n.mathpack,i=n.localeInfo;if(r.operator===Ue.Ne&&""===r.operand)return function(e){return!Sf(e)};if(r.operator===Ue.Eq&&""===r.operand)return Sf;if(void 0!==r.operator&&""===r.operand)return function(e){return!1};if(void 0===r.operator&&""===r.operand)return function(e){return Sf(e)||""===e};var o,u,c=void 0===r.operator?Ue.Eq:r.operator;switch(typeof r.operand){case"number":return o=c,u=r.operand,function(e){var t=kf(e)?e.getFallback():e;if("number"==typeof t)return Wv(a,o,t,u);if("string"==typeof t&&o===Ue.Eq){var r=i.parseNumber(t);return Ft(r)?Wv(a,o,r,u):(oE(i,t),!1)}return o===Ue.Ne};case"boolean":return function(e,t){return function(r){var n=kf(r)?r.getFallback():r;return"boolean"==typeof n?Vv(e,n,t):e===Ue.Ne}}(c,r.operand);case"string":return function(e,t){switch(e){case Ue.Eq:case Ue.Ne:var r=new nE(i,t);return function(t){var n=kf(t)?t.getFallback():t;return"string"!=typeof n?e===Ue.Ne:r.test(n)===(e===Ue.Eq)};case Ue.Lt:case Ue.Gt:case Ue.Le:case Ue.Ge:return function(r){var n=kf(r)?r.getFallback():r;return"string"==typeof n&&Bv(i,e,n,t)}}}(c,r.operand);case"object":return Cf(r.operand)?function(e,t){return function(r){var n=kf(r)?r.getFallback():r;return Cf(n)?Gv(e,n.type-t.type):e===Ue.Ne}}(c,r.operand):k("calc.funcs.criteria.compileCriteria",r.operand)}return k("calc.funcs.criteria.compileCriteria",r.operand)}(e,uE(e.config.localeInfo,r)),i=t,o=void 0===n?i:n;return new yl(o.rows,o.cols,pr(i.denseRows,o.denseRows),pr(i.denseCols,o.denseCols),(function(e,t){var r=i.get(e,t);return a(r)?o.get(e,t):void 0}),(function(){var e=i.getSparse();return a(e)?o.getSparse():void 0}))}function sE(e,t,r,n,a){var i=function(n,i,u,c){if("object"==typeof i&&i.kind===x.Array){for(var s=new gl(i.rows,i.cols,i.opers),l=n,f=0;f<u;f+=1)l=o(l,s);return l}var d=(c&&void 0!==a?a:r)(e,i);return null==d?n:t(n,d,u)};function o(e,t){for(var r=e,n=0;n<t.rows;n+=1)for(var a=0;a<t.cols;a+=1){var o=t.get(n,a);void 0!==o&&(r=i(r,o,1,!0))}return r}function u(e,t){for(var r=e,n=t.getSparse(),a=t.cols-t.denseCols,o=0;o<t.denseRows;o+=1){for(var u=0;u<t.denseCols;u+=1){var c=t.get(o,u);void 0!==c&&(r=i(r,c,1,!1))}a>0&&void 0!==n&&(r=i(r,n,a,!1))}var s=(t.rows-t.denseRows)*t.cols;return s>0&&void 0!==n&&(r=i(r,n,s,!1)),r}return n.reduce((function(e,t){return"object"==typeof t&&t.kind===dh.RangeValues?t.arrays.reduce(u,e):i(e,t,1,!1)}),void 0)}function lE(e){return function(t,r){return e(t)(r[0])}}function fE(e){return function(t,r){return e(t)(r[0],r[1])}}var dE=function(e){return"number"==typeof e?e:A("calc.funcs.assertNumber")},hE=function(e){return"string"==typeof e?e:A("calc.funcs.assertString")};function vE(e,t){var r=_f(e,t,!1),n=kf(r)?r.getFallback():r;switch(typeof n){case"number":return n;case"boolean":return Ee;case"string":var a=e.coerceOper(n,x.Number);return"number"==typeof a?a:Ee;case"object":switch(n.kind){case x.Error:return n;case x.Array:return Ee;case x.Missing:return be;case x.Blank:return e.mathpack.zero}}return k("calc.funcs.chkNumOper",n)}function pE(e,t){var r="string"==typeof t,n=vE(e,t);if(Cf(n))return n;var a=e.mathpack;return a.cond(n)<0?Ae:mE(e,n=a.floor(n))?(e.config.date1904&&!r&&(n=a.add(a.fromNumber(1462),n)),n):Ae}function mE(e,t){var r,n,a=e.mathpack.lfix(t);return e.config.date1904?(r=0,n=2957003):(r=0,n=2958465),a>=r&&a<=n}function gE(e,t,r){var n=e.div(t,r);if(Cf(n))return n;var a=e.mul(e.trunc(n),r);if(Cf(a))return a;var i=e.sub(t,a);return!Cf(i)&&e.cond(t)<0?e.abs(i):i}function CE(e,t){var r=kf(t)?t.getFallback():t;switch(typeof r){case"number":return r;case"object":break;default:return}switch(r.kind){case x.Error:return r;case x.Missing:case x.Blank:return;default:return k("calc.funcs.arithmeticOperationCoerce",r)}}function SE(e,t){var r=kf(t)?t.getFallback():t;switch(typeof r){case"boolean":return r?e.mathpack.one:e.mathpack.zero;case"number":return r;case"string":return e.mathpack.zero;case"object":break;default:return k("calc.funcs.arithmeticAOperationCoerce",r)}switch(r.kind){case x.Error:return r;case x.Missing:case x.Blank:return;default:return k("calc.funcs.arithmeticAOperationCoerce",r)}}function yE(e){return function(t,r,n){if(void 0!==t&&Cf(t))return t;if(b("calc.funcs.numberReducer",void 0===t||"number"==typeof t),Cf(r))return r;var a,i;b("calc.funcs.numberReducer","number"==typeof r),void 0===t?(a=r,i=n-1):(a=t,i=n);for(var o=0;o<i;o+=1){var u=e(a,r);if(Cf(u))return u;a=u}return a}}function EE(e){return function(t,r,n){return e.count+=n,r}}function OE(e,t,r){if("number"!=typeof r)return r;var n=function(e){for(var t=e.length-1;t>=0;t-=1){var r=e[t];if("object"==typeof r&&r.kind===dh.RangeValues)for(var n=r.arrays.length-1;n>=0;n-=1){var a=r.arrays[n];if(a.rows>a.denseRows||a.cols>a.denseCols)if("number"==typeof(u=a.getSparse()))return u;for(var i=a.denseRows-1;i>=0;i-=1)for(var o=a.denseCols-1;o>=0;o-=1){var u;if("number"==typeof(u=a.get(i,o)))return u}}}}(t);return"number"!=typeof n?r:e.mathpack.checkAlmostCancellation(n,r)}function kE(e,t,r){var n=sE(t,yE(t.mathpack.add),CE,r);return null==n?t.mathpack.zero:(e&&(n=OE(t,r,n)),n)}var AE=kE.bind(void 0,!1),bE=kE.bind(void 0,!0);function RE(e,t){var r=e.dereferenceAllOpers(t),n=DO(CE),a=sE(e,yE(e.mathpack.add),n,r);return null==a?e.mathpack.zero:a}function IE(e){return e.kind===x.Range&&1!==e.ranges.length}function TE(e,t,r){if(IE(t))return it(Ee);if(void 0===r){var n=e.dereferenceAllOpers([t])[0];return at({values:n,valuesToFilter:n})}if(IE(r))return it(Ee);var a=function(e,t){var r=e.ranges[0],n=t.ranges[0],a=vr(r.cols,16384-n.col),i=vr(r.rows,(1<<20)-n.row),o=zt(r.row,r.col,i,a),u=Me(e.sheets,o),c=zt(n.row,n.col,i,a),s=Me(t.sheets,c);return{actualEvalRange:u,actualFilterRange:s}}(t,r),i=a.actualEvalRange,o=a.actualFilterRange,u=i.ranges[0],c=o.ranges[0],s=e.dereferenceAllOpers([i])[0];return u.col===c.col&&u.row===c.row?at({values:s,valuesToFilter:s}):at({values:s,valuesToFilter:e.dereferenceAllOpers([o])[0]})}function NE(e,t){var r=t,n=r[0],a=r[1],i=TE(e,n,r[2]);if(!ot(i))return i.reason;var o=i.value,u=o.values,c=o.valuesToFilter,s=[yh([cE(e,u.arrays[0],a,c.arrays[0])])];return AE(e,s)}function FE(e,t,r,n){void 0===r&&(r=!1),void 0===n&&(n=!1);var a,i,o=t[0];if(IE(o))return it(Ee);if(r){var u=t[1],c=e.dereferenceAllOpers([o])[0];a=cE(e,c.arrays[0],u),i=2}else{a=e.dereferenceAllOpers([o])[0].arrays[0],i=1}for(var s=i;s<t.length;s+=2){var l=t[s],f=t[s+1];if(IE(l))return it(Ee);if(l.ranges[0].cols!==o.ranges[0].cols||l.ranges[0].rows!==o.ranges[0].rows)return it(Ee);c=e.dereferenceAllOpers([l])[0];a=cE(e,c.arrays[0],f,a)}return n&&(a=a.strict()),at(yh([a]))}function _E(e,t){if(3===t.length)return NE(e,[t[1],t[2],t[0]]);var r=FE(e,t);return ot(r)?AE(e,[r.value]):r.reason}function ME(e,t){var r=sE(e,yE(e.mathpack.mul),CE,t);return null==r?e.mathpack.zero:r}function DE(e,t,r,n,a,i){var o=sE(a,yE(a.mathpack.add),e,i,t);if(null==o)return n;if(r&&(o=OE(a,i,o)),Cf(o))return o;var u={count:0},c=sE(a,EE(u),e,i,t);b("calc.funcs.averageCoerceInner","number"==typeof o&&"number"==typeof c&&u.count>0);var s=a.mathpack.div(o,a.mathpack.fromNumber(u.count));return Cf(s)?s:[s,u.count]}function wE(e,t,r,n,a){var i=DE(e,t,r,ye,n,a);return Array.isArray(i)?i[0]:i}var LE=wE.bind(void 0,CE,void 0,!1),UE=wE.bind(void 0,CE,void 0,!0),xE=wE.bind(void 0,SE,(function(e,t){var r=kf(t)?t.getFallback():t;return"string"==typeof r?e.mathpack.zero:CE(0,r)}),!0);function PE(e,t){var r=t,n=r[0],a=r[1],i=TE(e,n,r[2]);if(!ot(i))return i.reason;var o=i.value,u=o.values,c=o.valuesToFilter,s=[yh([cE(e,u.arrays[0],a,c.arrays[0]).strict()])];return LE(e,s)}function GE(e,t){if(3===t.length)return PE(e,[t[1],t[2],t[0]]);var r=FE(e,t,void 0,!0);return ot(r)?LE(e,[r.value]):r.reason}function VE(e,t){var r=e.dereferenceAllOpers(t);return xE(e,r)}function BE(e,t,r,n,a){for(var i=void 0,o=0,u="",c=function(e,t){return e.coerceOper(t,x.String)},s=function(e,n,a){if(void 0!==e&&Cf(e))return e;for(var c=0;c<a;c+=1){if(void 0!==i&&t.length>0&&(!r||i.length>0)){var s=t[o];if(o=(o+1)%t.length,u.length+s.length>32767)return Ee;u+=s}if(Cf(n))return n;if("string"!=typeof n)return A("calc.funcs.concatInner: expected string in reducer");if(u.length+n.length>32767)return Ee;if(u+=n,i=n,""===n&&(0===t.length||r))break}return n},l=0;l<a.length;l+=1){var f=n[l];if(Of(f)&&f.ranges.length>1)return Ee;var d=sE(e,s,c,a.slice(l,l+1));if(void 0!==d&&Cf(d))return d;b("calc.funcs.concatInner: expected string from reduce","string"==typeof d)}if(r&&""===i&&t.length>0&&u.length>0){var h=t[(o+t.length-1)%t.length];u=u.substring(0,u.length-h.length)}return u}function WE(e,t){var r=t,n=r[0],a=r[1],i=r.slice(2),o=[];if(!Ef(n)){if(Of(n)&&n.ranges.length>1)return Ee;var u=sE(e,vO(o,hE),(function(e,t){return e.coerceOper(t,x.String)}),e.dereferenceAllOpers([n]));if(void 0!==u&&Cf(u))return u;b("calc.funcs.textjoin: expected string from reduce","string"==typeof u)}return BE(e,o,Ef(a)||a,i,e.dereferenceAllOpers(i))}function jE(e,t,r){var n={count:0};return sE(t,EE(n),e,r),t.mathpack.fromNumber(n.count)}var HE=jE.bind(void 0,(function(e,t){var r=kf(t)?t.getFallback():t;return"number"==typeof r?r:void 0}));function KE(e,t){var r=e.dereferenceAllOpers(t);return HE(e,r)}var qE=jE.bind(void 0,(function(e,t){var r=kf(t)?t.getFallback():t;return Sf(r)||""===r?r:void 0}));var YE=jE.bind(void 0,(function(e,t){var r=kf(t)?t.getFallback():t;return"object"!=typeof r||r.kind===x.Error?r:void 0}));var JE=jE.bind(void 0,(function(e,t){return t}));function QE(e,t){var r=t,n=r[0],a=r[1];if(IE(n))return Ee;var i=e.dereferenceAllOpers([n])[0],o=[yh([cE(e,i.arrays[0],a)])];return JE(e,o)}function XE(e,t){if(2===t.length)return QE(e,t);var r=FE(e,t,!0);return ot(r)?JE(e,[r.value]):r.reason}var zE=function(e,t,r){return e.mathpack.cond2(t,r)>0},ZE=function(e,t,r){return e.mathpack.cond2(t,r)<0};function $E(e,t,r,n,a){var i=sE(n,(function(t,r,a){return void 0===t?r:Cf(t)?t:(b("calc.funcs.minMaxCoerceInner","number"==typeof t),Cf(r)?r:(b("calc.funcs.minMaxCoerceInner","number"==typeof r),e(n,t,r)?t:r))}),t,a,r);return null==i?n.mathpack.zero:i}var eO=$E.bind(void 0,zE,CE,void 0),tO=$E.bind(void 0,ZE,CE,void 0),rO=$E.bind(void 0,zE,SE,CE),nO=$E.bind(void 0,ZE,SE,CE);function aO(e,t){var r=e.dereferenceAllOpers(t);return rO(e,r)}function iO(e,t){var r=e.dereferenceAllOpers(t);return nO(e,r)}function oO(e,t){var r=FE(e,t);return ot(r)?eO(e,[r.value]):r.reason}function uO(e,t){var r=FE(e,t);return ot(r)?tO(e,[r.value]):r.reason}function cO(e,t){var r=kf(t)?t.getFallback():t;switch(typeof r){case"boolean":return r;case"number":return 0!==e.mathpack.cond(r);case"object":break;default:return}switch(r.kind){case x.Error:return r;case x.Missing:case x.Blank:return;default:return k("calc.funcs.aggregationFuncs: booleanOperationCoerce",r)}}function sO(e,t,r){var n=sE(t,(function(t,r,n){return void 0!==t&&Cf(t)?t:Cf(r)?r:(b("calc.funcs.booleanInner",(void 0===t||"boolean"==typeof t)&&"boolean"==typeof r),e(t,r,n))}),cO,r);return null==n?Ee:n}var lO=sO.bind(void 0,(function(e,t){return!1!==e&&t})),fO=sO.bind(void 0,(function(e,t){return!0===e||t})),dO=sO.bind(void 0,(function(e,t,r){return t?((!0===e?1:0)+r)%2==1:!0===e}));function hO(e,t){var r=e.dereferenceAllOpers(t);return dO(e,r)}function vO(e,t){return function(r,n,a){if(void 0!==r&&Cf(r))return r;if(!Cf(n))for(var i=t(n),o=0;o<a;o+=1)e.push(i);return n}}function pO(e,t,r,n){var a=[],i=sE(t,vO(a,dE),CE,[r]);if(null==i)return Ae;if(Cf(i))return i;var o=t.mathpack;if(o.cond2(n,o.one)<0)return Ae;if(o.cond2(n,o.fromNumber(a.length))>0)return Ae;var u=a.sort(o.cond2);if(e){var c=dE(o.add(dE(o.sub(o.fromNumber(a.length),n)),o.one));return u[o.lfix(c)-1]}return u[o.lfix(n)-1]}var mO=pO.bind(void 0,!0),gO=pO.bind(void 0,!1);function CO(e,t){var r=e.dereferenceAllOpers(t),n=r[0],a=r[1];return mO(e,n,a)}function SO(e,t){var r=e.dereferenceAllOpers(t),n=r[0],a=r[1];return gO(e,n,a)}function yO(e,t,r,n){var a=e.mathpack,i=[],o=sE(e,vO(i,dE),CE,t);if(null==o)return Ae;if(Cf(o))return o;if(Cf(r))return r;if(a.cond(r)<0)return Ae;if(a.cond2(r,a.one)>0)return Ae;var u=i.sort(a.cond2),c=dE(a.sub(a.fromNumber(u.length),a.one)),s=dE(a.add(a.fromNumber(u.length),a.one)),l=dE(n?a.mul(c,r):a.sub(dE(a.mul(s,r)),a.one));if(a.cond(l)<0||a.cond2(l,c)>0)return Ae;var f=a.lfix(l),d=dE(a.sub(l,a.fromNumber(f)));if(0===a.cond(d))return u[f];var h=a.sub(u[f+1],u[f]);return Cf(h)?h:a.add(u[f],dE(a.mul(h,d)))}var EO=function(e,t,r){return yO(e,[t],r,!0)};function OO(e,t){var r=e.dereferenceAllOpers(t),n=r[0],a=r[1];return EO(e,n,a)}var kO=function(e,t,r){return yO(e,[t],r,!1)};function AO(e,t){var r=e.dereferenceAllOpers(t),n=r[0],a=r[1];return kO(e,n,a)}function bO(e,t){var r=e.mathpack;if(r.cond(t)<0)return Ae;if(r.cond2(t,r.fromNumber(5))>=0)return Ae;var n=r.lfix(t);return r.div(r.fromNumber(n),r.fromNumber(4))}var RO=function(e,t,r){return yO(e,[t],bO(e,r),!0)};function IO(e,t){var r=e.dereferenceAllOpers(t),n=r[0],a=r[1];return RO(e,n,a)}var TO=function(e,t,r){return yO(e,[t],bO(e,r),!1)};function NO(e,t){var r=e.dereferenceAllOpers(t),n=r[0],a=r[1];return TO(e,n,a)}function FO(e,t){return yO(e,t,e.mathpack.fromNumber(.5),!0)}function _O(e,t){var r=e.dereferenceAllOpers(t);return FO(e,r)}function MO(e,t){var r=e.dereferenceAllOpers(t),n=r[0],a=r[1],i=[],o=sE(e,vO(i,dE),CE,[n]);if(null==o)return Ae;if(Cf(o))return o;var u=e.mathpack;if(u.cond(a)<0)return Ae;if(u.cond2(a,u.one)>=0)return Ae;i=i.sort(u.cond2);var c=u.lfix(dE(u.div(dE(u.mul(u.fromNumber(i.length),a)),u.fromNumber(2))));b("calc.funcs.trimmean",c+c<i.length);var s=i[c],l=i[i.length-1-c],f=0,d=0,h=sE(e,yE(e.mathpack.add),(function(e,t){var r=CE(0,t);if(void 0===r)return r;b("calc.funcs.trimmean: unexpected error","number"==typeof r);var n=e.mathpack;if(n.cond2(r,s)<0)f+=1;else{if(!(n.cond2(r,l)>0))return r;d+=1}}),[n]);b("calc.funcs.trimmean: found no elements","number"==typeof h),b("calc.funcs.trimmean: trimmed too many",f<=c&&d<=c);for(var v=h;f<c;f+=1){if(Cf(p=u.sub(v,s)))return p;v=p}for(;d<c;d+=1){var p;if(Cf(p=u.sub(v,l)))return p;v=p}return u.div(v,u.fromNumber(i.length-c-c))}function DO(e){return function(t,r){var n=e(t,r);return"number"==typeof n?t.mathpack.mul(n,n):n}}function wO(e,t){return function(r,n){var a=e(r,n);if("number"!=typeof a)return a;var i=r.mathpack,o=i.sub(a,t);return Cf(o)?o:i.mul(o,o)}}function LO(e,t,r,n){var a={count:0};if(null==sE(r,EE(a),e,n,t))return ye;b("calc.funcs.varFirstPass: unexpected count type",a.count>=1);var i=yE(r.mathpack.add),o=sE(r,i,e,n,t),u=sE(r,i,DO(e),n,void 0===t?void 0:DO(t));if(b("calc.funcs.varFirstPass: unexpected sum type",null!=o),Cf(o))return o;b("calc.funcs.varFirstPass: unexpected error","number"==typeof o&&"number"==typeof u);var c=r.mathpack,s=c.div(o,c.fromNumber(a.count));return Cf(s)?s:[a.count,o,u,s]}function UO(e,t,r,n,a){var i=sE(r,yE(r.mathpack.add),wO(e,a),n,void 0===t?void 0:wO(t,a));return b("calc.funcs.varSecondPass: unexpected error","number"==typeof i),i}function xO(e,t,r,n){var a=LO(e,t,r,n);if(!Array.isArray(a))return a;var i=r.mathpack,o=a[0],u=a[1],c=a[2],s=a[3];if(o<2)return ye;var l=i.mul(u,u);if(Cf(l))return l;var f=dE(i.div(l,i.fromNumber(o))),d=dE(i.sub(c,f));if(0===i.cond(s))return i.cond(d)<0?i.zero:i.div(d,i.fromNumber(o-1));if(i.cond(d)>=0){var h=dE(i.div(d,i.fromNumber(o-1)));if(i.cond2(h,i.fromNumber(21219957905e-324))>0){var v=i.div(f,c),p=Cf(v)?v:i.sub(v,i.one);if(!Cf(p)&&i.cond2(i.abs(p),i.fromNumber(.01))>0){var m=i.div(s,h),g=Cf(m)?m:i.sub(i.abs(m),i.fromNumber(1e3));if(!Cf(g)&&i.cond(g)<0)return h}}}var C=UO(e,t,r,n,s);return i.cond(C)<0?i.zero:i.div(C,i.fromNumber(o-1))}function PO(e,t,r,n){var a=LO(e,t,r,n);if(!Array.isArray(a))return a;var i=r.mathpack,o=a[0],u=a[1],c=a[2],s=a[3];if(o<1)return ye;var l=i.mul(u,u);if(Cf(l))return l;var f=i.mul(c,i.fromNumber(o));if(Cf(f))return f;var d=dE(i.sub(f,l));if(0===i.cond(s))return i.cond(d)<0?i.zero:i.div(d,i.fromNumber(o*o));if(i.cond(d)>=0){var h=dE(i.div(d,i.fromNumber(o*o)));if(i.cond2(h,i.fromNumber(21219957905e-324))>0){var v=i.div(dE(i.div(l,i.fromNumber(o))),c),p=Cf(v)?v:i.sub(v,i.one);if(!Cf(p)&&i.cond2(i.abs(p),i.fromNumber(.01))>0){var m=i.div(s,h),g=Cf(m)?m:i.sub(i.abs(m),i.fromNumber(1e3));if(!Cf(g)&&i.cond(g)<0)return h}}}var C=UO(e,t,r,n,s);return i.cond(C)<0?i.zero:i.div(C,i.fromNumber(o))}var GO=xO.bind(void 0,CE,void 0),VO=PO.bind(void 0,CE,void 0),BO=xO.bind(void 0,SE,CE),WO=PO.bind(void 0,SE,CE);function jO(e){return function(t,r){var n=e(t,r);return"number"!=typeof n?n:t.mathpack.sqrt(n)}}var HO=jO(GO),KO=jO(VO),qO=jO(BO),YO=jO(WO);function JO(e,t){var r=e.dereferenceAllOpers(t);return HO(e,r)}function QO(e,t){var r=e.dereferenceAllOpers(t);return KO(e,r)}function XO(e,t){var r=e.dereferenceAllOpers(t);return qO(e,r)}function zO(e,t){var r=e.dereferenceAllOpers(t);return YO(e,r)}function ZO(e,t){var r=e.dereferenceAllOpers(t);return GO(e,r)}function $O(e,t){var r=e.dereferenceAllOpers(t);return VO(e,r)}function ek(e,t){var r=e.dereferenceAllOpers(t);return BO(e,r)}function tk(e,t){var r=e.dereferenceAllOpers(t);return WO(e,r)}var rk=[UE,HE,YE,eO,tO,ME,HO,KO,bE,GO,VO];function nk(e,t){var r,n=[],a=sE(e,(r=n,function(e,t,n){if(void 0!==e&&Cf(e))return e;if("number"==typeof t)for(var a=0;a<n;a+=1)r.push({value:t,index:r.length});return t}),CE,t);if(null==a)return be;if(Cf(a))return a;var i=e.mathpack,o=n.sort((function(e,t){return i.cond2(e.value,t.value)})),u=1,c=0,s=1/0,l=[];function f(e){u=1,s=e.index}var d,h,v,p=function(e){var t=e.value;u>c?(c=u,l.length=0,l.push({value:t,index:s})):u===c&&l.push({value:t,index:s})};f(o[0]);for(var m=1;m<o.length;m+=1)h=o[m-1],v=o[m],0===i.cond2(h.value,v.value)?((d=o[m]).index<s&&(s=d.index),u+=1):(p(o[m-1]),f(o[m]));return p(o[o.length-1]),c<2?be:(b("calc.funcs.modeInner: unexpected error",0!==l.length),l.sort((function(e,t){return e.index-t.index})))}function ak(e,t){var r=nk(e,t);return Array.isArray(r)?r[0].value:r}function ik(e,t){var r=e.dereferenceAllOpers(t);return ak(e,r)}function ok(e,t){var r=e.dereferenceAllOpers(t),n=nk(e,r);return Array.isArray(n)?Fe(n.length,1,n.map((function(e){return[e.value]}))):n}function uk(e){return"object"!=typeof e||e.kind!==dh.RangeValues?e:yh(e.arrays.map((function(e){return e.map((function(e){var t=e[0],r=e[1];return void 0!==r&&function(e){for(var t in e)if(e.hasOwnProperty(t)){var r=e[t];if(void 0!==r&&r.kind===w.WorksheetFuncName&&(r.id===De.SUBTOTAL||r.id===De.AGGREGATE))return!0}return!1}(r.formula.annotations)?void 0:t}))})))}function ck(e,t){var r=e.mathpack.sfix(t[0]),n=rk.length;if(!(r>=1&&r<=n||r>=101&&r<=n+100))return Ee;var a=r>100||e.isInFilterMode(t.slice(1)),i=e.dereferenceAllOpersAndFormulae(t.slice(1),a).map(uk);return(0,rk[r%100-1])(e,i)}var sk=Object(j.f)(rk,[FO,ak]),lk=[mO,gO,EO,RO,kO,TO];function fk(e,t){var r=e.mathpack,n=r.sfix(t[0]),a=r.sfix(t[1]);if(!(n>=1&&n<=sk.length+lk.length&&a>=0&&a<=7))return Ee;var i=1==(1&a),o=2==(2&a),u=!(4==(4&a));function c(t){var r=u?e.dereferenceAllOpersAndFormulae(t,i).map(uk):e.dereferenceAllOpers(t,i);return o&&(r=r.map((function(e){if("object"!=typeof e)return e;if(e.kind===dh.RangeValues)return yh(e.arrays.map((function(e){return e.map((function(e){return void 0===e||Cf(e)?void 0:e}))})));if(e.kind===x.Array){var t=e.opers.map((function(e){return e.map((function(e){return void 0===e||Cf(e)?void 0:e}))}));return function(e,t,r){return R("calc.runtime.coercedArrayOper",e),R("calc.runtime.coercedArrayOper",t),r.length!==e?A("calc.runtime.coercedArrayOper: Inconsistent row number"):{kind:x.Array,rows:e,cols:t,opers:r}}(e.rows,e.cols,t)}return e}))),r}if(n>sk.length){if(4!==t.length)return Ee;var s=x.Number,l=e.coerceOper(e.dereferenceOper(t[3],s),s);if(Cf(l))return Ee;var f=t[2];if(f.kind===x.Range&&!ct(f.sheets))return Ee;var d=c([f])[0],h=sk.length;return(0,lk[n-h-1])(e,d,l)}for(var v=2;v<t.length;v+=1){var p=t[v];if(!Of(p)||!ct(p.sheets))return Ee}var m=c(t.slice(2));return b("calc.funcs.aggregate: requested non-array function with unexpected number",n>=1&&n<=sk.length),(0,sk[n-1])(e,m)}function dk(e,t){return vk(e,t,!1)}function hk(e,t){return vk(e,t,!0)}function vk(e,t,r){var n=t[0],a=!0===t[2]?1:-1,i=0,o=0,u=e.mathpack,c=sE(e,(function(e,t,r){if(void 0!==e)return e;if(Cf(t))return t;var c=u.cond2(n,dE(t));0===c?i+=r:c===a&&(o+=r)}),CE,e.dereferenceAllOpers([t[1]]));if(void 0!==c)return c;if(0===i)return be;var s=u.fromNumber(o+1);if(r){var l=u.div(u.fromNumber(i-1),u.fromNumber(2));return u.add(s,dE(l))}return s}function pk(e){return function(t,r){var n=e(t,r);return"number"==typeof n?t.mathpack.abs(n):n}}function mk(e,t,r){var n=DE(CE,void 0,!0,Ae,t,r);if(!Array.isArray(n))return n;var a=n[0],i=n[1],o=sE(t,yE(t.mathpack.add),e(function(e,t){return function(r,n){var a=e(r,n);return"number"==typeof a?r.mathpack.sub(a,t):a}}(CE,a)),r);return b("calc.funcs.sumDevAndCount",void 0!==o),Cf(o)?o:[dE(o),i]}function gk(e,t){var r=e.dereferenceAllOpers(t),n=mk(pk,e,r);if(!Array.isArray(n))return n;var a=n[0],i=n[1];return e.mathpack.div(a,e.mathpack.fromNumber(i))}function Ck(e,t){var r=e.dereferenceAllOpers(t),n=mk(DO,e,r);return Array.isArray(n)?n[0]:n}var Sk=ui.numErrorOper;var yk=lE((function(e){return e.mathpack.sqrt})),Ek=lE((function(e){return e.mathpack.exp})),Ok=fE((function(e){return e.mathpack.power})),kk=lE((function(e){return e.mathpack.ln})),Ak=lE((function(e){return e.mathpack.log}));var bk=lE((function(e){return e.mathpack.sin})),Rk=lE((function(e){return e.mathpack.cos})),Ik=lE((function(e){return e.mathpack.tan})),Tk=lE((function(e){return e.mathpack.asin})),Nk=lE((function(e){return e.mathpack.acos})),Fk=lE((function(e){return e.mathpack.atan})),_k=fE((function(e){return e.mathpack.atan2}));function Mk(e,t){var r=t[0],n=e.mathpack;return n.cond2(n.abs(r),n.fromNumber(1e15))<0&&(r=n.viewRound(r)),n.floor(r)}var Dk=fE((function(e){return e.mathpack.round}));function wk(e,t){var r=t,n=r[0],a=r[1],i=e.mathpack;return i.roundDown(n,null!=a?a:i.zero)}var Lk=fE((function(e){return e.mathpack.roundUp})),Uk=fE((function(e){return e.mathpack.roundDown}));function xk(e,t){var r=vE(e,t[0]);if(Cf(r))return r;var n=vE(e,t[1]);if(Cf(n))return n;var a=e.mathpack;if(0===a.cond(n))return a.zero;if(0!==a.cond(r)&&a.cond(r)<0!=a.cond(n)<0)return Sk;var i=a.div(r,n);if(Cf(i))return Sk;var o=a.floor(i),u=dE(a.sub(i,o)),c=a.fromNumber(.5-5e-15);if(a.cond2(u,c)<0)return a.mul(o,n);var s=a.add(o,a.one);return Cf(s)?s:a.mul(s,n)}function Pk(e,t,r){var n=e.cond(t),a=e.cond(r);if(n>0&&a<0)return Sk;if(0===n||0===a)return e.zero;var i=e.div(t,r);return Cf(i)?i:e.mul(e.ceil(e.viewRound(i)),r)}function Gk(e,t,r){var n=e.cond(t),a=e.cond(r);if(n>0&&a<0)return Sk;if(0===n&&0===a)return t;var i=e.div(t,r);return Cf(i)?i:e.mul(e.floor(e.viewRound(i)),r)}function Vk(e,t){return Pk(e.mathpack,t[0],t[1])}function Bk(e,t){var r=t,n=r[0],a=r[1],i=r[2],o=e.mathpack,u=void 0===a||Ef(a)?o.one:o.abs(a),c=void 0===i||Ef(i)?o.zero:i;return 0!==o.cond(c)&&o.cond(n)<0&&(u=o.neg(u)),0===o.cond(u)?o.zero:Pk(o,n,u)}function Wk(e,t){var r=t,n=r[0],a=r[1],i=e.mathpack,o=void 0===a||Ef(a)?i.one:i.abs(a);return 0===i.cond(o)?i.zero:Pk(i,n,o)}function jk(e,t){var r=t,n=r[0],a=r[1],i=r[2],o=e.mathpack,u=void 0===a||Ef(a)?o.one:o.abs(a),c=void 0===i||Ef(i)?o.zero:i;return 0!==o.cond(c)&&o.cond(n)<0&&(u=o.neg(u)),0===o.cond(u)?o.zero:Gk(o,n,u)}function Hk(e,t){var r=t,n=r[0],a=r[1],i=e.mathpack,o=void 0===a||Ef(a)?i.one:i.abs(a);return 0===i.cond(o)?i.zero:Gk(i,n,o)}function Kk(e,t,r){var n=r[0],a=t.mathpack;if(a.cond(n)>=0){var i=a.ceil(n);return 0===a.cond2(dE(gE(a,i,a.fromNumber(2))),a.one)===e?a.add(i,a.one):i}var o=a.floor(n);return 0===a.cond2(dE(gE(a,o,a.fromNumber(2))),a.one)===e?a.sub(o,a.one):o}var qk=Kk.bind(void 0,!0),Yk=Kk.bind(void 0,!1),Jk=lE((function(e){return e.mathpack.abs}));function Qk(e,t){var r=vE(e,t[0]);if(Cf(r))return r;var n=vE(e,t[1]);if(Cf(n))return n;var a=e.mathpack;if(0===a.cond(n))return ye;var i=a.div(r,n);return Cf(i)?Sk:a.cond(i)>0?a.floor(i):a.ceil(i)}function Xk(e,t){var r=vE(e,t[0]);if(Cf(r))return r;var n=e.mathpack,a=n.floor(r);if(n.cond2(a,n.fromNumber(-1))<0||n.cond2(a,n.fromNumber(300))>0)return Sk;for(var i=n.one,o=n.toNumber(a);o>1;o-=2){if(Cf(i))return i;i=n.mul(n.fromNumber(o),i)}return i}function zk(e,t){var r=vE(e,t[0]);if(Cf(r))return r;var n=e.mathpack;if(n.cond(r)<0)return Sk;var a=n.mul(n.pi,r);return Cf(a)?a:n.sqrt(a)}function Zk(e,t,r){var n=t.config.datepack.fromNum(t.config,t.mathpack.toNumber(r[0]),ca.RoundSec);return!1===n?Ae:t.mathpack.fromNumber(e(n))}var $k=Zk.bind(void 0,(function(e){return e.yr})),eA=Zk.bind(void 0,(function(e){return e.mon})),tA=Zk.bind(void 0,(function(e){return e.dom})),rA=Zk.bind(void 0,(function(e){return e.hour})),nA=Zk.bind(void 0,(function(e){return e.min})),aA=Zk.bind(void 0,(function(e){return e.sec}));function iA(e,t,r){void 0===r&&(r=!1);var n=t,a=n[0],i=n[1],o=e.config.datepack.fromNum(Object(j.a)(Object(j.a)({},e.config),{date1904:e.config.date1904&&!r}),e.mathpack.toNumber(a),ca.RoundSec);if(!1===o)return Ae;var u,c=e.mathpack;switch(void 0!==i?c.sfix(i):1){case 1:case 17:u=o.wdy;break;case 2:case 11:u=1===o.wdy?7:o.wdy-1;break;case 3:u=1===o.wdy?6:o.wdy-2;break;case 12:u=(o.wdy+4)%7+1;break;case 13:u=(o.wdy+3)%7+1;break;case 14:u=(o.wdy+2)%7+1;break;case 15:u=(o.wdy+1)%7+1;break;case 16:u=o.wdy%7+1;break;default:return Ae}return c.fromNumber(u)}function oA(e,t){return iA(e,t)}function uA(e,t,r){if(!t){var n=e.lfix(r);if(0===n||1===n)return e.fromNumber(52)}return Ae}function cA(e,t,r){var n=r,a=n[0],i=n[1],o=pE(t,a);if(Cf(o))return o;var u=function(e,t,r){if(void 0===t||Ef(t))return[r?2:1,r];var n=vE(e,t);if(!Cf(n)){var a=e.mathpack.sfix(n);if(r){if(1===a||2===a)return[a,r]}else{if(1===a||2===a)return[a,r];if(a>=11&&a<=16)return[a-9,r];if(17===a)return[1,r];if(21===a)return[2,!0]}}return[void 0,r]}(t,i,e),c=u[0],s=u[1];if(void 0===c)return Ae;var l=t.mathpack,f={dateCompatibility:t.config.dateCompatibility,date1904:!1},d=t.config.datepack.fromNum(f,t.mathpack.toNumber(o),ca.RoundSec);if(!1===d)return uA(l,f.dateCompatibility,o);var h=sa(d.yr,1,1,0,0,0,0,0,ca.RoundSec),v=t.config.datepack.toNum(f,h);if(Cf(v))return uA(l,f.dateCompatibility,o);var p=iA(t,[l.fromNumber(v)],!0);if(Cf(p))return p;var m=dE(l.add(dE(l.sub(p,l.fromNumber(c))),l.fromNumber(7))),g=dE(gE(l,m,l.fromNumber(7))),C=dE(l.add(l.floor(dE(l.div(dE(l.add(dE(l.sub(o,l.fromNumber(v))),g)),l.fromNumber(7)))),l.one));return s?function(e,t,r,n){var a=e.config.mathpack,i=Object(j.a)({},n),o=(t+6-i.wdy)%7;if(12===i.mon&&i.dom+o>=35)return a.one;i.dom=4,i.mon=1;var u=dE(e.config.datepack.toDays(e.config,i));if(((u=(u-1)%7+1)-t+7)%7<3){var c=dE(a.sub(r,a.one));if(0===a.cond(c)){var s=i.yr-1;return t===u||s%4==0&&(s%100!=0||s%400==0)&&(t-u+7)%7==6?a.fromNumber(53):a.fromNumber(52)}return c}return r}(t,c,C,d):C}var sA=cA.bind(void 0,!0),lA=cA.bind(void 0,!1);function fA(e,t){var r=t,n=r[0],a=r[1],i=r[2],o=e.mathpack,u=o.sfix(n);if(u>9999)return Ae;var c=o.sfix(a);if(c>32767||c<-32768)return Ae;var s=o.sfix(i);(s>32767||s<-32768)&&(s=32767),e.config.dateCompatibility?u<1900&&(u+=1900):u<1900&&!(1899===u&&12===c&&s>=30)&&(u+=1900);var l=sa(u,c,s,0,0,0,0,0,ca.RoundSec);return e.config.datepack.toNum(e.config,l)}var dA;function hA(e,t){var r=t,n=r[0],a=r[1],i=r[2],o=e.mathpack,u=o.sfix(n);if(u>32767)return Ae;var c=o.sfix(a);if(c>32767)return Ae;var s,l,f,d=o.sfix(i);if(d>32767)return Ae;e.config.dateCompatibility?(s=e.config.date1904?1904:1900,l=1,f=e.config.date1904?1:0):(s=1899,l=12,f=30);var h=sa(s,l,f,u,c,d,0,0,ca.RoundSec),v=e.config.datepack.toNum(e.config,h);if(Cf(v))return v;if(v<0)return Ae;var p=o.fromNumber(v);return o.sub(p,o.trunc(p))}function vA(e,t){var r=e.mathpack,n=!0===t[2],a=e.config.datepack.fromNum(e.config,r.toNumber(t[0]),ca.RoundSec);if(!1===a)return be;var i=31===a.dom||!n&&2===a.mon&&a.dom===e.config.datepack.daysPerMonth(2,a.yr,e.config.dateCompatibility)?30:a.dom,o=r.fromNumber(360*(a.yr-1900)+30*a.mon+i),u=e.config.datepack.fromNum(e.config,r.toNumber(t[1]),ca.RoundSec);if(!1===u)return be;var c=31!==u.dom||!n&&30!==a.dom?u.dom:30,s=r.fromNumber(360*(u.yr-1900)+30*u.mon+c);return r.sub(s,o)}function pA(e,t){var r=t,n=r[0],a=r[1],i=r[2];if(i.length>2||0===i.length)return Ae;var o=e.mathpack.lfix(n),u=e.config.datepack.fromNum(e.config,e.mathpack.toNumber(n),ca.RoundSec);if(!1===u)return Ae;var c=e.mathpack.lfix(a),s=e.config.datepack.fromNum(e.config,e.mathpack.toNumber(a),ca.RoundSec);if(!1===s)return Ae;if(o>c)return Ae;var l=s.dom,f=s.mon,d=s.yr;u.dom>l&&(0===(f-=1)&&(f=12,d-=1),l+=e.config.datepack.daysPerMonth(f,d,e.config.dateCompatibility)),u.mon>f&&(f+=12,d-=1);var h=function(t,r){return 0===e.config.localeInfo.stringCompareCI(t,r)},v=e.mathpack;if(h(i,"Y"))return v.fromNumber(d-u.yr);if(h(i,"M"))return v.fromNumber(12*(d-u.yr)+(f-u.mon));if(h(i,"D"))return v.fromNumber(c-o);if(h(i,"MD"))return v.fromNumber(l-u.dom);if(h(i,"YM"))return v.fromNumber(f-u.mon);if(h(i,"YD")){for(var p=0,m=u.mon;m<f;m+=1)p+=e.config.datepack.daysPerMonth(m,u.yr,e.config.dateCompatibility);return v.fromNumber(p+(l-u.dom))}return Ae}function mA(e,t){var r;if("string"==typeof t){var n=t.replace(/^\s+/,"");if(Cf(r=e.coerceOper(n,x.Number)))return r}else r=t;return pE(e,r)}function gA(e,t){var r=t,n=r[0],a=r[1];if("string"==typeof n&&n.length>255||"string"==typeof a&&a.length>255)return Ee;var i=mA(e,n);if(Cf(i))return i;var o=mA(e,a);return Cf(o)?o:e.mathpack.sub(i,o)}function CA(e,t,r){return r?dE(e.sub(t,e.fromNumber(1462))):t}function SA(e,t){return 0!=(e>>t%7&1)}function yA(e){switch(e){case 1:return dA.Saturday|dA.Sunday;case 2:return dA.Sunday|dA.Monday;case 3:return dA.Monday|dA.Tuesday;case 4:return dA.Tuesday|dA.Wednesday;case 5:return dA.Wednesday|dA.Thursday;case 6:return dA.Thursday|dA.Friday;case 7:return dA.Friday|dA.Saturday;case 11:return dA.Sunday;case 12:return dA.Monday;case 13:return dA.Tuesday;case 14:return dA.Wednesday;case 15:return dA.Thursday;case 16:return dA.Friday;case 17:return dA.Saturday;default:return!1}}function EA(e){if(7!==e.length)return!1;for(var t=dA.None,r=0;r<e.length;r+=1)if("1"===e[r])t|=1<<(r+2)%7;else if("0"!==e[r])return!1;return t}function OA(e,t){var r=dA.Saturday|dA.Sunday,n=t[0],a=t[1],i=pE(e,n);if(Cf(i))return i;var o=vE(e,a);if(Cf(o))return o;var u=e.mathpack;o=u.floor(o);var c=u.cond(o)>0?u.one:u.fromNumber(-1),s=u.abs(o);if(!mE(e,dE(u.add(i,o))))return Ae;if(0===u.cond(s))return CA(u,i,e.config.date1904);var l=null,f=[];if(2!==t.length){var d=t[2];if(!Ef(d)){if("number"==typeof d){var h=yA(u.lfix(d));if(!1===h)return Ae;r=h}else{if("string"!=typeof d)return Ae;var v=EA(d);if(!1===v)return Ee;r=v}if(127===r)return Ee}if(4===t.length){var p=t[3];if(!Ef(p)){var m=function e(t,r){switch(typeof r){case"number":return at(new Cl(1,1,1,1,[[r]],Le));case"string":var n=t.coerceOper(r,x.Number);return Cf(n)?it(Ee):at(new Cl(1,1,1,1,[[n]],Le));case"object":break;default:return it(Ee)}switch(r.kind){case x.Blank:return at(new Cl(1,1,1,1,[[t.mathpack.zero]],Le));case x.Missing:return it(be);case x.Error:return it(r);case x.Range:return e(t,_f(t,r,!1));case x.Array:return at(new Cl(r.rows,r.cols,r.rows,r.cols,r.opers,Le))}return it(Ee)}(e,p);if(!ot(m))return m.reason;l=m.value}}}for(var g=null==l?[]:function(e){for(var t=[],r=e.getSparse(),n=e.cols-e.denseCols,a=0;a<e.denseRows;a+=1){for(var i=0;i<e.denseCols;i+=1){var o=e.get(a,i);void 0!==o&&t.push(o)}if(n>0&&void 0!==r)for(var u=0;u<n;u+=1)t.push(r)}var c=(e.rows-e.denseRows)*e.cols;if(c>0&&void 0!==r)for(a=0;a<c;a+=1)t.push(r);return t}(l),C=g.length-1;C>=0;C-=1){var S=g[C];switch(typeof S){case"number":case"string":var y=pE(e,S);if(Cf(y))return y;f[C]=y;break;case"object":switch(S.kind){case x.Blank:var E=pE(e,S);if(Cf(E))return E;f[C]=E;break;case x.Error:return S;default:return Ee}break;default:return Ee}}for(;u.cond(s)>0;){if(i=dE(u.add(i,c)),!SA(r,u.lfix(i))){var O=!0;for(C=0;C<g.length;C+=1)if(0===u.cond2(f[C],i)){O=!1;break}O&&(s=dE(u.sub(s,u.one)))}}return mE(e,i=CA(u,i,e.config.date1904))?i:Ae}function kA(e,t){return 2===t.length?OA(e,t):OA(e,[t[0],t[1],we,t[2]])}!function(e){e[e.None=0]="None",e[e.Saturday=1]="Saturday",e[e.Sunday=2]="Sunday",e[e.Monday=4]="Monday",e[e.Tuesday=8]="Tuesday",e[e.Wednesday=16]="Wednesday",e[e.Thursday=32]="Thursday",e[e.Friday=64]="Friday"}(dA||(dA={}));function AA(e,t,r,n){var a={dateCompatibility:e.config.dateCompatibility,date1904:!1},i=e.mathpack,o=e.config.datepack.fromNum(a,i.toNumber(t),ca.RoundSec);if(!1===o)return o;var u=i.fromNumber(o.dom),c=i.fromNumber(o.mon),s=i.fromNumber(12),l=i.fromNumber(o.yr);if(i.cond(r)>=0){l=dE(i.add(i.floor(dE(i.div(r,s))),l));var f=dE(gE(i,r,s)),d=dE(i.add(f,c));1===i.cond2(d,s)&&(l=dE(i.add(l,i.one))),c=dE(gE(i,d,s))}else{var h=i.neg(r),v=i.floor(dE(i.div(h,s)));l=dE(i.sub(l,v));f=dE(gE(i,h,s));if(i.cond2(f,c)>=0)l=dE(i.sub(l,i.one)),c=dE(i.add(dE(i.sub(c,f)),s));else{var p=dE(i.sub(c,f));c=dE(gE(i,p,s))}}0===i.cond(c)&&(c=s);var m=i.lfix(c);switch(m){case 4:case 6:case 9:case 11:var g=i.fromNumber(30);i.cond2(u,g)>0&&(u=g);break;case 2:i.cond2(u,i.fromNumber(28))>0&&(u=i.fromNumber(e.config.datepack.daysPerMonth(2,i.toNumber(l),!1)))}if(n&&(u=e.config.datepack.daysPerMonth(m,i.toNumber(l),!1)),i.lfix(l)<(a.dateCompatibility?1900:-9999))return!1;var C=function(e,t,r,n,a,i){var o=e.lfix(n),u=e.lfix(a),c=e.lfix(i);return t.toNum(r,sa(c,u,o,0,0,0,0,0,ca.RoundSec))}(i,e.config.datepack,a,u,c,l);return!Cf(C)&&C}function bA(e,t,r){var n=r,a=n[0],i=n[1],o=pE(t,a);if(Cf(o))return o;var u=vE(t,i);if(Cf(u))return u;var c=t.mathpack,s=AA(t,o,u=c.cond(u)>0?c.floor(u):c.ceil(u),!e);return!1===s?Ae:CA(c,s,t.config.date1904)}var RA,IA=bA.bind(void 0,!0),TA=bA.bind(void 0,!1);function NA(e,t){var r,n=e.mathpack,a=dA.Saturday|dA.Sunday,i=5,o=t[0],u=t[1],c=t[2];function s(e){i=7;for(var t=a=e;0!==t;)1==(1&t)&&(i-=1),t>>=1}if(void 0!==c&&!Ef(c))if("string"==typeof c){var l=EA(c);if(!1===l)return Ee;s(l)}else{var f=vE(e,c);if(Cf(f))return Ee;var d=yA(n.lfix(f));if(!1===d)return Ae;s(d)}var h=4===t.length?t[3]:we,v=pE(e,o);if(Cf(v))return v;var p=pE(e,u);if(Cf(p))return p;var m,g=n.lfix(v),C=n.lfix(p);g>C?(m=g,g=C,C=m,r=-1):r=1,m=g%7,m=C%7;for(var S=0,y=g<C?g:C,E=g<C?C:g;y%7!=0&&y!==E;)SA(a,y)||(S+=1),y+=1;for(;E%7!=6&&y!==E;)SA(a,E)||(S+=1),E-=1;if(E===y&&1!=(a>>y%7&1)&&(S+=1),g>C){var O=y;y=E,E=O}var k=n.fromNumber(i*Math.floor((E+1-y)/7)+S);switch(typeof h){case"number":case"string":var A=pE(e,h);if(Cf(A))return A;(m=n.lfix(A))>=g&&m<=C&&m%7>=2&&(k=dE(n.sub(k,n.one)));break;case"object":switch(h.kind){case x.Range:case x.Array:var b=function(e,t,r,n,a,i){var o,u=e.mathpack;if(void 0===i||Ef(i))o=dA.Saturday|dA.Sunday;else if("string"==typeof i){var c=EA(i);if(!1===c)return Ee;o=c}else{var s=vE(e,i);if(Cf(s))return Ee;var l=yA(u.lfix(s));if(!1===l)return Ae;o=l}var f=u.fromNumber(r),d=u.fromNumber(n),h=e.dereferenceOper(a,x.Array);if(!yf(h))return Ee;var v=[];function p(e){if(u.cond2(e,f)>=0&&u.cond2(e,d)<=0){var t=u.lfix(e);SA(o,t)||v.push(e)}}for(var m=0;m<h.rows;m+=1)for(var g=0;g<h.cols;g+=1){var C=h.opers[m][g];switch(typeof C){case"number":case"string":var S=pE(e,C);if(Cf(S))return S;p(S);break;case"object":switch(C.kind){case x.Blank:break;case x.Error:return C;default:return Ee}break;default:return Ee}}var y=t;if(0!==v.length){var E=v.sort((function(e,t){return u.cond2(e,t)})),O=E[0];y=dE(u.sub(y,u.one));for(m=0;m<E.length;m+=1){var k=E[m];0!==u.cond2(k,O)&&(O=k,y=dE(u.sub(y,u.one)))}}return y}(e,k,g,C,h,c);if(Cf(b))return b;k=b;break;case x.Error:return h;case x.Missing:}break;default:return Ee}return n.mul(n.fromNumber(r),k)}function FA(e,t){return 2===t.length?NA(e,t):NA(e,[t[0],t[1],we,t[2]])}function _A(e,t,r,n,a,i){return i-a+30*(n-r)+360*(t-e)}function MA(e,t,r,n){return t===e.config.datepack.daysPerMonth(r,n,e.config.dateCompatibility)}function DA(e,t,r,n,a){var i=e.mathpack;switch(i.cond2(t,r)){case 1:break;case 0:return i.zero;case-1:switch(n){case RA.Basis30360:return function(e,t,r,n,a){var i=e.mathpack,o=e.config.datepack.fromNum(e.config,i.toNumber(t),ca.RoundSec);if(!1===o)return!1;var u=o.dom,c=o.mon,s=o.yr,l=e.config.datepack.fromNum(e.config,i.toNumber(r),ca.RoundSec);if(!1===l)return!1;var f=l.dom,d=l.mon,h=l.yr;return 2===f&&MA(e,f,d,h)&&(2===u&&MA(e,u,c,s)||3===n)&&(f=30),31===f&&(u>=30||3===n)&&(f=30),31===u&&(u=30),a&&2===c&&MA(e,u,c,s)&&(u=30),_A(s,h,c,d,u,f)}(e,t,r,a,!0);case RA.BasisActual360:case RA.BasisActual365:case RA.BasisActual:return dE(i.sub(r,t));case RA.BasisE30360:return function(e,t,r){var n=e.mathpack,a=e.config.datepack.fromNum(e.config,n.toNumber(t),ca.RoundSec);if(!1===a)return!1;var i=a.dom,o=a.mon,u=a.yr,c=e.config.datepack.fromNum(e.config,n.toNumber(r),ca.RoundSec);if(!1===c)return!1;var s=c.dom,l=c.mon;return 31===i&&(i=30),31===s&&(s=30),_A(u,c.yr,o,l,i,s)}(e,t,r)}}return!1}function wA(e,t){var r=t,n=r[0],a=r[1],i=r[2],o=RA.DefaultBasis;if(void 0!==i){var u=function(e,t){var r=RA.DefaultBasis;if(void 0===t||Ef(t))return r;var n=vE(e,t);if(Cf(n))return n;var a=e.mathpack;switch(r=a.lfix(a.floor(n))){case RA.Basis30360:case RA.BasisActual:case RA.BasisActual360:case RA.BasisActual365:case RA.BasisE30360:return r;default:return Ae}}(e,i);if(Cf(u))return u;o=u}var c=pE(e,n);if(Cf(c))return c;var s=pE(e,a);if(Cf(s))return s;var l=e.mathpack;if(l.cond2(c,s)>0){var f=c;c=s,s=f}var d=DA(e,c,s,o,0);if(!1===d)return Ae;var h=function(e,t,r,n){var a=e.mathpack,i=a.fromNumber(360),o=a.fromNumber(365),u=a.fromNumber(366);switch(t){case RA.BasisActual:var c=e.config.datepack.fromNum(e.config,a.toNumber(r),ca.RoundSec);if(!1===c)return!1;var s=c.dom,l=c.mon,f=c.yr,d=e.config.datepack.fromNum(e.config,a.toNumber(n),ca.RoundSec);if(!1===d)return!1;var h,v=d.dom,p=d.mon,m=d.yr,g=dE(a.sub(m,a.one));if(0===a.cond2(f,m))return 29===e.config.datepack.daysPerMonth(2,f,e.config.dateCompatibility)?u:o;if(0===a.cond2(g,f)&&(a.cond2(l,p)>0||0===a.cond2(l,p)&&a.cond2(s,v)>=0))return 29===e.config.datepack.daysPerMonth(2,f,e.config.dateCompatibility)?!Cf(h=e.config.datepack.toNum(e.config,sa(f,2,29,0,0,0,0,0,ca.RoundSec)))&&(a.cond2(h,r)>=0?u:o):29===e.config.datepack.daysPerMonth(2,m,e.config.dateCompatibility)?!Cf(h=e.config.datepack.toNum(e.config,sa(f,2,29,0,0,0,0,0,ca.RoundSec)))&&(a.cond2(h,n)<=0?u:o):o;for(var C=a.lfix(f),S=a.lfix(m),y=a.zero,E=C;E<=S;E+=1)y=29===e.config.datepack.daysPerMonth(2,E,e.config.dateCompatibility)?dE(a.add(y,u)):dE(a.add(y,o));var O=dE(a.add(dE(a.sub(m,f)),a.one));return dE(a.div(y,O));case RA.Basis30360:case RA.BasisActual360:case RA.BasisE30360:return i;case RA.BasisActual365:return o;default:return i}}(e,o,c,s);return!1===h?Ae:l.div(d,h)}function LA(e,t){return _f(e,t[0],!0)instanceof Op}function UA(e,t){var r=vE(e,t[0]);if(Cf(r))return r;var n=e.mathpack,a=dE(n.add(n.abs(r),n.fromNumber(1.0000000000000003e-10))),i=dE(n.div(n.floor(a),n.fromNumber(2)));return 0===n.cond2(i,n.floor(i))}function xA(e,t,r){var n=t[0];if(!ct(n.sheets))return Ee;var a=n.ranges[0];if(e.calcingArray||!lt(a)){var i=n.sheets;return Fe(a.rows,a.cols,El(a.rows,a.cols,(function(t,n){var o=rr(i,Zt(a.row+t,a.col+n));return r(e.getCellFormula(o),o)})))}var o=St(tr(n.sheets,a));return r(e.getCellFormula(o),o)}function PA(e,t){return xA(e,t,(function(e){return void 0!==e}))}function GA(e,t){return xA(e,t,(function(t,r){if(void 0===t)return be;var n=e.formatFormula(t,r.range);return t.source.kind===Vt.Cell?n:"{"+n+"}"}))}!function(e){e[e.DefaultBasis=0]="DefaultBasis",e[e.Basis30360=0]="Basis30360",e[e.BasisActual=1]="BasisActual",e[e.BasisActual360=2]="BasisActual360",e[e.BasisActual365=3]="BasisActual365",e[e.BasisE30360=4]="BasisE30360"}(RA||(RA={}));function VA(e){return 55296==(64512&e)}function BA(e){return 56320==(64512&e)}function WA(e){return 55296==(63488&e)}function jA(e,t){if(VA(e)&&BA(t))return 65536+((1023&e)<<10|1023&t)}function HA(e,t,r){for(var n=t,a=0;a<r;a+=1){if(n>=e.length)return;VA(e.charCodeAt(n))&&n+1<e.length&&BA(e.charCodeAt(n+1))?n+=2:n+=1}return n}function KA(e,t,r){for(var n=0,a=t;a<r;n+=1){VA(e.charCodeAt(a))&&a+1<r&&BA(e.charCodeAt(a+1))?a+=2:a+=1}return n}var qA=ui.valueErrorOper;function YA(e,t){return void 0===t?1:e.cond(t)<0?qA:e.sfix(t)}function JA(e,t){var r=t;return r[0]===r[1]}function QA(e,t){var r=t[0],n=t[1],a=e.mathpack,i=a.fix(n);return a.cond(n)<0||i>2147483647?qA:""===r?"":i*r.length>32767?qA:r.repeat(i)}function XA(e,t){for(var r=t[0],n="",a=0;a<r.length;){for(;a<r.length&&32===r.charCodeAt(a);)a+=1;for(var i=a;a<r.length;){var o=32===r.charCodeAt(a);if(a+=1,o)break}n+=r.substring(i,a)}return n.length>0&&32===n.charCodeAt(n.length-1)&&(n=n.substring(0,n.length-1)),n}function zA(e,t){for(var r=t[0],n="",a=0;a<r.length;a+=1){var i=r.charCodeAt(a);(i>=256||(127&i)>=32)&&(n+=r.charAt(a))}return n}function ZA(e,t){var r=e.mathpack.sfix(t[0]);return r<1||r>255?qA:String.fromCharCode(r)}function $A(e,t){var r=t[0],n=e.mathpack,a=n.lfix(n.trunc(r));if(n.cond2(r,n.one)<0||a>=1114112)return qA;return a<=65535&&WA(a)||a>=64976&&a<=65007||(65535&a)>=65534?be:function(e){if(e<=65535)return String.fromCharCode(e);var t=e-65536;return String.fromCharCode(t>>10|55296,1023&t|56320)}(a)}function eb(e,t){var r=t[0];if(0===r.length)return qA;var n=r.charCodeAt(0);return n>255?cv(Il(["CODE for codepoints > 255"])):e.mathpack.fromNumber(n)}function tb(e,t){var r=t[0];if(0===r.length)return qA;var n=r.charCodeAt(0),a=e.mathpack;if(!WA(n))return a.fromNumber(n);if(1===r.length)return qA;var i=jA(n,r.charCodeAt(1));return void 0===i?qA:a.fromNumber(i)}function rb(e){return e>=65&&e<=90||e>=97&&e<=122}function nb(e,t,r){return""===e?e:function(e){for(var t=0;t<e.length;t+=1)if(e.charCodeAt(t)>=128)return!1;return!0}(e)?r():cv(Il([t+" for non-ASCII input"]))}function ab(e,t){var r=t[0];return nb(r,"LOWER",r.toLowerCase.bind(r))}function ib(e,t){var r=t[0];return nb(r,"UPPER",r.toUpperCase.bind(r))}function ob(e,t){var r=t[0];return nb(r,"PROPER",(function(){for(var e=r.toLowerCase(),t="",n=0;;){for(var a=n;n<e.length&&!rb(e.charCodeAt(n));)n+=1;if(t+=e.substring(a,n),n===e.length)break;var i=n;for(t+=e.charAt(n).toUpperCase(),n+=1;n<e.length&&rb(e.charCodeAt(n));)n+=1;t+=e.substring(i+1,n)}return t}))}function ub(e,t){var r,n=t,a=n[0],i=n[1],o=n[2],u=void 0!==o?e.mathpack.sfix(o)-1:0;if(u<0||u>=2147483647)return qA;var c=null!=(r=HA(i,0,u))?r:i.length,s=i.indexOf(a,c);return s>=0?e.mathpack.fromNumber(KA(i,0,s)+1):qA}function cb(e,t){var r,n,a=t,i=a[0],o=a[1],u=a[2],c=a[3],s=e.mathpack.sfix(o)-1;if(s<0||s>=32767)return qA;var l=e.mathpack.sfix(u);if(l<0||l>32767)return qA;var f=null!=(r=HA(i,0,s))?r:i.length,d=null!=(n=HA(i,f,l))?n:i.length,h=i.slice(0,f),v=i.slice(d);return h.length+c.length+v.length>32767?qA:h+c+v}function sb(e,t){var r,n=t,a=n[0],i=n[1],o=n[2],u=void 0!==o?e.mathpack.sfix(o)-1:0;if(u<0||u>=2147483647)return qA;for(var c=null!=(r=HA(i,0,u))?r:i.length,s=new nE(e.config.localeInfo,a,!0);c<i.length;c+=1)if(s.test(i.slice(c)))return e.mathpack.fromNumber(KA(i,0,c)+1);return qA}function lb(e,t){var r=t,n=r[0],a=r[1],i=r[2],o=r[3],u=1/0;if(void 0!==o){var c=e.coerceOper(o,x.Number);if(Cf(c))return c;if((u=e.mathpack.sfix(c))<1||u>2147483646)return qA}var s=a.length;if(s>0){for(var l="",f=0,d=0;u>=0&&-1!==(d=n.indexOf(a,d));)if((u-=1)===1/0||0===u){var h=n.slice(f,d);if(l.length+h.length+i.length>32767)return qA;l+=h,l+=i,f=d+=s}else d+=1;var v=n.slice(f);return l.length+v.length>32767?qA:l+=v}return n}function fb(e,t){var r=t[0],n=t[1];if(kf(r)){var a=r.getField(n);if(void 0!==a)return a}return Ie}function db(e,t){for(var r=t[0],n=e.config.localeInfo,a=ml.create(n.stringCompareCI),i=1;i<t.length;i+=2){var o=t[i],u=t[i+1];a=a.setValue(o,u)}return new Ep(a,r)}function hb(e,t){var r=t[0];return ct(r.sheets)?e.mathpack.fromNumber(r.ranges.length):Ee}function vb(e,t){var r=t[0],n=e.mathpack;return yf(r)?n.fromNumber(r.rows):ct(r.sheets)?r.ranges.length>1?Oe:n.fromNumber(r.ranges[0].rows):Ee}function pb(e,t){var r=t[0],n=e.mathpack;return yf(r)?n.fromNumber(r.cols):ct(r.sheets)?r.ranges.length>1?Oe:n.fromNumber(r.ranges[0].cols):Ee}function mb(e,t){if(0===t.length)return[e.reflectionGridCell,!e.calcingArray];var r=t[0];if(!ct(r.sheets))return Ee;if(r.ranges.length>1)return Oe;var n=r.ranges[0];return[n,lt(n)]}function gb(e,t){var r=mb(e,t);if(!Array.isArray(r))return r;var n=r[0],a=r[1],i=e.mathpack;return a?i.fromNumber(n.row+1):Fe(n.rows,1,El(n.rows,1,(function(e){return i.fromNumber(n.row+e+1)})))}function Cb(e,t){var r=mb(e,t);if(!Array.isArray(r))return r;var n=r[0],a=r[1],i=e.mathpack;return a?i.fromNumber(n.col+1):Fe(1,n.cols,El(1,n.cols,(function(e,t){return i.fromNumber(n.col+t+1)})))}function Sb(e,t){var r=e.mathpack;if(0===t.length)return r.fromNumber(e.getSheetRangeIndexes(Jt(e.reflectionSheet.document)).length);var n=t[0];return yf(n)?be:r.fromNumber(e.getSheetRangeIndexes(n.sheets).length)}function yb(e,t){var r=e.mathpack;if(0===t.length){var n=e.reflectionSheet;return void 0===n.index?be:r.fromNumber(e.getSheetRangePosition(n)+1)}var a=t[0];if("string"==typeof a){var i=e.getSheetIndex(e.reflectionSheet.document,a);return void 0===i?be:r.fromNumber(e.getSheetRangePosition(i)+1)}return a.kind===x.Range?r.fromNumber(e.getSheetRangePosition(a.sheets)+1):a.kind===x.Array?be:k("calc.funcs.sheet",a)}function Eb(e,t){var r=t,n=r[0],a=r[1],i=r[2],o=r[3],u=r[4];if(!ct(n.sheets))return Ee;if(1!==n.ranges.length)return Ee;var c=e.mathpack,s=n.ranges[0],l=s.row,f=s.col,d=s.rows,h=s.cols,v=l;"number"==typeof a&&(v+=c.lfix(a));var p=f;"number"==typeof i&&(p+=c.lfix(i));var m=v+d-1;if("number"==typeof o){if(0===(C=c.cond(o)))return Oe;m=v+c.lfix(o)-(C>0?1:-1)}var g=p+h-1;if("number"==typeof u){var C;if(0===(C=c.cond(u)))return Oe;g=p+c.lfix(u)-(C>0?1:-1)}var S=vr(v,m),y=vr(p,g),E=pr(v,m)-S+1,O=pr(p,g)-y+1;return S<0||y<0||S+E>1<<20||y+O>16384?Oe:_e(n.sheets,[zt(S,y,E,O)])}function Ob(e,t){var r=t[0];return yf(r)?Fe(r.cols,r.rows,El(r.cols,r.rows,(function(e,t){return r.opers[t][e]}))):r}function kb(e,t){var r=t,n=r[0],a=r[1],i=r[2],o=r[3],u=r[4],c=e.mathpack,s="number"!=typeof i?0:c.sfix(i)-1;if(s<0||s>3)return Ee;var l=0!=(1&s),f=0!=(2&s),d="boolean"!=typeof o||o?F.A1:F.R1C1,h=function(e,t,r){return d===F.R1C1&&e?-t<r&&r<t:1<=r&&r<=t},v=c.sfix(n);if(!h(f,1<<20,v))return Ee;if("number"!=typeof a)return Ee;var p=c.sfix(a);if(!h(l,16384,p))return Ee;var m=Zt(v<0?1048575:0,p<0?16383:0),g=X(f?D.Rel:D.Abs,d===F.R1C1&&f?v:v-1),C=X(l?D.Rel:D.Abs,d===F.R1C1&&l?p:p-1),S=an(e.config.localeInfo,d,m,g,C,!1);return b("calc.funcs.address: cell wrapped",void 0!==S),"string"==typeof u?""===u?"!"+S:u.length>255?Ee:fn(e.config.localeInfo,e.config.refStyle,u)+"!"+S:S}function Ab(e,t){var r=t,n=r[0],a=r[1],i="boolean"!=typeof a||a?F.A1:F.R1C1;if(n.length>255||n.length>0&&" "===n[0])return Ee;var o=nr(e.originSheet,e.originGridCell),u={lexicalKind:Vt.Indirect,originGridCell:at(o.range),originSheet:at(o.sheet),allowRelativeQualifier:!1,allowUnqualifiedCell:!0},c=e.parseFormula(i,o.range,u,"="+n);if(!ot(c))return Oe;for(var s=c.value.node,l=!1,f=!1;;){if(!l&&s.kind===L.App&&s.head.kind===L.Operator&&s.head.id===Ue.Pound&&1===s.args.length&&En(hn.CalcDynamicArrayOperators)&&(l=!0,s=s.args[0]),f||s.kind!==L.Name){if(s.kind===L.CellRef){var d=e.getCellRef(s.qualifier,s.ref,o,!0);return void 0===d?Oe:ct(d.sheets)?l?Hv(e,Ue.Pound,[d]):d:Oe}return Oe}var h=e.getNameFormula(s.qualifier,s.whole);if(void 0===h)return Oe;o=nr(o.sheet,Zt(0,0)),s=h[1],f=!0}}var bb=Mf(rt(De.IFS)),Rb=Mf(rt(De.SWITCH));function Ib(e,t){var r=t[0];b("calc.funcs.choose","number"==typeof r);var n=e.mathpack.fix(r);return n<1||n>t.length-1?Ee:t[n]}function Tb(e,t,r,n){var a=n.slice();return e.dereferenceOpers(a,t),wf(e,t,(function(n){for(var a=[],i=0;i<n.length;i+=1){var o=It(t,i,n.length);a[i]=e.coerceOper(n[i],o)}return r(e,a)}),a)}function Nb(e,t){for(var r=0;r<t.length;r+=2){var n=t[r];if(yf(n)){var a=t.slice(r);return Tb(e,bb,Nb,a)}if(Cf(n))return n;if(b("calc.funcs.ifs","boolean"==typeof n),n)return t[r+1]}return be}function Fb(e,t){var r=t[0];if(yf(r))return Tb(e,Rb,Fb,t);if(Cf(r))return r;for(var n=function(e,t){var r=e.mathpack,n=e.localeInfo;switch(typeof t){case"number":return function(e){return kf(e)?cv(Dt(["SWITCH with a rich value case"])):"number"==typeof e&&0===r.compare(t,e)};case"string":return function(e){return kf(e)?cv(Dt(["SWITCH with a rich value case"])):"string"==typeof e&&0===n.stringCompareCI(t,e)};case"boolean":return function(e){return kf(e)?cv(Dt(["SWITCH with a rich value case"])):t===e};default:return kf(t)?cv(Dt(["SWITCH with a rich value condition"])):k("calc.funcs.makeSwitchComparer",t)}}(e.config,r),a=1;a<t.length-1;a+=2){var i=x.Error|x.Rich|x.Number|x.Boolean|x.String|x.Array,o=e.coerceOper(e.dereferenceOper(t[a],i),i);if(yf(o))return Tb(e,Rb,Fb,t);if(Cf(o))return o;if(n(o))return t[a+1]}return t.length%2==0?t[t.length-1]:be}function _b(e,t){return!0}function Mb(e,t){return!1}function Db(e,t){return!t[0]}function wb(e,t){var r=t,n=r[0],a=r[1];return e.followHyperlinks?n:void 0!==a?a:n}function Lb(e,t){return be}function Ub(e,t){if(Of(t)){if(ct(t.sheets)){var r=_e(t.sheets,[Ct(t.ranges[0])]);return e.dereferenceOper(r,mf)}return Ee}return t}function xb(e,t){var r=Ub(e,t[0]);return"string"==typeof r||Cf(r)?r:""}function Pb(e,t){var r=Ub(e,t[0]);if("number"==typeof r||Cf(r))return r;var n=e.mathpack;return"boolean"==typeof r&&r?n.one:n.zero}function Gb(e,t){var r=t[0],n=e.mathpack;switch(typeof r){case"number":return n.fromNumber(1);case"string":return n.fromNumber(2);case"boolean":return n.fromNumber(4)}switch(r.kind){case x.Error:return n.fromNumber(16);case x.Array:return n.fromNumber(64);case x.Rich:return n.fromNumber(128)}return k("calc.funcs.type",r)}function Vb(e,t){var r=t[0];return Cf(r)?e.mathpack.fromNumber(r.type):be}function Bb(e,t){return Ee}function Wb(e,t){var r=t,n=r[0],a=r[1],i=void 0===a||Ef(a)?e.mathpack.zero:vE(e,a);if(Cf(i))return i;var o=vE(e,n);return Cf(o)?o:[o,i]}function jb(e,t){var r=Wb(e,t);if(!Array.isArray(r))return r;var n=r[0],a=r[1],i=e.mathpack;return 0===i.cond2(n,a)?i.one:i.zero}function Hb(e,t){var r=Wb(e,t);if(!Array.isArray(r))return r;var n=r[0],a=r[1],i=e.mathpack;return i.cond2(n,a)>=0?i.one:i.zero}function Kb(e,t,r){var n=_f(e,t,!0);return n instanceof Op?void 0!==r&&n.arity!==r?be:n:Cf(n)?n:Oe}function qb(e,t){var r=t,n=r[0],a=r.slice(1),i=Kb(e,n,a.length);return Cf(i)?i:e.applyLambda(i,a)}function Yb(e,t){var r=t,n=r[0],a=r[1],i=r[2],o=Kb(e,i,2);if(Cf(o))return o;var u=e.mathpack,c=u.fix(n),s=u.fix(a);if(c<1||s<1)return Ee;if(c*s>1e6)return cv(Dt(["ARRAY.MAKE with very large size"]));var l=[!1,!1];return uf(new sf(e,c,s,(function(t,r){var n=e.mathpack;return l[0]=n.fromNumber(t+1),l[1]=n.fromNumber(r+1),e.applyLambda(o,l)})))}function Jb(e,t){var r=_f(e,t[0],!0);return r instanceof Op?e.mathpack.fromNumber(r.arity):be}var Qb=ui.OperKind,Xb=ui.rangeSeqOper,zb=ui.valueErrorOper,Zb=ui.refErrorOper,$b=ui.arrayOper,eR=ii.gridRange,tR=hi.isSheetIndex;function rR(e,t){var r=t,n=r[0],a=r[1],i=r[2],o=r[3],u=e.mathpack,c=u.sfix(a);if(c<0)return zb;var s=void 0===i?void 0:u.sfix(i);if(void 0!==s&&s<0)return zb;var l,f,d=void 0===o?0:u.sfix(o)-1;if(d<0)return zb;switch(n.kind){case Qb.Range:if(!tR(n.sheets))return zb;if(d>=n.ranges.length)return Zb;var h=n.ranges[d];if(void 0===s)if(1===h.rows)l=0,f=c-1;else{if(1!==h.cols)return Zb;l=c-1,f=-1}else l=c-1,f=s-1;if(l>=h.rows||f>=h.cols)return Zb;var v=eR(h.row+pr(l,0),h.col+pr(f,0),-1===l?h.rows:1,-1===f?h.cols:1);return Xb(n.sheets,[v]);case Qb.Array:return d>0?Zb:(void 0===s?1===n.rows?(l=0,f=c-1):(l=c-1,f=-1):(l=c-1,f=s-1),l>=n.rows||f>=n.cols?Zb:-1===l&&-1===f?n:-1===l?$b(n.rows,1,n.opers.map((function(e){return[e[f]]}))):-1===f?$b(1,n.cols,[n.opers[l]]):n.opers[l][f]);default:return k("calc.funcs.lookupFuncs: INDEX",n)}}var nR=function(e){return e<0?Ue.Lt:e>0?Ue.Gt:Ue.Eq};function aR(e,t,r){void 0===r&&(r=!1);var n,a=e.config,i=a.localeInfo,o=a.mathpack;switch(typeof t){case"number":n=function(e){return{correctType:!0,sgnT:(r=o,n=e,a=t,nR(r.cond2(n,a)))};var r,n,a};break;case"string":if(r){var u=new nE(i,t);n=function(e){return{correctType:!0,sgnT:u.test(e)?Ue.Eq:Ue.Ne}}}else n=function(e){return{correctType:!0,sgnT:nR(i.stringCompareCI(e,t))}};break;case"boolean":n=function(e){return{correctType:!0,sgnT:(r=e,n=t,nR(r-n))};var r,n};break;case"object":return kf(t)?cv(Dt(["lookup with rich value condition"])):k("calc.funcs.makeLookupComparer",t)}return function(e){var r=kf(e)?e.getFallback():e;return typeof t!=typeof r?{correctType:!1,sgnT:Ue.Ne}:n(r)}}function iR(e,t,r){for(var n=!1,a=r.length-1,i=Math.floor((0+a)/2),o=0,u=a,c=aR(e,t);;){var s=c(r.get(i)).sgnT;if(s===Ue.Ne){if(i<u)for(var l=i+1;l<=u;l+=1)if((s=c(r.get(l)).sgnT)!==Ue.Ne){i=l;break}s===Ue.Ne&&(i=Math.floor((o+u)/2),s=Ue.Gt)}if(s===Ue.Eq){if(i<a){n=!0,o=i+=1,u=i;continue}return i}if(s===Ue.Lt?o=i+1:u=i-1,!(o<=u)){if(n)i-=1;else if(s===Ue.Gt&&(i-=1)>=0){o=i,u=i;continue}return i}i=Math.floor((o+u)/2)}}function oR(e,t,r,n){for(var a=-1,i=aR(e,t,n===Ue.Eq),o=0;o<r.length;o+=1){var u=i(r.get(o)),c=u.correctType,s=u.sgnT;if(c){if(s===Ue.Eq)return o;if(s!==Ue.Ne&&s===n)return a;a=o}o===r.denseLength&&(o=pr(o,r.length-2))}return n!==Ue.Eq?a:r.length}function uR(e){if("number"==typeof e)return be;switch(e.kind){case Qb.Range:return tR(e.sheets)?e.ranges.length>1?be:e:zb;case Qb.Array:return e}}function cR(e,t){if("number"==typeof t)return t;var r;switch(t.kind){case dh.RangeValues:r=t.arrays[0].get(0,0);break;case Qb.Array:r=t.opers[0][0];break;default:return k("calc.funcs.lookupFuncs.getNumFromRef",t)}return Cf(r=e.coerceOper(r,Qb.Number))?Zb:r}function sR(e){if("number"==typeof e)return be;switch(e.kind){case Qb.Rich:return be;case Qb.Range:if(!tR(e.sheets))return zb;if(e.ranges.length>1)return be;var t=e.ranges[0];return 1!==t.rows&&1!==t.cols?be:e;case Qb.Array:return 1!==e.rows&&1!==e.cols?be:e}}function lR(e){switch(e.kind){case dh.RangeValues:return e.arrays[0];case Qb.Array:return new Cl(e.rows,e.cols,e.rows,e.cols,e.opers,Le)}}function fR(e,t){switch(t.kind){case Qb.Range:var r=t.sheets,n=t.ranges[0];return new yl(n.rows,n.cols,n.rows,n.cols,(function(t,a){var i=Zt(n.row+t,n.col+a);return e.dereferenceAllOpers([Xb(r,[i])])[0].arrays[0].get(0,0)}),(function(){return A("calc.funcs.lookupFuncs: rangeOrArrayOperToLazyArray2D")}));case Qb.Array:return new Cl(t.rows,t.cols,t.rows,t.cols,t.opers,Le)}}function dR(e,t){var r=t,n=r[0],a=r[1],i=r[2],o=e.mathpack,u=function(e){if("number"==typeof e)return e;switch(e.kind){case Qb.Range:if(!tR(e.sheets))return zb;if(e.ranges.length>1)return Zb;var t=e.ranges[0];return 1!==t.rows||1!==t.cols?Zb:e}}(null!=i?i:o.one);if(Cf(u))return u;var c=e.dereferenceAllOpers([u])[0],s=cR(e,c);if(Cf(s))return s;var l=sR(a);if(Cf(l))return l;var f=lR(e.dereferenceAllOpers([l])[0]),d=CR(f,1===f.rows),h=-1;return(h=o.cond(s)>0?iR(e,n,d):0===o.cond(s)?oR(e,n,d,Ue.Eq):oR(e,n,d,Ue.Lt))<0||h>=d.length?be:e.mathpack.fromNumber(h+1)}function hR(e){if(Of(e)){var t=e.ranges[0];return t.cols>t.rows}return e.cols>e.rows}function vR(e,t){var r=t,n=r[0],a=r[1],i=r[2],o=uR(a);if(Cf(o))return o;var u=hR(o),c=SR(o,u),s=CR(lR(e.dereferenceAllOpers([c])[0]),u),l=iR(e,n,s);if(l<0)return be;if(void 0!==i){var f=sR(i);if(Cf(f))return f;var d=hR(f),h=CR(fR(e,function(e,t,r){if(r.kind===Qb.Range){var n=r.ranges[0],a=eR(n.row,n.col,vr(t?1:e,(1<<20)-n.row),vr(t?e:1,16384-n.col));return Me(r.sheets,a)}return r}(s.length,d,f)),d);return l>=h.length?f.kind===Qb.Array?be:Le:h.get(l)}var v=fR(e,o);return u?v.get(v.rows-1,l):v.get(l,v.cols-1)}function pR(e,t,r){var n=t,a=n[0],i=n[1],o=n[2],u=n[3],c=uR(i);if(Cf(c))return c;var s=SR(c,r),l=CR(lR(e.dereferenceAllOpers([s])[0]),r),f=!(null==u||u)?oR(e,a,l,Ue.Eq):iR(e,a,l);if(f<0||f>=l.length)return be;var d=function(e,t){if("number"==typeof t)return t;switch(t.kind){case Qb.Range:if(!tR(t.sheets))return zb;if(t.ranges.length>1)return Zb;var r=t.ranges;return e.calcingArray?cv(Dt(["HLOOKUP/VLOOKUP ref argument 3 in array formula"])):r[0].rows>1||r[0].cols>1?cv(Dt(["HLOOKUP/VLOOKUP non-singleton ref argument 3"])):t;case Qb.Array:return cv(Dt(["HLOOKUP/VLOOKUP array argument 3"]))}}(e,o);if(Cf(d))return d;var h=e.dereferenceAllOpers([d])[0],v=cR(e,h);if(Cf(v))return v;var p=e.mathpack.sfix(v)-1,m=fR(e,c);return p<0?zb:p>=(r?m.rows:m.cols)?Zb:r?m.get(p,f):m.get(f,p)}function mR(e,t){return pR(e,t,!0)}function gR(e,t){return pR(e,t,!1)}function CR(e,t){var r=e.getSparse.bind(e);return t?{length:e.cols,denseLength:e.denseCols,get:function(t){return e.get(0,t)},getSparse:r}:{length:e.rows,denseLength:e.denseRows,get:function(t){return e.get(t,0)},getSparse:r}}function SR(e,t){if(e.kind===Qb.Range){var r=e.ranges[0],n=eR(r.row,r.col,t?1:r.rows,t?r.cols:1);return Xb(e.sheets,[n])}return e}var yR={};yR[fi.WorksheetFuncId.SUM]=function(e,t){var r=e.dereferenceAllOpers(t);return bE(e,r)},yR[fi.WorksheetFuncId.PRODUCT]=function(e,t){var r=e.dereferenceAllOpers(t);return ME(e,r)},yR[fi.WorksheetFuncId.AVERAGE]=function(e,t){var r=e.dereferenceAllOpers(t);return UE(e,r)},yR[fi.WorksheetFuncId.COUNTBLANK]=function(e,t){var r=t[0];if(!Of(r)||!ct(r.sheets)||1!==r.ranges.length)return Ee;var n=e.dereferenceAllOpers(t);return qE(e,n)},yR[fi.WorksheetFuncId.MAX]=function(e,t){var r=e.dereferenceAllOpers(t);return eO(e,r)},yR[fi.WorksheetFuncId.MIN]=function(e,t){var r=e.dereferenceAllOpers(t);return tO(e,r)},yR[fi.WorksheetFuncId.AND]=function(e,t){var r=e.dereferenceAllOpers(t);return lO(e,r)},yR[fi.WorksheetFuncId.COUNTA]=function(e,t){var r=e.dereferenceAllOpers(t);return YE(e,r)},yR[fi.WorksheetFuncId.OR]=function(e,t){var r=e.dereferenceAllOpers(t);return fO(e,r)},yR[fi.WorksheetFuncId.CONCAT]=function(e,t){var r=t,n=e.dereferenceAllOpers(t);return BE(e,[],!0,r,n)},yR[fi.WorksheetFuncId.IF]=function(e,t){var r=t[0];return b("calc.funcs.if","boolean"==typeof r),t[r?1:2]},yR[fi.WorksheetFuncId.ISERROR]=function(e,t){return hi.operKind(t[0])===ui.OperKind.Error},yR[fi.WorksheetFuncId.ISERR]=function(e,t){var r=t[0];return Cf(r)&&r.type!==ui.ErrorType.NA},yR[fi.WorksheetFuncId.ISBLANK]=function(e,t){return hi.operKind(t[0])===ui.OperKind.Blank},yR[fi.WorksheetFuncId.ISLOGICAL]=function(e,t){return hi.operKind(t[0])===ui.OperKind.Boolean},yR[fi.WorksheetFuncId.ISNA]=function(e,t){var r=t[0];return Cf(r)&&r.type===ui.ErrorType.NA},yR[fi.WorksheetFuncId.ISNONTEXT]=function(e,t){return hi.operKind(t[0])!==ui.OperKind.String},yR[fi.WorksheetFuncId.ISTEXT]=function(e,t){return hi.operKind(t[0])===ui.OperKind.String},yR[fi.WorksheetFuncId.ISNUMBER]=function(e,t){return hi.operKind(t[0])===ui.OperKind.Number},yR[fi.WorksheetFuncId.ISREF]=function(e,t){return hi.operKind(t[0])===ui.OperKind.Range},yR[fi.WorksheetFuncId.ISEVEN]=UA,yR[fi.WorksheetFuncId.ISODD]=function(e,t){var r=UA(e,t);return"boolean"==typeof r?!r:r},yR[fi.WorksheetFuncId.ABS]=Jk,yR[fi.WorksheetFuncId.CEILING]=Vk,yR[fi.WorksheetFuncId.ECMA_CEILING]=Vk,yR[fi.WorksheetFuncId.DEGREES]=function(e,t){var r=e.mathpack,n=dE(r.div(r.fromNumber(180),r.pi));return r.mul(t[0],n)},yR[fi.WorksheetFuncId.FLOOR]=function(e,t){return Gk(e.mathpack,t[0],t[1])},yR[fi.WorksheetFuncId.RADIANS]=function(e,t){var r=e.mathpack,n=dE(r.div(r.pi,r.fromNumber(180)));return r.mul(t[0],n)},yR[fi.WorksheetFuncId.ROUND]=Dk,yR[fi.WorksheetFuncId.ROUNDUP]=Lk,yR[fi.WorksheetFuncId.ROUNDDOWN]=Uk,yR[fi.WorksheetFuncId.EVEN]=qk,yR[fi.WorksheetFuncId.SIGN]=function(e,t){var r=e.mathpack;return r.fromNumber(r.cond(t[0]))},yR[fi.WorksheetFuncId.PI]=function(e,t){return e.mathpack.pi},yR[fi.WorksheetFuncId.SQRT]=yk,yR[fi.WorksheetFuncId.EXP]=Ek,yR[fi.WorksheetFuncId.POWER]=Ok,yR[fi.WorksheetFuncId.LN]=kk,yR[fi.WorksheetFuncId.LOG10]=Ak,yR[fi.WorksheetFuncId.LOG]=function(e,t){var r=t,n=r[0],a=r[1],i=e.mathpack;if(void 0===a)return i.log(n);var o=i.ln(n);if(Cf(o))return o;var u=i.ln(a);return Cf(u)?u:i.div(o,u)},yR[fi.WorksheetFuncId.SIN]=bk,yR[fi.WorksheetFuncId.COS]=Rk,yR[fi.WorksheetFuncId.TAN]=Ik,yR[fi.WorksheetFuncId.ASIN]=Tk,yR[fi.WorksheetFuncId.ACOS]=Nk,yR[fi.WorksheetFuncId.ATAN]=Fk,yR[fi.WorksheetFuncId.ATAN2]=_k,yR[fi.WorksheetFuncId.FACT]=function(e,t){var r=t[0],n=e.mathpack,a=n.sfix(r);if(n.cond(r)<0||a>170)return Sk;for(var i=n.one,o=a;o>0;o-=1){if(Cf(i))return i;i=n.mul(n.fromNumber(o),i)}return i},yR[fi.WorksheetFuncId.LEFT]=function(e,t){var r,n=t,a=n[0],i=n[1];if(void 0!==i&&Cf(i))return i;var o=YA(e.mathpack,i);if(Cf(o))return qA;var u=null!=(r=HA(a,0,o))?r:a.length;return a.substring(0,u)},yR[fi.WorksheetFuncId.RIGHT]=function(e,t){var r,n=t,a=n[0],i=n[1];if(void 0!==i&&Cf(i))return i;var o=YA(e.mathpack,i);if("number"!=typeof o&&Cf(o))return qA;var u=null!=(r=function(e,t,r){for(var n=t,a=0;a<r;a+=1){if(n-1<0)return;BA(e.charCodeAt(n-1))&&n-2>=0&&VA(e.charCodeAt(n-2))?n-=2:n-=1}return n}(a,a.length,o))?r:0;return a.substring(u)},yR[fi.WorksheetFuncId.MID]=function(e,t){var r,n,a=t,i=a[0],o=a[1],u=a[2],c=e.mathpack,s=c.fix(o)-1,l=c.fix(u);if(c.cond(o)<0||s<0||c.cond(u)<0||l<0)return qA;var f=null!=(r=HA(i,0,s))?r:i.length,d=null!=(n=HA(i,f,l))?n:i.length;return i.substring(f,d)},yR[fi.WorksheetFuncId.LEN]=function(e,t){var r=t[0];return e.mathpack.fromNumber(KA(r,0,r.length))},yR[fi.WorksheetFuncId.CONCATENATE]=function(e,t){for(var r=t,n="",a=0;a<r.length;a+=1){var i=r[a];if(n.length+i.length>32767)return n+i.substring(0,32767-n.length);n+=i}return n};var ER=!1;function OR(e){return ER||(ER=!0,En(hn.CalcWorksheetFunctions)&&(En(hn["OfficeVSO:3852168_CalcCGIFS"])&&(yR[fi.WorksheetFuncId.IFS]=Nb),En(hn["OfficeVSO:3852168_CalcCGSWITCH"])&&(yR[fi.WorksheetFuncId.SWITCH]=Fb),En(hn["OfficeVSO:3852168_CalcCGAVERAGEIF"])&&(yR[fi.WorksheetFuncId.AVERAGEIF]=PE),En(hn["OfficeVSO:3852168_CalcCGAVERAGEIFS"])&&(yR[fi.WorksheetFuncId.AVERAGEIFS]=GE),En(hn["OfficeVSO:3852168_CalcCGCOUNT"])&&(yR[fi.WorksheetFuncId.COUNT]=KE),En(hn["OfficeVSO:3852168_CalcCGCOUNTIF"])&&(yR[fi.WorksheetFuncId.COUNTIF]=QE),En(hn["OfficeVSO:3852168_CalcCGCOUNTIFS"])&&(yR[fi.WorksheetFuncId.COUNTIFS]=XE),En(hn["OfficeVSO:3852168_CalcCGMEDIAN"])&&(yR[fi.WorksheetFuncId.MEDIAN]=_O),En(hn["OfficeVSO:3852168_CalcCGSUMSQ"])&&(yR[fi.WorksheetFuncId.SUMSQ]=RE),En(hn["OfficeVSO:3852168_CalcCGSUMIF"])&&(yR[fi.WorksheetFuncId.SUMIF]=NE),En(hn["OfficeVSO:3852168_CalcCGSUMIFS"])&&(yR[fi.WorksheetFuncId.SUMIFS]=_E),En(hn["OfficeVSO:3852168_CalcCGROWS"])&&(yR[fi.WorksheetFuncId.ROWS]=vb),En(hn["OfficeVSO:3852168_CalcCGCOLUMNS"])&&(yR[fi.WorksheetFuncId.COLUMNS]=pb),En(hn["OfficeVSO:3852168_CalcCGINDEX"])&&(yR[fi.WorksheetFuncId.INDEX]=rR),En(hn["OfficeVSO:3852168_CalcCGMATCH"])&&(yR[fi.WorksheetFuncId.MATCH]=dR),En(hn["OfficeVSO:3852168_CalcCGLOOKUP"])&&(yR[fi.WorksheetFuncId.LOOKUP]=vR),En(hn["OfficeVSO:3852168_CalcCGHLOOKUP"])&&(yR[fi.WorksheetFuncId.HLOOKUP]=mR),En(hn["OfficeVSO:3852168_CalcCGVLOOKUP"])&&(yR[fi.WorksheetFuncId.VLOOKUP]=gR),En(hn["OfficeVSO:3852168_CalcCGLARGE"])&&(yR[fi.WorksheetFuncId.LARGE]=CO),En(hn["OfficeVSO:3852168_CalcCGSMALL"])&&(yR[fi.WorksheetFuncId.SMALL]=SO),En(hn["OfficeVSO:3852168_CalcCGRANK"])&&(yR[fi.WorksheetFuncId.RANK]=dk,yR[fi.WorksheetFuncId.RANK_EQ]=dk),En(hn["OfficeVSO:3852168_CalcCGRANK_AVG"])&&(yR[fi.WorksheetFuncId.RANK_AVG]=hk),En(hn["OfficeVSO:3852168_CalcCGPERCENTILE"])&&(yR[fi.WorksheetFuncId.PERCENTILE]=OO,yR[fi.WorksheetFuncId.PERCENTILE_INC]=OO),En(hn["OfficeVSO:3852168_CalcCGPERCENTILE_EXC"])&&(yR[fi.WorksheetFuncId.PERCENTILE_EXC]=AO),En(hn["OfficeVSO:3852168_CalcCGQUARTILE"])&&(yR[fi.WorksheetFuncId.QUARTILE]=IO,yR[fi.WorksheetFuncId.QUARTILE_INC]=IO),En(hn["OfficeVSO:3852168_CalcCGQUARTILE_EXC"])&&(yR[fi.WorksheetFuncId.QUARTILE_EXC]=NO),En(hn["OfficeVSO:3852168_CalcCGTRIMMEAN"])&&(yR[fi.WorksheetFuncId.TRIMMEAN]=MO),En(hn["OfficeVSO:3852168_CalcCGTRUE"])&&(yR[fi.WorksheetFuncId.TRUE]=_b),En(hn["OfficeVSO:3852168_CalcCGFALSE"])&&(yR[fi.WorksheetFuncId.FALSE]=Mb),En(hn["OfficeVSO:3852168_CalcCGNOT"])&&(yR[fi.WorksheetFuncId.NOT]=Db),En(hn["OfficeVSO:3852168_CalcCGNA"])&&(yR[fi.WorksheetFuncId.NA]=Lb),En(hn["OfficeVSO:3852168_CalcCGAVERAGEA"])&&(yR[fi.WorksheetFuncId.AVERAGEA]=VE),En(hn["OfficeVSO:3852168_CalcCGMAXA"])&&(yR[fi.WorksheetFuncId.MAXA]=aO),En(hn["OfficeVSO:3852168_CalcCGMINA"])&&(yR[fi.WorksheetFuncId.MINA]=iO),En(hn["OfficeVSO:3852168_CalcCGMAXIFS"])&&(yR[fi.WorksheetFuncId.MAXIFS]=oO),En(hn["OfficeVSO:3852168_CalcCGMINIFS"])&&(yR[fi.WorksheetFuncId.MINIFS]=uO),En(hn["OfficeVSO:3852168_CalcCGXOR"])&&(yR[fi.WorksheetFuncId.XOR]=hO),En(hn["OfficeVSO:3852168_CalcCGT"])&&(yR[fi.WorksheetFuncId.T]=xb),En(hn["OfficeVSO:3852168_CalcCGN"])&&(yR[fi.WorksheetFuncId.N]=Pb),En(hn["OfficeVSO:3852168_CalcCGHYPERLINK"])&&(yR[fi.WorksheetFuncId.HYPERLINK]=wb),En(hn["OfficeVSO:3852168_CalcCGAGGREGATE"])&&(yR[fi.WorksheetFuncId.AGGREGATE]=fk),En(hn["OfficeVSO:3852168_CalcCGSUBTOTAL"])&&(yR[fi.WorksheetFuncId.SUBTOTAL]=ck),En(hn["OfficeVSO:3852168_CalcCGVAR"])&&(yR[fi.WorksheetFuncId.VAR]=ZO,yR[fi.WorksheetFuncId.VAR_S]=ZO),En(hn["OfficeVSO:3852168_CalcCGVARP"])&&(yR[fi.WorksheetFuncId.VARP]=$O,yR[fi.WorksheetFuncId.VAR_P]=$O),En(hn["OfficeVSO:3852168_CalcCGSTDEV"])&&(yR[fi.WorksheetFuncId.STDEV]=JO,yR[fi.WorksheetFuncId.STDEV_S]=JO),En(hn["OfficeVSO:3852168_CalcCGSTDEVP"])&&(yR[fi.WorksheetFuncId.STDEVP]=QO,yR[fi.WorksheetFuncId.STDEV_P]=QO),En(hn["OfficeVSO:3852168_CalcCGVARA"])&&(yR[fi.WorksheetFuncId.VARA]=ek),En(hn["OfficeVSO:3852168_CalcCGVARPA"])&&(yR[fi.WorksheetFuncId.VARPA]=tk),En(hn["OfficeVSO:3852168_CalcCGSTDEVA"])&&(yR[fi.WorksheetFuncId.STDEVA]=XO),En(hn["OfficeVSO:3852168_CalcCGSTDEVPA"])&&(yR[fi.WorksheetFuncId.STDEVPA]=zO),En(hn["OfficeVSO:3852168_CalcCGAVEDEV"])&&(yR[fi.WorksheetFuncId.AVEDEV]=gk),En(hn["OfficeVSO:3852168_CalcCGDEVSQ"])&&(yR[fi.WorksheetFuncId.DEVSQ]=Ck),En(hn["OfficeVSO:3852168_CalcCGMODE"])&&(yR[fi.WorksheetFuncId.MODE]=ik,yR[fi.WorksheetFuncId.MODE_SNGL]=ik),En(hn["OfficeVSO:3852168_CalcCGMODE_MULT"])&&(yR[fi.WorksheetFuncId.MODE_MULT]=ok),En(hn["OfficeVSO:3852168_CalcCGTYPE"])&&(yR[fi.WorksheetFuncId.TYPE]=Gb),En(hn["OfficeVSO:3852168_CalcCGERROR_TYPE"])&&(yR[fi.WorksheetFuncId.ERROR_TYPE]=Vb),En(hn["OfficeVSO:3852168_CalcCGAREAS"])&&(yR[fi.WorksheetFuncId.AREAS]=hb),En(hn["OfficeVSO:3852168_CalcCGSHEETS"])&&(yR[fi.WorksheetFuncId.SHEETS]=Sb),En(hn["OfficeVSO:3852168_CalcCGROW"])&&(yR[fi.WorksheetFuncId.ROW]=gb),En(hn["OfficeVSO:3852168_CalcCGCOLUMN"])&&(yR[fi.WorksheetFuncId.COLUMN]=Cb),En(hn["OfficeVSO:3852168_CalcCGSHEET"])&&(yR[fi.WorksheetFuncId.SHEET]=yb),En(hn["OfficeVSO:3852168_CalcCGOFFSET"])&&(yR[fi.WorksheetFuncId.OFFSET]=Eb),En(hn["OfficeVSO:3852168_CalcCGEXACT"])&&(yR[fi.WorksheetFuncId.EXACT]=JA),En(hn["OfficeVSO:3852168_CalcCGREPT"])&&(yR[fi.WorksheetFuncId.REPT]=QA),En(hn["OfficeVSO:3852168_CalcCGTRIM"])&&(yR[fi.WorksheetFuncId.TRIM]=XA),En(hn["OfficeVSO:3852168_CalcCGCLEAN"])&&(yR[fi.WorksheetFuncId.CLEAN]=zA),En(hn["OfficeVSO:3852168_CalcCGCHAR"])&&(yR[fi.WorksheetFuncId.CHAR]=ZA),En(hn["OfficeVSO:3852168_CalcCGUNICHAR"])&&(yR[fi.WorksheetFuncId.UNICHAR]=$A),En(hn["OfficeVSO:3852168_CalcCGCODE"])&&(yR[fi.WorksheetFuncId.CODE]=eb),En(hn["OfficeVSO:3852168_CalcCGUNICODE"])&&(yR[fi.WorksheetFuncId.UNICODE]=tb),En(hn["OfficeVSO:3852168_CalcCGLOWER"])&&(yR[fi.WorksheetFuncId.LOWER]=ab),En(hn["OfficeVSO:3852168_CalcCGUPPER"])&&(yR[fi.WorksheetFuncId.UPPER]=ib),En(hn["OfficeVSO:3852168_CalcCGPROPER"])&&(yR[fi.WorksheetFuncId.PROPER]=ob),En(hn["OfficeVSO:3852168_CalcCGFIND"])&&(yR[fi.WorksheetFuncId.FIND]=ub),En(hn["OfficeVSO:3852168_CalcCGREPLACE"])&&(yR[fi.WorksheetFuncId.REPLACE]=cb),En(hn["OfficeVSO:3852168_CalcCGSEARCH"])&&(yR[fi.WorksheetFuncId.SEARCH]=sb),En(hn["OfficeVSO:3852168_CalcCGSUBSTITUTE"])&&(yR[fi.WorksheetFuncId.SUBSTITUTE]=lb),En(hn["OfficeVSO:3852168_CalcCGISFORMULA"])&&(yR[fi.WorksheetFuncId.ISFORMULA]=PA),En(hn["OfficeVSO:3852168_CalcCGFORMULATEXT"])&&(yR[fi.WorksheetFuncId.FORMULATEXT]=GA),En(hn["OfficeVSO:3852168_CalcCGINFO"])&&(yR[fi.WorksheetFuncId.INFO]=Bb),En(hn["OfficeVSO:3852168_CalcCGDELTA"])&&(yR[fi.WorksheetFuncId.DELTA]=jb),En(hn["OfficeVSO:3852168_CalcCGGESTEP"])&&(yR[fi.WorksheetFuncId.GESTEP]=Hb),En(hn["OfficeVSO:3852168_CalcCGTRANSPOSE"])&&(yR[fi.WorksheetFuncId.TRANSPOSE]=Ob),En(hn["OfficeVSO:3852168_CalcCGADDRESS"])&&(yR[fi.WorksheetFuncId.ADDRESS]=kb),En(hn["OfficeVSO:3852168_CalcCGINDIRECT"])&&(yR[fi.WorksheetFuncId.INDIRECT]=Ab),En(hn["OfficeVSO:3852168_CalcCGTEXTJOIN"])&&(yR[fi.WorksheetFuncId.TEXTJOIN]=WE),En(hn["OfficeVSO:3852168_CalcCGCHOOSE"])&&(yR[fi.WorksheetFuncId.CHOOSE]=Ib),En(hn["OfficeVSO:3852168_CalcCGSQRTPI"])&&(yR[fi.WorksheetFuncId.SQRTPI]=zk),En(hn["OfficeVSO:3852168_CalcCGFACTDOUBLE"])&&(yR[fi.WorksheetFuncId.FACTDOUBLE]=Xk),En(hn["OfficeVSO:3852168_CalcCGINT"])&&(yR[fi.WorksheetFuncId.INT]=Mk),En(hn["OfficeVSO:3852168_CalcCGTRUNC"])&&(yR[fi.WorksheetFuncId.TRUNC]=wk,yR[fi.WorksheetFuncId.ROUNDDOWN]=Uk),En(hn["OfficeVSO:3852168_CalcCGODD"])&&(yR[fi.WorksheetFuncId.ODD]=Yk),En(hn["OfficeVSO:3852168_CalcCGMROUND"])&&(yR[fi.WorksheetFuncId.MROUND]=xk),En(hn["OfficeVSO:3852168_CalcCGQUOTIENT"])&&(yR[fi.WorksheetFuncId.QUOTIENT]=Qk),En(hn["OfficeVSO:3852168_CalcCGFLOOR.MATH"])&&(yR[fi.WorksheetFuncId.FLOOR_MATH]=jk),En(hn["OfficeVSO:3852168_CalcCGFLOOR.PRECISE"])&&(yR[fi.WorksheetFuncId.FLOOR_PRECISE]=Hk),En(hn["OfficeVSO:3852168_CalcCGCEILING.MATH"])&&(yR[fi.WorksheetFuncId.CEILING_MATH]=Bk),En(hn["OfficeVSO:3852168_CalcCGCEILING.PRECISE"])&&(yR[fi.WorksheetFuncId.CEILING_PRECISE]=Wk,yR[fi.WorksheetFuncId.ISO_CEILING]=Wk)),En(hn.CalcDateTimeFunctions)&&(En(hn["OfficeVSO:3852168_CalcCGYEAR"])&&(yR[fi.WorksheetFuncId.YEAR]=$k),En(hn["OfficeVSO:3852168_CalcCGMONTH"])&&(yR[fi.WorksheetFuncId.MONTH]=eA),En(hn["OfficeVSO:3852168_CalcCGDAY"])&&(yR[fi.WorksheetFuncId.DAY]=tA),En(hn["OfficeVSO:3852168_CalcCGHOUR"])&&(yR[fi.WorksheetFuncId.HOUR]=rA),En(hn["OfficeVSO:3852168_CalcCGMINUTE"])&&(yR[fi.WorksheetFuncId.MINUTE]=nA),En(hn["OfficeVSO:3852168_CalcCGSECOND"])&&(yR[fi.WorksheetFuncId.SECOND]=aA),En(hn["OfficeVSO:3852168_CalcCGWEEKNUM"])&&(yR[fi.WorksheetFuncId.WEEKNUM]=lA),En(hn["OfficeVSO:3852168_CalcCGISOWEEKNUM"])&&(yR[fi.WorksheetFuncId.ISOWEEKNUM]=sA),En(hn["OfficeVSO:3852168_CalcCGWEEKDAY"])&&(yR[fi.WorksheetFuncId.WEEKDAY]=oA),En(hn["OfficeVSO:3852168_CalcCGDATE"])&&(yR[fi.WorksheetFuncId.DATE]=fA),En(hn["OfficeVSO:3852168_CalcCGTIME"])&&(yR[fi.WorksheetFuncId.TIME]=hA),En(hn["OfficeVSO:3852168_CalcCGDAYS360"])&&(yR[fi.WorksheetFuncId.DAYS360]=vA),En(hn["OfficeVSO:3852168_CalcCGDAYS"])&&(yR[fi.WorksheetFuncId.DAYS]=gA),En(hn["OfficeVSO:3852168_CalcCGDATEDIF"])&&(yR[fi.WorksheetFuncId.DATEDIF]=pA),En(hn["OfficeVSO:3852168_CalcCGWORKDAY"])&&(yR[fi.WorksheetFuncId.WORKDAY]=kA),En(hn["OfficeVSO:3852168_CalcCGWORKDAY.INTL"])&&(yR[fi.WorksheetFuncId.WORKDAY_INTL]=OA),En(hn["OfficeVSO:3852168_CalcCGEDATE"])&&(yR[fi.WorksheetFuncId.EDATE]=IA),En(hn["OfficeVSO:3852168_CalcCGEOMONTH"])&&(yR[fi.WorksheetFuncId.EOMONTH]=TA),En(hn["OfficeVSO:3852168_CalcCGENETWORKDAYS"])&&(yR[fi.WorksheetFuncId.NETWORKDAYS]=FA),En(hn["OfficeVSO:3852168_CalcCGENETWORKDAYS.INTL"])&&(yR[fi.WorksheetFuncId.NETWORKDAYS_INTL]=NA),En(hn["OfficeVSO:3852168_CalcCGEYEARFRAC"])&&(yR[fi.WorksheetFuncId.YEARFRAC]=wA)),En(hn.CalcFieldValueFunction)&&(yR[fi.WorksheetFuncId.FIELDVALUE]=fb,yR[fi.WorksheetFuncId._FV]=fb),En(hn.CalcRecordFunctions)&&(yR[fi.WorksheetFuncId.RECORD]=db),En(hn.CalcFunFunctions)&&(yR[fi.WorksheetFuncId.ARITY]=Jb,yR[fi.WorksheetFuncId.APPLY]=qb,yR[fi.WorksheetFuncId.ARRAYMAKE]=Yb,yR[fi.WorksheetFuncId.ISFUN]=LA)),yR[e]}var kR=Zt(0,0);var AR=ge([],[],G.None,W.Exact),bR=function(){function e(e,t,r,n,a,i,o,u,c){this.onNameFailure=t,this.onRangeFailure=r,this.onUnavailableObject=n,this.onSetCellValue=a,this.onSetCellValues=i,this.schedulerConfig=o,this.limits=u,this.maxDereferenceCells=c,this.iformats=[],this.worksheetFuncOverrides={},this.interruptToken=[Dl.Continue],this.setDynamicPrecs=function(){},this.getCellValue=this.makeGetCellValues(this.tryGetCellValue.bind(this)),this.getCellValues=this.makeGetCellValues(this.tryGetCellValues.bind(this)),this.config=e,this.parser=ks(this),this.analyzer=Sh(this),this.compiler=iv(this),this.evaluator=Pp(this)}return e.prototype.cloneServer=function(){var t,r=new e(this.config,(function(){}),(function(){}),(function(){}),(function(){}),(function(){}),this.schedulerConfig,this.limits,this.maxDereferenceCells);return r.documentLoc=this.documentLoc,r.document=null===(t=this.document)||void 0===t?void 0:t.cloneServer(),r},e.prototype.reconfigure=function(e,t,r){this.schedulerConfig=e,this.limits=t,this.maxDereferenceCells=r},e.prototype.setConfig=function(e){this.config=e},e.prototype.getDocumentLoc=function(e,t){var r=this.documentLoc;return void 0===r||void 0!==e&&e!==r.path||0!==this.config.localeInfo.stringCompareCI(t,r.name)?it(UR([{kind:_R.DocumentLoc,document:Kt(e,t)}])):at(r)},e.prototype.forEachDocument=function(e){void 0!==this.document&&e(this.document)},e.prototype.getNameLoc=function(e,t){var r=this.getDocument(e.document);if(r.kind===Be.Failure)return it(UR([r.reason]));var n=r.value.getNameLoc(e.index,t);return n.kind===Be.Failure?it(UR([n.reason])):n},e.prototype.getUserDefinedFuncLoc=function(e,t){return it(Dt(["call UDF"]))},e.prototype.getCellFormat=function(e){var t=this.allEditedAvailable(e);if(t.kind===Be.Failure)return it(UR([t.reason]));if(!t.value)return it(UR([{kind:_R.GridRange,range:e}]));var r=this.getEditedFormat(e);if(r.kind===Be.Failure)return it(UR([r.reason]));if(!1===r.value)return it(UR([{kind:_R.CellFormat}]));var n=this.resolveIformat(r.value);return void 0===n.category||void 0===n.decimals?it(UR([{kind:_R.NumberFormat,iformat:n.iformat}])):at({iformat:n.iformat,category:n.category,decimals:n.decimals})},e.prototype.getNameFormula=function(e){var t=this.getDocument(e.scope.document);if(t.kind===Be.Failure)return it(UR([t.reason]));var r=t.value.getNameFormula(e);if(r.kind===Be.Failure)return it(UR([r.reason]));if(void 0===r.value)return at(void 0);var n=r.value.compiledFmla.getValue();if(ot(n))return n;var a=this.hasRecalcNameFailure(e);return ot(a)?a.value||this.setNameFailure(e,n.reason):this.onUnavailableObject(a.reason),it(function(e){return{kind:Nl.PreviousNameFailure,name:e}}(e))},e.prototype.getCellFormula=function(e){var t=this.getEditedFormula(e);if(t.kind===Be.Failure)return it(UR([t.reason]));if(void 0===t.value)return at(void 0);var r=t.value,n=r[0],a=r[1];if(void 0===a.compiledFmla)return at(void 0);var i=tr(e.sheet,n),o=this.readCompiledFmla(i,a.compiledFmla);return ot(o)?at(Gl(jt(a.lexicalKind,i),o.value)):o},e.prototype.getKnownFormat=function(e){var t=this.iformats[e];return void 0===t?it(UR([{kind:_R.NumberFormat,iformat:e}])):at({iformat:e,category:t.category,decimals:t.decimals})},e.prototype.setCellValue=function(e,t,r){var n=this.hasRecalcValueChanged(e,t);if(n.kind===Be.Failure)return this.onUnavailableObject(n.reason);var a=this.setEditedAndRecalcValues(e,t);if(a.kind===Be.Failure)return this.onUnavailableObject(a.reason);var i=this.propagateEditTaint(e,r);if(i.kind===Be.Failure)return this.onUnavailableObject(i.reason);this.onSetCellValue(e,t,r,i.value,this.evalParams,n.value)},e.prototype.setCellValues=function(e,t,r){var n=this.setEditedAndRecalcValues(e,t);if(n.kind===Be.Failure)return this.onUnavailableObject(n.reason);var a=this.propagateEditTaint(e,r);if(a.kind===Be.Failure)return this.onUnavailableObject(a.reason);this.onSetCellValues(e,t,r,a.value,this.evalParams)},e.prototype.getWorksheetFunc=function(e){if(0!=(rt(e).staticPrecs&(G.Time|G.Calc)))return it(UR([{kind:_R.VolatileFunction,name:Ta(e)}]));if(void 0!==this.worksheetFuncOverrides[e])return at(this.worksheetFuncOverrides[e]);var t=OR(e);return null!=t?at(t):it(Dt([Ta(e)]))},e.prototype.getUserDefinedFunc=function(e){return it(Dt(["call UDF"]))},e.prototype.getSheetRangeIndexes=function(e){var t=this.getSheetRangeIds(e);return t.kind===Be.Failure?it(UR([t.reason])):at(t.value)},e.prototype.setCellFailure=function(e,t,r){var n=this.setRecalcFailure(e.sheet,wC(e.range));if(n.kind===Be.Failure)return this.onUnavailableObject(n.reason);var a=this.setEditedAndRecalcValues(e,Le);if(a.kind===Be.Failure)return this.onUnavailableObject(a.reason);var i=this.propagateEditTaint(e,r);if(i.kind===Be.Failure)return this.onUnavailableObject(i.reason);this.onRangeFailure(e,t,r,i.value,this.evalParams)},e.prototype.getUsedRange=function(e){var t=this.getEditedUsedRange(e);return t.kind===Be.Failure?it(UR([t.reason])):t},e.prototype.getSheetName=function(e,t){var r=this.getDocument(e);if(r.kind===Be.Failure)return it(UR([r.reason]));var n=r.value.getSheetName(t);return n.kind===Be.Failure?it(UR([n.reason])):void 0===n.value?n:at(n.value)},e.prototype.getSheetIndex=function(e,t){var r=this.getDocument(e);if(r.kind===Be.Failure)return it(UR([r.reason]));var n=r.value.getSheetIndex(t);return n.kind===Be.Failure?it(UR([n.reason])):void 0===n.value?n:at(n.value.index)},e.prototype.getHiddenRows=function(e,t,r){var n=this.getDocument(e.document);if(n.kind===Be.Failure)return it(UR([n.reason]));var a=n.value.getHiddenRows(e.index,t,r);return a.kind===Be.Failure?it(UR([a.reason])):a},e.prototype.isInFilterMode=function(e){var t=this.getDocument(e.document);if(t.kind===Be.Failure)return it(UR([t.reason]));var r=t.value.isInFilterMode(e.index);return r.kind===Be.Failure?it(UR([r.reason])):r},e.prototype.withEvalParams=function(e,t){var r=this,n=this.evalParams;this.evalParams=e;try{var a=t();return Array.isArray(a)?a:Ql((function(){return r.withEvalParams(e,a.resume)}))}finally{this.evalParams=n}},e.prototype.withEvalParamsEvalFormula=function(e,t){var r=this,n=this.evalParams;this.evalParams=e;try{var a=t();return a.kind!==Be.Paused?a:Ql((function(){return r.withEvalParamsEvalFormula(e,a.resume)}))}finally{this.evalParams=n}},e.prototype.evaluate=function(e,t){var r=this;return this.withEvalParams({computeKind:e,computeCell:t},(function(){return r.evaluator.evalCells([t])}))},e.prototype.evalFormula=function(e,t){var r=this,n={lexicalKind:Vt.Other,originGridCell:at(kR),originSheet:at(t),allowRelativeQualifier:!1,allowUnqualifiedCell:!0},a={lexicalSource:{kind:Vt.Other},originGridCell:at(kR),originSheet:at(t),calcingArray:!1,reflectionGridCell:at(kR),reflectionSheet:at(t),implicitIntersect:!1,wrapCellReferences:!1,followHyperlinks:at(!1)};return this.withEvalParamsEvalFormula({computeKind:UC.EvalFormula,computeCell:rr(t,kR)},(function(){var t=r.parser.parseFormula(n,e),i=r.checkFormula(n,t,e,"eval-formula"),o=r.compileFormula(n,i);return ot(o)?r.evaluator.evalFormula(a,o.value):o}))},e.prototype.setWorksheetFuncOverrides=function(e){this.worksheetFuncOverrides=e},e.prototype.setSheetNames=function(e,t){var r=this.ensureDocument(e);return r.kind===Be.Failure?r:(this.document=r.value.setSheetNames(t),at(void 0))},e.prototype.advanceState=function(e){void 0!==this.document&&this.document.advanceState(e)},e.prototype.onCellModified=function(e){if(void 0!==this.document)return this.document.onCellModified(e)},e.prototype.getServerDocument=function(){return this.documentLoc},e.prototype.allServerAvailable=function(e){var t=this.getDocument(e.sheet.document);return t.kind===Be.Failure?t:t.value.allServerAvailable(e)},e.prototype.forEachEditedNonBlankCellInSet=function(e,t,r){var n=e.index,a=e.document,i=this.getDocument(a);return i.kind===Be.Failure?i:i.value.forEachEditedNonBlankCellInSet(n,t,r)},e.prototype.forEachServerNonBlankCellInSet=function(e,t,r){var n=e.index,a=e.document,i=this.getDocument(a);return i.kind===Be.Failure?i:i.value.forEachServerNonBlankCellInSet(n,t,r)},e.prototype.clearCompiledFormulas=function(){if(void 0!==this.document)return this.document.clearCompiledFormulas()},e.prototype.getGridStatistics=function(){return void 0!==this.document?this.document.getGridStatistics():MS},e.prototype.getNameStatistics=function(){return void 0!==this.document?this.document.getNameStatistics():zy},e.prototype.collectGarbage=function(e){if(void 0!==this.document)return this.document.collectGarbage(e)},e.prototype.getEditedFormula=function(e){var t=this.getDocument(e.sheet.document);return t.kind===Be.Failure?t:t.value.getEditedFormula(e)},e.prototype.getEditedFormat=function(e){var t=this.getDocument(e.sheet.document);return t.kind===Be.Failure?t:t.value.getEditedFormat(e)},e.prototype.getServerFormat=function(e){var t=this.getDocument(e.sheet.document);return t.kind===Be.Failure?t:t.value.getServerFormat(e)},e.prototype.getRecalcValue=function(e){var t=this.getDocument(e.sheet.document);return t.kind===Be.Failure?t:t.value.getRecalcValue(e)},e.prototype.getServerValue=function(e){var t=this.getDocument(e.sheet.document);return t.kind===Be.Failure?t:t.value.getServerValue(e)},e.prototype.getServerFormula=function(e){var t=this.getDocument(e.sheet.document);return t.kind===Be.Failure?t:t.value.getServerFormula(e)},e.prototype.getServerUsedRange=function(e){var t=this.getDocument(e.document);if(t.kind===Be.Failure)return t;var r=t.value.getServerUsedRange(e.index);return r.kind===Be.Failure||void 0===r.value?r:at(tr(e,r.value))},e.prototype.getServerAvailableCells=function(){var e=[];return this.forEachDocument((function(t){return e.push.apply(e,t.getServerAvailableCells())})),e},e.prototype.promoteServerAvailability=function(e,t){var r=e.sheet,n=e.set,a=this.getDocument(r.document);return a.kind===Be.Failure?a:a.value.promoteServerAvailability(r.index,n,t)},e.prototype.extendServerUnused=function(e,t){var r=this.getDocument(e.document);return r.kind===Be.Failure?r:r.value.extendServerUnused(e.index,t)},e.prototype.setCellContents=function(e,t,r,n,a,i,o,u,c){var s=this.getDocument(t.sheet.document);if(s.kind===Be.Failure)return s;var l=void 0===r?void 0:n?this.compileFmla(e,Vt.Cell,rr(t.sheet,a),void 0,r):""===r?AS:{fmla:r,lexicalKind:Vt.Cell,origin:a,compiledFmla:void 0};return s.value.setCellContents(e,t,l,i,o,u,c)},e.prototype.setRangeFormula=function(e,t,r,n,a,i,o){var u=this.getDocument(t.sheet.document);if(u.kind===Be.Failure)return u;var c=""===r?bS:this.compileFmla(e,Vt.Range,rr(t.sheet,n),Ct(t.range),r);return u.value.setRangeFormula(e,t,c,a,i,o)},e.prototype.getDirtyEditedCells=function(){return this.document?this.document.getDirtyEditedCells():[]},e.prototype.getDirtyDependentCells=function(){return this.document?this.document.getDirtyDependentCells():[]},e.prototype.setNamedObject=function(e,t,r){var n=this.getDocument(t.scope.document);if(n.kind===Be.Failure)return n;var a=Ht(t),i=void 0===r?void 0:this.compileNamedObject(e,a,r);return n.value.setNamedObject(e,t,i)},e.prototype.setUndefinedNames=function(e){var t=this.getDocument(e.document);return t.kind===Be.Failure?t:t.value.setUndefinedNames(e)},e.prototype.promoteNamedObjects=function(e,t){var r=this.getDocument(e.document);return r.kind===Be.Failure?r:r.value.promoteNamedObjects(e,t)},e.prototype.setNumberFormats=function(e,t){var r=this;t||(this.iformats=[]),e.forEach((function(e){r.iformats[e.iformat]=e}))},e.prototype.writeHiddenRows=function(e,t,r){var n=this.getDocument(e.document);return n.kind===Be.Failure?n:n.value.setHiddenRows(e.index,t,r)},e.prototype.writeInFilterMode=function(e,t){var r=this.getDocument(e.document);return r.kind===Be.Failure?r:r.value.setInFilterMode(e.index,t)},e.prototype.resolveIformat=function(e){if(e.isExact&&(void 0===e.category||void 0===e.decimals)){var t=this.iformats[e.iformat];void 0!==t&&(e.category=t.category,e.decimals=t.decimals)}return e},e.prototype.inferRangeFormat=function(e,t){var r,n=this,a=e,i=AC(wC(t.range),e);if(void 0!==i&&i<=0){var o=this.inferCellFormat(t);if(!ot(o)||void 0===o.value)return[];a=kC(a,wC(t.range)),r=o.value}else{var u=this.getEditedFormat(t);if(!ot(u))return[u.reason];if(!1===u.value)return[];r=this.resolveIformat(u.value)}r=Object(j.a)({},r);var c=[];return this.forEachEditedNonBlankCellInSet(t.sheet,a,(function(e){var a=rr(t.sheet,e),i=n.isFormatGeneral(a);if(!ot(i))return c.push(i.reason),!0;if(!i.value)return!0;var o=n.setEditedFormat(a,r);return ot(o)||c.push(o.reason),!0})),c},e.prototype.inferCellFormat=function(e){var t=this.isFormatGeneral(e);if(!ot(t))return t;if(!t.value)return at(void 0);var r=this.getEditedFormula(e);if(r.kind===Be.Failure)return r;if(void 0===r.value||void 0===r.value[1].compiledFmla)return at(void 0);var n=r.value[1].compiledFmla.getValue();if(!ot(n))return at(void 0);var a=jt(r.value[1].lexicalKind,tr(e.sheet,r.value[0])),i=n.value,o=this.analyzer.findBestFormat(Qs(a),i);if(!ot(o))return at(void 0);var u=o.value,c=u.category,s=u.iformat,l=u.decimals,f=this.iformats[s],d=void 0!==f&&c===f.category&&l===f.decimals,h=ES(d,s,c,l),v=this.setEditedFormat(e,h);return ot(v)?at(h):v},e.prototype.isFormatGeneral=function(e){var t=this.getEditedFormat(e);return t.kind===Be.Failure?t:!1===t.value?at(!1):at("General"===this.resolveIformat(t.value).category)},e.prototype.anonymizeFormula=function(e,t){var r,n,a,i,o=null===(r=t.compiledFmla)||void 0===r?void 0:r.getValue();return void 0!==o&&ot(o)?[ai(o.value,e),(n=o.value,a=[],i=Ka(Ha((function(){})),(function(){}),{vArray:function(e){e.nodes.forEach((function(e){return e.forEach((function(e){return ja(e,i)}))}))},vApp:function(e){var t;if(bt(e.head))a.push(Na(e.head.id));else{var r=n.annotations[e.head.label];(null===(t=r)||void 0===t?void 0:t.kind)===w.WorksheetFuncName&&a.push(Ta(r.id))}for(var o=0,u=e.args;o<u.length;o++)ja(u[o],i)},vParen:function(e){ja(e.node,i)}}),Wa(n.node,i),a)]:[Ai(t.fmla),[]]},e.prototype.compileFmla=function(e,t,r,n,a){var i=this;return{fmla:a,lexicalKind:t,origin:null!=n?n:r.range,compiledFmla:new rE((function(){var o=i.parser.parseFormula(Ni(t,r.range),a),u=e?o:i.autocorrectFormula(Ys(t,r),o),c=i.checkFormula(Ys(t,r),u,a,e?"server-cell-formula":"edit-cell-formula"),s=i.adjustFormulaOrigin(c,r.range,n);return i.compileFormula(_l(t,r.range),s)}))}},e.prototype.compileFormula=function(e,t){return ot(t)?this.compiler.compileFormula(e,t.value):t},e.prototype.compileNamedObject=function(e,t,r){var n=this,a=e?"server-named-formula":"edit-named-formula";switch(r.kind){case"NamedFormula":return{obj:r,compiledFmla:new rE((function(){var t=r.fmla,i=n.parser.parseFormula(Ni(Vt.NameManager,kR),t);b("calc.calc.PartialWorkbookDocumentCollection.compileNamedObject: isServerUpdate",e);var o=Js(nr(ar(n.documentLoc),kR)),u=i,c=n.checkFormula(o,u,t,a);return n.compileFormula(_l(Vt.NameManager,kR),c)}))};case"NamedValue":return{obj:r,compiledFmla:new rE((function(){var e,i;if(Of(r.value)){b("calc.calc.PartialWorkbookDocumentCollection.compileNamedObject: bad range",ct(r.value.sheets)&&1===r.value.ranges.length);var o=r.value.sheets,u=n.getDocument(o.document);if(!ot(u))return n.onUnavailableObject(u.reason),it(UR([u.reason]));var c=u.value.getSheetName(o.index);if(!ot(c))return n.onUnavailableObject(c.reason),it(UR([c.reason]));var s=r.value.ranges[0];e=re(de($(Z(X(D.Abs,s.row),X(D.Abs,s.col)),Z(X(D.Abs,s.row+s.rows-1),X(D.Abs,s.col+s.cols-1))),Y(c.value,q(o.document.name,o.document.path))),[]),i=rr(o,kR)}else e=re(oe(r.value,!0),[]),i=nr(ar(n.documentLoc),kR);var l=n.analyzer.checkFormula(Js(i),e,a);return st(l)?n.compileFormula(_l(Vt.NameManager,kR),at(l)):A("calc.calc.PartialWorkbookDocumentCollection.compileNamedObject: constructed ill-formed formula "+ai(e,t))}))};case"NamedFailure":return{obj:r,compiledFmla:new rE((function(){return it(UR([{kind:_R.ClientFailure,reason:r.failureReason}]))}))};default:return k("calc.calc.partialWorkbookDocumentCollection.compileNamedFmla",r)}},e.prototype.checkFormula=function(e,t,r,n){if(!ot(t))return t;var a=this.analyzer.checkFormulaWithDiagnostics(e,t.value,n);return st(a[0])?at(a[0]):it(Ul("calc.PartialWorkbook.checkFormula: expected well-formed formula; given "+Ai(r),n,Ks(a[1])))},e.prototype.autocorrectFormula=function(e,t){return ot(t)&&En(hn.CalcClosingParen)?this.analyzer.autocorrectFormula(e,t.value):t},e.prototype.adjustFormulaOrigin=function(e,t,r){return ot(e)&&void 0!==r?at(Jv(t,r,e.value)):e},e.prototype.printFormulaBarText=function(e,t,r){return this.parser.formatFormula(_i(e,rr(e.range.sheet,t)),r)},e.prototype.getDocument=function(e){return void 0!==this.documentLoc&&void 0!==this.document&&vt(this.documentLoc,e)?at(this.document):this.unavailableFailure({kind:_R.DocumentLoc,document:e})},e.prototype.ensureDocument=function(e){return void 0===this.documentLoc&&void 0===this.document&&(this.documentLoc=e,this.document=new tE(e,this.config.localeInfo.stringCompareCI)),this.getDocument(e)},e.prototype.unavailableFailure=function(e){return it(e)},e.prototype.tryGetCellValues=function(e,t){var r=this,n=new Array(e.rows);return ht(e,(function(a,i,o){var u=r.tryGetCellValue(a,t);return void 0!==u&&((void 0!==n[i]?n[i]:n[i]=new Array(e.cols))[o]=u,!0)}))?n:void 0},e.prototype.tryGetCellValue=function(e,t){var r=rr(t,e),n=this.getRecalcValue(r);if(n.kind!==Be.Failure){var a=n.value,i=a.oper,o=a.clientFailure;if(void 0===o){var u=this.hasRecalcDirty(r);if(ot(u)){if(!u.value)return xl(i);var c=this.getEditedFormula(r);if(c.kind!==Be.Failure)if(void 0!==c.value){var s=c.value,l=s[0],f=s[1];if(void 0!==f.compiledFmla){if(ot(this.readCompiledFmla(tr(t,l),f.compiledFmla)))return Pl(rr(t,Ct(l)))}else this.onUnavailableObject({kind:_R.CellEvaluatingValue})}else this.setCellFailure(r,UR([{kind:_R.CellMissingFormula}]),AR);else this.onUnavailableObject(c.reason)}else this.onUnavailableObject(u.reason)}else{var d={kind:_R.ClientFailure,reason:o};this.setCellFailure(r,UR([d]),AR)}}else this.onUnavailableObject(n.reason)},e.prototype.makeGetCellValues=function(e){var t=this;return function(r){var n=t.allEditedAvailable(r);if(n.kind===Be.Failure)return it(UR([n.reason]));if(!n.value)return it(UR([{kind:_R.GridRange,range:r}]));var a=t.hasRecalcFailure(r);if(a.kind===Be.Failure)return it(UR([a.reason]));if(a.value)return it(Yl(r));if(Ff(r.range)>t.maxDereferenceCells)return it(UR([{kind:_R.GridRangeSize,range:r}]));var i=e(r.range,r.sheet);return void 0===i?it(Yl(r)):at(i)}},e.prototype.readCompiledFmla=function(e,t){var r=t.getValue();if(ot(r))return r;if(this.setCellFailure(e,r.reason,AR),r.reason.kind===Mt.Unavailable){r.reason;return r}return it(UR([{kind:_R.CellFormula,reason:r.reason}]))},e.prototype.getEditedUsedRange=function(e){var t=this.getDocument(e.document);if(t.kind===Be.Failure)return t;var r=t.value.getEditedUsedRange(e.index);return r.kind===Be.Failure||void 0===r.value?r:at(tr(e,r.value))},e.prototype.getSheetRangeIds=function(e){var t=this.getDocument(e.document);return t.kind===Be.Failure?t:t.value.getSheetRangeIds(e)},e.prototype.allEditedAvailable=function(e){var t=this.getDocument(e.sheet.document);return t.kind===Be.Failure?t:t.value.allEditedAvailable(e)},e.prototype.hasRecalcDirty=function(e){var t=this.getDocument(e.sheet.document);return t.kind===Be.Failure?t:t.value.hasRecalcDirty(e)},e.prototype.hasRecalcFailure=function(e){var t=this.getDocument(e.sheet.document);return t.kind===Be.Failure?t:t.value.hasRecalcFailure(e)},e.prototype.hasEditedEditTaint=function(e){var t=this.getDocument(e.sheet.document);return t.kind===Be.Failure?t:t.value.hasEditedEditTaint(e)},e.prototype.hasRecalcEditTaint=function(e){var t=this.getDocument(e.sheet.document);return t.kind===Be.Failure?t:t.value.hasRecalcEditTaint(e)},e.prototype.setEditedFormat=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===Be.Failure?r:r.value.setEditedFormat(e,t)},e.prototype.setRecalcFailure=function(e,t){var r=this.getDocument(e.document);return r.kind===Be.Failure?r:r.value.setRecalcFailure(e.index,t)},e.prototype.hasRecalcValueChanged=function(e,t){var r=this.hasRecalcFailure(e);if(r.kind===Be.Failure||r.value)return r;var n=this.getRecalcValue(e);return n.kind===Be.Failure?n:at(void 0!==n.value.clientFailure||!_t(n.value.oper,t,!1))},e.prototype.setRecalcEditTaint=function(e,t){var r=this.getDocument(e.document);return r.kind===Be.Failure?r:r.value.setRecalcEditTaint(e.index,t)},e.prototype.propagateEditTaint=function(e,t){var r=this.hasEditedEditTaint(e);if(r.kind===Be.Failure)return r;if(r.value)return at(xC.EditedCell);for(var n=0,a=t.cells;n<a.length;n++){var i=a[n],o=this.hasRecalcEditTaint(i);if(o.kind===Be.Failure)return o;if(o.value){var u=this.setRecalcEditTaint(e.sheet,wC(e.range));return u.kind===Be.Failure?u:at(xC.DependentCell)}}return t.bound===W.Exact||void 0!==this.evalParams&&this.evalParams.computeKind===UC.EditedCell?at(xC.IndependentCell):at(xC.UnknownNonEditedCell)},e.prototype.setEditedAndRecalcValues=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===Be.Failure?r:r.value.setEditedAndRecalcValues(e,t)},e.prototype.hasRecalcNameFailure=function(e){var t=this.getDocument(e.scope.document);return t.kind===Be.Failure?t:t.value.hasRecalcNameFailure(e)},e.prototype.setRecalcNameFailure=function(e){var t=this.getDocument(e.scope.document);return t.kind===Be.Failure?t:t.value.setRecalcNameFailure(e)},e.prototype.setNameFailure=function(e,t){var r=this.setRecalcNameFailure(e);if(r.kind===Be.Failure)return this.onUnavailableObject(r.reason);this.onNameFailure(e,t,this.evalParams)},e}(),RR=function(e,t){return(e<<t|e>>>32-t)>>>0},IR=function(){function e(e){this.x=new Uint32Array([4058668781,e,e,e]);for(var t=0;t<20;t+=1)this.nextU32()}return e.prototype.next=function(){return this.nextU32()*(1/4294967296)},e.prototype.nextU32=function(){var e=this.x[0]-RR(this.x[1],27)>>>0;return this.x[0]=(this.x[1]^RR(this.x[2],17))>>>0,this.x[1]=this.x[2]+this.x[3]>>>0,this.x[2]=this.x[3]+e>>>0,this.x[3]=e+this.x[0]>>>0},e}();function TR(e,t){return e&t-1}var NR,FR=function(){function e(){this.front=0,this.count=0,this.values=[void 0]}return e.prototype.getCount=function(){return this.count},e.prototype.maybeResize=function(){var e=this.values.length;if(this.count>=e){this.values.length=e<<1;for(var t=0;t<this.front;t+=1)this.values[e+t]=this.values[t],this.values[t]=void 0}else{var r=e>>4;if(r>=1&&this.count<r){for(t=0;t<this.count;t+=1)this.values[TR(this.front+t,r)]=this.values[TR(this.front+t,e)];this.values.length=r,this.front=TR(this.front,r)}}},e.prototype.pushBack=function(e){this.maybeResize(),this.values[TR(this.front+this.count,this.values.length)]=e,this.count+=1},e.prototype.pushFront=function(e){this.maybeResize();var t=TR(this.front-1,this.values.length);this.values[t]=e,this.front=t,this.count+=1},e.prototype.peekBack=function(){return this.values[TR(this.front+this.count-1,this.values.length)]},e.prototype.peekFront=function(){return this.values[this.front]},e.prototype.popBack=function(){var e=TR(this.front+this.count-1,this.values.length),t=this.values[e];return void 0!==t&&(this.values[e]=void 0,this.count-=1),t},e.prototype.popFront=function(){var e=this.values[this.front];return void 0!==e&&(this.values[this.front]=void 0,this.front=TR(this.front+1,this.values.length),this.count-=1),e},e.prototype.forEach=function(e){for(var t=this.values.length,r=0;r<this.count;r+=1){if(!e(this.values[TR(this.front+r,t)]))return!1}return!0},e}();!function(e){e[e.Back=0]="Back",e[e.Front=1]="Front"}(NR||(NR={}));var _R,MR=function(){function e(){this.minPriority=0,this.taskDeqs=[]}return e.prototype.deleteTasks=function(e,t){var r=this.taskDeqs[e];if(r)for(var n;n=r.popFront();)"function"!=typeof n&&n.onDeleted&&n.onDeleted(t)},e.prototype.addTask=function(e,t,r){var n,a=null!=(n=this.taskDeqs[e])?n:this.taskDeqs[e]=new FR;t===NR.Back?a.pushBack(r):a.pushFront(r),e<this.minPriority&&(this.minPriority=e)},e.prototype.runTask=function(){for(var e,t=this.minPriority;t<this.taskDeqs.length;t+=1){this.minPriority=t;var r=null===(e=this.taskDeqs[t])||void 0===e?void 0:e.popFront();if(r)return"function"==typeof r?r():r.onRun(),!0}return!1},e.prototype.getCount=function(){return this.taskDeqs.reduce((function(e,t){return t?e+t.getCount():e}),0)},e}(),DR=zt(0,0,1<<20,16384);!function(e){e.DocumentLoc="DocumentLoc",e.SheetId="SheetId",e.GridRange="GridRange",e.GridRangeSize="GridRangeSize",e.CellFormat="CellFormat",e.HiddenRows="HiddenRows",e.InFilterMode="InFilterMode",e.CellFormula="CellFormula",e.CellMissingFormula="CellMissingFormula",e.CellEvaluatingValue="CellEvaluatingValue",e.ClientFailure="ClientFailure",e.NumberFormat="NumberFormat",e.NameLoc="NameLoc",e.VolatileFunction="VolatileFunction",e.PrecisionIncorrect="PrecisionIncorrect",e.PrecisionUnknown="PrecisionUnknown"}(_R||(_R={}));var wR,LR,UR=Tl;!function(e){e.EvalFinished="EvalFinished",e.EvalTimedOut="EvalTimedOut",e.StateIdAdvanced="StateIdAdvanced",e.EditReceived="EditReceived",e.SetSheetNames="SetSheetNames",e.SetRefStyle="SetRefStyle",e.SetLocaleInfo="SetLocaleInfo"}(wR||(wR={})),function(e){e[e.ServerUpdate=0]="ServerUpdate",e[e.ClientEdit=1]="ClientEdit",e[e.EvalFormula=2]="EvalFormula",e[e.BeforeCompute=3]="BeforeCompute",e[e.ComputeCellValue=4]="ComputeCellValue",e[e.AfterCompute=5]="AfterCompute",e[e.ComputeEvalFormula=6]="ComputeEvalFormula",e[e.RecalcFinished=7]="RecalcFinished",e[e.MaybeCollectGarbage=8]="MaybeCollectGarbage",e[e.PrecisionComputeCellValue=9]="PrecisionComputeCellValue",e[e.PrecisionPrintFormula=10]="PrecisionPrintFormula",e[e.RunExperiment=11]="RunExperiment",e[e.TestAdvanceState=12]="TestAdvanceState"}(LR||(LR={}));var xR=function(){function e(e,t,r,n,a){var i,o=n.date1904,u=n.dateCompatibility,c=n.timezone;void 0===a&&(a={}),this.scheduler=new MR,this.outputMessageLog=[],this.stateId=-1/0,this.stateChangesSinceLastGC=0,this.stateChanges=0,this.stateEvalTime=0,this.docs=new bR(da(e,r,t,o,u,c),this.onNameFailure.bind(this),this.onRangeFailure.bind(this),this.logUnavailableObject.bind(this),this.onSetCellValue.bind(this),this.onSetCellValues.bind(this),a,a,null!=(i=a.maxDereferenceCells)?i:32768),this.reconfigure(a)}return e.prototype.reconfigure=function(e){var t;this.config=e,this.rng=new IR(void 0!==e.rngSeed?e.rngSeed:0),this.docs.reconfigure(e,e,null!=(t=e.maxDereferenceCells)?t:32768)},e.prototype.onNameFailure=function(e,t,r){var n=r.computeKind;n!==UC.PrecisionTest&&n!==UC.EvalFormula&&this.outputMessageLog.push({kind:tS.NameFailure,stateId:this.stateId,name:e,reason:t})},e.prototype.onRangeFailure=function(e,t,r,n,a){var i=a,o=i.computeKind,u=i.computeCell;if(o!==UC.PrecisionTest)o!==UC.EvalFormula&&this.outputMessageLog.push({kind:tS.RangeFailure,stateId:this.stateId,cellKind:n,range:e,reason:t});else if(pt(e.sheet,u.sheet)&&mS(e.range,u.range)){var c={samples:[],failures:[t]};this.outputMessageLog.push({kind:tS.PrecisionEvalStatistics,stateId:this.stateId,stats:c})}},e.prototype.setWorksheetFuncOverrides=function(e){this.docs.setWorksheetFuncOverrides(e)},e.prototype.logUnavailableObject=function(e){var t=UR([e]);this.outputMessageLog.push({kind:tS.UnhandledFailure,stateId:this.stateId,reason:t})},e.prototype.onSetCellValue=function(e,t,r,n,a,i){var o=a,u=o.computeKind,c=o.computeCell;if(u===UC.PrecisionTest)return this.setPrecisionResult(c,e,t,r);if(u!==UC.EvalFormula){var s=void 0,l=this.docs.getEditedFormat(e);if(l.kind===Be.Failure)return this.logUnavailableObject(l.reason);var f=this.docs.getServerFormat(e);if(f.kind===Be.Failure)return this.logUnavailableObject(f.reason);l.value!==f.value&&"object"==typeof l.value&&(s=this.docs.resolveIformat(l.value));var d=void 0;n===xC.EditedCell&&(d=this.predictFormulaBarText(e)),i||void 0!==s||void 0!==d?(this.outputMessageLog.push({kind:tS.RecalcStatistics,message:qC.ChangedCell,stateId:this.stateId,cellKind:n}),n!==xC.EditedCell&&n!==xC.DependentCell||this.outputMessageLog.push({kind:tS.CellWrite,stateId:this.stateId,cellKind:n,cell:e,value:t,format:s,formulaBarText:d})):this.outputMessageLog.push({kind:tS.RecalcStatistics,message:qC.UnchangedCell,stateId:this.stateId,cellKind:n})}},e.prototype.onSetCellValues=function(e,t,r,n,a){var i=this,o=a,u=o.computeKind,c=o.computeCell;if(u!==UC.PrecisionTest){if(u!==UC.EvalFormula){var s=void 0;n===xC.EditedCell&&(s=this.predictFormulaBarText(e)),n!==xC.EditedCell&&n!==xC.DependentCell||this.outputMessageLog.push({kind:tS.RangeWrite,stateId:this.stateId,cellKind:n,range:e,values:t,formulaBarText:s})}}else ht(e.range,(function(n,a,o){return i.setPrecisionResult(c,rr(e.sheet,n),t[a][o],r),!0}))},e.prototype.predictFormulaBarText=function(e){var t=St(e),r=this.getAvailableFormula(t);if(ot(r)){var n=r.value,a=n[0],i=n[1],o=i.compiledFmla.getValue(),u=ot(o)?this.docs.printFormulaBarText(a,t.range,o.value):o;if(u.kind===Be.Success){if(!mt(i.origin,t.range)||u.value!==i.fmla)return u.value}else this.outputMessageLog.push({kind:tS.PrintFormulaFailure,stateId:this.stateId,range:e,reason:u.reason})}else this.logUnavailableObject(r.reason)},e.prototype.getAvailableFormula=function(e){var t=this.docs.getEditedFormula(e);if(t.kind===Be.Failure)return t;if(void 0===t.value)return it({kind:_R.CellMissingFormula});var r=t.value,n=r[0],a=r[1];return void 0===a.compiledFmla?it({kind:_R.CellEvaluatingValue}):at([jt(a.lexicalKind,tr(e.sheet,n)),a])},e.prototype.setPrecisionResult=function(e,t,r,n){var a=this.docs.allServerAvailable(t);if(a.kind===Be.Failure)return this.logUnavailableObject(a.reason);if(gt(e,t)){var i=this.getAvailableFormula(t);if(!ot(i))return this.logUnavailableObject(i.reason);var o=i.value,u=o[0],c=o[1];if(!a.value)return this.logUnavailableObject({kind:_R.GridRange,range:t});var s=this.docs.getServerValue(t);if(s.kind===Be.Failure)return this.logUnavailableObject(s.reason);var l={samples:[this.precisionResult(r,s.value,u,c)],failures:[]};this.outputMessageLog.push({kind:tS.PrecisionEvalStatistics,stateId:this.stateId,stats:l})}else if(a.value){var f=this.docs.getServerValue(t);if(f.kind===Be.Failure)return this.logUnavailableObject(f.reason);_t(r,f.value,!0)||this.docs.setCellFailure(t,UR([{kind:_R.PrecisionIncorrect}]),n)}else this.docs.setCellFailure(t,UR([{kind:_R.PrecisionUnknown}]),n)},e.prototype.precisionResult=function(e,t,r,n){var a=zC(t),i=this.docs.anonymizeFormula(r,n),o=i[0],u=i[1];if(_t(e,t,!0))return{expected:a,formula:o,functions:u};var c=zC(e);return"number"==typeof t&&"number"==typeof e?{expected:a,sampled:c,relMagnitude:XC(0===t?e:(e-t)/t),formula:o,functions:u}:{expected:a,sampled:c,formula:o,functions:u}},e.prototype.handleSetCellContents=function(e,t,r,n,a,i,o,u,c){var s=this,l=void 0!==n?n:void 0!==r&&oy(r),f=!e&&l?Le:a,d=this.docs.setCellContents(e,t,r,l,i,f,u,o,c);if(d.kind===Be.Failure)return this.logUnavailableObject(d.reason);if(this.docs.onCellModified(e),e)void 0!==u||!l&&void 0!==r||HC(t.set,(function(e){return s.shouldSample(s.config.samplePrecisionEvalRate)&&s.enqueueComputeCellValue(rr(t.sheet,e),UC.PrecisionTest),s.shouldSample(s.config.samplePrecisionPrintFormulaRate)&&s.enqueuePrecisionPrintFormula(rr(t.sheet,e)),!0}));else{if(l){var h=rr(t.sheet,i);this.docs.inferRangeFormat(t.set,h).forEach(this.logUnavailableObject.bind(this))}this.enqueueBeforeCompute(c)}},e.prototype.enqueuePrecisionPrintFormula=function(e){var t=this;this.scheduler.addTask(LR.PrecisionPrintFormula,NR.Back,(function(){var r=t.getAvailableFormula(e);if(!ot(r))return t.logUnavailableObject(r.reason);var n=r.value,a=n[0],i=n[1],o=i.compiledFmla.getValue(),u=ot(o)?t.docs.printFormulaBarText(a,i.origin,o.value):o;if(ot(u)){var c=Ai(i.fmla),s=u.value===i.fmla?{expected:c}:{expected:c,sampled:Ai(u.value)};t.outputMessageLog.push({kind:tS.PrecisionPrintFormulaStatistics,stateId:t.stateId,stats:{samples:[s],failures:[]}})}else t.outputMessageLog.push({kind:tS.PrecisionPrintFormulaStatistics,stateId:t.stateId,stats:{samples:[],failures:[u.reason]}})}))},e.prototype.handleSetRangeFormula=function(e,t,r,n,a){var i=oy(r);b("calc.calc.PartialWorkbook: handleSetRangeFormula",""===r&&!e||i);var o=e?void 0:Le,u=!!e&&void 0,c=this.docs.setRangeFormula(e,t,r,n,o,u,a);if(c.kind===Be.Failure)return this.logUnavailableObject(c.reason);this.docs.onCellModified(e),e||this.enqueueBeforeCompute(a)},e.prototype.evalFormula=function(e,t,r){var n=this;return new Promise((function(a){var i=function(){return a(it(Vl))};n.scheduler.deleteTasks(LR.EvalFormula,void 0),n.scheduler.addTask(LR.EvalFormula,NR.Back,{onRun:function(){if(!n.trySetStateId(LR.EvalFormula,e))return i();n.enqueueComputeEvalFormula(t,r,a)},onDeleted:i}),n.enqueueRecalcFinished()}))},e.prototype.enqueueBeforeCompute=function(e){var t=this;this.scheduler.deleteTasks(LR.BeforeCompute,void 0),this.scheduler.addTask(LR.BeforeCompute,NR.Back,(function(){t.enqueueAfterCompute(),t.scheduleViewportCells(t.docs.getDirtyEditedCells(),e,UC.EditedCell),t.scheduleViewportCells(t.docs.getDirtyDependentCells(),e,UC.DependentCell)}))},e.prototype.withEvalTiming=function(e){var t=this.docs.schedulerConfig.totalTimeMs;if(void 0===t)return e();var r,n=Cr();try{r=e()}finally{this.stateEvalTime+=pr(1,Cr()-n),this.stateEvalTime>=t&&(this.deleteComputeTasks(wR.EvalTimedOut),this.outputMessageLog.push({kind:tS.RecalcStatistics,stateId:this.stateId,message:qC.StateTimedOut}),r=[])}return r},e.prototype.enqueueComputeCellValue=function(e,t){var r,n=this,a=t===UC.EditedCell&&this.shouldSample(this.config.sampleRecalcEditedStopwatchRate)?mn("calc.calc.PartialWorkbook: recalc edited"):void 0,i=t===UC.PrecisionTest?LR.PrecisionComputeCellValue:LR.ComputeCellValue,o=!0,u=function(){return n.docs.evaluate(t,e)},c=function(){var t,s;if(o){o=!1,r=n.shouldSample(n.config.sampleCellEvalStopwatchRate)?mn("calc.calc.PartialWorkbook: cell eval"):void 0,i===LR.PrecisionComputeCellValue&&n.docs.onCellModified(!0);var l=n.docs.hasRecalcDirty(e);if(!ot(l))return n.logUnavailableObject(l.reason);if(!l.value)return;var f=n.docs.getEditedFormula(e);if(f.kind===Be.Failure)return n.logUnavailableObject(f.reason);if(void 0===f.value)return}else n.outputMessageLog.push({kind:tS.RecalcStatistics,stateId:n.stateId,message:qC.ContinueComputation});var d=n.withEvalTiming(u);if(Array.isArray(d))return null===(t=r)||void 0===t||t.stop(),void(null===(s=a)||void 0===s||s.stop());u=d.resume,n.scheduler.addTask(i,NR.Front,c)};this.scheduler.addTask(i,NR.Back,c)},e.prototype.enqueueComputeEvalFormula=function(e,t,r){var n=this,a=function(){return n.docs.evalFormula(e,t)},i={onRun:function(){var e=a();e.kind===Be.Paused?(a=e.resume,n.scheduler.addTask(LR.ComputeEvalFormula,NR.Front,i)):r(e)},onDeleted:function(){return r(it(Vl))}};this.scheduler.addTask(LR.ComputeEvalFormula,NR.Back,i)},e.prototype.enqueueAfterCompute=function(){var e=this;this.scheduler.deleteTasks(LR.AfterCompute,wR.EditReceived);var t=this.shouldSample(this.config.sampleRecalcViewportStopwatchRate)?mn("calc.calc.PartialWorkbook: recalc viewport"):void 0;this.scheduler.addTask(LR.AfterCompute,NR.Back,{onRun:function(){var r;null===(r=t)||void 0===r||r.stop(wR.EvalFinished),e.outputMessageLog.push({kind:tS.RecalcStatistics,message:qC.EditFinished,stateId:e.stateId})},onDeleted:function(e){var r;null===(r=t)||void 0===r||r.stop(e)}})},e.prototype.enqueueRecalcFinished=function(){var e=this;this.scheduler.deleteTasks(LR.RecalcFinished,void 0),this.scheduler.addTask(LR.RecalcFinished,NR.Back,(function(){e.outputMessageLog.push({kind:tS.RecalcStatistics,message:qC.RecalcFinished,stateId:e.stateId})}))},e.prototype.promoteCellContents=function(e,t,r,n){var a=this;this.scheduler.addTask(LR.ServerUpdate,NR.Back,(function(){if(a.trySetStateId(LR.ServerUpdate,e)){var i=a.docs.promoteServerAvailability(r,n);if(i.kind===Be.Failure)return a.logUnavailableObject(i.reason);a.docs.onCellModified(!0),i.value||a.outputMessageLog.push({kind:tS.UpdateRequest,stateId:a.stateId,range:t})}}))},e.prototype.writeCellContents=function(e,t,r,n,a,i,o,u){var c=this,s=void 0!==o?ES(!0,o):void 0;this.scheduler.addTask(LR.ServerUpdate,NR.Back,(function(){c.trySetStateId(LR.ServerUpdate,e)&&c.handleSetCellContents(!0,t,r,n,i,a,s,u,void 0)}))},e.prototype.editCellContents=function(e,t,r,n,a,i,o){var u=this;void 0===i&&(i=Le),void 0===o&&(o=tr(t.sheet,DR)),this.scheduler.addTask(LR.ClientEdit,NR.Back,(function(){u.trySetStateId(LR.ClientEdit,e)&&u.handleSetCellContents(!1,t,r,n,i,a,!1,void 0,o)})),this.enqueueRecalcFinished()},e.prototype.writeArrayFormula=function(e,t,r,n,a){var i=this;void 0===n&&(n=Ct(t.range)),void 0===a&&(a=!1),this.scheduler.addTask(LR.ServerUpdate,NR.Back,(function(){i.trySetStateId(LR.ServerUpdate,e)&&i.handleSetRangeFormula(!0,t,r,n,void 0)}))},e.prototype.editArrayFormula=function(e,t,r,n,a){var i=this;void 0===n&&(n=Ct(t.range)),void 0===a&&(a=tr(t.sheet,DR)),this.scheduler.addTask(LR.ClientEdit,NR.Back,(function(){i.trySetStateId(LR.ClientEdit,e)&&i.handleSetRangeFormula(!1,t,r,n,a)})),this.enqueueRecalcFinished()},e.prototype.testAdvanceState=function(e){var t=this;this.scheduler.addTask(LR.TestAdvanceState,NR.Back,(function(){t.trySetStateId(LR.TestAdvanceState,e)}))},e.prototype.step=function(){if(!this.scheduler.runTask())return{queueEmpty:!0,messages:[]};var e=this.outputMessageLog;return this.outputMessageLog=[],{queueEmpty:!1,messages:e}},e.prototype.trySetStateId=function(e,t){if(t<this.stateId)return!1;if(e===LR.ClientEdit&&(this.deleteComputeTasks(wR.EditReceived),this.stateEvalTime=0),t>this.stateId){if(this.stateId!==-1/0&&this.shouldSample(this.config.sampleWorkbookStatisticsRate)&&this.outputMessageLog.push({kind:tS.WorkbookStatistics,stateId:this.stateId,stats:this.getStatistics()}),2===this.stateChanges&&void 0!==this.config.experimentDefinitions)for(var r=this.config.experimentDefinitions,n=this.docs.cloneServer(),a=0,i=r.experiments;a<i.length;a++){var o=i[a];o.setContext(n),this.enqueueRunExperiment(r.budget,o)}this.deleteComputeTasks(wR.StateIdAdvanced);var u=this.stateId;this.stateId=t,this.docs.advanceState(u),this.outputMessageLog.push({kind:tS.StateAdvanced,stateId:this.stateId}),this.stateEvalTime=0,this.stateChangesSinceLastGC+=1,this.stateChanges+=1,this.enqueueMaybeCollectGarbage()}return!0},e.prototype.deleteComputeTasks=function(e){this.scheduler.deleteTasks(LR.BeforeCompute,void 0),this.scheduler.deleteTasks(LR.ComputeCellValue,void 0),this.scheduler.deleteTasks(LR.AfterCompute,e),e!==wR.EvalTimedOut&&this.scheduler.deleteTasks(LR.ComputeEvalFormula,void 0),this.scheduler.deleteTasks(LR.PrecisionComputeCellValue,void 0),this.scheduler.deleteTasks(LR.PrecisionPrintFormula,void 0)},e.prototype.enqueueRunExperiment=function(e,t){var r=this,n=function(){if(t.done)r.outputMessageLog.push({kind:tS.ExperimentRunResult,logMessage:t.resultLogMessage});else{var a=Cr();if(t.step(),Cr()-a<e||t.done)r.scheduler.addTask(LR.RunExperiment,NR.Front,n);else{var i=t.failedLogMessage;void 0!==i&&r.outputMessageLog.push({kind:tS.ExperimentRunResult,logMessage:i})}}};this.scheduler.addTask(LR.RunExperiment,NR.Back,n)},e.prototype.setSheetNames=function(e,t,r){var n=this;this.scheduler.addTask(LR.ServerUpdate,NR.Back,(function(){if(n.trySetStateId(LR.ServerUpdate,r)){var a=n.docs.setSheetNames(e,t);a.kind===Be.Failure&&n.logUnavailableObject(a.reason),n.deleteComputeTasks(wR.SetSheetNames)}}))},e.prototype.setRefStyle=function(e,t){var r=this;this.scheduler.addTask(LR.ServerUpdate,NR.Back,(function(){if(r.trySetStateId(LR.ServerUpdate,t)){var n=r.docs.config,a=n.localeInfo,i=n.mathpack,o=n.date1904,u=n.dateCompatibility,c=n.timezone;r.docs.setConfig(da(a,e,i,o,u,c)),r.docs.clearCompiledFormulas(),r.deleteComputeTasks(wR.SetRefStyle)}}))},e.prototype.setLocaleInfo=function(e,t){var r=this;this.scheduler.addTask(LR.ServerUpdate,NR.Back,(function(){if(r.trySetStateId(LR.ServerUpdate,t)){var n=r.docs.config,a=n.refStyle,i=n.mathpack,o=n.date1904,u=n.dateCompatibility,c=n.timezone;r.docs.setConfig(da(e,a,i,o,u,c)),r.docs.clearCompiledFormulas(),r.deleteComputeTasks(wR.SetLocaleInfo)}}))},e.prototype.setWorkbookProps=function(e,t){var r=this;this.scheduler.addTask(LR.ServerUpdate,NR.Back,(function(){if(r.trySetStateId(LR.ServerUpdate,t)){var n=r.docs.config,a=n.localeInfo,i=n.refStyle,o=n.mathpack,u=e.date1904,c=e.dateCompatibility,s=e.timezone;r.docs.setConfig(da(a,i,o,u,c,s))}}))},e.prototype.setNumberFormats=function(e,t,r){var n=this;this.scheduler.addTask(LR.ServerUpdate,NR.Back,(function(){n.trySetStateId(LR.ServerUpdate,r)&&n.docs.setNumberFormats(e,t)}))},e.prototype.writeNamedObject=function(e,t,r,n){var a=this;this.scheduler.addTask(LR.ServerUpdate,NR.Back,(function(){if(a.trySetStateId(LR.ServerUpdate,e)){var i=a.docs.setNamedObject(!0,or(t,r),n);return i.kind===Be.Failure?a.logUnavailableObject(i.reason):void 0}}))},e.prototype.writeUndefinedNames=function(e,t){var r=this;this.scheduler.addTask(LR.ServerUpdate,NR.Back,(function(){if(r.trySetStateId(LR.ServerUpdate,e)){var n=r.docs.setUndefinedNames(t);return n.kind===Be.Failure?r.logUnavailableObject(n.reason):void 0}}))},e.prototype.promoteNamedObjects=function(e,t,r){var n=this;this.scheduler.addTask(LR.ServerUpdate,NR.Back,(function(){if(n.trySetStateId(LR.ServerUpdate,e)){var a=n.docs.promoteNamedObjects(t,r);if(a.kind===Be.Failure)return n.logUnavailableObject(a.reason);a.value||n.outputMessageLog.push({kind:tS.UpdateNamesRequest,stateId:n.stateId,scope:t})}}))},e.prototype.extendUnusedRange=function(e,t){var r=this;this.scheduler.addTask(LR.ServerUpdate,NR.Back,(function(){if(r.trySetStateId(LR.ServerUpdate,t)){var n=r.docs.extendServerUnused(e.sheet,e.range);if(n.kind===Be.Failure)return r.logUnavailableObject(n.reason);r.docs.onCellModified(!0)}}))},e.prototype.writeHiddenRows=function(e,t){var r=this;this.scheduler.addTask(LR.ServerUpdate,NR.Back,(function(){if(r.trySetStateId(LR.ServerUpdate,e)){var n=r.docs.writeHiddenRows(t.sheet,t.range,t.hidden);return n.kind===Be.Failure?r.logUnavailableObject(n.reason):void 0}}))},e.prototype.writeInFilterMode=function(e,t){var r=this;this.scheduler.addTask(LR.ServerUpdate,NR.Back,(function(){if(r.trySetStateId(LR.ServerUpdate,e)){var n=r.docs.writeInFilterMode(t.sheet,t.inFilterMode);return n.kind===Be.Failure?r.logUnavailableObject(n.reason):void 0}}))},e.prototype.getStatistics=function(){return{queueSize:this.scheduler.getCount(),totalGridStatistics:this.docs.getGridStatistics(),totalNameStatistics:this.docs.getNameStatistics()}},e.prototype.enqueueMaybeCollectGarbage=function(){var e=this;this.scheduler.deleteTasks(LR.MaybeCollectGarbage,void 0),this.scheduler.addTask(LR.MaybeCollectGarbage,NR.Back,(function(){if(!(e.stateChangesSinceLastGC<17)){var t=e.stateId-17;e.docs.collectGarbage(t),e.outputMessageLog.push({kind:tS.GarbageCollected,minStateIdKept:t}),e.stateChangesSinceLastGC=0}}))},e.prototype.shouldSample=function(e){return void 0!==e&&this.rng.next()<=e},e.prototype.scheduleAvailableFormulas=function(e,t){var r=this;return this.docs.forEachEditedNonBlankCellInSet(e.sheet,e.set,(function(n){var a=rr(e.sheet,n),i=r.docs.getEditedFormula(a);return i.kind===Be.Failure?(r.logUnavailableObject(i.reason),!0):(void 0!==i.value&&void 0!==i.value[1].compiledFmla&&r.enqueueComputeCellValue(a,t),!0)}))},e.prototype.scheduleViewportCells=function(e,t,r){if(void 0!==t)for(var n=t.sheet,a=wC(t.range),i=0,o=e;i<o.length;i++){pt(n,(s=o[i]).sheet)&&this.scheduleAvailableFormulas(KC(n,EC(s.set,a)),r)}else for(var u=0,c=e;u<c.length;u++){var s=c[u];this.scheduleAvailableFormulas(s,r)}},e}();function PR(e){return new Promise((function(t){return setTimeout(t,e)}))}function GR(e,t){var r=t&&t.timeThreshold||10,n=t&&t.costThreshold||1,a=t&&t.macrotaskDelay||0,i={iterations:0,microtaskContinues:0,macrotaskContinues:0,macrotaskTotalDelay:0},o=Pm(),u=o[0],c=o[1],s=c[0],l=c[1];var f=!0;var d=PR(a),h=Cr();return function t(){if(!f||!function(){try{for(var t=0;t<n;){i.iterations+=1;var r=e();if(void 0===r)return!1;t+=r}return!0}catch(e){return l(e),!1}}())return s();var o=Cr();o-h<r?(Promise.resolve().then(t),i.microtaskContinues+=1):(d.then((function(){d=PR(a),h=Cr(),i.macrotaskTotalDelay+=h-o,t()})),i.macrotaskContinues+=1)}(),{promise:u,stop:function(){f=!1},stats:i}}var VR=function(){function e(e){this.stepDelay=e,this.done=!1,this.resultLogMessage="TestExperiment",this.failedLogMessage="TestExperiment exceeded budget",this.iters=0}return e.create=function(t){if("number"==typeof t)return new e(t);var r="calc.calc.TestExperiment: expected number; given "+t;O.ULS.traceTag(591974878,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Warning,r)},e.prototype.setContext=function(){},e.prototype.step=function(){for(var e=Cr();Cr()<e+this.stepDelay;);this.iters+=1,this.iters>1&&(this.done=!0)},e}();var BR={TestExperiment:VR.create.bind(VR)};function WR(e,t){var r=gr("en-US"),n=function(e,t,r){var n=_a().slice();return BS(t,cy,r,"localeData.worksheetFunctionNames").forEach((function(e){return n[e.functionId]=e.functionName})),Ma(e,n)}(r,e.worksheetFunctionNames,t),a=n.getWorksheetFuncId,i=n.getWorksheetFuncName,o=function(e,t){var r=Ra.slice();return BS(e,sy,t,"localeData.errorTypeNames").forEach((function(e){return r[e.errorType]=e.errorName})),r}(e.errorTypeNames,t);return Object(j.a)(Object(j.a)({},e),{parseNumber:Ea(ia()),getWorksheetFuncId:a,getWorksheetFuncName:i,isNumeral:Oa,getOrdinal:ka,isIdentStart:Aa,isIdentContinue:ba,stringCompareCI:r,errorNames:o})}function jR(e,t){return fr(t)?{index:e,length:1}:{index:e,length:mr(t-e)+1}}function HR(e,t){var r=jR(t.row,t.lastRow),n=r.index,a=r.length,i=jR(t.column,t.lastColumn),o=i.index,u=i.length;return tr(Yt(e,t.sheetId),zt(n,o,a,u))}function KR(e,t){var r=t.sheetId,n=t.usedRange;return lr(n)?HR(e,Object(j.a)({sheetId:r},n)):{sheet:Yt(e,r),range:void 0}}function qR(e,t,r){return{sheet:e.sheet,set:function(e,t,r){var n=uC({row:t}),a=uC({col:r}),i=SC(n,a);return kC(wC(e),i)}(e.range,t,r)}}function YR(e,t){return{sheet:e.sheet,range:e.range,hidden:t}}function JR(e){return dt(e)?Xp(e.sheet.index,e.range.row,e.range.col):Xp(e.sheet.index,e.range.row,e.range.col,e.range.row+e.range.rows-1,e.range.col+e.range.cols-1)}function QR(e,t,r,n){var a=Hg;if(fr(n))return a;for(var i=0;i<n.length;i+=1){var o=n[i];if(e<=o&&o<e+t){for(var u=1;i+u<n.length&&n[i+u]===o+u;)u+=1;i+=u-1,a=Dg(a,r(hr(o,o+u)))}}return a}function XR(e,t){switch(typeof t){case"string":case"boolean":return t;case"number":return e.fromNumber(t)}switch(t.kind){case"Blank":return Le;case"Error":return Ce(t.type);default:return}}function zR(e,t){switch(typeof t){case"string":case"boolean":return t;case"number":return e.toNumber(t)}switch(t.kind){case x.Error:return Kp(t.type);case x.Blank:return Hp;default:return}}function ZR(e,t,r){if(!fr(r)){switch(r.kind){case"NamedValue":switch(typeof r.value){case"string":case"boolean":return Jy(r.value);case"number":return Jy(e.fromNumber(r.value))}return"Error"===r.value.kind?Jy(Ce(r.value.type)):k("calc.calc.namedObjectDataToNamedObject: NamedValue",r.value.kind);case"NamedFormula":return Qy(r.formulaBarText);case"NamedRange":var n=HR(t,r.range);return Jy(Me(n.sheet,n.range));case"NamedFailure":return Xy(r.failureReason,fr(r.objectKind)?void 0:r.objectKind)}return k("calc.calc.namedObjectDataToNamedObject: kind",r)}}function $R(e,t){var r,n;if(t.kind===Nl.NotImplemented)for(var a=0,i=t.features;a<i.length;a++){var o=i[a];xS(e,Nl.NotImplemented+" "+o)}else if(t.kind===Nl.IllFormedFormula)xS(e,Nl.IllFormedFormula+" "+((null!=(r=t.mode)?r:"")+" ")+JSON.stringify(null!=(n=t.diagnostics)?n:{}));else if(t.kind===Nl.Unavailable)for(var u=0,c=t.objects;u<c.length;u++){var s=c[u],l=[Nl.Unavailable];if("string"==typeof s.kind&&s.kind in _R){var f=s;switch(l.push(f.kind),f.kind){case _R.SheetId:l.push(f.sheetId);break;case _R.NameLoc:l.push(void 0===f.name.scope.index?"global":"sheet");break;case _R.ClientFailure:l.push(f.reason);break;case _R.VolatileFunction:l.push(f.name)}}else l.push(JSON.stringify(s));xS(e,l.join(" "))}else t.kind===Nl.LimitExceeded?xS(e,t.kind+" "+wl[t.limit]):xS(e,t.kind)}var eI=function(){function e(e,t,r){this.onRecalcResults=e,this.onUpdateRequest=t,this.currentOutputStateId=r,this.editedRangeDeltas=[],this.dependentRangeDeltas=[],this.arrayDeltas=[],this.rangeUpdateRequests=[],this.namesUpdateRequests=[],this.isRecalcFinished=!1}return e.prototype.setOutputStateId=function(e){e<=this.currentOutputStateId||(this.flush(),this.currentOutputStateId=e)},e.prototype.pushCellWrite=function(e,t){(e!==xC.DependentCell?this.editedRangeDeltas:this.dependentRangeDeltas).push(t)},e.prototype.pushRangeWrite=function(e){for(var t,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];(t=e!==xC.DependentCell?this.editedRangeDeltas:this.dependentRangeDeltas).push.apply(t,r)},e.prototype.pushUpdateRequest=function(e){this.rangeUpdateRequests.push(e)},e.prototype.pushUpdateNameRequest=function(e){this.namesUpdateRequests.push(e.index)},e.prototype.pushRecalcFinished=function(e){this.isRecalcFinished=this.isRecalcFinished||e},e.prototype.flush=function(){(this.rangeUpdateRequests.length>0||this.namesUpdateRequests.length>0)&&(this.onUpdateRequest(Dm(this.rangeUpdateRequests,[],this.namesUpdateRequests)),this.rangeUpdateRequests=[],this.namesUpdateRequests=[]),(this.editedRangeDeltas.length>0||this.arrayDeltas.length>0)&&(this.sendRecalcResults("Edited",this.editedRangeDeltas,this.arrayDeltas),this.editedRangeDeltas=[],this.arrayDeltas=[]),this.dependentRangeDeltas.length>0&&(this.sendRecalcResults("Dependents",this.dependentRangeDeltas,[]),this.dependentRangeDeltas=[]),this.isRecalcFinished&&(this.onRecalcResults(Mm(this.currentOutputStateId,"Dependents",!0,[],[])),this.isRecalcFinished=!1)},e.prototype.sendRecalcResults=function(e,t,r){for(var n=0;n<Math.max(t.length,r.length);n+=10)this.onRecalcResults(Mm(this.currentOutputStateId,e,!1,t.slice(n,n+10),r.slice(n,n+10)))},e}(),tI=function(){function e(e,t,r){this.onRecalcResults=e,this.onUpdateRequest=t,this.onGC=r,this.document=Kt(void 0,""),this.localeInfo=La(),this.mathpack=ia(),this.refStyle=F.A1,this.currentInputStateId=-1/0,this.currentOutputStateId=-1/0,this.recalcStatistics=YC,this.precisionEvalStatistics=ZC,this.precisionPrintFormulaStatistics=rS,this.nameFailures=[],this.rangeFailures=[],this.printFormulaFailures=[],this.unhandledFailures=[],this.ignoredInputStats={},this.ignoredOutputStats={},this.setConfig({}),this.setProps({}),this.dataModel=new xR(this.localeInfo,this.mathpack,this.refStyle,this.props,this.config)}return e.prototype.ping=function(){},e.prototype.setInputStateId=function(e){var t=e-this.currentInputStateId;return t<0?(this.logInputStateIdDecrease(),!1):(0!==t&&(this.flushInputLogs(),this.currentInputStateId=e),!0)},e.prototype.setOutputStateId=function(e){var t=e-this.currentOutputStateId;return t<0?(this.logOutputStateIdDecrease(),!1):(0!==t&&(this.flushOutputLogs(),this.currentOutputStateId=e),!0)},e.prototype.clearAsyncResumeRecalc=function(){void 0!==this.recalcLoop&&this.recalcLoop.stop()},e.prototype.resumeRecalc=function(){var e=this;return this.clearAsyncResumeRecalc(),this.recalcLoop=GR((function(){var t=e.dataModel.step(),r=t.messages,n=t.queueEmpty;return r.length>0&&e.processRecalcResults(r),n?void 0:1}),{costThreshold:1,timeThreshold:this.config.yieldIntervalMs}),xm(this.recalcLoop.promise,(function(){e.recalcLoop=void 0}))},e.prototype.processRecalcResults=function(e){for(var t,r,n=new eI(this.onRecalcResults,this.onUpdateRequest,this.currentOutputStateId),a=0,i=e;a<i.length;a++){var o=i[a];if(o.kind!==tS.GarbageCollected)if(o.kind!==tS.ExperimentRunResult){if(this.setOutputStateId(o.stateId))switch(n.setOutputStateId(o.stateId),o.kind){case tS.CellWrite:var u=o.cell,c=o.value,s=o.format,l=o.cellKind,f=o.formulaBarText,d=u.sheet,h=u.range,v=this.cellWriteToRangeDelta(d.index,h.row,h.col,c,s,f,"messages.<index>.value");lr(v)&&n.pushCellWrite(l,v);break;case tS.RangeWrite:var p=o.range,m=o.values;l=o.cellKind,f=o.formulaBarText,d=p.sheet,h=p.range;n.pushRangeWrite.apply(n,Object(j.f)([l],this.rangeWriteToRangeDeltas(d.index,h,m,f,"messages.<index>.values")));break;case tS.NameFailure:this.nameFailures.push(o);break;case tS.RangeFailure:this.rangeFailures.push(o);break;case tS.PrintFormulaFailure:this.printFormulaFailures.push(o);break;case tS.UnhandledFailure:this.unhandledFailures.push(o);break;case tS.UpdateRequest:n.pushUpdateRequest(JR(o.range));break;case tS.UpdateNamesRequest:n.pushUpdateNameRequest(o.scope);break;case tS.RecalcStatistics:n.pushRecalcFinished(o.message===qC.RecalcFinished),this.recalcStatistics=QC(this.recalcStatistics,o);break;case tS.PrecisionEvalStatistics:this.precisionEvalStatistics=(t=this.precisionEvalStatistics,r=o.stats,{samples:$C(t.samples,r.samples),failures:$C(t.failures,r.failures)});break;case tS.PrecisionPrintFormulaStatistics:this.precisionPrintFormulaStatistics=nS(this.precisionPrintFormulaStatistics,o.stats);break;case tS.WorkbookStatistics:this.logWorkbookStats(o.stateId,o.stats);break;case tS.StateAdvanced:break;default:return k("calc.calc.RecalcServiceImpl.processRecalcResults",o)}}else this.logExperimentRunResult(o.logMessage);else this.onGC(o.minStateIdKept)}n.flush()},e.prototype.logExperimentRunResult=function(e){O.ULS.traceTag(594409422,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,"calc.calc.RecalcService: experiment done; "+e)},e.prototype.logAllFailureStats=function(){var e=this.nameFailures;this.nameFailures=[];var t=this.rangeFailures;this.rangeFailures=[];var r=this.printFormulaFailures;this.printFormulaFailures=[];var n=this.unhandledFailures;this.unhandledFailures=[],this.logGenFailureStats(e,595194337,"name",f.TraceLevel.Info),this.logCellFailureStats(t,595658722,"range",f.TraceLevel.Info),this.logGenFailureStats(r,592730065,"print-formula",f.TraceLevel.Info),this.logGenFailureStats(n,595194338,"unhandled",f.TraceLevel.Warning)},e.prototype.logGenFailureStats=function(e,t,r,n){if(0!==e.length){for(var a={},i=0,o=e;i<o.length;i++){$R(a,o[i].reason)}var u="calc.calc.RecalcService: recalc "+r+" failures; stateId = "+this.currentOutputStateId+", stats = "+JSON.stringify(a);O.ULS.traceTag(t,f.LogCategory.msoulscat_ES_EWAJS,n,u),this.logJavaScriptFailures(e,r)}},e.prototype.logCellFailureStats=function(e,t,r,n){var a=this;if(0!==e.length){for(var i={},o=0,u=e;o<u.length;o++){var c=u[o],s=c.reason,l=c.cellKind;$R(i[l]||(i[l]={}),s)}Object.getOwnPropertyNames(i).sort().forEach((function(e){var o=i[e],u="calc.calc.RecalcService: recalc "+r+" failures; stateId = "+a.currentOutputStateId+", cell kind = "+e+", stats = "+JSON.stringify(o);O.ULS.traceTag(t,f.LogCategory.msoulscat_ES_EWAJS,n,u)})),this.logJavaScriptFailures(e,r)}},e.prototype.logJavaScriptFailures=function(e,t){for(var r=0,n=e;r<n.length;r++){var a=n[r].reason;if(a.kind===Nl.JavaScriptError){var i="calc.calc.RecalcService: recalc "+t+" JavaScript error: "+p(a.error);O.ULS.traceTag(595658721,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Warning,i)}}},e.prototype.logIgnoredStats=function(e,t,r,n){if(0!==Object.getOwnPropertyNames(n).length){var a="calc.calc.RecalcService: ignored "+r+" data; "+("stateId = "+t+", stats = "+JSON.stringify(n));O.ULS.traceTag(e,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,a)}},e.prototype.logIgnoredInputStats=function(){this.logIgnoredStats(595658723,this.currentInputStateId,"input",this.ignoredInputStats),this.ignoredInputStats={}},e.prototype.logIgnoredOutputStats=function(){this.logIgnoredStats(595658752,this.currentOutputStateId,"output",this.ignoredOutputStats),this.ignoredOutputStats={}},e.prototype.logRecalcStats=function(){if(this.currentOutputStateId!==-1/0){var e=this.recalcStatistics;if(this.recalcStatistics=YC,this.dataModel.shouldSample(this.config.sampleRecalcStatisticsRate)){var t="calc.calc.RecalcService: recalc statistics; "+("stateId = "+this.currentOutputStateId+", stats = "+JSON.stringify(e));O.ULS.traceTag(595654593,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,t)}}},e.prototype.logPrecisionEvalStats=function(){if(0!==this.precisionEvalStatistics.samples.length||0!==this.precisionEvalStatistics.failures.length){var e=this.precisionEvalStatistics,t=e.samples,r=e.failures,n={};r.forEach((function(e){return $R(n,e)}));var a="calc.calc.RecalcService: precision eval statistics; "+("stateId = "+this.currentOutputStateId+", stats = "+JSON.stringify({samples:t,failures:n}));O.ULS.traceTag(595645023,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,a),this.precisionEvalStatistics=ZC}},e.prototype.logPrecisionPrintFormulaStats=function(){if(0!==this.precisionPrintFormulaStatistics.samples.length||0!==this.precisionPrintFormulaStatistics.failures.length){var e=this.precisionPrintFormulaStatistics,t=e.samples,r=e.failures,n={};r.forEach((function(e){return $R(n,e)}));var a="calc.calc.RecalcService: precision print-formula statistics; "+("stateId = "+this.currentOutputStateId+", stats = "+JSON.stringify({samples:t,failures:n}));O.ULS.traceTag(592730059,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,a),this.precisionPrintFormulaStatistics=rS}},e.prototype.logWorkbookStats=function(e,t){var r="calc.calc.RecalcService: workbook statistics; "+("stateId = "+e+", stats = "+JSON.stringify(t));O.ULS.traceTag(595359882,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,r)},e.prototype.logInputStateIdDecrease=function(){xS(this.ignoredInputStats,"stateId went backwards")},e.prototype.logOutputStateIdDecrease=function(){xS(this.ignoredOutputStats,"stateId went backwards")},e.prototype.flushInputLogs=function(){this.logIgnoredInputStats()},e.prototype.flushOutputLogs=function(){this.logAllFailureStats(),this.logIgnoredOutputStats(),this.logRecalcStats(),this.logPrecisionEvalStats(),this.logPrecisionPrintFormulaStats()},e.prototype.cellWriteToRangeDelta=function(e,t,r,n,a,i,o){if(VS(n,qy,this.ignoredOutputStats,o)){var u=zR(this.mathpack,n),c=function(e){if(void 0!==e)return Im(e.isExact,e.iformat,!1,e.category,e.decimals)}(a);return lr(i)||lr(u)||lr(c)?Nm(Xp(e,t,r),Tm(i,u,c)):void 0}},e.prototype.rangeWriteToRangeDeltas=function(e,t,r,n,a){for(var i=a+".<index>.<index>",o=t.row,u=t.col,c=t.rows,s=t.cols,l=[],f=0;f<c;f+=1)for(var d=0;d<s;d+=1){var h=this.cellWriteToRangeDelta(e,o+f,u+d,r[f][d],void 0,0===f&&0===d?n:void 0,i);lr(h)&&l.push(h)}return l},e.prototype.setA1ReferenceStyle=function(e){this.clearAsyncResumeRecalc(),this.refStyle=e?F.A1:F.R1C1,this.dataModel.setRefStyle(this.refStyle,this.currentInputStateId)},e.prototype.setLocale=function(e){this.clearAsyncResumeRecalc(),this.localeInfo=WR(e,this.ignoredInputStats),this.dataModel.setLocaleInfo(this.localeInfo,this.currentInputStateId)},e.prototype.setWorkbookProps=function(e){this.clearAsyncResumeRecalc(),VS(e,Wy,this.ignoredInputStats,"workbookProps")&&(this.setProps(e),this.dataModel.setWorkbookProps(this.props,this.currentInputStateId))},e.prototype.setNumberFormats=function(e,t){this.clearAsyncResumeRecalc(),this.dataModel.setNumberFormats(BS(e,fy,this.ignoredInputStats,"numberFormats"),t,this.currentInputStateId)},e.prototype.setSheetNames=function(e){this.updateSheetNames(this.currentInputStateId,e)},e.prototype.updateSheetNames=function(e,t){this.setInputStateId(e)&&(this.clearAsyncResumeRecalc(),this.dataModel.setSheetNames(this.document,BS(t,hy,this.ignoredInputStats,"sheetNames"),e))},e.prototype.updateNamedObjects=function(e,t){if(this.setInputStateId(e)){this.clearAsyncResumeRecalc();for(var r=0,n=BS(t,Dy,this.ignoredInputStats,"namedObjectsUpdates");r<n.length;r++){var a=n[r],i=a.scope,o=a.objects,u=a.fromStateId,c=ir(this.document,lr(i)?i:void 0);if(lr(o))for(var s=0,l=BS(o,My,this.ignoredInputStats,"namedObjectsUpdates.<index>.objects");s<l.length;s++){var f=l[s],d=f.name,h=f.data;this.dataModel.writeNamedObject(e,c,d,ZR(this.mathpack,this.document,h))}else lr(u)?this.dataModel.promoteNamedObjects(e,c,u):this.dataModel.writeUndefinedNames(e,c)}}},e.prototype.updateUnusedCells=function(e,t){if(this.setInputStateId(e)){this.clearAsyncResumeRecalc();for(var r=0,n=BS(t,Ry,this.ignoredInputStats,"unusedCellsUpdates");r<n.length;r++){var a=n[r];this.dataModel.extendUnusedRange(KR(this.document,a),e)}}},e.prototype.updateRanges=function(e,t){var r,n;if(this.setInputStateId(e)){this.clearAsyncResumeRecalc();for(var a=0,i=BS(t,ky,this.ignoredInputStats,"rangeUpdates");a<i.length;a++){var o=i[a],u=o.range,c=o.excludeRows,s=o.excludeColumns,l=o.data,f=o.fromStateId,d=HR(this.document,u),h=d.range,v=QR(h.row,h.rows,DC.row,c),p=qR(d,v,QR(h.col,h.cols,DC.col,s)),m=lr(l)?XR(this.mathpack,l.value):Le;if(void 0!==m){var g=Ct(h);if(lr(l)){var C=l.iformat,S="ArrayFormula"===l.kind?void 0:null!=(r=l.formulaBarText)?r:void 0,y=null!=(n=l.failureReason)?n:void 0;if("Inferred"===l.kind)this.dataModel.writeCellContents(e,p,S,void 0,g,m,C,y);else{var E="CellFormula"===l.kind;this.dataModel.writeCellContents(e,p,S,E,g,m,C,y)}}else fr(f)?this.dataModel.writeCellContents(e,p,"",!1,g,Le,0,void 0):this.dataModel.promoteCellContents(e,d,p,f);this.dataModel.writeHiddenRows(e,YR(d,v))}}}},e.prototype.updateArrays=function(e,t){if(this.setInputStateId(e)){this.clearAsyncResumeRecalc();for(var r=0,n=BS(t,by,this.ignoredInputStats,"arrayUpdates");r<n.length;r++){var a=n[r],i=a.range,o=a.data,u=a.fromStateId,c=HR(this.document,i);if(lr(o)){var s=o.formulaBarText,l=o.isSpilled,f=Ct(c.range);this.dataModel.writeArrayFormula(e,c,s,f,l)}else lr(u)}}},e.prototype.editRangeFormulas=function(e,t){var r=this;if(this.setInputStateId(e)){this.clearAsyncResumeRecalc();for(var n=BS(t,Py,this.ignoredInputStats,"rangeFormulaEdits"),a=function(t){var n=t.kind,a=t.range,o=t.formulaBarText,u=t.value,c=t.origin,s=t.viewport,l=Hg;a.forEach((function(e){l=SC(l,wC(HR(r.document,e).range))}));var f=HR(i.document,a[0]),d=lr(c)?Zt(c.row,c.column):Ct(f.range),h=lr(s)?HR(i.document,s):void 0,v=void 0;if(lr(u)){if(void 0===(v=XR(i.mathpack,u)))return"continue"}else v=void 0;var p="CellFormula"===n||"Value"!==n&&void 0;i.dataModel.editCellContents(e,KC(f.sheet,l),o,p,d,v,h)},i=this,o=0,u=n;o<u.length;o++){a(u[o])}}},e.prototype.editArrayFormulas=function(e,t){if(this.setInputStateId(e)){this.clearAsyncResumeRecalc();for(var r=0,n=BS(t,Gy,this.ignoredInputStats,"arrayFormulaEdits");r<n.length;r++){var a=n[r],i=a.range,o=a.formulaBarText,u=a.origin,c=a.viewport,s=HR(this.document,i),l=lr(u)?Zt(u.row,u.column):Zt(i.row,i.column),f=lr(c)?HR(this.document,c):void 0;this.dataModel.editArrayFormula(e,s,o,l,f)}}},e.prototype.setConfig=function(e){var t,r,n,a,i,o,u,c,s,l,f,d=Array.isArray(e.runExperiments)?{budget:(t=e.experimentBudget,null!=t?t:10),experiments:(f=e.runExperiments,f.map((function(e){var t=e.name,r=e.param;return BR[t](r)})).filter((function(e){return void 0!==e})))}:void 0;this.config={yieldIntervalMs:10,totalTimeMs:(r=e.totalEvalTimeMs,null!=r?r:1e4),maxCellChain:32768,maxNameChain:128,maxLambdaCalls:1e4,maxLambdaDepth:1e3,samplePrecisionEvalRate:(n=e.samplePrecisionEvalRate,null!=n?n:.02),samplePrecisionPrintFormulaRate:(a=e.samplePrecisionPrintFormulaRate,null!=a?a:.001),sampleRecalcStatisticsRate:(i=e.sampleRecalcStatisticsRate,null!=i?i:.2),sampleWorkbookStatisticsRate:(o=e.sampleWorkbookStatisticsRate,null!=o?o:.1),sampleCellEvalStopwatchRate:(u=e.sampleCellEvalStopwatchRate,null!=u?u:.003),sampleRecalcEditedStopwatchRate:(c=e.sampleRecalcEditedStopwatchRate,null!=c?c:1),sampleRecalcViewportStopwatchRate:(s=e.sampleRecalcViewportStopwatchRate,null!=s?s:1),rngSeed:(l=e.rngSeed,null!=l?l:1e3*Date.now()),experimentDefinitions:d}},e.prototype.setProps=function(e){var t,r,n;this.props={date1904:(t=e.date1904,null!=t&&t),dateCompatibility:(r=e.dateCompatibility,null==r||r),timezone:(n=e.timezone,null!=n?n:ua)}},e.prototype.reconfigure=function(e){this.setConfig(e),this.dataModel.reconfigure(this.config)},e.prototype.clearCache=function(){this.clearAsyncResumeRecalc(),this.dataModel=new xR(this.localeInfo,this.mathpack,this.refStyle,this.props,this.config),this.recalcStatistics=YC,this.precisionEvalStatistics=ZC,this.precisionPrintFormulaStatistics=rS,this.nameFailures=[],this.rangeFailures=[],this.unhandledFailures=[],this.ignoredInputStats={},this.ignoredOutputStats={},this.currentInputStateId=this.currentOutputStateId=-1/0},e.prototype.evalFormula=function(e,t,r){var n=this,a=Yt(this.document,r);return this.dataModel.evalFormula(e,t,a).then((function(e){if(ot(e)){if(!VS(e.value,Yy,n.ignoredOutputStats,"evalFormula"))throw new Error("ignored output");var t=zR(n.mathpack,e.value);return b("calc.calc.RecalcService.evalFormula",void 0!==t),at(t)}return it(e.reason.kind)}))},e.prototype.testAdvanceState=function(e){this.setInputStateId(e)&&(this.dataModel.testAdvanceState(e),this.clearAsyncResumeRecalc())},e.prototype.testDelay=function(e){return Object(j.b)(this,void 0,void 0,(function(){return Object(j.d)(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t){return setTimeout(t,e)}))];case 1:return t.sent(),[2]}}))}))},e}();function rI(){return{onError:function(e,t){var r="calc.calc.recalcServiceInsideDef.onError: "+JSON.stringify({kind:t.kind,closing:t.closing,message:p(t.error)});O.ULS.traceTag(595658753,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Warning,r)},onInit:function(e){var t=e.getImports("client",["onRecalcResults","onUpdateRequest","onGC"]),r=t.onRecalcResults,n=t.onUpdateRequest,a=t.onGC;e.setExports("service",new tI(r.notify,n.notify,a.notify))},scriptName:"excelOnlineRecalcService.worker"}}var nI;!function(e){e.Thread="Thread",e.Local="Local",e.ThreadOrLocal="ThreadOrLocal"}(nI||(nI={}));var aI=function(e){return void 0===e&&(e=nI.Thread),Object(j.b)(this,void 0,void 0,(function(){var t,r,n,a,i,o,u,c,s=this;return Object(j.d)(this,(function(l){switch(l.label){case 0:return t=!1,r={outside:{onError:function(e,r){var n=p(r.error),a="calc.calc.recalcServiceOutsideDef.onError: "+JSON.stringify({kind:r.kind,closing:r.closing,message:n});O.ULS.traceTag(595658719,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Warning,a),r.closing&&(t=!0)},onClosed:function(e){var r="calc.calc.recalcServiceOutsideDef.onClosed: recalc service closed "+(t?"because of an error":"normally");O.ULS.traceTag(595658720,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Warning,r),t=!0}},inside:rI()},[4,fg(e===nI.Thread?[Om.Dedicated]:e===nI.Local?[Om.FunctionCall]:[Om.Dedicated,Om.FunctionCall],r)];case 1:if(null==(n=l.sent()))throw new Error("could not create recalc service worker");return a="calc.calc.createRecalcService: worker created; outside.workerKind = "+n.workerKind,O.ULS.traceTag(595731987,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,a),i=-1/0,o={onRecalcResults:function(e){},onUpdateRequest:function(e){},onGC:function(e){i=e}},n.setExports("client",o),(u=n.getImports("service",["setA1ReferenceStyle","setLocale","setWorkbookProps","setNumberFormats","setSheetNames","updateSheetNames","updateUnusedCells","updateNamedObjects","updateRanges","updateArrays","editRangeFormulas","editArrayFormulas","resumeRecalc","reconfigure","clearCache","testAdvanceState","testDelay","evalFormula","ping"])).ping.callTimeout=3e4,c=function(e,t){},Bm((function(){return Object(j.b)(s,void 0,void 0,(function(){var e,r,n,a;return Object(j.d)(this,(function(i){switch(i.label){case 0:return[4,new Promise((function(e){return setTimeout(e,1e3)}))];case 1:if(i.sent(),t)return[2,void 0];e=Cr(),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,u.ping.call()];case 3:return i.sent(),[3,5];case 4:return i.sent(),r=u.ping.callTimeout,n=Cr()-e,a="calc.calc.RecalcService: unresponsive; timeout = "+r+", waitTime = "+n,O.ULS.traceTag(591934810,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Warning,a),c(r,n),[3,5];case 5:return[2,!0]}}))}))}),!0).catch((function(e){var t="calc.calc.RecalcService: ping loop threw an error: "+p(e);O.ULS.traceTag(590698012,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Warning,t)})),[2,{setOnRecalcResults:function(e){o.onRecalcResults=e},setOnUpdateRequest:function(e){o.onUpdateRequest=e},setOnUnresponsive:function(e){c=e},setA1ReferenceStyle:function(e){t||u.setA1ReferenceStyle.notify(e)},setLocale:function(e){t||u.setLocale.notify(e)},setWorkbookProps:function(e){t||u.setWorkbookProps.notify(e)},setNumberFormats:function(e,r){t||u.setNumberFormats.notify(e,r)},setSheetNames:function(e){t||u.setSheetNames.notify(e)},updateSheetNames:function(e,r){t||u.updateSheetNames.notify(e,r)},updateNamedObjects:function(e,r){t||u.updateNamedObjects.notify(e,r)},setUsedRanges:function(e,t){},updateUnusedCells:function(e,r){t||u.updateUnusedCells.notify(e,r)},updateRanges:function(e,r){t||u.updateRanges.notify(e,r)},updateArrays:function(e,r){t||u.updateArrays.notify(e,r)},editRangeFormulas:function(e,r){t||u.editRangeFormulas.notify(e,r)},editArrayFormulas:function(e,r){t||u.editArrayFormulas.notify(e,r)},resumeRecalc:function(){t||u.resumeRecalc.notify()},reconfigure:function(e){var r;t||(u.ping.callTimeout=null!=(r=e.responsivenessPingTimeout)?r:3e4,u.reconfigure.notify(e))},clearCache:function(){t||u.clearCache.notify()},testAdvanceState:function(e){t||u.testAdvanceState.notify(e)},testResumeRecalc:function(){return u.resumeRecalc.call()},testCrash:function(){return u.testDelay.isCritical=!0,u.testDelay.callTimeout=0,u.testDelay.call(100)},close:function(){n.close()},stateIdAvailable:function(e){return e>=i},evalFormula:function(e,t,r){return u.evalFormula.call(e,t,r)}}]}}))}))};r.d(t,"packageVersion",(function(){return"13.7.0"})),r.d(t,"location",(function(){return ii})),r.d(t,"formula",(function(){return si})),r.d(t,"value",(function(){return ui})),r.d(t,"signature",(function(){return fi})),r.d(t,"util",(function(){return hi})),r.d(t,"config",(function(){return pi})),r.d(t,"math",(function(){return gi})),r.d(t,"date",(function(){return Si})),r.d(t,"parse",(function(){return n})),r.d(t,"analyze",(function(){return o})),r.d(t,"runtime",(function(){return u})),r.d(t,"calc",(function(){return l})),r.d(t,"funcs",(function(){return s})),r.d(t,"worker",(function(){return c}))}]);
//# sourceMappingURL=excelOnlineCalc.min.js.map